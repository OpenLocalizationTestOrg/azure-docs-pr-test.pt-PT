# <a name="back-up-azure-unmanaged-vm-disks-with-incremental-snapshots"></a><span data-ttu-id="9f448-101">Criar cópias de segurança do Azure discos VM não geridos com instantâneos incrementais</span><span class="sxs-lookup"><span data-stu-id="9f448-101">Back up Azure unmanaged VM disks with incremental snapshots</span></span>
## <a name="overview"></a><span data-ttu-id="9f448-102">Descrição geral</span><span class="sxs-lookup"><span data-stu-id="9f448-102">Overview</span></span>
<span data-ttu-id="9f448-103">Armazenamento do Azure fornece a capacidade de Olá tootake instantâneos de blobs.</span><span class="sxs-lookup"><span data-stu-id="9f448-103">Azure Storage provides hello capability tootake snapshots of blobs.</span></span> <span data-ttu-id="9f448-104">Instantâneos capturam o estado de blob Olá neste ponto no tempo.</span><span class="sxs-lookup"><span data-stu-id="9f448-104">Snapshots capture hello blob state at that point in time.</span></span> <span data-ttu-id="9f448-105">Neste artigo, vamos descrever um cenário em que pode manter cópias de segurança dos discos da máquina virtual através de instantâneos.</span><span class="sxs-lookup"><span data-stu-id="9f448-105">In this article, we describe a scenario in which you can maintain backups of virtual machine disks using snapshots.</span></span> <span data-ttu-id="9f448-106">Pode utilizar este metodologia quando optar por não toouse cópia de segurança do Azure e o serviço de recuperação e desejar toocreate uma estratégia de cópia de segurança personalizada para os discos da máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="9f448-106">You can use this methodology when you choose not toouse Azure Backup and Recovery Service, and wish toocreate a custom backup strategy for your virtual machine disks.</span></span>

<span data-ttu-id="9f448-107">Discos de máquina virtual do Azure são armazenados como blobs de páginas no armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="9f448-107">Azure virtual machine disks are stored as page blobs in Azure Storage.</span></span> <span data-ttu-id="9f448-108">Uma vez que vamos são que descrevem uma estratégia de cópia de segurança para os discos da máquina virtual neste artigo, vamos Consulte toosnapshots no contexto de Olá de blobs de páginas.</span><span class="sxs-lookup"><span data-stu-id="9f448-108">Since we are describing a backup strategy for virtual machine disks in this article, we refer toosnapshots in hello context of page blobs.</span></span> <span data-ttu-id="9f448-109">toolearn mais informações sobre instantâneos, consulte demasiado[criar um instantâneo de um Blob](https://docs.microsoft.com/rest/api/storageservices/Creating-a-Snapshot-of-a-Blob).</span><span class="sxs-lookup"><span data-stu-id="9f448-109">toolearn more about snapshots, refer too[Creating a Snapshot of a Blob](https://docs.microsoft.com/rest/api/storageservices/Creating-a-Snapshot-of-a-Blob).</span></span>

## <a name="what-is-a-snapshot"></a><span data-ttu-id="9f448-110">O que é um instantâneo?</span><span class="sxs-lookup"><span data-stu-id="9f448-110">What is a snapshot?</span></span>
<span data-ttu-id="9f448-111">Um instantâneo do blob é uma versão só de leitura de um blob que é capturada num ponto no tempo.</span><span class="sxs-lookup"><span data-stu-id="9f448-111">A blob snapshot is a read-only version of a blob that is captured at a point in time.</span></span> <span data-ttu-id="9f448-112">Assim que tiver sido criado um instantâneo,-lo pode ser ler, copiar, ou eliminada, mas não modificado.</span><span class="sxs-lookup"><span data-stu-id="9f448-112">Once a snapshot has been created, it can be read, copied, or deleted, but not modified.</span></span> <span data-ttu-id="9f448-113">Os instantâneos proporcionar uma tooback de forma a segurança de um blob como é apresentado um momento.</span><span class="sxs-lookup"><span data-stu-id="9f448-113">Snapshots provide a way tooback up a blob as it appears at a moment in time.</span></span> <span data-ttu-id="9f448-114">Até REST versão 2015-04-05, era necessário instantâneos do Olá capacidade toocopy completa.</span><span class="sxs-lookup"><span data-stu-id="9f448-114">Until REST version 2015-04-05, you had hello ability toocopy full snapshots.</span></span> <span data-ttu-id="9f448-115">Com Olá REST versão 2015-07-08 e superior, também pode copiar instantâneos incrementais.</span><span class="sxs-lookup"><span data-stu-id="9f448-115">With hello REST version 2015-07-08 and above, you can also copy incremental snapshots.</span></span>

## <a name="full-snapshot-copy"></a><span data-ttu-id="9f448-116">Cópia de instantâneo completo</span><span class="sxs-lookup"><span data-stu-id="9f448-116">Full snapshot copy</span></span>
<span data-ttu-id="9f448-117">Instantâneos podem ser copiados tooanother conta de armazenamento como um cópias de segurança do blob tookeep do blob base Olá.</span><span class="sxs-lookup"><span data-stu-id="9f448-117">Snapshots can be copied tooanother storage account as a blob tookeep backups of hello base blob.</span></span> <span data-ttu-id="9f448-118">Também pode copiar um instantâneo ao longo do respetivo blob base, o que é como restaurar Olá blob tooan versão anterior.</span><span class="sxs-lookup"><span data-stu-id="9f448-118">You can also copy a snapshot over its base blob, which is like restoring hello blob tooan earlier version.</span></span> <span data-ttu-id="9f448-119">Quando um instantâneo é copiado a partir de um tooanother de conta de armazenamento, ocupar Olá mesmo espaço como blob de página base Olá.</span><span class="sxs-lookup"><span data-stu-id="9f448-119">When a snapshot is copied from one storage account tooanother, it occupies hello same space as hello base page blob.</span></span> <span data-ttu-id="9f448-120">Por conseguinte, copiar todo instantâneos de um tooanother de conta de armazenamento está lento e consome espaço na conta de armazenamento de destino Olá.</span><span class="sxs-lookup"><span data-stu-id="9f448-120">Therefore, copying whole snapshots from one storage account tooanother is slow and consumes much space in hello target storage account.</span></span>

> [!NOTE]
> <span data-ttu-id="9f448-121">Se copiar o destino de tooanother de base blob Olá, Olá os instantâneos de blob Olá não são copiados, juntamente com o mesmo.</span><span class="sxs-lookup"><span data-stu-id="9f448-121">If you copy hello base blob tooanother destination, hello snapshots of hello blob are not copied along with it.</span></span> <span data-ttu-id="9f448-122">Da mesma forma, se substituir um blob base com uma cópia, instantâneos associados blob base Olá não são afetados e permanecem intactos sob o nome do base blob Olá.</span><span class="sxs-lookup"><span data-stu-id="9f448-122">Similarly, if you overwrite a base blob with a copy, snapshots associated with hello base blob are not affected and stay intact under hello base blob name.</span></span>
> 
> 

### <a name="back-up-disks-using-snapshots"></a><span data-ttu-id="9f448-123">Criar cópias de segurança utilizando instantâneos de discos</span><span class="sxs-lookup"><span data-stu-id="9f448-123">Back up disks using snapshots</span></span>
<span data-ttu-id="9f448-124">Como uma estratégia de cópia de segurança para os discos da máquina virtual, pode criar periódicos instantâneos do blob de página ou disco Olá e copiá-los utilizando ferramentas como conta de armazenamento de tooanother [copiar Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob) operação ou [AzCopy](../articles/storage/common/storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="9f448-124">As a backup strategy for your virtual machine disks, you can take periodic snapshots of hello disk or page blob, and copy them tooanother storage account using tools like [Copy Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob) operation or [AzCopy](../articles/storage/common/storage-use-azcopy.md).</span></span> <span data-ttu-id="9f448-125">Pode copiar um blob de página de destino do instantâneo tooa com um nome diferente.</span><span class="sxs-lookup"><span data-stu-id="9f448-125">You can copy a snapshot tooa destination page blob with a different name.</span></span> <span data-ttu-id="9f448-126">blob de página de destino Olá resultante é um blob de página gravável e não um instantâneo.</span><span class="sxs-lookup"><span data-stu-id="9f448-126">hello resulting destination page blob is a writeable page blob and not a snapshot.</span></span> <span data-ttu-id="9f448-127">Neste artigo, vamos descrever cópias de segurança do passos tootake dos discos da máquina virtual através de instantâneos.</span><span class="sxs-lookup"><span data-stu-id="9f448-127">Later in this article, we describe steps tootake backups of virtual machine disks using snapshots.</span></span>

### <a name="restore-disks-using-snapshots"></a><span data-ttu-id="9f448-128">Restaurar utilizando instantâneos de discos</span><span class="sxs-lookup"><span data-stu-id="9f448-128">Restore disks using snapshots</span></span>
<span data-ttu-id="9f448-129">Quando for toorestore tempo tooa seu disco estável versão que foram capturado anteriormente dos instantâneos de cópia de segurança de Olá, pode copiar um instantâneo através de blob de página base Olá.</span><span class="sxs-lookup"><span data-stu-id="9f448-129">When it is time toorestore your disk tooa stable version that was previously captured in one of hello backup snapshots, you can copy a snapshot over hello base page blob.</span></span> <span data-ttu-id="9f448-130">Após o instantâneo de Olá toohello promovida blob de página base, Olá instantâneo permanece, mas a origem é substituída por uma cópia que pode ser de leitura e escrita.</span><span class="sxs-lookup"><span data-stu-id="9f448-130">After hello snapshot is promoted toohello base page blob, hello snapshot remains, but its source is overwritten with a copy that can be both read and written.</span></span> <span data-ttu-id="9f448-131">Neste artigo, vamos descrevem passos toorestore uma versão anterior do disco do respetivo instantâneo.</span><span class="sxs-lookup"><span data-stu-id="9f448-131">Later in this article we describe steps toorestore a previous version of your disk from its snapshot.</span></span>

### <a name="implementing-full-snapshot-copy"></a><span data-ttu-id="9f448-132">Implementar a cópia de instantâneo completo</span><span class="sxs-lookup"><span data-stu-id="9f448-132">Implementing full snapshot copy</span></span>
<span data-ttu-id="9f448-133">Pode implementar uma cópia completa de instantâneo efetuando o seguinte Olá,</span><span class="sxs-lookup"><span data-stu-id="9f448-133">You can implement a full snapshot copy by doing hello following,</span></span>

* <span data-ttu-id="9f448-134">Em primeiro lugar, tire um instantâneo do blob base Olá utilizando Olá [instantâneo Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob) operação.</span><span class="sxs-lookup"><span data-stu-id="9f448-134">First, take a snapshot of hello base blob using hello [Snapshot Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob) operation.</span></span>
* <span data-ttu-id="9f448-135">Em seguida, copiar Olá instantâneo tooa destino armazenamento conta utilizando [copiar Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob).</span><span class="sxs-lookup"><span data-stu-id="9f448-135">Then, copy hello snapshot tooa target storage account using [Copy Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob).</span></span>
* <span data-ttu-id="9f448-136">Repita este processo toomaintain cópia de segurança cópias o blob de base.</span><span class="sxs-lookup"><span data-stu-id="9f448-136">Repeat this process toomaintain backup copies of your base blob.</span></span>

## <a name="incremental-snapshot-copy"></a><span data-ttu-id="9f448-137">Cópia de instantâneo incremental</span><span class="sxs-lookup"><span data-stu-id="9f448-137">Incremental snapshot copy</span></span>
<span data-ttu-id="9f448-138">funcionalidade nova do Olá do Olá [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges) API fornece um muito tooback forma uma melhor segurança instantâneos Olá dos seus blobs de páginas ou discos.</span><span class="sxs-lookup"><span data-stu-id="9f448-138">hello new feature in hello [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges) API provides a much better way tooback up hello snapshots of your page blobs or disks.</span></span> <span data-ttu-id="9f448-139">Olá API devolve Olá lista de alterações entre blob base Olá e instantâneos de Olá, que reduz a quantidade de Olá de espaço de armazenamento numa conta Olá de cópia de segurança.</span><span class="sxs-lookup"><span data-stu-id="9f448-139">hello API returns hello list of changes between hello base blob and hello snapshots, which reduces hello amount of storage space used on hello backup account.</span></span> <span data-ttu-id="9f448-140">Olá API suporta blobs de páginas no armazenamento Premium, bem como o armazenamento Standard.</span><span class="sxs-lookup"><span data-stu-id="9f448-140">hello API supports page blobs on Premium Storage as well as Standard Storage.</span></span> <span data-ttu-id="9f448-141">Utilizar esta API, pode criar soluções de cópia de segurança mais rápidas e eficientes para VMs do Azure.</span><span class="sxs-lookup"><span data-stu-id="9f448-141">Using this API, you can build faster and more efficient backup solutions for Azure VMs.</span></span> <span data-ttu-id="9f448-142">Esta API será disponíveis Olá REST versão 2015-07-08 e planos superiores.</span><span class="sxs-lookup"><span data-stu-id="9f448-142">This API will be available with hello REST version 2015-07-08 and higher.</span></span>

<span data-ttu-id="9f448-143">Cópia de instantâneo incremental permite-lhe toocopy de um armazenamento conta tooanother Olá diferença entre,</span><span class="sxs-lookup"><span data-stu-id="9f448-143">Incremental Snapshot Copy allows you toocopy from one storage account tooanother hello difference between,</span></span>

* <span data-ttu-id="9f448-144">Base blob e o respetivo instantâneo ou um</span><span class="sxs-lookup"><span data-stu-id="9f448-144">Base blob and its Snapshot OR</span></span>
* <span data-ttu-id="9f448-145">Todos os instantâneos do blob base Olá dois</span><span class="sxs-lookup"><span data-stu-id="9f448-145">Any two snapshots of hello base blob</span></span>

<span data-ttu-id="9f448-146">Olá fornecido seguintes condições são cumpridos,</span><span class="sxs-lookup"><span data-stu-id="9f448-146">Provided hello following conditions are met,</span></span>

* <span data-ttu-id="9f448-147">blob Olá foi criado no Jan-1-2016 ou posterior.</span><span class="sxs-lookup"><span data-stu-id="9f448-147">hello blob was created on Jan-1-2016 or later.</span></span>
* <span data-ttu-id="9f448-148">blob Olá não foi substituído pela [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) ou [copiar Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob) entre duas instantâneos.</span><span class="sxs-lookup"><span data-stu-id="9f448-148">hello blob was not overwritten with [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) or [Copy Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob) between two snapshots.</span></span>

<span data-ttu-id="9f448-149">**Tenha em atenção**: esta funcionalidade está disponível para Blobs de página do Azure Standard e Premium.</span><span class="sxs-lookup"><span data-stu-id="9f448-149">**Note**: This feature is available for Premium and Standard Azure Page Blobs.</span></span>

<span data-ttu-id="9f448-150">Quando tiver uma estratégia de cópia de segurança personalizada através de instantâneos, copiar instantâneos Olá um tooanother de conta de armazenamento pode ser lenta e pode consumir muito espaço de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="9f448-150">When you have a custom backup strategy using snapshots, copying hello snapshots from one storage account tooanother can be slow and can consume much storage space.</span></span> <span data-ttu-id="9f448-151">Em vez de copiar conta de armazenamento de cópia de segurança de tooa de instantâneo completo de Olá, pode escrever diferença Olá entre BLOBs de páginas de cópia de segurança de tooa de instantâneos consecutivos.</span><span class="sxs-lookup"><span data-stu-id="9f448-151">Instead of copying hello entire snapshot tooa backup storage account, you can write hello difference between consecutive snapshots tooa backup page blob.</span></span> <span data-ttu-id="9f448-152">Desta forma, Olá tempo toocopy Olá espaço toostore cópias de segurança e é reduzido.</span><span class="sxs-lookup"><span data-stu-id="9f448-152">This way, hello time toocopy and hello space toostore backups is substantially reduced.</span></span>

### <a name="implementing-incremental-snapshot-copy"></a><span data-ttu-id="9f448-153">Implementar a cópia de instantâneo Incremental</span><span class="sxs-lookup"><span data-stu-id="9f448-153">Implementing Incremental Snapshot Copy</span></span>
<span data-ttu-id="9f448-154">Pode implementar a cópia de instantâneo incremental efetuando o seguinte Olá,</span><span class="sxs-lookup"><span data-stu-id="9f448-154">You can implement incremental snapshot copy by doing hello following,</span></span>

* <span data-ttu-id="9f448-155">Tirar um instantâneo da utilização de base blob Olá [instantâneo Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob).</span><span class="sxs-lookup"><span data-stu-id="9f448-155">Take a snapshot of hello base blob using [Snapshot Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob).</span></span>
* <span data-ttu-id="9f448-156">Cópia Olá instantâneo toohello destino armazenamento de cópia de segurança conta utilizando [copiar Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob).</span><span class="sxs-lookup"><span data-stu-id="9f448-156">Copy hello snapshot toohello target backup storage account using [Copy Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob).</span></span> <span data-ttu-id="9f448-157">Este é o blob de páginas de cópia de segurança de Olá.</span><span class="sxs-lookup"><span data-stu-id="9f448-157">This is hello backup page blob.</span></span> <span data-ttu-id="9f448-158">Tirar um instantâneo de BLOBs de páginas de cópia de segurança de Olá e armazene-o numa conta Olá de cópia de segurança.</span><span class="sxs-lookup"><span data-stu-id="9f448-158">Take a snapshot of hello backup page blob and store it in hello backup account.</span></span>
* <span data-ttu-id="9f448-159">Crie outro instantâneo de blob base Olá utilizando o Blob de instantâneo.</span><span class="sxs-lookup"><span data-stu-id="9f448-159">Take another snapshot of hello base blob using Snapshot Blob.</span></span>
* <span data-ttu-id="9f448-160">Obter a diferença de Olá entre os instantâneos de primeiro e segundo Olá de utilizar o base blob Olá [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges).</span><span class="sxs-lookup"><span data-stu-id="9f448-160">Get hello difference between hello first and second snapshots of hello base blob using [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges).</span></span> <span data-ttu-id="9f448-161">Utilize o parâmetro novo Olá **prevsnapshot**, toospecify Olá de instantâneo Olá pretende diferença de Olá tooget com o valor DateTime.</span><span class="sxs-lookup"><span data-stu-id="9f448-161">Use hello new parameter **prevsnapshot**, toospecify hello DateTime value of hello snapshot you want tooget hello difference with.</span></span> <span data-ttu-id="9f448-162">Quando este parâmetro estiver presente, Olá resposta REST inclui apenas Olá as páginas que foram alteradas entre os instantâneos de destino e instantâneo anterior, incluindo páginas encriptadas.</span><span class="sxs-lookup"><span data-stu-id="9f448-162">When this parameter is present, hello REST response includes only hello pages that were changed between target snapshot and previous snapshot including clear pages.</span></span>
* <span data-ttu-id="9f448-163">Utilize [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) tooapply blob de página de cópia de segurança de toohello estas alterações.</span><span class="sxs-lookup"><span data-stu-id="9f448-163">Use [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) tooapply these changes toohello backup page blob.</span></span>
* <span data-ttu-id="9f448-164">Por fim, tire um instantâneo de BLOBs de páginas de cópia de segurança de Olá e armazene-o numa conta de armazenamento de cópia de segurança de Olá.</span><span class="sxs-lookup"><span data-stu-id="9f448-164">Finally, take a snapshot of hello backup page blob and store it in hello backup storage account.</span></span>

<span data-ttu-id="9f448-165">Na secção seguinte, Olá, iremos descrevem com maior detalhe como pode manter as cópias de segurança de discos utilizando a cópia de instantâneo Incremental</span><span class="sxs-lookup"><span data-stu-id="9f448-165">In hello next section, we will describe in more detail how you can maintain backups of disks using Incremental Snapshot Copy</span></span>

## <a name="scenario"></a><span data-ttu-id="9f448-166">Cenário</span><span class="sxs-lookup"><span data-stu-id="9f448-166">Scenario</span></span>
<span data-ttu-id="9f448-167">Nesta secção, iremos descrevem um cenário que envolva uma estratégia de cópia de segurança personalizada para os discos da máquina virtual através de instantâneos.</span><span class="sxs-lookup"><span data-stu-id="9f448-167">In this section, we describe a scenario that involves a custom backup strategy for virtual machine disks using snapshots.</span></span>

<span data-ttu-id="9f448-168">Considere uma VM do Azure-série DS com o premium storage P30 disco ligado.</span><span class="sxs-lookup"><span data-stu-id="9f448-168">Consider a DS-series Azure VM with a premium storage P30 disk attached.</span></span> <span data-ttu-id="9f448-169">disco Olá P30 chamado *mypremiumdisk* são armazenados numa conta de armazenamento premium chamada *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="9f448-169">hello P30 disk called *mypremiumdisk* is stored in a premium storage account called *mypremiumaccount*.</span></span> <span data-ttu-id="9f448-170">Uma conta de armazenamento standard denominada *mybackupstdaccount* é utilizado para armazenar a cópia de segurança de Olá de *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="9f448-170">A standard storage account called *mybackupstdaccount* is used for storing hello backup of *mypremiumdisk*.</span></span> <span data-ttu-id="9f448-171">Gostaríamos tookeep um instantâneo de *mypremiumdisk* cada 12 horas.</span><span class="sxs-lookup"><span data-stu-id="9f448-171">We would like tookeep a snapshot of *mypremiumdisk* every 12 hours.</span></span>

<span data-ttu-id="9f448-172">toolearn sobre a criação de conta de armazenamento e discos, consulte demasiado[contas do storage do Azure sobre](../articles/storage/storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="9f448-172">toolearn about creating storage account and disks, refer too[About Azure storage accounts](../articles/storage/storage-create-storage-account.md).</span></span>

<span data-ttu-id="9f448-173">toolearn sobre a cópia de segurança de VMs do Azure, consulte demasiado[cópias de segurança de VM do Azure planear](../articles/backup/backup-azure-vms-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="9f448-173">toolearn about backing up Azure VMs, refer too[Plan Azure VM backups](../articles/backup/backup-azure-vms-introduction.md).</span></span>

## <a name="steps-toomaintain-backups-of-a-disk-using-incremental-snapshots"></a><span data-ttu-id="9f448-174">Cópias de segurança do passos toomaintain de um disco através de instantâneos de incrementais</span><span class="sxs-lookup"><span data-stu-id="9f448-174">Steps toomaintain backups of a disk using incremental snapshots</span></span>
<span data-ttu-id="9f448-175">Olá passos seguintes descrevem como instantâneos de tootake de *mypremiumdisk* e manter cópias de segurança de Olá no *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="9f448-175">hello following steps describe how tootake snapshots of *mypremiumdisk* and maintain hello backups in *mybackupstdaccount*.</span></span> <span data-ttu-id="9f448-176">Olá cópia de segurança é um blob de página padrão chamado *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="9f448-176">hello backup is a standard page blob called *mybackupstdpageblob*.</span></span> <span data-ttu-id="9f448-177">Olá BLOBs de páginas de cópia de segurança sempre refletem Olá mesmo estado como Olá último instantâneo *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="9f448-177">hello backup page blob always reflects hello same state as hello last snapshot of *mypremiumdisk*.</span></span>

1. <span data-ttu-id="9f448-178">Criar um instantâneo de BLOBs de páginas de cópia de segurança de Olá para o disco de armazenamento premium, *mypremiumdisk* chamado *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="9f448-178">Create hello backup page blob for your premium storage disk, by taking a snapshot of *mypremiumdisk* called *mypremiumdisk_ss1*.</span></span>
2. <span data-ttu-id="9f448-179">Copie esta toomybackupstdaccount de instantâneo como um blob de página chamado *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="9f448-179">Copy this snapshot toomybackupstdaccount as a page blob called *mybackupstdpageblob*.</span></span>
3. <span data-ttu-id="9f448-180">Tirar um instantâneo *mybackupstdpageblob* chamado *mybackupstdpageblob_ss1*com [instantâneo Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob) e armazená-la no *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="9f448-180">Take a snapshot of *mybackupstdpageblob* called *mybackupstdpageblob_ss1*, using [Snapshot Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob) and store it in *mybackupstdaccount*.</span></span>
4. <span data-ttu-id="9f448-181">Durante a janela de cópia de segurança Olá, crie outro instantâneo de *mypremiumdisk*, diga *mypremiumdisk_ss2*e armazená-la no *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="9f448-181">During hello backup window, create another snapshot of *mypremiumdisk*, say *mypremiumdisk_ss2*, and store it in *mypremiumaccount*.</span></span>
5. <span data-ttu-id="9f448-182">Obter as alterações incrementais Olá entre instantâneos Olá dois, *mypremiumdisk_ss2* e *mypremiumdisk_ss1*com [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges) no  *mypremiumdisk_ss2* com Olá **prevsnapshot** toohello timestamp do conjunto de parâmetros *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="9f448-182">Get hello incremental changes between hello two snapshots, *mypremiumdisk_ss2* and *mypremiumdisk_ss1*, using [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges) on *mypremiumdisk_ss2* with hello **prevsnapshot** parameter set toohello timestamp of *mypremiumdisk_ss1*.</span></span> <span data-ttu-id="9f448-183">Escrita de BLOBs de página de cópia de segurança de toohello estas alterações incrementais *mybackupstdpageblob* no *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="9f448-183">Write these incremental changes toohello backup page blob *mybackupstdpageblob* in *mybackupstdaccount*.</span></span> <span data-ttu-id="9f448-184">Se existirem intervalos eliminados alterações incrementais Olá, tem de ser limpo a partir do blob de página de cópia de segurança de Olá.</span><span class="sxs-lookup"><span data-stu-id="9f448-184">If there are deleted ranges in hello incremental changes, they must be cleared from hello backup page blob.</span></span> <span data-ttu-id="9f448-185">Utilize [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) blob de página de cópia de segurança de toohello do toowrite alterações incrementais.</span><span class="sxs-lookup"><span data-stu-id="9f448-185">Use [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) toowrite incremental changes toohello backup page blob.</span></span>
6. <span data-ttu-id="9f448-186">Tirar um instantâneo de BLOBs de páginas de cópia de segurança de Olá *mybackupstdpageblob*, chamado *mybackupstdpageblob_ss2*.</span><span class="sxs-lookup"><span data-stu-id="9f448-186">Take a snapshot of hello backup page blob *mybackupstdpageblob*, called *mybackupstdpageblob_ss2*.</span></span> <span data-ttu-id="9f448-187">Eliminar instantâneo anterior Olá *mypremiumdisk_ss1* da conta de armazenamento premium.</span><span class="sxs-lookup"><span data-stu-id="9f448-187">Delete hello previous snapshot *mypremiumdisk_ss1* from premium storage account.</span></span>
7. <span data-ttu-id="9f448-188">Repita os passos 4 a 6 cada janela de cópia de segurança.</span><span class="sxs-lookup"><span data-stu-id="9f448-188">Repeat steps 4-6 every backup window.</span></span> <span data-ttu-id="9f448-189">Desta forma, pode manter as cópias de segurança de *mypremiumdisk* numa conta do standard storage.</span><span class="sxs-lookup"><span data-stu-id="9f448-189">In this way, you can maintain backups of *mypremiumdisk* in a standard storage account.</span></span>

![Cópia de segurança disco utilizando instantâneos de incrementais](../articles/virtual-machines/windows/media/incremental-snapshots/storage-incremental-snapshots-1.png)

## <a name="steps-toorestore-a-disk-from-snapshots"></a><span data-ttu-id="9f448-191">Passos toorestore um disco de instantâneos</span><span class="sxs-lookup"><span data-stu-id="9f448-191">Steps toorestore a disk from snapshots</span></span>
<span data-ttu-id="9f448-192">Olá, os seguintes passos, que descrevem como toorestore Olá disco premium, *mypremiumdisk* tooan anteriormente instantâneo da conta de armazenamento de cópia de segurança de Olá *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="9f448-192">hello following steps, describe how toorestore hello premium disk, *mypremiumdisk* tooan earlier snapshot from hello backup storage account *mybackupstdaccount*.</span></span>

1. <span data-ttu-id="9f448-193">Identifique Olá ponto no tempo que pretende toorestore Olá premium disco.</span><span class="sxs-lookup"><span data-stu-id="9f448-193">Identify hello point in time that you wish toorestore hello premium disk to.</span></span> <span data-ttu-id="9f448-194">Digamos que é instantâneo *mybackupstdpageblob_ss2*, que é armazenado na conta de armazenamento de cópia de segurança de Olá *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="9f448-194">Let's say that it is snapshot *mybackupstdpageblob_ss2*, which is stored in hello backup storage account *mybackupstdaccount*.</span></span>
2. <span data-ttu-id="9f448-195">No mybackupstdaccount, promover o instantâneo de Olá *mybackupstdpageblob_ss2* como blob de página base cópia de segurança nova Olá *mybackupstdpageblobrestored*.</span><span class="sxs-lookup"><span data-stu-id="9f448-195">In mybackupstdaccount, promote hello snapshot *mybackupstdpageblob_ss2* as hello new backup base page blob *mybackupstdpageblobrestored*.</span></span>
3. <span data-ttu-id="9f448-196">Tirar um instantâneo este BLOBs de páginas de cópia de segurança restaurada, denominado *mybackupstdpageblobrestored_ss1*.</span><span class="sxs-lookup"><span data-stu-id="9f448-196">Take a snapshot of this restored backup page blob, called *mybackupstdpageblobrestored_ss1*.</span></span>
4. <span data-ttu-id="9f448-197">Blob de páginas de Olá restaurada cópia *mybackupstdpageblobrestored* de *mybackupstdaccount* demasiado*mypremiumaccount* como disco de premium novo Olá  *mypremiumdiskrestored*.</span><span class="sxs-lookup"><span data-stu-id="9f448-197">Copy hello restored page blob *mybackupstdpageblobrestored* from *mybackupstdaccount* too*mypremiumaccount* as hello new premium disk *mypremiumdiskrestored*.</span></span>
5. <span data-ttu-id="9f448-198">Tirar um instantâneo *mypremiumdiskrestored*, chamado *mypremiumdiskrestored_ss1* para efetuar cópias de segurança incrementais futuras.</span><span class="sxs-lookup"><span data-stu-id="9f448-198">Take a snapshot of *mypremiumdiskrestored*, called *mypremiumdiskrestored_ss1* for making future incremental backups.</span></span>
6. <span data-ttu-id="9f448-199">Ponto de série de Olá DS toohello restaurada disco da VM *mypremiumdiskrestored* e desanexar Olá antigo *mypremiumdisk* de Olá VM.</span><span class="sxs-lookup"><span data-stu-id="9f448-199">Point hello DS series VM toohello restored disk *mypremiumdiskrestored* and detach hello old *mypremiumdisk* from hello VM.</span></span>
7. <span data-ttu-id="9f448-200">Iniciar o processo de cópia de segurança de Olá descrito na secção anterior para o disco de Olá restaurada *mypremiumdiskrestored*, utilizando Olá *mybackupstdpageblobrestored* como BLOBs de páginas de cópia de segurança de Olá.</span><span class="sxs-lookup"><span data-stu-id="9f448-200">Begin hello Backup process described in previous section for hello restored disk *mypremiumdiskrestored*, using hello *mybackupstdpageblobrestored* as hello backup page blob.</span></span>

![Restaurar o disco de instantâneos](../articles/virtual-machines/windows/media/incremental-snapshots/storage-incremental-snapshots-2.png)

## <a name="next-steps"></a><span data-ttu-id="9f448-202">Passos Seguintes</span><span class="sxs-lookup"><span data-stu-id="9f448-202">Next Steps</span></span>
<span data-ttu-id="9f448-203">Seguinte de Olá utilize liga toolearn mais informações sobre a criação de instantâneos de um blob e planeamento da sua infraestrutura de cópia de segurança de VM.</span><span class="sxs-lookup"><span data-stu-id="9f448-203">Use hello following links toolearn more about creating snapshots of a blob and planning your VM backup infrastructure.</span></span>

* [<span data-ttu-id="9f448-204">Criar um instantâneo de um Blob</span><span class="sxs-lookup"><span data-stu-id="9f448-204">Creating a Snapshot of a Blob</span></span>](https://docs.microsoft.com/rest/api/storageservices/Creating-a-Snapshot-of-a-Blob)
* [<span data-ttu-id="9f448-205">Planear a infraestrutura de cópia de segurança de VM</span><span class="sxs-lookup"><span data-stu-id="9f448-205">Plan your VM Backup Infrastructure</span></span>](../articles/backup/backup-azure-vms-introduction.md)

