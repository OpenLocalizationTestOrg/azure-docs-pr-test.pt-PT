> [!div class="op_single_selector"]
> * [<span data-ttu-id="c45f9-101">Linux</span><span class="sxs-lookup"><span data-stu-id="c45f9-101">Linux</span></span>](../articles/iot-hub/iot-hub-linux-iot-edge-simulated-device.md)
> * [<span data-ttu-id="c45f9-102">Windows</span><span class="sxs-lookup"><span data-stu-id="c45f9-102">Windows</span></span>](../articles/iot-hub/iot-hub-windows-iot-edge-simulated-device.md)

<span data-ttu-id="c45f9-103">Estas instruções de Olá [nuvem dispositivo simulado carregar exemplo] mostra-lhe como toouse [limite do Azure IoT] [ lnk-sdk] toosend telemetria do dispositivo para nuvem tooIoT Hub da simulada dispositivos.</span><span class="sxs-lookup"><span data-stu-id="c45f9-103">This walkthrough of hello [Simulated Device Cloud Upload sample] shows you how toouse [Azure IoT Edge][lnk-sdk] toosend device-to-cloud telemetry tooIoT Hub from simulated devices.</span></span>

<span data-ttu-id="c45f9-104">Estas instruções abrangem:</span><span class="sxs-lookup"><span data-stu-id="c45f9-104">This walkthrough covers:</span></span>

* <span data-ttu-id="c45f9-105">**Arquitetura**: as informações da arquitetura sobre Olá [nuvem dispositivo simulado carregar exemplo].</span><span class="sxs-lookup"><span data-stu-id="c45f9-105">**Architecture**: architectural information about hello [Simulated Device Cloud Upload sample].</span></span>
* <span data-ttu-id="c45f9-106">**Compilar e executar**: Olá passos necessários toobuild e exemplo de Olá execução.</span><span class="sxs-lookup"><span data-stu-id="c45f9-106">**Build and run**: hello steps required toobuild and run hello sample.</span></span>

## <a name="architecture"></a><span data-ttu-id="c45f9-107">Arquitetura</span><span class="sxs-lookup"><span data-stu-id="c45f9-107">Architecture</span></span>

<span data-ttu-id="c45f9-108">Olá [nuvem dispositivo simulado carregar exemplo] mostra como toocreate um gateway que envia a telemetria de simulated o IoT hub tooan dispositivos.</span><span class="sxs-lookup"><span data-stu-id="c45f9-108">hello [Simulated Device Cloud Upload sample] shows how toocreate a gateway that sends telemetry from simulated devices tooan IoT hub.</span></span> <span data-ttu-id="c45f9-109">Um dispositivo não pode ser capaz de tooconnect diretamente tooIoT Hub porque dispositivo Olá:</span><span class="sxs-lookup"><span data-stu-id="c45f9-109">A device may not be able tooconnect directly tooIoT Hub because hello device:</span></span>

* <span data-ttu-id="c45f9-110">Não utilize um protocolo de comunicações abrangido pelo IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="c45f9-110">Does not use a communications protocol understood by IoT Hub.</span></span>
* <span data-ttu-id="c45f9-111">Não é suficientemente inteligente tooremember Olá identidade atribuída tooit pelo IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="c45f9-111">Is not smart enough tooremember hello identity assigned tooit by IoT Hub.</span></span>

<span data-ttu-id="c45f9-112">Um gateway de IoT pode resolver estes problemas no Olá seguintes formas:</span><span class="sxs-lookup"><span data-stu-id="c45f9-112">An IoT Edge gateway can solve these problems in hello following ways:</span></span>

* <span data-ttu-id="c45f9-113">gateway de Olá compreende o protocolo de Olá utilizado pelo dispositivo Olá, recebe a telemetria do dispositivo para nuvem dos dispositivos de Olá e reencaminha esses tooIoT mensagens Hub utilizando um protocolo abrangido pelo Olá IoT hub.</span><span class="sxs-lookup"><span data-stu-id="c45f9-113">hello gateway understands hello protocol used by hello device, receives device-to-cloud telemetry from hello device, and forwards those messages tooIoT Hub using a protocol understood by hello IoT hub.</span></span>

* <span data-ttu-id="c45f9-114">gateway de Olá mapeia toodevices de identidades do IoT Hub e age como um proxy quando um dispositivo envia mensagens tooIoT Hub.</span><span class="sxs-lookup"><span data-stu-id="c45f9-114">hello gateway maps IoT Hub identities toodevices and acts as a proxy when a device sends messages tooIoT Hub.</span></span>

<span data-ttu-id="c45f9-115">Olá seguinte diagrama mostra Olá componentes principais do exemplo Olá, incluindo Olá módulos de limite de IoT:</span><span class="sxs-lookup"><span data-stu-id="c45f9-115">hello following diagram shows hello main components of hello sample, including hello IoT Edge modules:</span></span>

![][1]

<span data-ttu-id="c45f9-116">módulos de Olá não passa mensagens diretamente tooeach outro.</span><span class="sxs-lookup"><span data-stu-id="c45f9-116">hello modules do not pass messages directly tooeach other.</span></span> <span data-ttu-id="c45f9-117">módulos de Olá publicar mensagens tooan interno mediador que fornece Olá mensagens toohello outros módulos utilizando um mecanismo de subscrição.</span><span class="sxs-lookup"><span data-stu-id="c45f9-117">hello modules publish messages tooan internal broker that delivers hello messages toohello other modules using a subscription mechanism.</span></span> <span data-ttu-id="c45f9-118">Para obter mais informações, consulte [introdução ao Azure IoT Edge][lnk-gw-getstarted].</span><span class="sxs-lookup"><span data-stu-id="c45f9-118">For more information, see [Get started with Azure IoT Edge][lnk-gw-getstarted].</span></span>

### <a name="protocol-ingestion-module"></a><span data-ttu-id="c45f9-119">Módulo de ingestão de protocolo</span><span class="sxs-lookup"><span data-stu-id="c45f9-119">Protocol ingestion module</span></span>

<span data-ttu-id="c45f9-120">Este módulo é Olá a ponto para a receção de dados a partir de dispositivos, através do gateway de Olá e na nuvem de Olá.</span><span class="sxs-lookup"><span data-stu-id="c45f9-120">This module is hello starting point for receiving data from devices, through hello gateway, and into hello cloud.</span></span> <span data-ttu-id="c45f9-121">Exemplo de Olá, módulo Olá:</span><span class="sxs-lookup"><span data-stu-id="c45f9-121">In hello sample, hello module:</span></span>

1. <span data-ttu-id="c45f9-122">Cria dados de temperatura simulada.</span><span class="sxs-lookup"><span data-stu-id="c45f9-122">Creates simulated temperature data.</span></span> <span data-ttu-id="c45f9-123">Se utilizar dispositivos físicos, módulo Olá lê dados a partir desses dispositivos físicos.</span><span class="sxs-lookup"><span data-stu-id="c45f9-123">If you use physical devices, hello module reads data from those physical devices.</span></span>
1. <span data-ttu-id="c45f9-124">Cria uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="c45f9-124">Creates a message.</span></span>
1. <span data-ttu-id="c45f9-125">Coloca Olá simulado temperatura dados no conteúdo da mensagem Olá.</span><span class="sxs-lookup"><span data-stu-id="c45f9-125">Places hello simulated temperature data into hello message content.</span></span>
1. <span data-ttu-id="c45f9-126">Adiciona uma propriedade com uma mensagem de toohello de endereço MAC falsificada.</span><span class="sxs-lookup"><span data-stu-id="c45f9-126">Adds a property with a fake MAC address toohello message.</span></span>
1. <span data-ttu-id="c45f9-127">Faz com que o módulo seguinte do Olá mensagem toohello disponíveis na cadeia de Olá.</span><span class="sxs-lookup"><span data-stu-id="c45f9-127">Makes hello message available toohello next module in hello chain.</span></span>

<span data-ttu-id="c45f9-128">módulo Olá chamado **ingestão de protocolo X** Olá diagrama anterior é designado **dispositivo simulado** no código de origem Olá.</span><span class="sxs-lookup"><span data-stu-id="c45f9-128">hello module called **Protocol X ingestion** in hello previous diagram is called **Simulated device** in hello source code.</span></span>

### <a name="mac-lt-gt-iot-hub-id-module"></a><span data-ttu-id="c45f9-129">MAC &lt;-&gt; Módulo de ID do Hub IoT</span><span class="sxs-lookup"><span data-stu-id="c45f9-129">MAC &lt;-&gt; IoT Hub ID module</span></span>

<span data-ttu-id="c45f9-130">Este módulo verifica a existência de mensagens em fila que tem uma propriedade de endereço Mac.</span><span class="sxs-lookup"><span data-stu-id="c45f9-130">This module scans for messages that have a Mac address property.</span></span> <span data-ttu-id="c45f9-131">Exemplo de Olá, o módulo de ingestão de protocolo de Olá adiciona propriedade de endereço MAC Olá.</span><span class="sxs-lookup"><span data-stu-id="c45f9-131">In hello sample, hello protocol ingestion module adds hello MAC address property.</span></span> <span data-ttu-id="c45f9-132">Se o módulo Olá localiza essa propriedade, adiciona outra propriedade com uma mensagem de toohello chave do dispositivo IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="c45f9-132">If hello module finds such a property, it adds another property with an IoT Hub device key toohello message.</span></span> <span data-ttu-id="c45f9-133">módulo Olá, em seguida, faz com que o módulo seguinte do Olá mensagem toohello disponíveis na cadeia de Olá.</span><span class="sxs-lookup"><span data-stu-id="c45f9-133">hello module then makes hello message available toohello next module in hello chain.</span></span>

<span data-ttu-id="c45f9-134">Programador Olá configura um mapeamento entre os endereços MAC e dispositivos do IoT Hub identidades tooassociate Olá simulado com identidades de dispositivo do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="c45f9-134">hello developer sets up a mapping between MAC addresses and IoT Hub identities tooassociate hello simulated devices with IoT Hub device identities.</span></span> <span data-ttu-id="c45f9-135">Programador Olá adiciona manualmente mapeamento Olá como parte da configuração do módulo Olá.</span><span class="sxs-lookup"><span data-stu-id="c45f9-135">hello developer adds hello mapping manually as part of hello module configuration.</span></span>

> [!NOTE]
> <span data-ttu-id="c45f9-136">Esta amostra utiliza um endereço MAC como identificador de dispositivo exclusivo e correlaciona-o com uma identidade de dispositivo Hub IoT.</span><span class="sxs-lookup"><span data-stu-id="c45f9-136">This sample uses a MAC address as a unique device identifier and correlates it with an IoT Hub device identity.</span></span> <span data-ttu-id="c45f9-137">No entanto, pode escrever o seu próprio módulo que utiliza um identificador exclusivo diferente.</span><span class="sxs-lookup"><span data-stu-id="c45f9-137">However, you can write your own module that uses a different unique identifier.</span></span> <span data-ttu-id="c45f9-138">Por exemplo, os seus dispositivos podem ter exclusivos de números de série ou dados de telemetria de Olá podem incluir um nome único para o dispositivo incorporado.</span><span class="sxs-lookup"><span data-stu-id="c45f9-138">For example, your devices may have unique serial numbers or hello telemetry data may include a unique embedded device name.</span></span>

### <a name="iot-hub-communication-module"></a><span data-ttu-id="c45f9-139">Módulo de comunicação do Hub IoT</span><span class="sxs-lookup"><span data-stu-id="c45f9-139">IoT Hub communication module</span></span>

<span data-ttu-id="c45f9-140">Este módulo demora mensagens com um IoT Hub propriedade de chave do dispositivo que foi atribuída pelo módulo Olá de anterior.</span><span class="sxs-lookup"><span data-stu-id="c45f9-140">This module takes messages with an IoT Hub device key property that was assigned by hello previous module.</span></span> <span data-ttu-id="c45f9-141">módulo Olá envia a mensagem de saudação tooIoT conteúdo Hub utilizando Olá protocolo HTTP.</span><span class="sxs-lookup"><span data-stu-id="c45f9-141">hello module sends hello message content tooIoT Hub using hello HTTP protocol.</span></span> <span data-ttu-id="c45f9-142">HTTP é uma das Olá três protocolos abrangidos pelo IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="c45f9-142">HTTP is one of hello three protocols understood by IoT Hub.</span></span>

<span data-ttu-id="c45f9-143">Em vez de abrir uma ligação para cada dispositivo simulado, este módulo é aberta uma ligação HTTP única do hub IoT do Olá gateway toohello.</span><span class="sxs-lookup"><span data-stu-id="c45f9-143">Instead of opening a connection for each simulated device, this module opens a single HTTP connection from hello gateway toohello IoT hub.</span></span> <span data-ttu-id="c45f9-144">em seguida, o módulo Olá multiplexes ligações a partir de todos os dispositivos de Olá simulado através dessa ligação.</span><span class="sxs-lookup"><span data-stu-id="c45f9-144">hello module then multiplexes connections from all hello simulated devices over that connection.</span></span> <span data-ttu-id="c45f9-145">Esta abordagem permite que um único gateway tooconnect muitos mais dispositivos.</span><span class="sxs-lookup"><span data-stu-id="c45f9-145">This approach enables a single gateway tooconnect many more devices.</span></span>

## <a name="before-you-get-started"></a><span data-ttu-id="c45f9-146">Antes de começar</span><span class="sxs-lookup"><span data-stu-id="c45f9-146">Before you get started</span></span>

<span data-ttu-id="c45f9-147">Antes de começar, tem de:</span><span class="sxs-lookup"><span data-stu-id="c45f9-147">Before you get started, you must:</span></span>

* <span data-ttu-id="c45f9-148">[Criar um hub IoT] [ lnk-create-hub] na sua subscrição do Azure, terá de nome de Olá do seu hub toocomplete estas instruções.</span><span class="sxs-lookup"><span data-stu-id="c45f9-148">[Create an IoT hub][lnk-create-hub] in your Azure subscription, you need hello name of your hub toocomplete this walkthrough.</span></span> <span data-ttu-id="c45f9-149">Se não tiver uma conta, pode criar uma [conta gratuita][lnk-free-trial] em apenas alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="c45f9-149">If you don't have an account, you can create a [free account][lnk-free-trial] in just a couple of minutes.</span></span>
* <span data-ttu-id="c45f9-150">Adicionar dois iothub de tooyour dispositivos e anote os respetivos ids e as chaves de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c45f9-150">Add two devices tooyour IoT hub and make a note of their ids and device keys.</span></span> <span data-ttu-id="c45f9-151">Pode utilizar Olá [Explorador de dispositivo] [ lnk-device-explorer] ou [iothub explorer] [ lnk-iothub-explorer] ferramenta tooadd dispositivos toohello hub IoT que criou no Olá anterior passo e obter as respetivas chaves.</span><span class="sxs-lookup"><span data-stu-id="c45f9-151">You can use hello [device explorer][lnk-device-explorer] or [iothub-explorer][lnk-iothub-explorer] tool tooadd your devices toohello IoT hub you created in hello previous step and retrieve their keys.</span></span>

![][2]

<!-- Images -->
[1]: media/iot-hub-iot-edge-simulated-selector/image1.png
[2]: media/iot-hub-iot-edge-simulated-selector/image2.png

<!-- Links -->
[nuvem dispositivo simulado carregar exemplo]: https://github.com/Azure/iot-edge/blob/master/samples/simulated_device_cloud_upload/README.md
[lnk-sdk]: https://github.com/Azure/iot-edge
[lnk-gw-getstarted]: ../articles/iot-hub/iot-hub-linux-iot-edge-get-started.md
[lnk-free-trial]: https://azure.microsoft.com/pricing/free-trial/
[lnk-device-explorer]: https://github.com/Azure/azure-iot-sdk-csharp/tree/master/tools/DeviceExplorer
[lnk-iothub-explorer]: https://github.com/Azure/iothub-explorer/blob/master/readme.md
[lnk-create-hub]: ../articles/iot-hub/iot-hub-create-through-portal.md