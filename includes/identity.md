Gestão de identidade é tão importante na nuvem pública Olá porque esta está no local. toohelp com esta opção, o Azure suporta várias tecnologias de identidade de nuvem diferente. Estes incluem:

* Pode executar o Windows Server Active Directory (geralmente denominado apenas AD) na nuvem de Olá utilizar máquinas virtuais criadas com as máquinas virtuais do Azure. Esta abordagem faz sentido quando estiver a utilizar o Azure tooextend datacenter no local na nuvem do Olá.
* Pode utilizar o Azure Active Directory toogive os seus utilizadores único início de sessão demasiado[Software como serviço (SaaS)](https://azure.microsoft.com/overview/what-is-saas/) aplicações. Office 365 do Microsoft utiliza esta tecnologia, por exemplo, e aplicações em execução no Azure ou outras plataformas de cloud também podem utilizá-la.
* Aplicações em execução no Olá na nuvem ou no local pode utilizar o Azure Active Directory controlo de acesso toolet utilizadores inicie sessão com as identidades de Facebook, Google, Microsoft e outros fornecedores de identidade.

Este artigo descreve os três destas opções.

## <a name="table-of-contents"></a>Índice
* [A executar o Windows Server Active Directory nas máquinas virtuais](#adinvm)
* [Utilizar o Azure Active Directory](#ad)
* [Utilizar o controlo de acesso do Azure Active Directory](#ac)

## <a name="adinvm"></a>A executar o Windows Server Active Directory nas máquinas virtuais
Com o Windows Server AD em máquinas virtuais do Azure é idêntica à executá-lo no local. [Figura 1](#fig1) mostra um exemplo típico de aspeto.

![Azure Active Directory na máquina Virtual](./media/identity/identity_01_ADinVM.png)

<a name="Fig1"></a>Figura 1: Windows Server Active Directory podem ser executados no Centro de dados do local de máquinas virtuais do Azure ligadas tooan organização utilizando a rede Virtual do Azure.

Exemplo de Olá mostradas aqui, Windows Server AD está em execução em VMs criadas com máquinas virtuais do Azure, tecnologia de IaaS da plataforma Olá. Estas VMs e alguns outros estão agrupados em rede virtual ligado tooan local no Centro de dados utilizando a rede Virtual do Azure. rede virtual Olá carves fora de um grupo de máquinas virtuais na nuvem que interagem com a rede no local de Olá através de uma ligação de rede privada virtual (VPN). Se o fizer esta permite estas máquinas virtuais do Azure aspeto apenas outra sub-rede toohello no Centro de dados local. Como mostra a figura Olá, dois dessas VMS em execução os controladores de domínio do Windows Server AD. Olá outras máquinas virtuais na rede virtual Olá poderá estar em execução aplicações, como o SharePoint ou a ser utilizado de alguma forma, tal como para desenvolvimento e testes. datacenter no local de Olá também está em execução dois controladores de domínio do Windows Server AD.

Existem várias opções para os controladores de domínio Olá ligação na nuvem de Olá com os em execução no local:

* Tornar todos eles fazem parte de um único domínio de Active Directory.
* Criar AD domínios no local independente e na nuvem de Olá que fazem parte do Olá mesma floresta.
* Criar separadas florestas do AD na nuvem de Olá e no local, em seguida, ligar florestas, Olá com confiança entre florestas ou Windows Server Active Directory os serviços de Federação (AD FS), que também pode executar em máquinas virtuais no Azure.

É efetuada qualquer opção, um administrador deve certificar-se de que os pedidos de autenticação de utilizadores no local aceda a controladores de domínio toocloud apenas quando necessário, porque a nuvem de toohello Olá ligação está toobe provável mais lenta do que as redes no local. Outro fator tooconsider na nuvem de ligação e os controladores de domínio no local é o tráfego de Olá gerado pela replicação. Os controladores de domínio na nuvem de Olá normalmente, são os seus próprios site AD, que permite um tooschedule de administrador com que frequência é efetuada a replicação. Custos do Azure para o tráfego enviado fora de um datacenter Azure, embora não bytes enviados na, que podem afetar as opções de replicação do administrador Olá. É também vale a apontar que enquanto o Azure fornece a suas próprias suporte do sistema de nomes de domínio (DNS), este serviço está em falta funcionalidades exigidas pelo Active Directory (por exemplo, o suporte para os registos de DNS dinâmicos e SRV). Por este motivo, com o Windows Server AD no Azure necessita de configurar os seus próprios servidores DNS na nuvem de Olá.

Com o Windows Server AD em VMs do Azure, pode fazer sentido em várias situações diferentes. Eis alguns exemplos:

* Se estiver a utilizar máquinas virtuais do Azure como uma extensão do seu próprio Centro de dados, poderá executar aplicações na nuvem de Olá que necessitam de coisas toohandle de controladores de domínio local, como pedidos de autenticação integrada do Windows ou consultas LDAP. SharePoint, por exemplo, interage frequentemente com o Active Directory e, por isso, embora seja possível toorun um farm do SharePoint no Azure através de um diretório no local, como configurar os controladores de domínio na nuvem de Olá será significativamente melhorar o desempenho. (É toorealize importante que isto não é necessariamente necessário, no entanto; muitos das aplicações podem ser executado com êxito na nuvem de Olá utilizar controladores de domínio apenas no local).
* Suponha que uma sucursal faraway não possui Olá recursos toorun os seus próprios controladores de domínio. Hoje em dia, os utilizadores devem autenticar-se os controladores de toodomain Olá outro lado da Olá mundo - inícios de sessão estão lentas. Em execução do Active Directory no Azure num datacenter Microsoft próximo pode acelerar a isto sem necessidade de mais servidores no escritório de sucursal Olá.
* Uma organização que utiliza o Azure para a recuperação de desastre pode manter um pequeno conjunto de VMs do Active Directory na nuvem de Olá, incluindo um controlador de domínio. Em seguida, pode ser preparado tooexpand deste site como tootake necessário através de falhas noutro local.

Existem também outras possibilidades. Por exemplo, não for necessária tooconnect Olá nuvem tooan Windows Server AD no local Centro de dados. Se quisesse toorun um farm do SharePoint que serviu um conjunto específico de utilizadores, por exemplo, todos os dos quais seriam iniciar sessão apenas com identidades baseado na nuvem, pode criar uma floresta autónomo no Azure. Como utilizar esta tecnologia depende de quais são os seus objetivos. (Para obter mais orientações sobre a utilização do Windows Server AD com o Azure, [apresentada aqui](http://msdn.microsoft.com/library/windowsazure/jj156090.aspx).)

## <a name="ad"></a>Utilizar o Azure Active Directory
Como aplicações SaaS fiquem mais comuns, gere uma questão óbvia: O tipo de serviço de diretório devem utilizar estas aplicações baseado na nuvem? Pergunta de toothat de resposta da Microsoft é o Azure Active Directory.

Existem duas opções principais para utilizar este serviço de diretório na nuvem de Olá:

* Indivíduos e as organizações que utilizam apenas a aplicações SaaS podem basear-se no Azure Active Directory como o respetivo serviço de diretório única.
* As organizações que executam o Windows Server Active Directory podem ligar os seus tooAzure de diretório no local do Active Directory, em seguida, utilizá-lo toogive os seus utilizadores único início de sessão tooSaaS aplicações.

[Figura 2](#fig2) ilustra Olá primeiro destas duas opções, onde o Azure Active Directory é tudo o que é necessário.

![Azure Active Directory na máquina Virtual](./media/identity/identity_02_AD.png)

<a name="fig2"></a>Figura 2: Azure Active Directory fornece aos utilizadores uma organização aplicações tooSaaS de início de sessão único, incluindo o Office 365.

Como mostra a figura Olá, Azure AD é um serviço de multi-inquilino. Isto significa que pode suportar em simultâneo muitas organizações diferentes, armazenar informações de diretório sobre os utilizadores em cada um deles. Neste exemplo, um utilizador na organização A está a tentar tooaccess uma aplicação SaaS. Esta aplicação pode fazer parte do Office 365, como o SharePoint Online, ou poderá ser autorize - aplicações de terceiros também podem utilizar esta tecnologia. Porque o Azure AD suporta o protocolo SAML 2.0 de Olá, todos os que necessita de uma aplicação é Olá capacidade toointeract utilizando esta norma da indústria. (Na realidade, podem executar as aplicações que utilizam o Azure AD no qualquer centro de dados, não apenas num datacenter do Azure.)

processo de Olá começa quando Olá utilizador acede a uma aplicação SaaS (passo 1). toouse esta aplicação, utilizador de Olá tem de apresentar um token emitido pelo Azure AD.

Este token contém informações que identifica o utilizador Olá e está assinado digitalmente pelo Azure AD. token de Olá tooget Olá utilizador é autenticado ele próprio tooAzure AD, fornecendo um nome de utilizador e palavra-passe (passo 2). Azure AD, em seguida, devolve o token Olá, ele tem (passo 3).

Este token é enviada aplicação SaaS a toohello (passo 4), que valida a assinatura do token de Olá e utiliza o respetivo conteúdo (passo 5). Normalmente, a aplicação Olá irá utilizar as informações de identidade Olá token Olá contém toodecide que utilizador Olá de informações é permitido tooaccess e talvez de outras formas.

Se a aplicação Olá precisar de mais informações sobre utilizador Olá do que o que está contido no token de Olá, pode pedir esta diretamente a partir do Azure AD através de Olá AD Graph API do Azure (passo 6). A versão inicial Olá do Azure AD, esquema de diretório Olá é bastante simple: contém apenas os utilizadores e grupos e as respetivas relações. As aplicações podem utilizar este toolearn informações acerca das ligações entre os utilizadores. Por exemplo, suponha que necessita de uma aplicação tooknow quem manager este utilizador é toodecide se ele é segmentos de toosome permitido acesso de dados. Pode saber isto ao consultar o Azure AD através de Olá Graph API.

Olá Graph API utiliza um protocolo RESTful comum, o que torna toouse simples da maioria dos clientes, incluindo dispositivos móveis. Olá API também suporta as extensões de Olá definidas pelo OData, adicionar coisas como uma consulta idioma toolet clientes aceder a dados das formas mais útil. (Para mais informações sobre OData, consulte [Introducing OData](http://download.microsoft.com/download/E/5/A/E5A59052-EE48-4D64-897B-5F7C608165B8/IntroducingOData.pdf).) Como Olá Graph API pode ser utilizado toolearn sobre relações entre os utilizadores, permite que aplicações compreender o gráfico de redes sociais Olá que está incorporado no esquema Olá do Azure AD para uma determinada organização (que é a razão pela qual é denominado Olá Graph API). E tooauthenticate próprio tooAzure AD para a Graph API pedidos, uma aplicação utiliza o OAuth 2.0.

Se uma organização não utiliza o Windows Server Active Directory, não tem servidores no local ou domínios - e baseia-se somente em aplicações em nuvem que utilizam o Azure AD, a utilizar apenas neste diretório em nuvem seria conceder utilizadores único início de sessão tooall do firm Olá deles. Ainda enquanto este cenário obtém mais comum diariamente, a maioria das organizações ainda utilizar no local domínios criados com o Windows Server Active Directory. Azure AD dispõe de uma função útil tooplay aqui, bem como [figura 3](#fig3) mostra.

![Azure Active Directory na máquina Virtual](./media/identity/identity_03_AD.png)
<a id="fig3"></a>figura 3: as organizações podem federar Windows Server Active Directory com o Azure Active Directory toogive respetivas aplicações de tooSaaS de início de sessão único de utilizadores.

Neste cenário, um utilizador na organização B pretende tooaccess uma aplicação SaaS. Antes da Joana efetua este procedimento, os administradores do diretório de organização Olá tem de estabelecer uma relação de federação com o Azure AD através do AD FS, tal como mostra a figura de Olá. Os administradores também devem configurar a sincronização de dados entre a no local do Windows Server organização Olá AD e do Azure AD. Esta copia automaticamente informações do grupo de utilizador e de tooAzure de diretório no local de Olá AD. Tenha em atenção que isto permite: em vigor, a organização Olá é alargar o seu diretório no local para nuvem Olá. Combinar o Windows Server AD e o Azure AD desta forma dá-organização Olá um serviço de diretório que pode ser gerido como uma única entidade, enquanto ainda tem um requisitos de espaço no local e na nuvem de Olá.

toouse do Azure AD, Olá utilizador primeiro iniciar sessão no domínio de Active Directory no local tooher como habitualmente (passo 1). Quando ela tenta aplicação SaaS a tooaccess Olá (passo 2), o processo de Federação Olá resulta no Azure AD lhe emitir um token para esta aplicação (passo 3). (Para obter mais informações sobre como funciona a Federação, consulte [identidade baseada em afirmações para Windows: tecnologias e cenários](http://www.davidchappell.com/writing/white_papers/Claims-Based_Identity_for_Windows_v3.0--Chappell.docx).) Como anteriormente, este token contém informações que identifica o utilizador Olá e está assinado digitalmente pelo Azure AD. Este token é enviada aplicação SaaS a toohello (passo 4), que valida a assinatura do token de Olá e utiliza o respetivo conteúdo (passo 5). E é cenário anterior de Olá, Olá SaaS pode utilizar a aplicação Olá toolearn Graph API mais informações sobre este utilizador, se for necessário (passo 6).

Hoje em dia, do Azure AD não é uma substituição completa para o local no Windows Server AD. Já mencionadas, como diretório em nuvem de Olá tem um esquema muito mais simples e também está em falta coisas como política de grupo, Olá capacidade toostore sobre máquinas e suporte para o LDAP. (Na realidade, um computador Windows não pode ser configurado toolet aos utilizadores iniciar sessão tooit utilizando nada mas do Azure AD - esta operação não é um cenário suportado.) Em vez disso, objetivos iniciais de Olá do Azure AD incluem permitindo que as aplicações de acesso de utilizadores empresariais na nuvem de Olá sem manter um início de sessão separado e libertar no local Administradores do diretório de sincronizar manualmente o respetivo diretório no local com o todas as aplicações de SaaS utiliza a respetiva organização. Ao longo do tempo, no entanto, espera este tooaddress de serviço de diretório em nuvem uma vasta gama de cenários.

## <a name="ac"></a>Utilizar o controlo de acesso do Azure Active Directory
Tecnologias de identidade baseada na nuvem podem ser utilizado toosolve uma variedade de problemas. Azure Active Directory pode dar aos utilizadores uma organização aplicações de SaaS toomultiple de início de sessão único, por exemplo. Mas tecnologias de identidade na nuvem de Olá também podem ser utilizadas de outras formas.

Por exemplo, suponha que uma aplicação pretende toolet utilizadores inicie sessão com tokens emitidos pelo vários *fornecedores de identidade (IdPs)*. Muitos fornecedores de identidade diferentes existem hoje em dia, incluindo o Facebook, Google, Microsoft e outras pessoas, e aplicações frequentemente permitem aos utilizadores iniciar sessão com uma estas identidades. Por que motivo deve uma aplicação bother toomaintain própria lista de utilizadores e palavras-passe quando em vez disso, pode depender de identidades que já existem? Aceitar identidades existentes faz vida mais simples para utilizadores, que tenham um menor tooremember de nome de utilizador e palavra-passe, e para as pessoas de Olá que criar aplicação Olá, que já não necessitam de toomaintain as suas próprias listas de nomes de utilizador e palavras-passe.

Mas, enquanto cada fornecedor de identidade emite algum tipo de token, esses tokens não padrão, são - a cada IdP tem o suas próprias formato. Além disso, as informações de Olá esses tokens também não não padrão. Uma aplicação que pretende tooaccept os tokens emitidos pelo, diga, Facebook, Google e Microsoft é confrontados com desafio Olá de escrever código exclusivo toohandle cada um destes formatos diferentes.

Mas, por que motivo fazer isto? Por que motivo não em vez disso, crie um intermediário que pode gerar um único formato de token com uma representação comum de informações de identidade? Esta abordagem iria tornar vida mais simples para programadores de Olá que criam aplicações, uma vez que têm agora toohandle apenas um tipo de token. O controlo de acesso do Active Directory do Azure é exatamente, fornecendo um intermediário na nuvem de Olá para trabalhar com diversos tokens. [Figura 4](#fig4) mostra como funciona

![Azure Active Directory na máquina Virtual](./media/identity/identity_04_IdentityProviders.png)
<a id="fig4"></a>figura 4: controlo de acesso do Azure Active Directory torna mais fácil para aplicações tooaccept identidade tokens emitidos por fornecedores de identidade diferentes.

processo de Olá começa quando um utilizador tenta tooaccess aplicação Olá um browser. aplicação Olá redireciona o respetivo tooan IdP à sua escolha (e essa aplicação Olá também confianças). A Joana efetua a autenticação herself toothis IdP, tal como ao introduzir um nome de utilizador e palavra-passe (passo 1) e Olá IdP devolve um token que contém informações sobre a obtenção (passo 2).

Como mostra a figura Olá, o controlo de acesso suporta uma gama de diferentes IdPs baseado na nuvem, incluindo as contas criadas através da Google, Yahoo, Facebook, Microsoft (anteriormente conhecido como Windows Live ID) e qualquer fornecedor OpenID. Também suporta as identidades criadas com o Azure Active Directory e, através de federação com o AD FS, Windows Server Active Directory. objetivo de Olá é identidades de Olá normalmente utilizada toocover hoje em dia, se de que está a ser emitidos por IdPs na nuvem de Olá ou no local.

Assim que o browser do utilizador Olá tem um token de IdP do respetivo escolhida IdP, envia esta token tooAccess controlo (passo 3). Controlo de acesso valida o token de Olá, certificando-se de que realmente foi emitido por esta IdP, em seguida, cria um novo token de acordo com as regras de toohello que foram definidas para esta aplicação. Como o Azure Active Directory, o controlo de acesso é um serviço de multi-inquilino, mas inquilinos Olá são aplicações em vez das organizações de cliente. Cada aplicação pode obter o seu próprio espaço de nomes, tal como mostra a figura de Olá e pode definir várias regras sobre autorização e muito mais.

Estas regras permitem definir como tokens a partir de vários IdPs devem ser transformados para um token de controlo de acesso de administrador de cada aplicação. Por exemplo, se IdPs diferentes utilizam tipos diferentes para que representa os nomes de utilizador, as regras de controlo de acesso podem transformar-todos estes para um tipo comum de nome de utilizador. Controlo de acesso, em seguida, envia este browser toohello back-token (passo 4), novo que submete-toohello aplicação (passo 5). Uma vez que tem um token de controlo de acesso Olá, a aplicação Olá verifica que este token realmente foi emitido pelo controlo de acesso, em seguida, utiliza as informações de Olá contém (passo 6).

Durante este processo pode parecer um pouco mais complicado, realmente faz vida significativamente mais simples de criador de Olá da aplicação Olá. Em vez de lidar com diversos tokens que contém informações diferentes, a aplicação Olá pode aceitar identidades emitidas por vários fornecedores de identidade ao ainda receber apenas um único token com informações familiares. Além disso, em vez de exigir a que cada aplicação toobe configurado tootrust IdPs várias, estas relações de confiança em vez disso, são mantidas pelo controlo de acesso – uma aplicação só tem de confiar nele.

É importante, apontar que nada sobre o controlo de acesso associada tooWindows - apenas também pode ser utilizado por uma aplicação do Linux que aceite apenas as identidades do Google e o Facebook. E, apesar de controlo de acesso faz parte da Olá família do Azure Active Directory, pode considerá-lo como um serviço completamente diferente da que foi descrito na secção anterior Olá. Embora ambas as tecnologias trabalham com a identidade, estes endereços problemas bastante diferentes (embora a Microsoft tem consiga aceder tal espera toointegrate Olá dois, a determinada altura).

Trabalhar com a identidade é importante em quase todas as aplicações. objetivo de Olá do controlo de acesso é toomake facilitam para aplicações de toocreate os programadores que aceitam as identidades de fornecedores de identidade diversos. Ao colocar este serviço na nuvem de Olá, Microsoft fez com que aplicações tooany disponíveis em execução em qualquer plataforma.

## <a name="about-hello-author"></a>Sobre Olá autor
O David Chappell é o Principal de Chappell & Associates [www.davidchappell.com](http://www.davidchappell.com) em frente, na Califórnia.

