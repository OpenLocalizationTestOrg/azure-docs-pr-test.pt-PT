---
title: dispositivos de IoT aaaAzure SDK para C - IoTHubClient | Microsoft Docs
description: "Como biblioteca de IoTHubClient Olá toouse em dispositivos de IoT do Azure SDK Olá C toocreate para aplicações de dispositivo que comunicam com um IoT hub."
services: iot-hub
documentationcenter: 
author: olivierbloch
manager: timlt
editor: 
ms.assetid: 828cf2bf-999d-4b8a-8a28-c7c901629600
ms.service: iot-hub
ms.devlang: cpp
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/06/2016
ms.author: obloch
ms.openlocfilehash: d1ece79e9ba6d1e5fd45cabb8fca393b24052e07
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="azure-iot-device-sdk-for-c--more-about-iothubclient"></a><span data-ttu-id="6d6f8-103">Dispositivos de IoT do Azure SDK para C – mais informações sobre IoTHubClient</span><span class="sxs-lookup"><span data-stu-id="6d6f8-103">Azure IoT device SDK for C – more about IoTHubClient</span></span>
<span data-ttu-id="6d6f8-104">Olá [primeiro artigo](iot-hub-device-sdk-c-intro.md) no Olá série introduzida **dispositivos de IoT do Azure SDK para C**. Esse artigo explicado que existem duas camadas de arquitetura no SDK.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-104">hello [first article](iot-hub-device-sdk-c-intro.md) in this series introduced hello **Azure IoT device SDK for C**. That article explained that there are two architectural layers in SDK.</span></span> <span data-ttu-id="6d6f8-105">A base de Olá é Olá **IoTHubClient** biblioteca que gere diretamente a comunicação com o IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-105">At hello base is hello **IoTHubClient** library which directly manages communication with IoT Hub.</span></span> <span data-ttu-id="6d6f8-106">Também é Olá **serializador** biblioteca baseia-se em cima do que tooprovide serviços de serialização.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-106">There's also hello **serializer** library that builds on top of that tooprovide serialization services.</span></span> <span data-ttu-id="6d6f8-107">Neste artigo fornecemos detalhes adicionais sobre Olá **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-107">In this article we'll provide additional detail on hello **IoTHubClient** library.</span></span>

<span data-ttu-id="6d6f8-108">artigo anterior Olá descrito como toouse Olá **IoTHubClient** biblioteca toosend eventos tooIoT Hub e receber mensagens.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-108">hello previous article described how toouse hello **IoTHubClient** library toosend events tooIoT Hub and receive messages.</span></span> <span data-ttu-id="6d6f8-109">Este artigo expande essa debate por explicar como gerir precisamente toomore *quando* enviar e receber dados, introduzindo-toohello **APIs de nível inferior**.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-109">This article extends that discussion by explaining how toomore precisely manage *when* you send and receive data, introducing you toohello **lower-level APIs**.</span></span> <span data-ttu-id="6d6f8-110">Também vamos explicar como tooattach propriedades tooevents (e provenientes de mensagens) utilizando a propriedade Olá processamento funcionalidades no Olá **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-110">We'll also explain how tooattach properties tooevents (and retrieve them from messages) using hello property handling features in hello **IoTHubClient** library.</span></span> <span data-ttu-id="6d6f8-111">Por último, iremos fornecer explicação adicional de diferentes formas toohandle mensagens recebidas a partir do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-111">Finally, we'll provide additional explanation of different ways toohandle messages received from IoT Hub.</span></span>

<span data-ttu-id="6d6f8-112">Olá artigo é concluída ao que abrangem alguns tópicos diversas, incluindo informações sobre as credenciais de dispositivo e como toochange Olá comportamento de Olá **IoTHubClient** através de opções de configuração.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-112">hello article concludes by covering a couple of miscellaneous topics, including more about device credentials and how toochange hello behavior of hello **IoTHubClient** through configuration options.</span></span>

<span data-ttu-id="6d6f8-113">Utilizaremos Olá **IoTHubClient** SDK amostras tooexplain estes tópicos.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-113">We'll use hello **IoTHubClient** SDK samples tooexplain these topics.</span></span> <span data-ttu-id="6d6f8-114">Se quiser toofollow ao longo, consulte Olá **iothub\_cliente\_exemplo\_http** e **iothub\_cliente\_exemplo\_amqp** aplicações que estão incluídas no dispositivo IoT do Azure de Olá SDK para C. tudo descrito nas seguintes secções de Olá é demonstrado nestes exemplos.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-114">If you want toofollow along, see hello **iothub\_client\_sample\_http** and **iothub\_client\_sample\_amqp** applications that are included in hello Azure IoT device SDK for C. Everything described in hello following sections is demonstrated in these samples.</span></span>

<span data-ttu-id="6d6f8-115">Pode encontrar Olá [ **dispositivos de IoT do Azure SDK para C** ](https://github.com/Azure/azure-iot-sdk-c) GitHub repositório e vista de detalhes de Olá API no Olá [referência da API de C](https://azure.github.io/azure-iot-sdk-c/index.html).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-115">You can find hello [**Azure IoT device SDK for C**](https://github.com/Azure/azure-iot-sdk-c) GitHub repository and view details of hello API in hello [C API reference](https://azure.github.io/azure-iot-sdk-c/index.html).</span></span>

## <a name="hello-lower-level-apis"></a><span data-ttu-id="6d6f8-116">Olá APIs de nível inferior</span><span class="sxs-lookup"><span data-stu-id="6d6f8-116">hello lower-level APIs</span></span>
<span data-ttu-id="6d6f8-117">artigo anterior Olá descrito funcionamento básico Olá Olá **IotHubClient** dentro do contexto Olá Olá **iothub\_cliente\_exemplo\_amqp** aplicação.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-117">hello previous article described hello basic operation of hello **IotHubClient** within hello context of hello **iothub\_client\_sample\_amqp** application.</span></span> <span data-ttu-id="6d6f8-118">Por exemplo, explicado como tooinitialize Olá biblioteca a utilizar este código.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-118">For example, it explained how tooinitialize hello library using this code.</span></span>

```
IOTHUB_CLIENT_HANDLE iotHubClientHandle;
iotHubClientHandle = IoTHubClient_CreateFromConnectionString(connectionString, AMQP_Protocol);
```

<span data-ttu-id="6d6f8-119">Também descrita como eventos de toosend utilizando este a chamada de funções.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-119">It also described how toosend events using this function call.</span></span>

```
IoTHubClient_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message);
```

<span data-ttu-id="6d6f8-120">artigo de Olá também descrita como tooreceive mensagens ao registar a uma função de chamada de retorno.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-120">hello article also described how tooreceive messages by registering a callback function.</span></span>

```
int receiveContext = 0;
IoTHubClient_SetMessageCallback(iotHubClientHandle, ReceiveMessageCallback, &receiveContext);
```

<span data-ttu-id="6d6f8-121">artigo de Olá também mostrou como toofree recursos com o código como o seguinte Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-121">hello article also showed how toofree resources using code such as hello following.</span></span>

```
IoTHubClient_Destroy(iotHubClientHandle);
```

<span data-ttu-id="6d6f8-122">No entanto, existem complementar funções tooeach destas APIs:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-122">However there are companion functions tooeach of these APIs:</span></span>

* <span data-ttu-id="6d6f8-123">IoTHubClient\_odas\_CreateFromConnectionString</span><span class="sxs-lookup"><span data-stu-id="6d6f8-123">IoTHubClient\_LL\_CreateFromConnectionString</span></span>
* <span data-ttu-id="6d6f8-124">IoTHubClient\_odas\_SendEventAsync</span><span class="sxs-lookup"><span data-stu-id="6d6f8-124">IoTHubClient\_LL\_SendEventAsync</span></span>
* <span data-ttu-id="6d6f8-125">IoTHubClient\_odas\_SetMessageCallback</span><span class="sxs-lookup"><span data-stu-id="6d6f8-125">IoTHubClient\_LL\_SetMessageCallback</span></span>
* <span data-ttu-id="6d6f8-126">IoTHubClient\_odas\_destruir</span><span class="sxs-lookup"><span data-stu-id="6d6f8-126">IoTHubClient\_LL\_Destroy</span></span>

<span data-ttu-id="6d6f8-127">Estas funções de todos os incluem "Odas" no nome da API Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-127">These functions all include “LL” in hello API name.</span></span> <span data-ttu-id="6d6f8-128">Além disso, os parâmetros de Olá de cada uma destas funções são homólogos de não odas tootheir idênticos.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-128">Other than that, hello parameters of each of these functions are identical tootheir non-LL counterparts.</span></span> <span data-ttu-id="6d6f8-129">No entanto, o comportamento de Olá destas funções é diferente de uma forma importante.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-129">However, hello behavior of these functions is different in one important way.</span></span>

<span data-ttu-id="6d6f8-130">Quando chamar **IoTHubClient\_CreateFromConnectionString**, bibliotecas subjacente Olá criar um novo thread que é executado em segundo plano de Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-130">When you call **IoTHubClient\_CreateFromConnectionString**, hello underlying libraries create a new thread that runs in hello background.</span></span> <span data-ttu-id="6d6f8-131">Envia eventos para este thread e recebe mensagens do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-131">This thread sends events to, and receives messages from, IoT Hub.</span></span> <span data-ttu-id="6d6f8-132">Nenhum desse thread é criado quando trabalhar com Olá "Odas" APIs.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-132">No such thread is created when working with hello "LL" APIs.</span></span> <span data-ttu-id="6d6f8-133">a criação do thread de segundo plano Olá Olá é um programador de toohello conveniência.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-133">hello creation of hello background thread is a convenience toohello developer.</span></span> <span data-ttu-id="6d6f8-134">Não tem tooworry sobre explicitamente enviar eventos e receber mensagens do IoT Hub – ocorre automaticamente em segundo plano de Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-134">You don’t have tooworry about explicitly sending events and receiving messages from IoT Hub -- it happens automatically in hello background.</span></span> <span data-ttu-id="6d6f8-135">Em contrapartida, Olá "Odas" APIs dão-lhe explícito controlo sobre a comunicação com o IoT Hub, se o ficheiro necessário.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-135">In contrast, hello "LL" APIs give you explicit control over communication with IoT Hub, if you need it.</span></span>

<span data-ttu-id="6d6f8-136">toounderstand esta melhor, vamos ver um exemplo:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-136">toounderstand this better, let’s look at an example:</span></span>

<span data-ttu-id="6d6f8-137">Quando chamar **IoTHubClient\_SendEventAsync**, que, na verdade, está a fazer é colocar o evento de Olá numa memória intermédia.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-137">When you call **IoTHubClient\_SendEventAsync**, what you're actually doing is putting hello event in a buffer.</span></span> <span data-ttu-id="6d6f8-138">Olá thread de segundo plano que criou quando chamar **IoTHubClient\_CreateFromConnectionString** continuamente monitoriza desta memória intermédia e envia quaisquer dados que contém tooIoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-138">hello background thread created when you call **IoTHubClient\_CreateFromConnectionString** continually monitors this buffer and sends any data that it contains tooIoT Hub.</span></span> <span data-ttu-id="6d6f8-139">Isto acontece em segundo plano de Olá em Olá mesmo tempo que Olá thread principal está a efetuar outras tarefas.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-139">This happens in hello background at hello same time that hello main thread is performing other work.</span></span>

<span data-ttu-id="6d6f8-140">Da mesma forma, quando efetua o registo uma função de chamada de retorno para mensagens utilizando **IoTHubClient\_SetMessageCallback**, está a que dá instruções em segundo plano do Olá SDK toohave Olá thread invocar a função de chamada de retorno de Olá quando uma mensagem é foi recebido, independentemente do thread principal Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-140">Similarly, when you register a callback function for messages using **IoTHubClient\_SetMessageCallback**, you're instructing hello SDK toohave hello background thread invoke hello callback function when a message is received, independent of hello main thread.</span></span>

<span data-ttu-id="6d6f8-141">Olá "Odas" APIs não criar um thread de segundo plano.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-141">hello "LL" APIs don’t create a background thread.</span></span> <span data-ttu-id="6d6f8-142">Em vez disso, uma nova API tem de ser chamado tooexplicitly enviar e receber dados a partir do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-142">Instead, a new API must be called tooexplicitly send and receive data from IoT Hub.</span></span> <span data-ttu-id="6d6f8-143">Isto é demonstrado no seguinte exemplo de Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-143">This is demonstrated in hello following example.</span></span>

<span data-ttu-id="6d6f8-144">Olá **iothub\_cliente\_exemplo\_http** aplicação que está incluída no Olá SDK demonstra Olá APIs de nível inferior.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-144">hello **iothub\_client\_sample\_http** application that’s included in hello SDK demonstrates hello lower-level APIs.</span></span> <span data-ttu-id="6d6f8-145">Este exemplo, vamos enviar eventos tooIoT Hub com o código como o seguinte Olá:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-145">In that sample, we send events tooIoT Hub with code such as hello following:</span></span>

```
EVENT_INSTANCE message;
sprintf_s(msgText, sizeof(msgText), "Message_%d_From_IoTHubClient_LL_Over_HTTP", i);
message.messageHandle = IoTHubMessage_CreateFromByteArray((const unsigned char*)msgText, strlen(msgText));

IoTHubClient_LL_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message)
```

<span data-ttu-id="6d6f8-146">Olá primeiro três linhas criar mensagem de saudação e a última linha de Olá envia eventos Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-146">hello first three lines create hello message, and hello last line sends hello event.</span></span> <span data-ttu-id="6d6f8-147">No entanto, tal como mencionado anteriormente, "Enviar" evento de Olá significa que os dados de Olá simplesmente são colocados numa memória intermédia.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-147">However, as mentioned previously, "sending" hello event means that hello data is simply placed in a buffer.</span></span> <span data-ttu-id="6d6f8-148">Nada é transmitido na rede de Olá quando chamamos **IoTHubClient\_odas\_SendEventAsync**.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-148">Nothing is transmitted on hello network when we call **IoTHubClient\_LL\_SendEventAsync**.</span></span> <span data-ttu-id="6d6f8-149">Na ordem tooactually entrada Olá dados tooIoT Hub, tem de chamar **IoTHubClient\_odas\_DoWork**, tal como neste exemplo:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-149">In order tooactually ingress hello data tooIoT Hub, you must call **IoTHubClient\_LL\_DoWork**, as in this example:</span></span>

```
while (1)
{
    IoTHubClient_LL_DoWork(iotHubClientHandle);
    ThreadAPI_Sleep(1000);
}
```

<span data-ttu-id="6d6f8-150">Este código (de Olá **iothub\_cliente\_exemplo\_http** aplicação) repetidamente chama **IoTHubClient\_odas\_DoWork** .</span><span class="sxs-lookup"><span data-stu-id="6d6f8-150">This code (from hello **iothub\_client\_sample\_http** application) repeatedly calls **IoTHubClient\_LL\_DoWork**.</span></span> <span data-ttu-id="6d6f8-151">Sempre que **IoTHubClient\_odas\_DoWork** é chamado, envia alguns eventos de memória intermédia de Olá tooIoT Hub e obtém uma mensagem em fila a ser enviada toohello dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-151">Each time **IoTHubClient\_LL\_DoWork** is called, it sends some events from hello buffer tooIoT Hub and it retrieves a queued message being sent toohello device.</span></span> <span data-ttu-id="6d6f8-152">caso última Olá significa que se registado é uma função de chamada de retorno de mensagens, em seguida, a chamada de retorno Olá é invocada (partindo do princípio de todas as mensagens são colocadas em cópia de segurança).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-152">hello latter case means that if we registered a callback function for messages, then hello callback is invoked (assuming any messages are queued up).</span></span> <span data-ttu-id="6d6f8-153">Iremos seria registou uma função de chamada de retorno com o código como o seguinte Olá:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-153">We would have registered such a callback function with code such as hello following:</span></span>

```
IoTHubClient_LL_SetMessageCallback(iotHubClientHandle, ReceiveMessageCallback, &receiveContext)
```

<span data-ttu-id="6d6f8-154">Olá pelo motivo que **IoTHubClient\_odas\_DoWork** é frequentemente designado ciclo for-que sempre que é denominado, envia *algumas* colocado na memória intermédia eventos tooIoT Hub e obtém *Olá junto* mensagem colocada em fila para o dispositivo de Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-154">hello reason that **IoTHubClient\_LL\_DoWork** is often called in a loop is that each time it’s called, it sends *some* buffered events tooIoT Hub and retrieves *hello next* message queued up for hello device.</span></span> <span data-ttu-id="6d6f8-155">Cada chamada não é garantida toosend todos os colocado na memória intermédia de eventos ou colocadas na fila de tooretrieve todas as mensagens.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-155">Each call isn’t guaranteed toosend all buffered events or tooretrieve all queued messages.</span></span> <span data-ttu-id="6d6f8-156">Se quiser toosend todos os eventos Olá memória intermédia e, em seguida, prosseguir no processamento adicional, pode substituir este ciclo com o código como o seguinte Olá:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-156">If you want toosend all events in hello buffer and then continue on with other processing you can replace this loop with code such as hello following:</span></span>

```
IOTHUB_CLIENT_STATUS status;

while ((IoTHubClient_LL_GetSendStatus(iotHubClientHandle, &status) == IOTHUB_CLIENT_OK) && (status == IOTHUB_CLIENT_SEND_STATUS_BUSY))
{
    IoTHubClient_LL_DoWork(iotHubClientHandle);
    ThreadAPI_Sleep(1000);
}
```

<span data-ttu-id="6d6f8-157">Este código chama **IoTHubClient\_odas\_DoWork** até que todos os eventos na memória intermédia de Olá terem sido enviados tooIoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-157">This code calls **IoTHubClient\_LL\_DoWork** until all events in hello buffer have been sent tooIoT Hub.</span></span> <span data-ttu-id="6d6f8-158">Tenha em conta de que isto também implica que todas as mensagens em fila foram recebidas.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-158">Note this does not also imply that all queued messages have been received.</span></span> <span data-ttu-id="6d6f8-159">Parte da razão de Olá para esta situação é que a verificar mensagens "all" não é determinística como uma ação.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-159">Part of hello reason for this is that checking for "all" messages isn’t as deterministic an action.</span></span> <span data-ttu-id="6d6f8-160">O que acontece se é possível obter "tudo" de mensagens hello, mas, em seguida, outra é enviada toohello dispositivo imediatamente após?</span><span class="sxs-lookup"><span data-stu-id="6d6f8-160">What happens if you retrieve "all" of hello messages, but then another one is sent toohello device immediately after?</span></span> <span data-ttu-id="6d6f8-161">Uma melhor toodeal de forma com que está com um tempo limite programados e.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-161">A better way toodeal with that is with a programmed timeout.</span></span> <span data-ttu-id="6d6f8-162">Por exemplo, a função de chamada de retorno de mensagem de Olá repor um temporizador sempre que é invocado.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-162">For example, hello message callback function could reset a timer every time it’s invoked.</span></span> <span data-ttu-id="6d6f8-163">Pode, em seguida, escrever o processamento de toocontinue lógica se, por exemplo, não foram recebidas mensagens no Olá pela última vez *X* segundos.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-163">You can then write logic toocontinue processing if, for example, no messages have been received in hello last *X* seconds.</span></span>

<span data-ttu-id="6d6f8-164">Quando está a terminar ingressing eventos e receber mensagens, ser toocall se Olá correspondente função tooclean recursos.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-164">When you’re finished ingressing events and receiving messages, be sure toocall hello corresponding function tooclean up resources.</span></span>

```
IoTHubClient_LL_Destroy(iotHubClientHandle);
```

<span data-ttu-id="6d6f8-165">Basicamente houver apenas um conjunto de APIs toosend e receber dados com um thread de segundo plano e outro conjunto de APIs que Olá a mesma coisa sem thread de segundo plano Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-165">Basically there’s only one set of APIs toosend and receive data with a background thread and another set of APIs that does hello same thing without hello background thread.</span></span> <span data-ttu-id="6d6f8-166">Muitos os programadores podem preferir Olá não - odas APIs, mas hello APIs de nível inferior são úteis quando programador Olá quiser explícito controlo sobre as transmissões de rede.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-166">A lot of developers may prefer hello non-LL APIs, but hello lower-level APIs are useful when hello developer wants explicit control over network transmissions.</span></span> <span data-ttu-id="6d6f8-167">Por exemplo, alguns dispositivos recolhem os dados ao longo do tempo e eventos de entrada apenas em intervalos especificados (por exemplo, uma vez uma hora ou uma vez por dia).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-167">For example, some devices collect data over time and only ingress events at specified intervals (for example, once an hour or once a day).</span></span> <span data-ttu-id="6d6f8-168">Olá conceder APIs de nível inferior Olá controlo tooexplicitly de capacidade quando enviar e receber dados a partir do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-168">hello lower-level APIs give you hello ability tooexplicitly control when you send and receive data from IoT Hub.</span></span> <span data-ttu-id="6d6f8-169">Outras pessoas simplesmente preferirão simplicidade Olá esse Olá que fornecem APIs de nível inferior.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-169">Others will simply prefer hello simplicity that hello lower-level APIs provide.</span></span> <span data-ttu-id="6d6f8-170">Tudo acontece no thread principal Olá em vez de algumas acontecer de trabalho em segundo plano de Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-170">Everything happens on hello main thread rather than some work happening in hello background.</span></span>

<span data-ttu-id="6d6f8-171">Qualquer modelo que escolher, ser se toobe consistente em que as APIs de utilizar.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-171">Whichever model you choose, be sure toobe consistent in which APIs you use.</span></span> <span data-ttu-id="6d6f8-172">Se iniciar chamando **IoTHubClient\_odas\_CreateFromConnectionString**, certifique-se de utilizar apenas Olá correspondente APIs de nível inferior de qualquer trabalho seguimento:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-172">If you start by calling **IoTHubClient\_LL\_CreateFromConnectionString**, be sure you only use hello corresponding lower-level APIs for any follow-up work:</span></span>

* <span data-ttu-id="6d6f8-173">IoTHubClient\_odas\_SendEventAsync</span><span class="sxs-lookup"><span data-stu-id="6d6f8-173">IoTHubClient\_LL\_SendEventAsync</span></span>
* <span data-ttu-id="6d6f8-174">IoTHubClient\_odas\_SetMessageCallback</span><span class="sxs-lookup"><span data-stu-id="6d6f8-174">IoTHubClient\_LL\_SetMessageCallback</span></span>
* <span data-ttu-id="6d6f8-175">IoTHubClient\_odas\_destruir</span><span class="sxs-lookup"><span data-stu-id="6d6f8-175">IoTHubClient\_LL\_Destroy</span></span>
* <span data-ttu-id="6d6f8-176">IoTHubClient\_odas\_DoWork</span><span class="sxs-lookup"><span data-stu-id="6d6f8-176">IoTHubClient\_LL\_DoWork</span></span>

<span data-ttu-id="6d6f8-177">Olá oposta também se aplica.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-177">hello opposite is true as well.</span></span> <span data-ttu-id="6d6f8-178">Se iniciar com **IoTHubClient\_CreateFromConnectionString**, em seguida, utilize Olá não - odas as APIs para qualquer processamento adicional.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-178">If you start with **IoTHubClient\_CreateFromConnectionString**, then use hello non-LL APIs for any additional processing.</span></span>

<span data-ttu-id="6d6f8-179">Olá Azure IoT dispositivo SDK para C, consulte Olá **iothub\_cliente\_exemplo\_http** para obter um exemplo de Olá concluída inferior ao nível da aplicação APIs.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-179">In hello Azure IoT device SDK for C, see hello **iothub\_client\_sample\_http** application for a complete example of hello lower-level APIs.</span></span> <span data-ttu-id="6d6f8-180">Olá **iothub\_cliente\_exemplo\_amqp** pode ser referenciada a aplicação para obter um exemplo completo de Olá não - odas APIs.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-180">hello **iothub\_client\_sample\_amqp** application can be referenced for a full example of hello non-LL APIs.</span></span>

## <a name="property-handling"></a><span data-ttu-id="6d6f8-181">Processamento de propriedade</span><span class="sxs-lookup"><span data-stu-id="6d6f8-181">Property handling</span></span>
<span data-ttu-id="6d6f8-182">Até ao momento quando que já descrito envio de dados, vamos tiver sido referir-se toohello corpo de mensagem de saudação.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-182">So far when we've described sending data, we've been referring toohello body of hello message.</span></span> <span data-ttu-id="6d6f8-183">Por exemplo, considere este código:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-183">For example, consider this code:</span></span>

```
EVENT_INSTANCE message;
sprintf_s(msgText, sizeof(msgText), "Hello World");
message.messageHandle = IoTHubMessage_CreateFromByteArray((const unsigned char*)msgText, strlen(msgText));
IoTHubClient_LL_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message)
```

<span data-ttu-id="6d6f8-184">Neste exemplo envia uma mensagem tooIoT Hub com texto de Olá "Olá mundo".</span><span class="sxs-lookup"><span data-stu-id="6d6f8-184">This example sends a message tooIoT Hub with hello text "Hello World."</span></span> <span data-ttu-id="6d6f8-185">No entanto, o IoT Hub permite também mensagem do propriedades toobe tooeach anexado.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-185">However, IoT Hub also allows properties toobe attached tooeach message.</span></span> <span data-ttu-id="6d6f8-186">As propriedades são pares nome/valor que podem ser anexado toohello mensagem.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-186">Properties are name/value pairs that can be attached toohello message.</span></span> <span data-ttu-id="6d6f8-187">Por exemplo, vamos pode modificar Olá anterior código tooattach uma mensagem de toohello da propriedade:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-187">For example, we can modify hello previous code tooattach a property toohello message:</span></span>

```
MAP_HANDLE propMap = IoTHubMessage_Properties(message.messageHandle);
sprintf_s(propText, sizeof(propText), "%d", i);
Map_AddOrUpdate(propMap, "SequenceNumber", propText);
```

<span data-ttu-id="6d6f8-188">Vamos começar por chamar **IoTHubMessage\_propriedades** e passou-o identificador de Olá da nossa mensagem.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-188">We start by calling **IoTHubMessage\_Properties** and passing it hello handle of our message.</span></span> <span data-ttu-id="6d6f8-189">O que vamos voltar é um **mapa\_PROCESSAR** referência que permite-nos toostart adicionar propriedades.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-189">What we get back is a **MAP\_HANDLE** reference that enables us toostart adding properties.</span></span> <span data-ttu-id="6d6f8-190">Olá esta última opção é conseguido ao chamar **mapa\_AddOrUpdate**, que aceita uma referência tooa mapa\_identificador, o nome da propriedade Olá e o valor da propriedade Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-190">hello latter is accomplished by calling **Map\_AddOrUpdate**, which takes a reference tooa MAP\_HANDLE, hello property name, and hello property value.</span></span> <span data-ttu-id="6d6f8-191">Com esta API adicionamos tantos propriedades como podemos como.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-191">With this API we can add as many properties as we like.</span></span>

<span data-ttu-id="6d6f8-192">Quando o evento Olá é lida **Event Hubs**, recetor Olá pode enumerar Olá propriedades e obter os valores correspondentes.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-192">When hello event is read from **Event Hubs**, hello receiver can enumerate hello properties and retrieve their corresponding values.</span></span> <span data-ttu-id="6d6f8-193">Por exemplo, no .NET seria fazê acedendo Olá [coleção de propriedades no objeto de EventData Olá](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.eventdata.properties.aspx).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-193">For example, in .NET this would be accomplished by accessing hello [Properties collection on hello EventData object](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.eventdata.properties.aspx).</span></span>

<span data-ttu-id="6d6f8-194">No exemplo anterior Olá, iremos está a expor o evento de tooan propriedades que podemos enviar tooIoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-194">In hello previous example, we’re attaching properties tooan event that we send tooIoT Hub.</span></span> <span data-ttu-id="6d6f8-195">As propriedades também podem ser anexados toomessages recebido a partir do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-195">Properties can also be attached toomessages received from IoT Hub.</span></span> <span data-ttu-id="6d6f8-196">Se quisermos tooretrieve propriedades de uma mensagem, podemos utilizar código como o seguinte Olá na nossa função de chamada de retorno de mensagem:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-196">If we want tooretrieve properties from a message, we can use code such as hello following in our message callback function:</span></span>

```
static IOTHUBMESSAGE_DISPOSITION_RESULT ReceiveMessageCallback(IOTHUB_MESSAGE_HANDLE message, void* userContextCallback)
{
    . . .

    // Retrieve properties from hello message
    MAP_HANDLE mapProperties = IoTHubMessage_Properties(message);
    if (mapProperties != NULL)
    {
        const char*const* keys;
        const char*const* values;
        size_t propertyCount = 0;
        if (Map_GetInternals(mapProperties, &keys, &values, &propertyCount) == MAP_OK)
        {
            if (propertyCount > 0)
            {
                printf("Message Properties:\r\n");
                for (size_t index = 0; index < propertyCount; index++)
                {
                    printf("\tKey: %s Value: %s\r\n", keys[index], values[index]);
                }
                printf("\r\n");
            }
        }
    }

    . . .
}
```

<span data-ttu-id="6d6f8-197">Olá chamada demasiado**IoTHubMessage\_propriedades** devolve Olá **mapa\_PROCESSAR** referência.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-197">hello call too**IoTHubMessage\_Properties** returns hello **MAP\_HANDLE** reference.</span></span> <span data-ttu-id="6d6f8-198">Vamos então, passe essa referência demasiado**mapa\_GetInternals** tooobtain uma matriz de tooan de referência de Olá. o nome/valor pares (bem como uma contagem das propriedades de Olá).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-198">We then pass that reference too**Map\_GetInternals** tooobtain a reference tooan array of hello name/value pairs (as well as a count of hello properties).</span></span> <span data-ttu-id="6d6f8-199">Nesse momento é tão simples como de Olá propriedades tooget toohello valores que queremos a enumerar.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-199">At that point it's a simple matter of enumerating hello properties tooget toohello values we want.</span></span>

<span data-ttu-id="6d6f8-200">Não tem propriedades toouse na sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-200">You don't have toouse properties in your application.</span></span> <span data-ttu-id="6d6f8-201">No entanto, se precisar de tooset-las em eventos ou provenientes de mensagens, hello **IoTHubClient** biblioteca torna mais fácil.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-201">However, if you need tooset them on events or retrieve them from messages, hello **IoTHubClient** library makes it easy.</span></span>

## <a name="message-handling"></a><span data-ttu-id="6d6f8-202">Processamento de mensagens</span><span class="sxs-lookup"><span data-stu-id="6d6f8-202">Message handling</span></span>
<span data-ttu-id="6d6f8-203">Conforme indicado anteriormente, quando chegam mensagens da Olá do IoT Hub **IoTHubClient** biblioteca responde invocando uma função de chamada de retorno registado.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-203">As stated previously, when messages arrive from IoT Hub hello **IoTHubClient** library responds by invoking a registered callback function.</span></span> <span data-ttu-id="6d6f8-204">Não há um parâmetro de retorno desta função que deserves algumas explicação adicional.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-204">There is a return parameter of this function that deserves some additional explanation.</span></span> <span data-ttu-id="6d6f8-205">Eis um excerpt da função de chamada de retorno de Olá na Olá **iothub\_cliente\_exemplo\_http** aplicação de exemplo:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-205">Here’s an excerpt of hello callback function in hello **iothub\_client\_sample\_http** sample application:</span></span>

```
static IOTHUBMESSAGE_DISPOSITION_RESULT ReceiveMessageCallback(IOTHUB_MESSAGE_HANDLE message, void* userContextCallback)
{
    . . .
    return IOTHUBMESSAGE_ACCEPTED;
}
```

<span data-ttu-id="6d6f8-206">Tenha em atenção que é do tipo de retorno de Olá **IOTHUBMESSAGE\_disposição\_resultado** e neste caso específico, Devolvemos **IOTHUBMESSAGE\_ACEITES**.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-206">Note that hello return type is **IOTHUBMESSAGE\_DISPOSITION\_RESULT** and in this particular case we return **IOTHUBMESSAGE\_ACCEPTED**.</span></span> <span data-ttu-id="6d6f8-207">Existem outros valores que pode devolver a partir desta função alteração como Olá **IoTHubClient** biblioteca reage toohello chamada de retorno de mensagem.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-207">There are other values we can return from this function that change how hello **IoTHubClient** library reacts toohello message callback.</span></span> <span data-ttu-id="6d6f8-208">Seguem-se as opções de Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-208">Here are hello options.</span></span>

* <span data-ttu-id="6d6f8-209">**IOTHUBMESSAGE\_ACEITES** – mensagem de saudação foi processada com êxito.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-209">**IOTHUBMESSAGE\_ACCEPTED** – hello message has been processed successfully.</span></span> <span data-ttu-id="6d6f8-210">Olá **IoTHubClient** biblioteca não será invocar a função de chamada de retorno de Olá com Olá mesma mensagem.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-210">hello **IoTHubClient** library will not invoke hello callback function again with hello same message.</span></span>
* <span data-ttu-id="6d6f8-211">**IOTHUBMESSAGE\_rejeitado** – mensagem de saudação não foi processada e não existe nenhum toodo desire Olá, por isso, no futuro.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-211">**IOTHUBMESSAGE\_REJECTED** – hello message was not processed and there is no desire toodo so in hello future.</span></span> <span data-ttu-id="6d6f8-212">Olá **IoTHubClient** biblioteca não deve invocar a função de chamada de retorno de Olá com Olá mesma mensagem.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-212">hello **IoTHubClient** library should not invoke hello callback function again with hello same message.</span></span>
* <span data-ttu-id="6d6f8-213">**IOTHUBMESSAGE\_ABANDONED** – a mensagem de saudação não foi processada com êxito, mas Olá **IoTHubClient** biblioteca deve invocar a função de chamada de retorno de Olá com Olá mesma mensagem.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-213">**IOTHUBMESSAGE\_ABANDONED** – hello message was not processed successfully, but hello **IoTHubClient** library should invoke hello callback function again with hello same message.</span></span>

<span data-ttu-id="6d6f8-214">Para Olá primeiro dois códigos de retorno, hello **IoTHubClient** biblioteca envia um tooIoT de mensagem que indica que mensagem de saudação do Hub deve ser eliminado da fila de dispositivo Olá e não entregar novamente.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-214">For hello first two return codes, hello **IoTHubClient** library sends a message tooIoT Hub indicating that hello message should be deleted from hello device queue and not delivered again.</span></span> <span data-ttu-id="6d6f8-215">efeito net Olá é Olá mesmo (mensagem de saudação é eliminada da fila de dispositivo Olá), mas se a mensagem de saudação foi aceite ou rejeitada ainda é registada.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-215">hello net effect is hello same (hello message is deleted from hello device queue), but whether hello message was accepted or rejected is still recorded.</span></span>  <span data-ttu-id="6d6f8-216">Gravar este distinção é útil toosenders de mensagem de saudação quem pode oiça comentários e saber se um dispositivo tem aceite ou rejeitou uma mensagem específica.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-216">Recording this distinction is useful toosenders of hello message who can listen for feedback and find out if a device has accepted or rejected a particular message.</span></span>

<span data-ttu-id="6d6f8-217">No caso de último Olá é enviada uma mensagem também tooIoT Hub, mas indica que essa mensagem de saudação deve ser reenviada.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-217">In hello last case a message is also sent tooIoT Hub, but it indicates that hello message should be redelivered.</span></span> <span data-ttu-id="6d6f8-218">Normalmente, irá abandonar uma mensagem se encontrar algum erro, mas pretende tootry tooprocess Olá mensagem novamente.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-218">Typically you’ll abandon a message if you encounter some error but want tootry tooprocess hello message again.</span></span> <span data-ttu-id="6d6f8-219">Em contrapartida, uma mensagem a rejeitar é adequada quando ocorrer um erro irrecuperável (ou se, simplesmente, decidir que não pretende a mensagem de saudação tooprocess).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-219">In contrast, rejecting a message is appropriate when you encounter an unrecoverable error (or if you simply decide you don’t want tooprocess hello message).</span></span>

<span data-ttu-id="6d6f8-220">Em qualquer caso, tenha em atenção de códigos de retorno diferentes Olá, de modo a que pode elicit comportamento Olá pretendido no Olá **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-220">In any case, be aware of hello different return codes so that you can elicit hello behavior you want from hello **IoTHubClient** library.</span></span>

## <a name="alternate-device-credentials"></a><span data-ttu-id="6d6f8-221">Credenciais de dispositivo alternativo</span><span class="sxs-lookup"><span data-stu-id="6d6f8-221">Alternate device credentials</span></span>
<span data-ttu-id="6d6f8-222">Tal como explicado anteriormente, Olá primeiro thing toodo ao trabalhar com Olá **IoTHubClient** biblioteca é tooobtain um **IOTHUB\_cliente\_PROCESSAR** com uma chamada como Olá os seguintes:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-222">As explained previously, hello first thing toodo when working with hello **IoTHubClient** library is tooobtain a **IOTHUB\_CLIENT\_HANDLE** with a call such as hello following:</span></span>

```
IOTHUB_CLIENT_HANDLE iotHubClientHandle;
iotHubClientHandle = IoTHubClient_CreateFromConnectionString(connectionString, AMQP_Protocol);
```

<span data-ttu-id="6d6f8-223">Olá argumentos demasiado**IoTHubClient\_CreateFromConnectionString** são cadeia de ligação do dispositivo Olá e um parâmetro que indica o protocolo de Olá utilizamos toocommunicate com o IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-223">hello arguments too**IoTHubClient\_CreateFromConnectionString** are hello device connection string and a parameter that indicates hello protocol we use toocommunicate with IoT Hub.</span></span> <span data-ttu-id="6d6f8-224">cadeia de ligação do dispositivo Olá tem um formato que aparece da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-224">hello device connection string has a format that appears as follows:</span></span>

```
HostName=IOTHUBNAME.IOTHUBSUFFIX;DeviceId=DEVICEID;SharedAccessKey=SHAREDACCESSKEY
```

<span data-ttu-id="6d6f8-225">Existem quatro tipos de informações nesta cadeia: nome do IoT Hub, sufixo do IoT Hub, ID de dispositivo e chave de acesso partilhado.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-225">There are four pieces of information in this string: IoT Hub name, IoT Hub suffix, device ID, and shared access key.</span></span> <span data-ttu-id="6d6f8-226">Obter o nome de domínio completamente qualificado (FQDN) Olá de um hub IoT quando criar a instância do hub IoT no portal do Azure de Olá — Isto dá-lhe nome de hub IoT Olá (Olá primeira parte do Olá FQDN) e o sufixo de hub IoT de Olá (Olá rest de Olá FQDN).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-226">You obtain hello fully qualified domain name (FQDN) of an IoT hub when you create your IoT hub instance in hello Azure portal — this gives you hello IoT hub name (hello first part of hello FQDN) and hello IoT hub suffix (hello rest of hello FQDN).</span></span> <span data-ttu-id="6d6f8-227">Obter o ID de dispositivo de Olá e chave de acesso partilhado Olá quando registar o seu dispositivo com o IoT Hub (conforme descrito em Olá [artigo anterior](iot-hub-device-sdk-c-intro.md)).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-227">You get hello device ID and hello shared access key when you register your device with IoT Hub (as described in hello [previous article](iot-hub-device-sdk-c-intro.md)).</span></span>

<span data-ttu-id="6d6f8-228">**IoTHubClient\_CreateFromConnectionString** dá-lhe biblioteca de Olá tooinitialize unidirecional.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-228">**IoTHubClient\_CreateFromConnectionString** gives you one way tooinitialize hello library.</span></span> <span data-ttu-id="6d6f8-229">Se preferir, pode criar um novo **IOTHUB\_cliente\_PROCESSAR** utilizando estes parâmetros individuais em vez de cadeia de ligação do dispositivo Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-229">If you prefer, you can create a new **IOTHUB\_CLIENT\_HANDLE** by using these individual parameters rather than hello device connection string.</span></span> <span data-ttu-id="6d6f8-230">Isto é conseguido com Olá seguinte código:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-230">This is achieved with hello following code:</span></span>

```
IOTHUB_CLIENT_CONFIG iotHubClientConfig;
iotHubClientConfig.iotHubName = "";
iotHubClientConfig.deviceId = "";
iotHubClientConfig.deviceKey = "";
iotHubClientConfig.iotHubSuffix = "";
iotHubClientConfig.protocol = HTTP_Protocol;
IOTHUB_CLIENT_HANDLE iotHubClientHandle = IoTHubClient_LL_Create(&iotHubClientConfig);
```

<span data-ttu-id="6d6f8-231">Isto concretiza Olá mesma coisa como **IoTHubClient\_CreateFromConnectionString**.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-231">This accomplishes hello same thing as **IoTHubClient\_CreateFromConnectionString**.</span></span>

<span data-ttu-id="6d6f8-232">Pode parecer que pretende toouse óbvios **IoTHubClient\_CreateFromConnectionString** em vez deste método de inicialização mais verboso.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-232">It may seem obvious that you would want toouse **IoTHubClient\_CreateFromConnectionString** rather than this more verbose method of initialization.</span></span> <span data-ttu-id="6d6f8-233">Tenha em atenção, no entanto, que, quando registar um dispositivo no IoT Hub, obter é um ID de dispositivo e a chave do dispositivo (não uma cadeia de ligação).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-233">Keep in mind, however, that when you register a device in IoT Hub what you get is a device ID and device key (not a connection string).</span></span> <span data-ttu-id="6d6f8-234">Olá *Explorador de dispositivo* ferramenta SDK introduzida no Olá [artigo anterior](iot-hub-device-sdk-c-intro.md) utiliza bibliotecas na Olá **SDK do serviço do Azure IoT** toocreate cadeia de ligação do dispositivo de Olá do ID de dispositivo de Olá, a chave do dispositivo e o nome de anfitrião do IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-234">hello *device explorer* SDK tool introduced in hello [previous article](iot-hub-device-sdk-c-intro.md) uses libraries in hello **Azure IoT service SDK** toocreate hello device connection string from hello device ID, device key, and IoT Hub host name.</span></span> <span data-ttu-id="6d6f8-235">Por isso, ao chamar **IoTHubClient\_odas\_criar** poderá ser preferível porque que lhe poupa passo Olá de gerar uma cadeia de ligação.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-235">So calling **IoTHubClient\_LL\_Create** may be preferable because it saves you hello step of generating a connection string.</span></span> <span data-ttu-id="6d6f8-236">Utilize qualquer método é conveniente.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-236">Use whichever method is convenient.</span></span>

## <a name="configuration-options"></a><span data-ttu-id="6d6f8-237">Opções de configuração</span><span class="sxs-lookup"><span data-stu-id="6d6f8-237">Configuration options</span></span>
<span data-ttu-id="6d6f8-238">Até ao momento tudo descrito sobre Olá de forma Olá **IoTHubClient** biblioteca funciona reflete o comportamento predefinido.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-238">So far everything described about hello way hello **IoTHubClient** library works reflects its default behavior.</span></span> <span data-ttu-id="6d6f8-239">No entanto, existem algumas opções que pode definir toochange como funciona a biblioteca de Olá.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-239">However, there are a few options that you can set toochange how hello library works.</span></span> <span data-ttu-id="6d6f8-240">Isto é conseguido ao tirar partido Olá **IoTHubClient\_odas\_SetOption** API.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-240">This is accomplished by leveraging hello **IoTHubClient\_LL\_SetOption** API.</span></span> <span data-ttu-id="6d6f8-241">Neste exemplo, considere:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-241">Consider this example:</span></span>

```
unsigned int timeout = 30000;
IoTHubClient_LL_SetOption(iotHubClientHandle, "timeout", &timeout);
```

<span data-ttu-id="6d6f8-242">Existem duas opções são frequentemente utilizadas:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-242">There are a couple of options that are commonly used:</span></span>

* <span data-ttu-id="6d6f8-243">**SetBatching** (bool) – se **verdadeiro**, em seguida, os dados enviados tooIoT Hub é enviada em lotes.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-243">**SetBatching** (bool) – If **true**, then data sent tooIoT Hub is sent in batches.</span></span> <span data-ttu-id="6d6f8-244">Se **falso**, em seguida, são enviadas mensagens individualmente.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-244">If **false**, then messages are sent individually.</span></span> <span data-ttu-id="6d6f8-245">predefinição de Olá é **falso**.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-245">hello default is **false**.</span></span> <span data-ttu-id="6d6f8-246">Tenha em atenção que Olá **SetBatching** opção aplica-se apenas toohello HTTP protocolo e não toohello MQTT ou AMQP protocolos.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-246">Note that hello **SetBatching** option only applies toohello HTTP protocol and not toohello MQTT or AMQP protocols.</span></span>
* <span data-ttu-id="6d6f8-247">**Tempo limite** (int não assinado) – este valor é representado em milissegundos.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-247">**Timeout** (unsigned int) – This value is represented in milliseconds.</span></span> <span data-ttu-id="6d6f8-248">Se a enviar um pedido de HTTP ou receber uma resposta demora mais tempo superior a esse tempo, em seguida, ligação Olá exceder o tempo limite.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-248">If sending an HTTP request or receiving a response takes longer than this time, then hello connection times out.</span></span>

<span data-ttu-id="6d6f8-249">Olá, opção de criação de batches é importante.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-249">hello batching option is important.</span></span> <span data-ttu-id="6d6f8-250">Por predefinição, Olá eventos de ingresses biblioteca individualmente (um único evento é independentemente demasiado passa**IoTHubClient\_odas\_SendEventAsync**).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-250">By default, hello library ingresses events individually (a single event is whatever you pass too**IoTHubClient\_LL\_SendEventAsync**).</span></span> <span data-ttu-id="6d6f8-251">Se estiver a opção de criação de batches de Olá **verdadeiro**, biblioteca Olá recolhe os eventos tantos possível da memória intermédia de Olá (cópia de segurança toohello tamanho da mensagem máximo que o IoT Hub aceitará).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-251">If hello batching option is **true**, hello library collects as many events as it can from hello buffer (up toohello maximum message size that IoT Hub will accept).</span></span>  <span data-ttu-id="6d6f8-252">Olá batch de evento é enviada tooIoT Hub numa única chamada HTTP (eventos individuais Olá estão incluídos para uma matriz JSON).</span><span class="sxs-lookup"><span data-stu-id="6d6f8-252">hello event batch is sent tooIoT Hub in a single HTTP call (hello individual events are bundled into a JSON array).</span></span> <span data-ttu-id="6d6f8-253">Ativar a criação de batches normalmente resulta em ganhos de desempenho grande, uma vez que está a reduzir ida e volta de rede.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-253">Enabling batching typically results in big performance gains since you’re reducing network round-trips.</span></span> <span data-ttu-id="6d6f8-254">Reduz significativamente largura de banda, uma vez que está a enviar um conjunto de cabeçalhos de HTTP com o batch um evento, em vez de um conjunto de cabeçalhos para cada evento individual.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-254">It also significantly reduces bandwidth since you are sending one set of HTTP headers with an event batch rather than a set of headers for each individual event.</span></span> <span data-ttu-id="6d6f8-255">A menos que tenha um motivo específico toodo, caso contrário, normalmente, deverá tooenable a criação de batches.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-255">Unless you have a specific reason toodo otherwise, typically you’ll want tooenable batching.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6d6f8-256">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="6d6f8-256">Next steps</span></span>
<span data-ttu-id="6d6f8-257">Este artigo descreve no comportamento de Olá de detalhe de Olá **IoTHubClient** biblioteca encontrada na Olá **dispositivos de IoT do Azure SDK para C**. Com esta informação, deve ter uma boa compreensão das funcionalidades de Olá dos Olá **IoTHubClient** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-257">This article describes in detail hello behavior of hello **IoTHubClient** library found in hello **Azure IoT device SDK for C**. With this information, you should have a good understanding of hello capabilities of hello **IoTHubClient** library.</span></span> <span data-ttu-id="6d6f8-258">Olá [artigo seguinte](iot-hub-device-sdk-c-serializer.md) fornece detalhes semelhantes em Olá **serializador** biblioteca.</span><span class="sxs-lookup"><span data-stu-id="6d6f8-258">hello [next article](iot-hub-device-sdk-c-serializer.md) provides similar detail on hello **serializer** library.</span></span>

<span data-ttu-id="6d6f8-259">toolearn mais informações sobre desenvolver para o IoT Hub, consulte Olá [SDKs IoT do Azure][lnk-sdks].</span><span class="sxs-lookup"><span data-stu-id="6d6f8-259">toolearn more about developing for IoT Hub, see hello [Azure IoT SDKs][lnk-sdks].</span></span>

<span data-ttu-id="6d6f8-260">toofurther explorar Olá das capacidades do IoT Hub, consulte:</span><span class="sxs-lookup"><span data-stu-id="6d6f8-260">toofurther explore hello capabilities of IoT Hub, see:</span></span>

* <span data-ttu-id="6d6f8-261">[Simulando um dispositivo com o Azure IoT Edge][lnk-iotedge]</span><span class="sxs-lookup"><span data-stu-id="6d6f8-261">[Simulating a device with Azure IoT Edge][lnk-iotedge]</span></span>

[lnk-sdks]: iot-hub-devguide-sdks.md

[lnk-iotedge]: iot-hub-linux-iot-edge-simulated-device.md
