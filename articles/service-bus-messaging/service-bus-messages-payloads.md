---
title: "Mensagens, payloads e serialização Service Bus do Azure | Microsoft Docs"
description: "Descrição geral do payloads de mensagens do Service Bus"
services: service-bus-messaging
documentationcenter: 
author: clemensv
manager: timlt
editor: 
ms.service: service-bus-messaging
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/28/2017
ms.author: sethm
ms.openlocfilehash: 7c18cc4a0e6a8dbf3a47c146707666c5538ff7c3
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/11/2017
---
# <a name="messages-payloads-and-serialization"></a>Mensagens, payloads e de serialização

Microsoft Azure Service Bus processa mensagens. Mensagens de transportem um payload, bem como os metadados, o formato das propriedades de pares chave-valor, que descreve o payload e dar instruções de processamento ao Service Bus e aplicações. Ocasionalmente, esses metadados autónomo são suficiente para executar as informações que quer que o remetente para comunicar com recetores e o payload permanece em branco.

O modelo de objeto dos clientes oficiais do Service Bus para .NET e Java refletir o estrutura de mensagens do Service Bus, que é mapeado para e do Service Bus suporta os protocolos de transmissão de abstracto.
 
Uma mensagem de Service Bus é composta por uma secção de payload binário que nunca processa barramento de serviço em qualquer formulário no lado do serviço e dois conjuntos de propriedades. O *mediador propriedades* estão predefinidas pelo sistema. Estas propriedades predefinidas ou controlam a funcionalidade de nível da mensagem dentro do Mediador ou mapeiam para itens de metadados comuns e padronizado. O *as propriedades do utilizador* são uma coleção de pares chave-valor que podem ser definidos e definidas pela aplicação.
 
As propriedades de Mediador predefinidas estão listadas na seguinte tabela. Os nomes são utilizados com todos os clientes oficial APIs e também o [BrokerProperties](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Properties_) objeto JSON do mapeamento de protocolo HTTP.
 
Os nomes equivalentes utilizados ao nível do protocolo AMQP são listados entre parênteses. 

| Nome da propriedade                         | Descrição                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) (tipo de conteúdo)           | Opcionalmente, descreve o payload da mensagem, com um descritor segue o formato de RFC2045, secção 5, por exemplo `application/json`.                                                                                                                                                                                                                                                                                             |
|  [CorrelationId](/dotnet/api/microsoft.azure.servicebus.message.correlationid#Microsoft_Azure_ServiceBus_Message_CorrelationId) (id de correlação)       | Permite que uma aplicação especificar um contexto para a mensagem para fins de correlação, por exemplo ao refletir o **MessageId** de uma mensagem que está a ser respondeu a.                                                                                                                                                                                                                                                                  |
| [DeadLetterSource](/dotnet/api/microsoft.azure.servicebus.message.deadlettersource)                      | Só é definido nas mensagens que foram lettered de mensagens não e subsequentemente automaticamente reencaminhado da fila entregues a outra entidade. Indica a entidade no qual a mensagem foi lettered de mensagens não. Esta propriedade é só de leitura.                                                                                                                                                                                                                                  |
| [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount)                         | Número de entregas que foram tentados para esta mensagem. A contagem é incrementada quando expira um bloqueio da mensagem ou a mensagem é abandonada explicitamente pelo recetor. Esta propriedade é só de leitura.                                                                                                                                                                                                                                                  |
| [EnqueuedSequenceNumber](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedsequencenumber)                | Para as mensagens que tenham sido reencaminhados de automática, esta propriedade reflete o número de sequência primeiro tinha atribuído à mensagem no ponto original de submissão. Esta propriedade é só de leitura.                                                                                                                                                                                                                                                                |
| [EnqueuedTimeUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedtimeutc)                       | UTC instantânea em que a mensagem foi aceite e armazenada na entidade. Este valor pode ser utilizado como um indicador de hora da chegada autoritativos e neutro quando o recetor não quiser confiar relógio do remetente. Esta propriedade é só de leitura.                                                                                                                                                                                                   |
|  [ExpiresAtUtc](/dotnet/api/microsoft.azure.servicebus.message.expiresatutc) (hora de expiração de absoluto) | O instantânea do UTC em que a mensagem está marcada para remoção e já não está disponível para obtenção de entidade devido à expiração da. Expiração é controlada pelo **TimeToLive** propriedade e esta propriedade é calculada do EnqueuedTimeUtc + TimeToLive. Esta propriedade é só de leitura.                                                                                                                                                                           |
| [ForcePersistence](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.forcepersistence)                      | Para filas ou tópicos que tenham o [EnableExpress](/dotnet/api/microsoft.servicebus.messaging.queuedescription.enableexpress?view=azureservicebus-4.1.1#Microsoft_ServiceBus_Messaging_QueueDescription_EnableExpress) sinalizador conjunto, esta propriedade pode ser definida para indicar que a mensagem tem de ser persistente para disco antes de é confirmada. Este é o comportamento padrão para todas as entidades não rápida.                                                                                                                                                                                                         |
| [Etiqueta](/dotnet/api/microsoft.azure.servicebus.message.label) (assunto)                       | Esta propriedade permite que a aplicação indicar o objetivo da mensagem para o recetor de uma forma normalizada, semelhante a uma linha de assunto do e-mail.                                                                                                                                                                                                                                                                                  |
| [LockedUntilUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.lockeduntilutc)                        | Para as mensagens obtidas sob um bloqueio (peek bloqueio receber modo, não previamente settled) esta propriedade reflete o UTC instantânea até que é mantida a mensagem bloqueada na fila/subscrição. Quando o bloqueio expira, o [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount) é incrementado e a mensagem é novamente disponível para obtenção. Esta propriedade é só de leitura.                                                                                                                         |
| [LockToken](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.locktoken)                             | O token de bloqueio é uma referência para o bloqueio de que está a ser retido pelo mediador na *peek bloqueio* receber modo. O token pode ser utilizado para afixar o bloqueio permanentemente através de [diferimento por](message-deferral.md) API e, em que, a mensagem sem o fluxo de estado de entrega regular tomar. Esta propriedade é só de leitura.                                                                                                                                                               |
| [MessageId](/dotnet/api/microsoft.azure.servicebus.message.messageid) (id de mensagem)                | O identificador da mensagem é um valor definido pela aplicação, que identifica exclusivamente a mensagem e o payload. O identificador é uma cadeia de formato livre e pode refletir um GUID ou um identificador derivado do contexto de aplicação. Se estiver ativada, o [duplicado deteção](duplicate-detection.md) funcionalidade identifica e remove o segundo e ainda mais as submissões de mensagens em fila com o mesmo **MessageId**.                                                                |
| [PartitionKey](/dotnet/api/microsoft.azure.servicebus.message.partitionkey)                          | Para [entidades particionadas](service-bus-partitioning.md), a definição deste valor permite a atribuição mensagens relacionadas para a mesma partição interna, para que a ordem de sequência de submissão é registada corretamente. A partição é escolhida por uma função de hash através deste valor e não pode ser escolhida diretamente. Para entidades com suporte para a sessão, o **SessionId** propriedade substitui este valor.                                                                                                       |
| [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto) (responder a)                    | Este valor opcional e definidas pela aplicação é uma forma padrão para expressar um caminho de resposta para o recetor da mensagem. Quando um remetente espera uma resposta, define o valor para o caminho absoluto ou relativo do tópico que espera que a resposta sejam enviados para ou fila.                                                                                                                                           |
| [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid) (reply-para--id de grupo)  | Este valor aumenta a **ReplyTo** informações e especifica que **SessionId** deve ser definida para a resposta quando enviados para a entidade de resposta.                                                                                                                                                                                                                                                                            |
| [ScheduledEnqueueTimeUtc](/dotnet/api/microsoft.azure.servicebus.message.scheduledenqueuetimeutc)               | Mensagens de que só são disponibilizadas para obtenção após um atraso, esta propriedade define o instantânea UTC em que a mensagem será logicamente colocados em fila, sequenciado e, por conseguinte, disponibilizar para recuperação.                                                                                                                                                                                                                 |
| [SequenceNumber](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.sequencenumber)                        | O número de sequência é um número inteiro 64-bit exclusivo atribuído a uma mensagem como é aceite e armazenada pela mediador e funções como o respetivo identificador verdadeiro. Para entidades particionadas, os mais superiores 16 bits refletir o identificador de partição. Números de sequência de forma monótona aumentam e são gapless. Estes rollover para 0 quando o intervalo de 48 64 bits se esgota. Esta propriedade é só de leitura.                                                                |
| [SessionId](/dotnet/api/microsoft.azure.servicebus.message.sessionid) (id de grupo)                  | Para entidades com suporte para a sessão, este valor definido pela aplicação Especifica o pedido de afiliação de sessão da mensagem. As mensagens com o mesmo identificador de sessão estão sujeitos a bloquear resumo e ative exato por ordem de processamento e demultiplexing. Para entidades não tem conhecimento da sessão, este valor é ignorado.                                                                                                                                     |
| [Tamanho](/dotnet/api/microsoft.azure.servicebus.message.size)                                  | Reflete o tamanho da mensagem no registo de Mediador como uma contagem de bytes, armazenado como esta conta para a quota de armazenamento. Esta propriedade é só de leitura.                                                                                                                                                                                                                                                                                                       |
| [Estado](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.state)                                 | Indica o estado da mensagem no registo. Esta propriedade só é relevante durante a mensagem de navegação ("peek"), para determinar se uma mensagem é "ativo" e disponíveis para obtenção como chegar à parte superior da fila, se é deferida, ou está a aguardar para ser agendados. Esta propriedade é só de leitura.                                                                                                                                           |
| [TimeToLive](/dotnet/api/microsoft.azure.servicebus.message.timetolive)                            | Este valor é a duração relativa após o qual a mensagem expira, a partir de instantâneas a mensagem foi aceite e armazenada por Mediador, como capturada no **EnqueueTimeUtc**. O valor de assumida quando não definir explicitamente, é o **DefaultTimeToLive** para a respetiva fila ou tópico. Um nível de mensagem **TimeToLive** valor não pode ser maior do que a entidade **DefaultTimeToLive** definição e é automaticamente tendo em conta o caso. |
| [Para](/dotnet/api/microsoft.azure.servicebus.message.to) (a)                               | Esta propriedade é reservada para utilização futura em cenários de encaminhamento e atualmente ignorada pelo Mediador de si próprio. As aplicações podem utilizar este valor nos cenários de cifras de reencaminhamento automática condicionada por regra para indicar o destino pretendido lógico da mensagem.                                                                                                                                                                                   |
| [ViaPartitionKey](/dotnet/api/microsoft.azure.servicebus.message.viapartitionkey)                       | Se é enviada uma mensagem através de uma fila de transferência no âmbito de uma transação, este valor seleciona a partição de fila de transferência.                                                                                                                                                                                                                                                                                                                 |

O modelo de mensagem abstrato permite uma mensagem a ser publicado para uma fila através de HTTP, na verdade, sempre HTTPS () e pode ser obtido através de AMQP. Em ambos os casos, a mensagem procura normal no contexto do respetivo protocolo. As propriedades de mediador são convertidas conforme necessário, e as propriedades do utilizador estão mapeadas para a localização mais adequada no modelo de mensagem de protocolo correspondentes. De HTTP, as propriedades do utilizador mapeiam diretamente de e para os cabeçalhos de HTTP no AMQP efectuam o mapeamento de e para o **propriedades da aplicação** mapa.

## <a name="message-routing-and-correlation"></a>Encaminhamento de mensagens e de correlação

Um subconjunto de propriedades de Mediador descrito anteriormente, especificamente [para](/dotnet/api/microsoft.azure.servicebus.message.to), [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto), [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid), [MessageId](/dotnet/api/microsoft.azure.servicebus.message.messageid), [ CorrelationId](/dotnet/api/microsoft.azure.servicebus.message.correlationid), e [SessionId](/dotnet/api/microsoft.azure.servicebus.message.sessionid), são utilizados para ajudar a aplicações encaminhar mensagens para destinos específicos. Para ilustrar isto, considere alguns padrões:

- **Simple de pedido/resposta**: um publicador envia uma mensagem para uma fila e espera que uma resposta do consumidor de mensagens. Para receber a resposta, o publicador é proprietário de uma fila no qual espera que as respostas para ser entregue. O endereço dessa fila é expresso na mensagem de saída **ReplyTo** propriedade. Quando o consumidor responde, copia o **MessageId** da mensagem processada para o **CorrelationId** propriedade da mensagem de resposta e entrega a mensagem para o destino indicada pelo **ReplyTo** propriedade. Uma mensagem pode produzir vários respostas, consoante o contexto de aplicação.
- **Pedido/resposta multicast**: como uma variação de padrão anterior, o publicador envia a mensagem para um tópico e múltiplos subscritores passam a ser elegíveis para consumir a mensagem. Cada um dos subscritores poderá responder de forma descrita anteriormente. Este padrão é utilizado em cenários de deteção ou chamada de agregação e a respondent normalmente identifica-se com uma propriedade de utilizador ou dentro do payload. Se **ReplyTo** aponta para um tópico, o conjunto de respostas de deteção pode ser distribuída para um público-alvo.
- **Multiplexação**: esta funcionalidade de sessão permite multiplexação de fluxos de mensagens relacionadas através de uma fila única ou uma subscrição de forma a que cada sessão (ou grupo) de mensagens relacionadas, identificado por correspondente **SessionId**valores, são encaminhados para um recetor específico enquanto o recetor realiza a sessão em bloqueio. Saiba mais sobre os detalhes de sessões [aqui](message-sessions.md).
- **Multiplexed pedido/resposta**: esta funcionalidade de sessão permite multiplexadas respostas, permitindo que várias editores de partilhar uma fila de resposta. Por definição **ReplyToSessionId**, o fabricante pode instruir consumer(s) copiar esse valor para o **SessionId** propriedade da mensagem de resposta. A fila ou um tópico publicação não tenha em atenção de sessão. Como a mensagem é enviada, o fabricante pode, em seguida, especificamente aguardar que uma sessão com o fornecido **SessionId** para materializar na fila ao condicionalmente aceitar um recetor de sessão. 

Encaminhamento dentro de um espaço de nomes de barramento de serviço pode ser realizado através de encadeamento de reencaminhamento automática e regras de subscrição de tópico. Encaminhamento através de espaços de nomes pode ser realizado [utilizando o Azure LogicApps](https://azure.microsoft.com/services/logic-apps/). Conforme indicado na lista anterior, o **para** propriedade está reservada para utilização futura e, eventualmente, poderá ser interpretada pelo broker com uma funcionalidade especial ativada. As aplicações que pretendem implementar o encaminhamento devem fazer, por isso, com base nas propriedades do utilizador e não lean no **para** propriedade; no entanto, fazê-lo agora não irá causar problemas de compatibilidade.

## <a name="payload-serialization"></a>Serialização de payload

Quando em trânsito ou armazenada no interior do Service Bus, o payload é sempre um bloco opaco, binário. O [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) propriedade permite que as aplicações descrever o payload, com o formato sugerido para os valores de propriedade que está a ser uma descrição do tipo de conteúdo MIME, de acordo com IETF RFC2045; por exemplo, `application/json;charset=utf-8`.

Ao contrário das variantes Java ou padrão de .NET, o .NET Framework versão de API do Service Bus suporta a criação de **BrokeredMessage** instâncias transferindo arbitrários objetos .NET para o construtor. 

Ao utilizar o protocolo SBMP legado, esses objetos, em seguida, são serializados com o serializador binário predefinido ou com um serializador externamente fornecido. Ao utilizar o protocolo AMQP, o objeto está a ser serializado para um objeto AMQP. O recetor pode obter os objetos com o [GetBody<T>()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.getbody#Microsoft_ServiceBus_Messaging_BrokeredMessage_GetBody__1) método, fornecendo o tipo esperado; com o AMQP, os objetos são serializados para um gráfico AMQP do **ArrayList** e **IDictionary < cadeia, objecto >** objetos e pode ser descodificar por qualquer cliente AMQP. 

Enquanto este magic de serialização oculto for conveniente, aplicações devem assumir o controlo explícito de serialização do objeto e ative os gráficos de objetos em fluxos antes incluindo-os para uma mensagem e fazer inversa no lado recetor. Isto gera resultados interoperável. Deve também ser salientado que enquanto AMQP tem um modelo de codificação binário poderoso, esta é associada ao ecossistema de mensagens do AMQP e clientes HTTP irão dificuldades descodificar essas payloads. 

Em geral, recomendamos JSON e Apache Avro como formatos de payload para dados estruturados.

Os padrão de .NET e Java API variantes só aceitam matrizes de bytes, o que significa que a aplicação tem de lidar com controlo de serialização do objeto. 

## <a name="next-steps"></a>Passos seguintes

Para obter mais informações sobre mensagens do Service Bus, consulte os tópicos seguintes:

* [Noções básicas sobre o Service Bus](service-bus-fundamentals-hybrid-solutions.md)
* [Filas, tópicos e subscrições do Service Bus](service-bus-queues-topics-subscriptions.md)
* [Introdução às filas do Service Bus](service-bus-dotnet-get-started-with-queues.md)
* [Como utilizar os tópicos e as subscrições do Service Bus](service-bus-dotnet-how-to-use-topics-subscriptions.md)