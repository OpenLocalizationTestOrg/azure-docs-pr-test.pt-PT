---
title: "aaaService barramento de serviço de mensagens assíncrono | Microsoft Docs"
description: "Descrição do serviço de mensagens assíncrono do Service Bus do Azure."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: f1435549-e1f2-40cb-a280-64ea07b39fc7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/19/2017
ms.author: sethm
ms.openlocfilehash: 5ab6ddf052155a9dd975b413cfaf393119c1999d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="asynchronous-messaging-patterns-and-high-availability"></a><span data-ttu-id="97629-103">Padrões de mensagens assíncronas e elevada disponibilidade</span><span class="sxs-lookup"><span data-stu-id="97629-103">Asynchronous messaging patterns and high availability</span></span>

<span data-ttu-id="97629-104">Serviço de mensagens assíncrono pode ser implementado numa variedade de formas diferentes.</span><span class="sxs-lookup"><span data-stu-id="97629-104">Asynchronous messaging can be implemented in a variety of different ways.</span></span> <span data-ttu-id="97629-105">Com as filas, tópicos e subscrições, o Service Bus do Azure suporta asynchronism através de uma loja e o mecanismo de reencaminhar.</span><span class="sxs-lookup"><span data-stu-id="97629-105">With queues, topics, and subscriptions, Azure Service Bus supports asynchronism via a store and forward mechanism.</span></span> <span data-ttu-id="97629-106">Na operação (síncrona) normal, pode enviar mensagens tooqueues e tópicos e recebe mensagens de filas e subscrições.</span><span class="sxs-lookup"><span data-stu-id="97629-106">In normal (synchronous) operation, you send messages tooqueues and topics, and receive messages from queues and subscriptions.</span></span> <span data-ttu-id="97629-107">As aplicações que escreve dependem estas entidades sempre que está a ser disponíveis.</span><span class="sxs-lookup"><span data-stu-id="97629-107">Applications you write depend on these entities always being available.</span></span> <span data-ttu-id="97629-108">Quando muda de estado de funcionamento de entidade de Olá, devido a tooa diversas circunstâncias, precisa de uma forma tooprovide uma entidade de capacidade reduzida que pode satisfazer a maioria das necessidades.</span><span class="sxs-lookup"><span data-stu-id="97629-108">When hello entity health changes, due tooa variety of circumstances, you need a way tooprovide a reduced capability entity that can satisfy most needs.</span></span>

<span data-ttu-id="97629-109">As aplicações utilizam normalmente tooenable padrões mensagens um número de cenários de comunicação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="97629-109">Applications typically use asynchronous messaging patterns tooenable a number of communication scenarios.</span></span> <span data-ttu-id="97629-110">Pode criar aplicações no qual os clientes podem enviar mensagens tooservices, mesmo quando o serviço de Olá não está em execução.</span><span class="sxs-lookup"><span data-stu-id="97629-110">You can build applications in which clients can send messages tooservices, even when hello service is not running.</span></span> <span data-ttu-id="97629-111">Para aplicações que experiência bursts das comunicações, uma fila pode ajudar a nível Olá carregar, fornecendo uma comunicações de toobuffer local.</span><span class="sxs-lookup"><span data-stu-id="97629-111">For applications that experience bursts of communications, a queue can help level hello load by providing a place toobuffer communications.</span></span> <span data-ttu-id="97629-112">Por fim, pode obter uma carga simple, mas eficaz mensagens de toodistribute balanceador em várias máquinas.</span><span class="sxs-lookup"><span data-stu-id="97629-112">Finally, you can get a simple but effective load balancer toodistribute messages across multiple machines.</span></span>

<span data-ttu-id="97629-113">Disponibilidade de toomaintain de ordem de qualquer uma destas entidades, considere um número de diferentes formas em que estas entidades podem aparecer indisponíveis para um sistema de mensagens durável.</span><span class="sxs-lookup"><span data-stu-id="97629-113">In order toomaintain availability of any of these entities, consider a number of different ways in which these entities can appear unavailable for a durable messaging system.</span></span> <span data-ttu-id="97629-114">Um modo geral, vemos entidade Olá ficar indisponível tooapplications, que iremos escrever em Olá seguir formas diferentes:</span><span class="sxs-lookup"><span data-stu-id="97629-114">Generally speaking, we see hello entity become unavailable tooapplications we write in hello following different ways:</span></span>

* <span data-ttu-id="97629-115">Não é possível toosend mensagens.</span><span class="sxs-lookup"><span data-stu-id="97629-115">Unable toosend messages.</span></span>
* <span data-ttu-id="97629-116">Não é possível tooreceive mensagens.</span><span class="sxs-lookup"><span data-stu-id="97629-116">Unable tooreceive messages.</span></span>
* <span data-ttu-id="97629-117">Não é possível toomanage entidades (criar, obter, atualizar ou eliminar entidades).</span><span class="sxs-lookup"><span data-stu-id="97629-117">Unable toomanage entities (create, retrieve, update, or delete entities).</span></span>
* <span data-ttu-id="97629-118">Serviço de Olá toocontact não é possível.</span><span class="sxs-lookup"><span data-stu-id="97629-118">Unable toocontact hello service.</span></span>

<span data-ttu-id="97629-119">Para cada uma destas falhas, modos diferentes falha existem que permitem um trabalho de tooperform toocontinue aplicação certo nível de capacidade reduzida.</span><span class="sxs-lookup"><span data-stu-id="97629-119">For each of these failures, different failure modes exist that enable an application toocontinue tooperform work at some level of reduced capability.</span></span> <span data-ttu-id="97629-120">Por exemplo, um sistema que pode enviar mensagens, mas não recebê-las pode continuar a receber as ordens de clientes, mas não é possível processar as ordens.</span><span class="sxs-lookup"><span data-stu-id="97629-120">For example, a system that can send messages but not receive them can still receive orders from customers but cannot process those orders.</span></span> <span data-ttu-id="97629-121">Este tópico aborda problemas potenciais que podem ocorrer, e como são atenuados desses problemas.</span><span class="sxs-lookup"><span data-stu-id="97629-121">This topic discusses potential issues that can occur, and how those issues are mitigated.</span></span> <span data-ttu-id="97629-122">Barramento de serviço foi introduzido um número de atenuações que tem a participar no, e este tópico descreve também Olá regras que rege Olá utilizam essas mitigações de optar ativamente por participar no.</span><span class="sxs-lookup"><span data-stu-id="97629-122">Service Bus has introduced a number of mitigations which you must opt into, and this topic also discusses hello rules governing hello use of those opt-in mitigations.</span></span>

## <a name="reliability-in-service-bus"></a><span data-ttu-id="97629-123">Fiabilidade no Service Bus</span><span class="sxs-lookup"><span data-stu-id="97629-123">Reliability in Service Bus</span></span>
<span data-ttu-id="97629-124">Existem várias formas toohandle problemas de mensagem e a entidade e existem diretrizes que rege a utilização adequada Olá esses mitigações.</span><span class="sxs-lookup"><span data-stu-id="97629-124">There are several ways toohandle message and entity issues, and there are guidelines governing hello appropriate use of those mitigations.</span></span> <span data-ttu-id="97629-125">diretrizes de Olá toounderstand, tem de compreender primeiro o que pode efetuar no Service Bus.</span><span class="sxs-lookup"><span data-stu-id="97629-125">toounderstand hello guidelines, you must first understand what can fail in Service Bus.</span></span> <span data-ttu-id="97629-126">Devido a estrutura de toohello de sistemas do Azure, todos estes problemas tendem toobe curta duração.</span><span class="sxs-lookup"><span data-stu-id="97629-126">Due toohello design of Azure systems, all of these issues tend toobe short-lived.</span></span> <span data-ttu-id="97629-127">Um nível elevado, causas diferentes Olá indisponibilidade aparecem da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="97629-127">At a high level, hello different causes of unavailability appear as follows:</span></span>

* <span data-ttu-id="97629-128">Limitação de um sistema externo em que depende do Service Bus.</span><span class="sxs-lookup"><span data-stu-id="97629-128">Throttling from an external system on which Service Bus depends.</span></span> <span data-ttu-id="97629-129">Limitação ocorre de interações com os recursos de armazenamento e computação.</span><span class="sxs-lookup"><span data-stu-id="97629-129">Throttling occurs from interactions with storage and compute resources.</span></span>
* <span data-ttu-id="97629-130">Problema de um sistema de que depende de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="97629-130">Issue for a system on which Service Bus depends.</span></span> <span data-ttu-id="97629-131">Por exemplo, uma determinada parte de armazenamento pode encontrar problemas.</span><span class="sxs-lookup"><span data-stu-id="97629-131">For example, a given part of storage can encounter issues.</span></span>
* <span data-ttu-id="97629-132">Falha do Service Bus no subsistema único.</span><span class="sxs-lookup"><span data-stu-id="97629-132">Failure of Service Bus on single subsystem.</span></span> <span data-ttu-id="97629-133">Nesta situação, um nó de computação pode obter num estado inconsistente e tem de reiniciar o próprio, fazendo com que todas as entidades serve saldo tooload tooother nós.</span><span class="sxs-lookup"><span data-stu-id="97629-133">In this situation, a compute node can get into an inconsistent state and must restart itself, causing all entities it serves tooload balance tooother nodes.</span></span> <span data-ttu-id="97629-134">Isto por sua vez, pode causar um curto período de tempo de processamento de mensagens lenta.</span><span class="sxs-lookup"><span data-stu-id="97629-134">This in turn can cause a short period of slow message processing.</span></span>
* <span data-ttu-id="97629-135">Falha do Service Bus dentro de um datacenter do Azure.</span><span class="sxs-lookup"><span data-stu-id="97629-135">Failure of Service Bus within an Azure datacenter.</span></span> <span data-ttu-id="97629-136">Esta é uma "Falha catastrófica" durante os quais sistema Olá está inacessível para o número de minutos ou algumas horas.</span><span class="sxs-lookup"><span data-stu-id="97629-136">This is a "catastrophic failure" during which hello system is unreachable for many minutes or a few hours.</span></span>

> [!NOTE]
> <span data-ttu-id="97629-137">termo do Olá **armazenamento** pode significar Storage do Azure e SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="97629-137">hello term **storage** can mean both Azure Storage and SQL Azure.</span></span>
> 
> 

<span data-ttu-id="97629-138">Barramento de serviço contém um número de mitigações para estes problemas.</span><span class="sxs-lookup"><span data-stu-id="97629-138">Service Bus contains a number of mitigations for these issues.</span></span> <span data-ttu-id="97629-139">Olá secções a seguir aborda e os respetivas mitigações de cada problema.</span><span class="sxs-lookup"><span data-stu-id="97629-139">hello following sections discuss each issue and their respective mitigations.</span></span>

### <a name="throttling"></a><span data-ttu-id="97629-140">Limitação</span><span class="sxs-lookup"><span data-stu-id="97629-140">Throttling</span></span>
<span data-ttu-id="97629-141">Com o Service Bus, a limitação permite a gestão de taxa de mensagem cooperative.</span><span class="sxs-lookup"><span data-stu-id="97629-141">With Service Bus, throttling enables cooperative message rate management.</span></span> <span data-ttu-id="97629-142">Cada nó de barramento de serviço individual aloja várias entidades.</span><span class="sxs-lookup"><span data-stu-id="97629-142">Each individual Service Bus node houses many entities.</span></span> <span data-ttu-id="97629-143">Cada uma dessas entidades estabelece exigências no sistema de Olá em termos de CPU, memória, armazenamento e outros aspetos.</span><span class="sxs-lookup"><span data-stu-id="97629-143">Each of those entities makes demands on hello system in terms of CPU, memory, storage, and other facets.</span></span> <span data-ttu-id="97629-144">Quando qualquer uma destas facetas Deteta utilização que exceder os limiares definidos, Service Bus pode negar um pedido específico.</span><span class="sxs-lookup"><span data-stu-id="97629-144">When any of these facets detects usage that exceeds defined thresholds, Service Bus can deny a given request.</span></span> <span data-ttu-id="97629-145">autor da chamada Olá recebe um [ServerBusyException] [ ServerBusyException] e repete após 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="97629-145">hello caller receives a [ServerBusyException][ServerBusyException] and retries after 10 seconds.</span></span>

<span data-ttu-id="97629-146">Como uma mitigação código Olá tem de ler erro Olá e pare quaisquer tentativas de mensagem de saudação para, pelo menos, 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="97629-146">As a mitigation, hello code must read hello error and halt any retries of hello message for at least 10 seconds.</span></span> <span data-ttu-id="97629-147">Uma vez que o erro de Olá pode acontecer em partes da aplicação de cliente Olá, espera-se que cada peça executa independentemente a lógica de repetição de Olá.</span><span class="sxs-lookup"><span data-stu-id="97629-147">Since hello error can happen across pieces of hello customer application, it is expected that each piece independently executes hello retry logic.</span></span> <span data-ttu-id="97629-148">código de Olá pode reduzir a probabilidade de Olá de limitação, permitindo a criação de partições num fila ou tópico.</span><span class="sxs-lookup"><span data-stu-id="97629-148">hello code can reduce hello probability of being throttled by enabling partitioning on a queue or topic.</span></span>

### <a name="issue-for-an-azure-dependency"></a><span data-ttu-id="97629-149">Problema de uma dependência do Azure</span><span class="sxs-lookup"><span data-stu-id="97629-149">Issue for an Azure dependency</span></span>
<span data-ttu-id="97629-150">Outros componentes no Azure, ocasionalmente, podem ter problemas de serviço.</span><span class="sxs-lookup"><span data-stu-id="97629-150">Other components within Azure can occasionally have service issues.</span></span> <span data-ttu-id="97629-151">Por exemplo, quando está a ser atualizado um sistema que utiliza o Service Bus, esse sistema temporariamente pode experimentar capacidades reduzidas.</span><span class="sxs-lookup"><span data-stu-id="97629-151">For example, when a system that Service Bus uses is being upgraded, that system can temporarily experience reduced capabilities.</span></span> <span data-ttu-id="97629-152">toowork à volta destes tipos de problemas, o Service Bus regularmente investiga e implementa mitigações.</span><span class="sxs-lookup"><span data-stu-id="97629-152">toowork around these types of issues, Service Bus regularly investigates and implements mitigations.</span></span> <span data-ttu-id="97629-153">Só aparecem efeitos secundários destas mitigações.</span><span class="sxs-lookup"><span data-stu-id="97629-153">Side effects of these mitigations do appear.</span></span> <span data-ttu-id="97629-154">Por exemplo, toohandle transitório problemas com o armazenamento, o Service Bus implementa um sistema que permite toowork de operações de envio de mensagem de forma consistente.</span><span class="sxs-lookup"><span data-stu-id="97629-154">For example, toohandle transient issues with storage, Service Bus implements a system that allows message send operations toowork consistently.</span></span> <span data-ttu-id="97629-155">Devido a natureza toohello mitigação de Olá, uma mensagem enviada pode demorar até too15 minutos tooappear na fila de Olá afetado ou na subscrição e estar pronto para uma operação de receção.</span><span class="sxs-lookup"><span data-stu-id="97629-155">Due toohello nature of hello mitigation, a sent message can take up too15 minutes tooappear in hello affected queue or subscription and be ready for a receive operation.</span></span> <span data-ttu-id="97629-156">Um modo geral, a maior parte das entidades não irá ocorrer este problema.</span><span class="sxs-lookup"><span data-stu-id="97629-156">Generally speaking, most entities will not experience this issue.</span></span> <span data-ttu-id="97629-157">No entanto, tendo em conta o número de Olá de entidades no Service Bus no Azure, este mitigação, por vezes, é necessário para um pequeno subconjunto de clientes do Service Bus.</span><span class="sxs-lookup"><span data-stu-id="97629-157">However, given hello number of entities in Service Bus within Azure, this mitigation is sometimes needed for a small subset of Service Bus customers.</span></span>

### <a name="service-bus-failure-on-a-single-subsystem"></a><span data-ttu-id="97629-158">Falha de barramento de serviço de subsistema de um único</span><span class="sxs-lookup"><span data-stu-id="97629-158">Service Bus failure on a single subsystem</span></span>
<span data-ttu-id="97629-159">Com qualquer aplicação, circunstâncias podem fazer com que um componente interno do Service Bus toobecome inconsistente.</span><span class="sxs-lookup"><span data-stu-id="97629-159">With any application, circumstances can cause an internal component of Service Bus toobecome inconsistent.</span></span> <span data-ttu-id="97629-160">Quando o Service Bus Deteta isto, recolhe dados de aplicação de Olá tooaid diagnosticar o que aconteceu.</span><span class="sxs-lookup"><span data-stu-id="97629-160">When Service Bus detects this, it collects data from hello application tooaid in diagnosing what happened.</span></span> <span data-ttu-id="97629-161">Depois de Olá os dados são recolhidos, a aplicação Olá é reiniciado no tooreturn tentativa-tooa consistente.</span><span class="sxs-lookup"><span data-stu-id="97629-161">Once hello data is collected, hello application is restarted in an attempt tooreturn it tooa consistent state.</span></span> <span data-ttu-id="97629-162">Este processo ocorre razoavelmente depressa e resultados numa entidade apresentação toobe disponível para a cópia de segurança tooa alguns minutos, embora típico para baixo vezes são muito mais curtos.</span><span class="sxs-lookup"><span data-stu-id="97629-162">This process happens fairly quickly, and results in an entity appearing toobe unavailable for up tooa few minutes, though typical down times are much shorter.</span></span>

<span data-ttu-id="97629-163">Nestes casos, aplicações de cliente Olá gera um [System.TimeoutException] [ System.TimeoutException] ou [MessagingException] [ MessagingException] exceção.</span><span class="sxs-lookup"><span data-stu-id="97629-163">In these cases, hello client application generates a [System.TimeoutException][System.TimeoutException] or [MessagingException][MessagingException] exception.</span></span> <span data-ttu-id="97629-164">Barramento de serviço contém uma mitigação para este problema no formulário de Olá de lógica de repetição de clientes automatizada.</span><span class="sxs-lookup"><span data-stu-id="97629-164">Service Bus contains a mitigation for this issue in hello form of automated client retry logic.</span></span> <span data-ttu-id="97629-165">Depois de se esgota período Olá e não for entregue a mensagem de saudação, pode explorar utilizar outras funcionalidades, tais como [emparelhado espaços de nomes][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="97629-165">Once hello retry period is exhausted and hello message is not delivered, you can explore using other features such as [paired namespaces][paired namespaces].</span></span> <span data-ttu-id="97629-166">Espaços de nomes emparelhados têm outras limitações que são debatidas esse artigo.</span><span class="sxs-lookup"><span data-stu-id="97629-166">Paired namespaces have other caveats that are discussed in that article.</span></span>

### <a name="failure-of-service-bus-within-an-azure-datacenter"></a><span data-ttu-id="97629-167">Falha do Service Bus dentro de um datacenter do Azure</span><span class="sxs-lookup"><span data-stu-id="97629-167">Failure of Service Bus within an Azure datacenter</span></span>
<span data-ttu-id="97629-168">Olá motivo mais provável uma falha num datacenter do Azure é uma implementação de atualização falhada do Service Bus ou um sistema dependente.</span><span class="sxs-lookup"><span data-stu-id="97629-168">hello most probable reason for a failure in an Azure datacenter is a failed upgrade deployment of Service Bus or a dependent system.</span></span> <span data-ttu-id="97629-169">Dado que a plataforma de Olá amadureceu, tem o seu probabilidade Olá deste tipo de falha.</span><span class="sxs-lookup"><span data-stu-id="97629-169">As hello platform has matured, hello likelihood of this type of failure has diminished.</span></span> <span data-ttu-id="97629-170">Também pode ocorrer uma falha de centro de dados por motivos que incluem Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="97629-170">A datacenter failure can also happen for reasons that include hello following:</span></span>

* <span data-ttu-id="97629-171">Falha de elétrica (fonte de alimentação e energia gerar desaparecer).</span><span class="sxs-lookup"><span data-stu-id="97629-171">Electrical outage (power supply and generating power disappear).</span></span>
* <span data-ttu-id="97629-172">Conectividade (quebra de internet entre os clientes e o Azure).</span><span class="sxs-lookup"><span data-stu-id="97629-172">Connectivity (internet break between your clients and Azure).</span></span>

<span data-ttu-id="97629-173">Em ambos os casos, um desastre natural ou man-made causou o problema de Olá.</span><span class="sxs-lookup"><span data-stu-id="97629-173">In both cases, a natural or man-made disaster caused hello issue.</span></span> <span data-ttu-id="97629-174">toowork contornar esta situação e certifique-se de que podem ainda enviar mensagens, pode utilizar [emparelhado espaços de nomes] [ paired namespaces] tooenable mensagens toobe enviado tooa segunda localização enquanto localização primária Olá é efetuada em bom estado novamente.</span><span class="sxs-lookup"><span data-stu-id="97629-174">toowork around this and make sure that you can still send messages, you can use [paired namespaces][paired namespaces] tooenable messages toobe sent tooa second location while hello primary location is made healthy again.</span></span> <span data-ttu-id="97629-175">Para obter mais informações, consulte [melhores práticas para insulating aplicações contra falhas de Service Bus e perante desastres][Best practices for insulating applications against Service Bus outages and disasters].</span><span class="sxs-lookup"><span data-stu-id="97629-175">For more information, see [Best practices for insulating applications against Service Bus outages and disasters][Best practices for insulating applications against Service Bus outages and disasters].</span></span>

## <a name="paired-namespaces"></a><span data-ttu-id="97629-176">Espaços de nomes emparelhados</span><span class="sxs-lookup"><span data-stu-id="97629-176">Paired namespaces</span></span>
<span data-ttu-id="97629-177">Olá [emparelhado espaços de nomes] [ paired namespaces] funcionalidade suporta cenários em que uma entidade de barramento de serviço ou a implementação no Centro de dados fica indisponível.</span><span class="sxs-lookup"><span data-stu-id="97629-177">hello [paired namespaces][paired namespaces] feature supports scenarios in which a Service Bus entity or deployment within a data center becomes unavailable.</span></span> <span data-ttu-id="97629-178">Enquanto este evento ocorre com pouca frequência, sistemas distribuídos ainda devem estar preparados toohandle pior cenários de caso.</span><span class="sxs-lookup"><span data-stu-id="97629-178">While this event occurs infrequently, distributed systems still must be prepared toohandle worst case scenarios.</span></span> <span data-ttu-id="97629-179">Normalmente, este evento ocorre porque algumas elemento de que depende de barramento de serviço estão a ocorrer um problema de curta duração.</span><span class="sxs-lookup"><span data-stu-id="97629-179">Typically, this event happens because some element on which Service Bus depends is experiencing a short-term issue.</span></span> <span data-ttu-id="97629-180">disponibilidade da aplicação toomaintain durante uma falha, os utilizadores do Service Bus podem utilizar o dois separados espaços de nomes, de preferência nos centros de dados separada, toohost as entidades de mensagens.</span><span class="sxs-lookup"><span data-stu-id="97629-180">toomaintain application availability during an outage, Service Bus users can use two separate namespaces, preferably in separate data centers, toohost their messaging entities.</span></span> <span data-ttu-id="97629-181">resto Olá esta secção utiliza Olá seguinte terminologia:</span><span class="sxs-lookup"><span data-stu-id="97629-181">hello remainder of this section uses hello following terminology:</span></span>

* <span data-ttu-id="97629-182">Espaço de nomes primário: Olá espaço de nomes com o qual a aplicação interage, para enviar e receber operações.</span><span class="sxs-lookup"><span data-stu-id="97629-182">Primary namespace: hello namespace with which your application interacts, for send and receive operations.</span></span>
* <span data-ttu-id="97629-183">Espaço de nomes secundário: Olá espaço de nomes que age como um espaço de nomes de principal de toohello cópia de segurança.</span><span class="sxs-lookup"><span data-stu-id="97629-183">Secondary namespace: hello namespace that acts as a backup toohello primary namespace.</span></span> <span data-ttu-id="97629-184">Lógica da aplicação não interage com este espaço de nomes.</span><span class="sxs-lookup"><span data-stu-id="97629-184">Application logic does not interact with this namespace.</span></span>
* <span data-ttu-id="97629-185">Intervalo de ativação pós-falha: quantidade de Olá de falhas normais de tooaccept tempo antes de aplicação Olá muda de Olá espaço de nomes primário toohello secundário espaço de nomes.</span><span class="sxs-lookup"><span data-stu-id="97629-185">Failover interval: hello amount of time tooaccept normal failures before hello application switches from hello primary namespace toohello secondary namespace.</span></span>

<span data-ttu-id="97629-186">Suporte de espaços de nomes de emparelhar *enviar disponibilidade*.</span><span class="sxs-lookup"><span data-stu-id="97629-186">Paired namespaces support *send availability*.</span></span> <span data-ttu-id="97629-187">Envie mensagens hello do toosend capacidade de preserva de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="97629-187">Send availability preserves hello ability toosend messages.</span></span> <span data-ttu-id="97629-188">disponibilidade de envio de toouse, a aplicação tem de cumprir Olá os requisitos:</span><span class="sxs-lookup"><span data-stu-id="97629-188">toouse send availability, your application must meet hello following requirements:</span></span>

1. <span data-ttu-id="97629-189">Apenas são recebidas mensagens do espaço de nomes de principal Olá.</span><span class="sxs-lookup"><span data-stu-id="97629-189">Messages are only received from hello primary namespace.</span></span>
2. <span data-ttu-id="97629-190">Tooa de mensagens enviadas fornecido a fila ou um tópico pode chegarem fora de ordem.</span><span class="sxs-lookup"><span data-stu-id="97629-190">Messages sent tooa given queue or topic might arrive out of order.</span></span>
3. <span data-ttu-id="97629-191">Poderão chegam fora de ordem mensagens dentro de uma sessão.</span><span class="sxs-lookup"><span data-stu-id="97629-191">Messages within a session might arrive out of order.</span></span> <span data-ttu-id="97629-192">Esta é uma quebra da funcionalidade normal das sessões.</span><span class="sxs-lookup"><span data-stu-id="97629-192">This is a break from normal functionality of sessions.</span></span> <span data-ttu-id="97629-193">Isto significa que a aplicação utiliza mensagens de grupo de toologically sessões.</span><span class="sxs-lookup"><span data-stu-id="97629-193">This means that your application uses sessions toologically group messages.</span></span>
4. <span data-ttu-id="97629-194">Estado da sessão só é mantido no espaço de nomes de principal Olá.</span><span class="sxs-lookup"><span data-stu-id="97629-194">Session state is only maintained on hello primary namespace.</span></span>
5. <span data-ttu-id="97629-195">fila primário Olá pode ficar online e iniciar a aceitação das mensagens antes de fila secundária Olá fornece todas as mensagens na fila primário Olá.</span><span class="sxs-lookup"><span data-stu-id="97629-195">hello primary queue can come online and start accepting messages before hello secondary queue delivers all messages into hello primary queue.</span></span>

<span data-ttu-id="97629-196">Olá secções a seguir aborda Olá APIs, como são implementadas Olá APIs e código de exemplo mostra que utiliza a funcionalidade de Olá.</span><span class="sxs-lookup"><span data-stu-id="97629-196">hello following sections discuss hello APIs, how hello APIs are implemented, and shows sample code that uses hello feature.</span></span> <span data-ttu-id="97629-197">Tenha em atenção que existem implicações de faturação associadas a esta funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="97629-197">Note that there are billing implications associated with this feature.</span></span>

### <a name="hello-messagingfactorypairnamespaceasync-api"></a><span data-ttu-id="97629-198">Olá MessagingFactory.PairNamespaceAsync API</span><span class="sxs-lookup"><span data-stu-id="97629-198">hello MessagingFactory.PairNamespaceAsync API</span></span>
<span data-ttu-id="97629-199">funcionalidade de espaços de nomes emparelhado Olá inclui Olá [PairNamespaceAsync] [ PairNamespaceAsync] método no Olá [Microsoft.ServiceBus.Messaging.MessagingFactory] [ Microsoft.ServiceBus.Messaging.MessagingFactory] classe:</span><span class="sxs-lookup"><span data-stu-id="97629-199">hello paired namespaces feature includes hello [PairNamespaceAsync][PairNamespaceAsync] method on hello [Microsoft.ServiceBus.Messaging.MessagingFactory][Microsoft.ServiceBus.Messaging.MessagingFactory] class:</span></span>

```csharp
public Task PairNamespaceAsync(PairedNamespaceOptions options);
```

<span data-ttu-id="97629-200">Quando Olá tarefa estiver concluída, o emparelhamento do espaço de nomes Olá, também é completa e pronto tooact após para qualquer [MessageReceiver][MessageReceiver], [QueueClient] [ QueueClient], ou [TopicClient] [ TopicClient] criados com Olá [MessagingFactory] [ MessagingFactory] instância.</span><span class="sxs-lookup"><span data-stu-id="97629-200">When hello task completes, hello namespace pairing is also complete and ready tooact upon for any [MessageReceiver][MessageReceiver], [QueueClient][QueueClient], or [TopicClient][TopicClient] created with hello [MessagingFactory][MessagingFactory] instance.</span></span> <span data-ttu-id="97629-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] [ Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] é classe base do Olá para Olá diferentes tipos de emparelhamento que estão disponíveis com um [MessagingFactory] [ MessagingFactory] objeto.</span><span class="sxs-lookup"><span data-stu-id="97629-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions][Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] is hello base class for hello different types of pairing that are available with a [MessagingFactory][MessagingFactory] object.</span></span> <span data-ttu-id="97629-202">Atualmente, Olá só classe derivada é um nome [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], que implementa os requisitos de disponibilidade de envio de Olá.</span><span class="sxs-lookup"><span data-stu-id="97629-202">Currently, hello only derived class is one named [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], which implements hello send availability requirements.</span></span> <span data-ttu-id="97629-203">[SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] tem um conjunto de construtores que criar entre si.</span><span class="sxs-lookup"><span data-stu-id="97629-203">[SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] has a set of constructors that build on each other.</span></span> <span data-ttu-id="97629-204">Consultar o construtor de Olá com Olá maioria dos parâmetros, pode compreender Olá comportamento dos Olá outros construtores.</span><span class="sxs-lookup"><span data-stu-id="97629-204">Looking at hello constructor with hello most parameters, you can understand hello behavior of hello other constructors.</span></span>

```csharp
public SendAvailabilityPairedNamespaceOptions(
    NamespaceManager secondaryNamespaceManager,
    MessagingFactory messagingFactory,
    int backlogQueueCount,
    TimeSpan failoverInterval,
    bool enableSyphon)
```

<span data-ttu-id="97629-205">Estes parâmetros tem Olá significados os seguintes:</span><span class="sxs-lookup"><span data-stu-id="97629-205">These parameters have hello following meanings:</span></span>

* <span data-ttu-id="97629-206">*secondaryNamespaceManager*: um inicializado [NamespaceManager] [ NamespaceManager] instância para o espaço de nomes secundário Olá esse Olá [PairNamespaceAsync] [ PairNamespaceAsync] método pode utilizar tooset segurança secundário Olá de espaço de nomes.</span><span class="sxs-lookup"><span data-stu-id="97629-206">*secondaryNamespaceManager*: An initialized [NamespaceManager][NamespaceManager] instance for hello secondary namespace that hello [PairNamespaceAsync][PairNamespaceAsync] method can use tooset up hello secondary namespace.</span></span> <span data-ttu-id="97629-207">Gestor de espaço de nomes de Olá-se tooobtain utilizados Olá lista de filas no espaço de nomes de Olá e toomake se de que as filas de registo de segurança de Olá necessário existem.</span><span class="sxs-lookup"><span data-stu-id="97629-207">hello namespace manager is used tooobtain hello list of queues in hello namespace and toomake sure that hello required backlog queues exist.</span></span> <span data-ttu-id="97629-208">Se não existirem as filas, são criados.</span><span class="sxs-lookup"><span data-stu-id="97629-208">If those queues do not exist, they are created.</span></span> <span data-ttu-id="97629-209">[NamespaceManager] [ NamespaceManager] requer Olá capacidade toocreate um token com Olá **gerir** de afirmação.</span><span class="sxs-lookup"><span data-stu-id="97629-209">[NamespaceManager][NamespaceManager] requires hello ability toocreate a token with hello **Manage** claim.</span></span>
* <span data-ttu-id="97629-210">*messagingFactory*: Olá [MessagingFactory] [ MessagingFactory] instância para secundário Olá de espaço de nomes.</span><span class="sxs-lookup"><span data-stu-id="97629-210">*messagingFactory*: hello [MessagingFactory][MessagingFactory] instance for hello secondary namespace.</span></span> <span data-ttu-id="97629-211">Olá [MessagingFactory] [ MessagingFactory] objeto é utilizado toosend e, se hello [EnableSyphon] [ EnableSyphon] for definida demasiado**verdadeiro** , receber mensagens de filas de registo de segurança de Olá.</span><span class="sxs-lookup"><span data-stu-id="97629-211">hello [MessagingFactory][MessagingFactory] object is used toosend and, if hello [EnableSyphon][EnableSyphon] property is set too**true**, receive messages from hello backlog queues.</span></span>
* <span data-ttu-id="97629-212">*backlogQueueCount*: número de Olá de registo de segurança de filas toocreate.</span><span class="sxs-lookup"><span data-stu-id="97629-212">*backlogQueueCount*: hello number of backlog queues toocreate.</span></span> <span data-ttu-id="97629-213">Este valor tem de ser no mínimo 1.</span><span class="sxs-lookup"><span data-stu-id="97629-213">This value must be at least 1.</span></span> <span data-ttu-id="97629-214">Ao enviar o registo de segurança de mensagens toohello, uma destas filas é escolhida aleatoriamente.</span><span class="sxs-lookup"><span data-stu-id="97629-214">When sending messages toohello backlog, one of these queues is randomly chosen.</span></span> <span data-ttu-id="97629-215">Se definir Olá valor too1, em seguida, apenas uma fila pode alguma vez ser utilizada.</span><span class="sxs-lookup"><span data-stu-id="97629-215">If you set hello value too1, then only one queue can ever be used.</span></span> <span data-ttu-id="97629-216">Quando isto acontece e fila de um registo de segurança de Olá gera erros, o cliente Olá não é possível tootry uma fila de registo de segurança diferentes e pode falhar toosend da mensagem.</span><span class="sxs-lookup"><span data-stu-id="97629-216">When this happens and hello one backlog queue generates errors, hello client is not able tootry a different backlog queue and may fail toosend your message.</span></span> <span data-ttu-id="97629-217">Recomendamos que a definição deste valor toosome maior valor e predefinido Olá valor too10.</span><span class="sxs-lookup"><span data-stu-id="97629-217">We recommend setting this value toosome larger value and default hello value too10.</span></span> <span data-ttu-id="97629-218">Pode alterar este tooa superior ou um valor inferior, dependendo da quantidade de dados que a aplicação envia por dia.</span><span class="sxs-lookup"><span data-stu-id="97629-218">You can change this tooa higher or lower value depending on how much data your application sends per day.</span></span> <span data-ttu-id="97629-219">Cada fila de registo de segurança pode manter cópias de segurança too5 GB de mensagens em fila.</span><span class="sxs-lookup"><span data-stu-id="97629-219">Each backlog queue can hold up too5 GB of messages.</span></span>
* <span data-ttu-id="97629-220">*failoverInterval*: Olá período de tempo durante os quais irá aceitar falhas no espaço de nomes de principal Olá antes de mudar qualquer entidade única através de espaço de nomes secundário toohello.</span><span class="sxs-lookup"><span data-stu-id="97629-220">*failoverInterval*: hello amount of time during which you will accept failures on hello primary namespace before switching any single entity over toohello secondary namespace.</span></span> <span data-ttu-id="97629-221">As ativações pós-falha ocorrerem numa entidade pela entidade base.</span><span class="sxs-lookup"><span data-stu-id="97629-221">Failovers occur on an entity-by-entity basis.</span></span> <span data-ttu-id="97629-222">As entidades de um único espaço de nomes com frequência em direto em nós diferentes no Service Bus.</span><span class="sxs-lookup"><span data-stu-id="97629-222">Entities in a single namespace frequently live in different nodes within Service Bus.</span></span> <span data-ttu-id="97629-223">Uma falha de uma entidade não implica uma falha no outro.</span><span class="sxs-lookup"><span data-stu-id="97629-223">A failure in one entity does not imply a failure in another.</span></span> <span data-ttu-id="97629-224">Pode definir este valor demasiado[System.TimeSpan.Zero] [ System.TimeSpan.Zero] toofailover toohello secundário imediatamente após a falha da primeira, não transitório.</span><span class="sxs-lookup"><span data-stu-id="97629-224">You can set this value too[System.TimeSpan.Zero][System.TimeSpan.Zero] toofailover toohello secondary immediately after your first, non-transient failure.</span></span> <span data-ttu-id="97629-225">Falhas de acionam de temporizador de ativação pós-falha de Olá são qualquer [MessagingException] [ MessagingException] no qual Olá [IsTransient] [ IsTransient] propriedade é false, ou um [System.TimeoutException][System.TimeoutException].</span><span class="sxs-lookup"><span data-stu-id="97629-225">Failures that trigger hello failover timer are any [MessagingException][MessagingException] in which hello [IsTransient][IsTransient] property is false, or a [System.TimeoutException][System.TimeoutException].</span></span> <span data-ttu-id="97629-226">Outras exceções, tal como [UnauthorizedAccessException] [ UnauthorizedAccessException] não fazer com que a ativação pós-falha, porque indicam que o cliente Olá está configurado incorretamente.</span><span class="sxs-lookup"><span data-stu-id="97629-226">Other exceptions, such as [UnauthorizedAccessException][UnauthorizedAccessException] do not cause failover, because they indicate that hello client is configured incorrectly.</span></span> <span data-ttu-id="97629-227">A [ServerBusyException] [ ServerBusyException] não causa ativação pós-falha porque padrão correto Olá toowait 10 segundos, em seguida, enviar mensagem de saudação novamente.</span><span class="sxs-lookup"><span data-stu-id="97629-227">A [ServerBusyException][ServerBusyException] does not cause failover because hello correct pattern is toowait 10 seconds, then send hello message again.</span></span>
* <span data-ttu-id="97629-228">*enableSyphon*: indica que este emparelhamento específica deve também syphon mensagens do Olá espaço de nomes secundário back toohello primário espaço de nomes.</span><span class="sxs-lookup"><span data-stu-id="97629-228">*enableSyphon*: Indicates that this particular pairing should also syphon messages from hello secondary namespace back toohello primary namespace.</span></span> <span data-ttu-id="97629-229">Em geral, as aplicações que enviam mensagens devem definir este valor demasiado**falso**; as aplicações que receber mensagens devem definir este valor demasiado**verdadeiro**.</span><span class="sxs-lookup"><span data-stu-id="97629-229">In general, applications that send messages should set this value too**false**; applications that receive messages should set this value too**true**.</span></span> <span data-ttu-id="97629-230">motivo Olá para isto é que frequentemente, existem menos recetores de mensagem que os remetentes de mensagens.</span><span class="sxs-lookup"><span data-stu-id="97629-230">hello reason for this is that frequently, there are fewer message receivers than message senders.</span></span> <span data-ttu-id="97629-231">Dependendo do número de Olá de recetores, pode escolher toohave uma única aplicação instância identificador Olá syphon deveres relativos.</span><span class="sxs-lookup"><span data-stu-id="97629-231">Depending on hello number of receivers, you can choose toohave a single application instance handle hello syphon duties.</span></span> <span data-ttu-id="97629-232">Utilizar vários recetores tem implicações de faturação para cada fila de registo de segurança.</span><span class="sxs-lookup"><span data-stu-id="97629-232">Using many receivers has billing implications for each backlog queue.</span></span>

<span data-ttu-id="97629-233">toouse Olá código, crie um site primário [MessagingFactory] [ MessagingFactory] instância de uma secundária [MessagingFactory] [ MessagingFactory] instância de uma secundária [NamespaceManager] [ NamespaceManager] instância e um [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instância.</span><span class="sxs-lookup"><span data-stu-id="97629-233">toouse hello code, create a primary [MessagingFactory][MessagingFactory] instance, a secondary [MessagingFactory][MessagingFactory] instance, a secondary [NamespaceManager][NamespaceManager] instance, and a [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="97629-234">chamada de Olá pode ser tão simple como seguinte Olá:</span><span class="sxs-lookup"><span data-stu-id="97629-234">hello call can be as simple as hello following:</span></span>

```csharp
SendAvailabilityPairedNamespaceOptions sendAvailabilityOptions = new SendAvailabilityPairedNamespaceOptions(secondaryNamespaceManager, secondary);
primary.PairNamespaceAsync(sendAvailabilityOptions).Wait();
```

<span data-ttu-id="97629-235">Olá quando a tarefa devolvida pelo Olá [PairNamespaceAsync] [ PairNamespaceAsync] método estiver concluída, tudo está configurado e pronto toouse.</span><span class="sxs-lookup"><span data-stu-id="97629-235">When hello task returned by hello [PairNamespaceAsync][PairNamespaceAsync] method completes, everything is set up and ready toouse.</span></span> <span data-ttu-id="97629-236">Antes da devolução da tarefa de Olá, poderá não concluiu todos os Olá em segundo plano trabalho necessário para Olá emparelhamento toowork direito.</span><span class="sxs-lookup"><span data-stu-id="97629-236">Before hello task is returned, you may not have completed all of hello background work necessary for hello pairing toowork right.</span></span> <span data-ttu-id="97629-237">Como resultado, não deve começar a enviar mensagens, até que a tarefa de Olá devolve.</span><span class="sxs-lookup"><span data-stu-id="97629-237">As a result, you should not start sending messages until hello task returns.</span></span> <span data-ttu-id="97629-238">Se tiver ocorreram quaisquer falhas, tais como credenciais incorretas, ou em filas de registo de segurança do falha toocreate Olá, essas exceções serão emitidas uma vez concluída a tarefa de Olá.</span><span class="sxs-lookup"><span data-stu-id="97629-238">If any failures occurred, such as bad credentials, or failure toocreate hello backlog queues, those exceptions will be thrown once hello task completes.</span></span> <span data-ttu-id="97629-239">Depois de o devolve a tarefa de Olá, certifique-se de que filas Olá foram localizadas ou criadas, examinando Olá [BacklogQueueCount] [ BacklogQueueCount] propriedade no seu [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instância.</span><span class="sxs-lookup"><span data-stu-id="97629-239">Once hello task returns, verify that hello queues were found or created by examining hello [BacklogQueueCount][BacklogQueueCount] property on your [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="97629-240">Para Olá precedente código, essa operação aparece da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="97629-240">For hello preceding code, that operation appears as follows:</span></span>

```csharp
if (sendAvailabilityOptions.BacklogQueueCount < 1)
{
    // Handle case where no queues were created.
}
```

## <a name="next-steps"></a><span data-ttu-id="97629-241">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="97629-241">Next steps</span></span>
<span data-ttu-id="97629-242">Agora que aprendeu as noções básicas de Olá de mensagens assíncronas no Service Bus, leia mais detalhes sobre [emparelhado espaços de nomes][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="97629-242">Now that you've learned hello basics of asynchronous messaging in Service Bus, read more details about [paired namespaces][paired namespaces].</span></span>

[ServerBusyException]: /dotnet/api/microsoft.servicebus.messaging.serverbusyexception
[System.TimeoutException]: https://msdn.microsoft.com/library/system.timeoutexception.aspx
[MessagingException]: /dotnet/api/microsoft.servicebus.messaging.messagingexception
[Best practices for insulating applications against Service Bus outages and disasters]: service-bus-outages-disasters.md
[Microsoft.ServiceBus.Messaging.MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[MessageReceiver]: /dotnet/api/microsoft.servicebus.messaging.messagereceiver
[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[TopicClient]: /dotnet/api/microsoft.servicebus.messaging.topicclient
[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.pairednamespaceoptions
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[SendAvailabilityPairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions
[NamespaceManager]: /dotnet/api/microsoft.servicebus.namespacemanager
[PairNamespaceAsync]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_PairNamespaceAsync_Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_
[EnableSyphon]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_EnableSyphon
[System.TimeSpan.Zero]: https://msdn.microsoft.com/library/system.timespan.zero.aspx
[IsTransient]: /dotnet/api/microsoft.servicebus.messaging.messagingexception#Microsoft_ServiceBus_Messaging_MessagingException_IsTransient
[UnauthorizedAccessException]: https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx
[BacklogQueueCount]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_BacklogQueueCount
[paired namespaces]: service-bus-paired-namespaces.md
