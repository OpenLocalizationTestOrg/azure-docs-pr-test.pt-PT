---
title: "aaaOverview de mensagens de filas, tópicos e subscrições do Azure Service Bus | Microsoft Docs"
description: "Descrição geral de entidades de mensagens do Service Bus."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a306ced4-74e9-47c6-990a-d9c47efa31d5
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 06/28/2017
ms.author: sethm
ms.openlocfilehash: 73135d2658e341c14dbb114ab938faed91578ff1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="service-bus-queues-topics-and-subscriptions"></a><span data-ttu-id="1d150-103">Filas, tópicos e subscrições do Service Bus</span><span class="sxs-lookup"><span data-stu-id="1d150-103">Service Bus queues, topics, and subscriptions</span></span>

<span data-ttu-id="1d150-104">Microsoft Azure Service Bus suporta um conjunto de tecnologias de middleware baseado na nuvem, orientado para a mensagem, incluindo a colocação de mensagens fiável e durável publicação de mensagens.</span><span class="sxs-lookup"><span data-stu-id="1d150-104">Microsoft Azure Service Bus supports a set of cloud-based, message-oriented middleware technologies including reliable message queuing and durable publish/subscribe messaging.</span></span> <span data-ttu-id="1d150-105">Estas capacidades de mensagens "mediadas" podem considerar como desassociados mensagens funcionalidades que o suporte de publicação-subscrição, temporal desacoplamento e cenários de utilização de recursos de infraestrutura mensagens do Service Bus Olá de balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="1d150-105">These "brokered" messaging capabilities can be thought of as decoupled messaging features that support publish-subscribe, temporal decoupling, and load balancing scenarios using hello Service Bus messaging fabric.</span></span> <span data-ttu-id="1d150-106">A comunicação desacoplada tem muitas vantagens; por exemplo, os clientes e os servidores podem ligar-se conforme necessário e efetuar as operações de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="1d150-106">Decoupled communication has many advantages; for example, clients and servers can connect as needed and perform their operations in an asynchronous fashion.</span></span>

<span data-ttu-id="1d150-107">entidades de mensagens Hello que formam core Olá de Olá mensagens capacidades no Service Bus são filas, tópicos e subscrições e regras/ações.</span><span class="sxs-lookup"><span data-stu-id="1d150-107">hello messaging entities that form hello core of hello messaging capabilities in Service Bus are queues, topics and subscriptions, and rules/actions.</span></span>

## <a name="queues"></a><span data-ttu-id="1d150-108">Filas</span><span class="sxs-lookup"><span data-stu-id="1d150-108">Queues</span></span>

<span data-ttu-id="1d150-109">As filas oferecem *First In, Out primeiro* tooone de entrega de mensagem (FIFO) ou mais consumidores concorrentes.</span><span class="sxs-lookup"><span data-stu-id="1d150-109">Queues offer *First In, First Out* (FIFO) message delivery tooone or more competing consumers.</span></span> <span data-ttu-id="1d150-110">Ou seja, as mensagens são normalmente esperado toobe recebidas e processadas pelos recetores segundo Olá Olá ordem pela qual foram adicionadas toohello fila, e cada mensagem é recebida e processada por apenas um consumidor de mensagens.</span><span class="sxs-lookup"><span data-stu-id="1d150-110">That is, messages are typically expected toobe received and processed by hello receivers in hello order in which they were added toohello queue, and each message is received and processed by only one message consumer.</span></span> <span data-ttu-id="1d150-111">Uma vantagem de utilizar as filas é tooachieve "desacoplamento temporal" dos componentes da aplicação.</span><span class="sxs-lookup"><span data-stu-id="1d150-111">A key benefit of using queues is tooachieve "temporal decoupling" of application components.</span></span> <span data-ttu-id="1d150-112">Olá por outras palavras, os produtores (remetentes) e os consumidores (recetores) não têm toobe envio e receção de mensagens em Olá mesmo tempo, porque as mensagens são armazenadas de maneira duradoura na fila de Olá.</span><span class="sxs-lookup"><span data-stu-id="1d150-112">In other words, hello producers (senders) and consumers (receivers) do not have toobe sending and receiving messages at hello same time, because messages are stored durably in hello queue.</span></span> <span data-ttu-id="1d150-113">Além disso, o produtor de Olá não possui toowait para uma resposta do consumidor Olá na ordem toocontinue tooprocess e enviar mensagens.</span><span class="sxs-lookup"><span data-stu-id="1d150-113">Furthermore, hello producer does not have toowait for a reply from hello consumer in order toocontinue tooprocess and send messages.</span></span>

<span data-ttu-id="1d150-114">Uma vantagem relacionada é "carga nivelamento," que permite toosend produtores e consumidores e recebe mensagens a taxas diferentes.</span><span class="sxs-lookup"><span data-stu-id="1d150-114">A related benefit is "load leveling," which enables producers and consumers toosend and receive messages at different rates.</span></span> <span data-ttu-id="1d150-115">Em muitas aplicações, a carga de sistema Olá varia ao longo do tempo; No entanto, o tempo de processamento de Olá necessário para cada unidade de trabalho é geralmente constante.</span><span class="sxs-lookup"><span data-stu-id="1d150-115">In many applications, hello system load varies over time; however, hello processing time required for each unit of work is typically constant.</span></span> <span data-ttu-id="1d150-116">A intermediação de mensagem de produtores e consumidores através de uma fila significa que Olá consumir aplicação só tem toobe toobe aprovisionado toohandle capaz de carga média em vez de pico de carga.</span><span class="sxs-lookup"><span data-stu-id="1d150-116">Intermediating message producers and consumers with a queue means that hello consuming application only has toobe provisioned toobe able toohandle average load instead of peak load.</span></span> <span data-ttu-id="1d150-117">profundidade Olá da fila de Olá aumenta e contrai como carga hello a receber varia.</span><span class="sxs-lookup"><span data-stu-id="1d150-117">hello depth of hello queue grows and contracts as hello incoming load varies.</span></span> <span data-ttu-id="1d150-118">Tal poupa diretamente dinheiro com a quantidade de toohello regard de carga da infraestrutura necessária tooservice Olá aplicação.</span><span class="sxs-lookup"><span data-stu-id="1d150-118">This directly saves money with regard toohello amount of infrastructure required tooservice hello application load.</span></span> <span data-ttu-id="1d150-119">Como Olá carga aumenta, mais processos de trabalho podem ser adicionado tooread da fila de Olá.</span><span class="sxs-lookup"><span data-stu-id="1d150-119">As hello load increases, more worker processes can be added tooread from hello queue.</span></span> <span data-ttu-id="1d150-120">Cada mensagem é processada apenas por um Olá de processos de trabalho.</span><span class="sxs-lookup"><span data-stu-id="1d150-120">Each message is processed by only one of hello worker processes.</span></span> <span data-ttu-id="1d150-121">Além disso, este balanceamento de carga baseado na solicitação permite a utilização ideal de computadores de trabalho de Olá, mesmo se os computadores de trabalho de Olá diferem com regard tooprocessing corrente, o vez que transmitirão as mensagens na sua própria taxa máxima.</span><span class="sxs-lookup"><span data-stu-id="1d150-121">Furthermore, this pull-based load balancing allows for optimum use of hello worker computers even if hello worker computers differ with regard tooprocessing power, as they will pull messages at their own maximum rate.</span></span> <span data-ttu-id="1d150-122">Este padrão é frequentemente denominado padrão padrão de "competir consumidor" Olá.</span><span class="sxs-lookup"><span data-stu-id="1d150-122">This pattern is often termed hello "competing consumer" pattern.</span></span>

<span data-ttu-id="1d150-123">Se utilizar filas toointermediate entre mensagem produtores e consumidores fornece um coupling soltas inerente entre os componentes de Olá.</span><span class="sxs-lookup"><span data-stu-id="1d150-123">Using queues toointermediate between message producers and consumers provides an inherent loose coupling between hello components.</span></span> <span data-ttu-id="1d150-124">Porque os produtores e consumidores não têm conhecimento entre si, um consumidor possa ser atualizado sem ter qualquer efeito em produtor Olá.</span><span class="sxs-lookup"><span data-stu-id="1d150-124">Because producers and consumers are not aware of each other, a consumer can be upgraded without having any effect on hello producer.</span></span>

<span data-ttu-id="1d150-125">Criar uma fila é um processo de vários passo.</span><span class="sxs-lookup"><span data-stu-id="1d150-125">Creating a queue is a multi-step process.</span></span> <span data-ttu-id="1d150-126">Efetuar operações de gestão do Service Bus entidades (filas e tópicos) através de Olá de mensagens [Microsoft.ServiceBus.NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) classe, que é criada, fornecendo o endereço base do Olá do Olá Service Bus espaço de nomes e Olá as credenciais do utilizador.</span><span class="sxs-lookup"><span data-stu-id="1d150-126">You perform management operations for Service Bus messaging entities (both queues and topics) via hello [Microsoft.ServiceBus.NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class, which is constructed by supplying hello base address of hello Service Bus namespace and hello user credentials.</span></span> <span data-ttu-id="1d150-127">[NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) fornece métodos toocreate, enumerar e eliminar entidades de mensagens.</span><span class="sxs-lookup"><span data-stu-id="1d150-127">[NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="1d150-128">Depois de criar um [Microsoft.ServiceBus.TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) objeto de objeto de nome SAS Olá e chave e um gestão de espaço de nomes de serviço, pode utilizar Olá [Microsoft.ServiceBus.NamespaceManager.CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) fila do método toocreate Olá.</span><span class="sxs-lookup"><span data-stu-id="1d150-128">After creating a [Microsoft.ServiceBus.TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) object from hello SAS name and key, and a service namespace management object, you can use hello [Microsoft.ServiceBus.NamespaceManager.CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) method toocreate hello queue.</span></span> <span data-ttu-id="1d150-129">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="1d150-129">For example:</span></span>

```csharp
// Create management credentials
TokenProvider credentials = TokenProvider.CreateSharedAccessSignatureTokenProvider(sasKeyName,sasKeyValue);
// Create namespace client
NamespaceManager namespaceClient = new NamespaceManager(ServiceBusEnvironment.CreateServiceUri("sb", ServiceNamespace, string.Empty), credentials);
```

<span data-ttu-id="1d150-130">Em seguida, pode criar um objeto de fila e uma fábrica de mensagens com Olá URI do Service Bus como um argumento.</span><span class="sxs-lookup"><span data-stu-id="1d150-130">You can then create a queue object and a messaging factory with hello Service Bus URI as an argument.</span></span> <span data-ttu-id="1d150-131">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="1d150-131">For example:</span></span>

```csharp
QueueDescription myQueue;
myQueue = namespaceClient.CreateQueue("TestQueue");
MessagingFactory factory = MessagingFactory.Create(ServiceBusEnvironment.CreateServiceUri("sb", ServiceNamespace, string.Empty), credentials); 
QueueClient myQueueClient = factory.CreateQueueClient("TestQueue");
```

<span data-ttu-id="1d150-132">Em seguida, pode enviar toohello a fila de mensagens.</span><span class="sxs-lookup"><span data-stu-id="1d150-132">You can then send messages toohello queue.</span></span> <span data-ttu-id="1d150-133">Por exemplo, se tiver uma lista de mensagens mediadas chamado `MessageList`, código de Olá aparece semelhante toohello seguinte:</span><span class="sxs-lookup"><span data-stu-id="1d150-133">For example, if you have a list of brokered messages called `MessageList`, hello code appears similar toohello following:</span></span>

```csharp
for (int count = 0; count < 6; count++)
{
    var issue = MessageList[count];
    issue.Label = issue.Properties["IssueTitle"].ToString();
    myQueueClient.Send(issue);
}
```

<span data-ttu-id="1d150-134">Em seguida, receber mensagens da fila de Olá da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="1d150-134">You then receive messages from hello queue as follows:</span></span>

```csharp
while ((message = myQueueClient.Receive(new TimeSpan(hours: 0, minutes: 0, seconds: 5))) != null)
    {
        Console.WriteLine(string.Format("Message received: {0}, {1}, {2}", message.SequenceNumber, message.Label, message.MessageId));
        message.Complete();

        Console.WriteLine("Processing message (sleeping...)");
        Thread.Sleep(1000);
    }
```

<span data-ttu-id="1d150-135">No Olá [ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode) modo, Olá receber operação única; ou seja, quando o Service Bus recebe o pedido de Olá, marca Olá mensagem como consumida e devolve a mesma aplicação toohello.</span><span class="sxs-lookup"><span data-stu-id="1d150-135">In hello [ReceiveAndDelete](/dotnet/api/microsoft.servicebus.messaging.receivemode) mode, hello receive operation is single-shot; that is, when Service Bus receives hello request, it marks hello message as being consumed and returns it toohello application.</span></span> <span data-ttu-id="1d150-136">**ReceiveAndDelete** modo é Olá de modelo mais simples e funciona melhor para cenários em que Olá aplicação pode tolerar o não processamento de uma mensagem no evento Olá de uma falha.</span><span class="sxs-lookup"><span data-stu-id="1d150-136">**ReceiveAndDelete** mode is hello simplest model and works best for scenarios in which hello application can tolerate not processing a message in hello event of a failure.</span></span> <span data-ttu-id="1d150-137">toounderstand isto, considere um cenário no quais problemas de consumidor Olá Olá receber o pedido e, em seguida, falhas antes do processamento-lo.</span><span class="sxs-lookup"><span data-stu-id="1d150-137">toounderstand this, consider a scenario in which hello consumer issues hello receive request and then crashes before processing it.</span></span> <span data-ttu-id="1d150-138">Porque o Service Bus marca a mensagem de saudação como consumida, quando a aplicação Olá reinicia e começa a consumir novamente mensagens, terá perdido mensagem de saudação foi consumida falhas toohello anterior.</span><span class="sxs-lookup"><span data-stu-id="1d150-138">Because Service Bus marks hello message as being consumed, when hello application restarts and begins consuming messages again, it will have missed hello message that was consumed prior toohello crash.</span></span>

<span data-ttu-id="1d150-139">No [PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode) modo, Olá receber operação torna-se duas etapas, que torna possível toosupport aplicações que não toleram mensagens em falta.</span><span class="sxs-lookup"><span data-stu-id="1d150-139">In [PeekLock](/dotnet/api/microsoft.servicebus.messaging.receivemode) mode, hello receive operation becomes two-stage, which makes it possible toosupport applications that cannot tolerate missing messages.</span></span> <span data-ttu-id="1d150-140">Quando o Service Bus recebe o pedido de Olá, localiza toobe Olá seguinte mensagem consumida, bloqueia-tooprevent outros consumidores de receção e, em seguida, devolve a mesma aplicação toohello.</span><span class="sxs-lookup"><span data-stu-id="1d150-140">When Service Bus receives hello request, it finds hello next message toobe consumed, locks it tooprevent other consumers from receiving it, and then returns it toohello application.</span></span> <span data-ttu-id="1d150-141">Após a aplicação Olá concluir o processamento da mensagem de saudação (ou armazena a mesma forma fiável para processamento futuro), conclui Olá segunda etapa do Olá processo de receção ao chamar [concluída](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) na mensagem de saudação recebida.</span><span class="sxs-lookup"><span data-stu-id="1d150-141">After hello application finishes processing hello message (or stores it reliably for future processing), it completes hello second stage of hello receive process by calling [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) on hello received message.</span></span> <span data-ttu-id="1d150-142">Quando o Service Bus vê Olá **concluída** chamada, marca a mensagem de saudação como consumida.</span><span class="sxs-lookup"><span data-stu-id="1d150-142">When Service Bus sees hello **Complete** call, it marks hello message as being consumed.</span></span>

<span data-ttu-id="1d150-143">Se a aplicação Olá for não é possível tooprocess Olá mensagem por algum motivo, pode chamar Olá [abandonar](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) método na mensagem de saudação recebida (em vez de [concluída](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span><span class="sxs-lookup"><span data-stu-id="1d150-143">If hello application is unable tooprocess hello message for some reason, it can call hello [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) method on hello received message (instead of [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span></span> <span data-ttu-id="1d150-144">Isto permite que a mensagem de saudação do Service Bus toounlock e torná-lo disponível toobe novamente recebida, por Olá consumidor mesmo ou outro consumidor concorrente.</span><span class="sxs-lookup"><span data-stu-id="1d150-144">This enables Service Bus toounlock hello message and make it available toobe received again, either by hello same consumer or by another competing consumer.</span></span> <span data-ttu-id="1d150-145">Lugar, existe é associado a um tempo limite de bloqueio de Olá e se a aplicação Olá falha tooprocess Olá mensagem antes de Olá tempo limite de bloqueio expira (por exemplo, se a falha da aplicação Olá), o Service Bus desbloqueia a mensagem de saudação e torna toobe disponível novamente recebida (essencialmente efetuar um [abandonar](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operação por predefinição).</span><span class="sxs-lookup"><span data-stu-id="1d150-145">Secondly, there is a timeout associated with hello lock and if hello application fails tooprocess hello message before hello lock timeout expires (for example, if hello application crashes), then Service Bus unlocks hello message and makes it available toobe received again (essentially performing an [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operation by default).</span></span>

<span data-ttu-id="1d150-146">Tenha em atenção que no Olá eventos Olá aplicação falhas após o processamento da mensagem de saudação, mas antes de Olá **concluída** pedido é emitido, mensagem de saudação é reenviada toohello aplicação quando esta reiniciar.</span><span class="sxs-lookup"><span data-stu-id="1d150-146">Note that in hello event that hello application crashes after processing hello message, but before hello **Complete** request is issued, hello message is redelivered toohello application when it restarts.</span></span> <span data-ttu-id="1d150-147">Isto é frequentemente designado *, pelo menos, uma vez* processamento; ou seja, cada mensagem é processada pelo menos uma vez.</span><span class="sxs-lookup"><span data-stu-id="1d150-147">This is often called *At Least Once* processing; that is, each message is processed at least once.</span></span> <span data-ttu-id="1d150-148">No entanto, em determinadas Olá situações mesma mensagem poderá ser reenviada.</span><span class="sxs-lookup"><span data-stu-id="1d150-148">However, in certain situations hello same message may be redelivered.</span></span> <span data-ttu-id="1d150-149">Se o cenário de Olá não pode tolerar o processamento duplicado, em seguida, é necessário lógica adicional no Olá aplicação toodetect os duplicados que podem ser conseguidos com base no Olá **MessageId** propriedade da mensagem de saudação, que permanece constante nas tentativas de entrega.</span><span class="sxs-lookup"><span data-stu-id="1d150-149">If hello scenario cannot tolerate duplicate processing, then additional logic is required in hello application toodetect duplicates which can be achieved based upon hello **MessageId** property of hello message, which remains constant across delivery attempts.</span></span> <span data-ttu-id="1d150-150">Isto é conhecido como *exatamente uma vez* processamento.</span><span class="sxs-lookup"><span data-stu-id="1d150-150">This is known as *Exactly Once* processing.</span></span>

## <a name="topics-and-subscriptions"></a><span data-ttu-id="1d150-151">Tópicos e subscrições</span><span class="sxs-lookup"><span data-stu-id="1d150-151">Topics and subscriptions</span></span>
<span data-ttu-id="1d150-152">Em contraste tooqueues, em que cada mensagem é processada por um único consumidor, *tópicos* e *subscrições* proporcionar uma forma de um-para-muitos de comunicação, um *publicação* padrão.</span><span class="sxs-lookup"><span data-stu-id="1d150-152">In contrast tooqueues, in which each message is processed by a single consumer, *topics* and *subscriptions* provide a one-to-many form of communication, in a *publish/subscribe* pattern.</span></span> <span data-ttu-id="1d150-153">Útil para dimensionamento toovery grandes quantidades de destinatários, cada mensagem publicada é efetuada registada no tópico Olá de subscrição de tooeach disponíveis.</span><span class="sxs-lookup"><span data-stu-id="1d150-153">Useful for scaling toovery large numbers of recipients, each published message is made available tooeach subscription registered with hello topic.</span></span> <span data-ttu-id="1d150-154">As mensagens são enviadas tooa tópico e entregue tooone ou mais subscrições associadas, consoante as regras de filtro que podem ser definidas numa base por subscrição.</span><span class="sxs-lookup"><span data-stu-id="1d150-154">Messages are sent tooa topic and delivered tooone or more associated subscriptions, depending on filter rules that can be set on a per-subscription basis.</span></span> <span data-ttu-id="1d150-155">subscrições de Olá podem utilizar mensagens hello toorestrict de filtros adicionais que querem tooreceive.</span><span class="sxs-lookup"><span data-stu-id="1d150-155">hello subscriptions can use additional filters toorestrict hello messages that they want tooreceive.</span></span> <span data-ttu-id="1d150-156">As mensagens são enviadas tooa tópico Olá mesma forma são enviadas tooa fila, mas as mensagens não são recebeu tópico Olá diretamente.</span><span class="sxs-lookup"><span data-stu-id="1d150-156">Messages are sent tooa topic in hello same way they are sent tooa queue, but messages are not received from hello topic directly.</span></span> <span data-ttu-id="1d150-157">Em vez disso, são recebidos de subscrições.</span><span class="sxs-lookup"><span data-stu-id="1d150-157">Instead, they are received from subscriptions.</span></span> <span data-ttu-id="1d150-158">Uma subscrição de tópico é semelhante uma fila virtual que recebe cópias das mensagens hello que são enviadas toohello tópico.</span><span class="sxs-lookup"><span data-stu-id="1d150-158">A topic subscription resembles a virtual queue that receives copies of hello messages that are sent toohello topic.</span></span> <span data-ttu-id="1d150-159">As mensagens são recebidas a partir de uma subscrição de forma idêntica forma toohello que são recebidos a partir de uma fila.</span><span class="sxs-lookup"><span data-stu-id="1d150-159">Messages are received from a subscription identically toohello way they are received from a queue.</span></span>

<span data-ttu-id="1d150-160">A título de comparação, hello funcionalidade de envio de mensagem de uma fila mapeia diretamente tooa tópico e a funcionalidade de receção de mensagens mapeia tooa subscrição.</span><span class="sxs-lookup"><span data-stu-id="1d150-160">By way of comparison, hello message-sending functionality of a queue maps directly tooa topic and its message-receiving functionality maps tooa subscription.</span></span> <span data-ttu-id="1d150-161">Entre outras coisas, isto significa que as subscrições suportam Olá padrões mesmos descritas anteriormente nesta secção com regard tooqueues: consumidor concorrente, desacoplamento temporal, nivelamento de carga e balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="1d150-161">Among other things, this means that subscriptions support hello same patterns described earlier in this section with regard tooqueues: competing consumer, temporal decoupling, load leveling, and load balancing.</span></span>

<span data-ttu-id="1d150-162">A criação de um tópico é semelhante toocreating uma fila, conforme mostrado no exemplo de Olá na secção anterior Olá.</span><span class="sxs-lookup"><span data-stu-id="1d150-162">Creating a topic is similar toocreating a queue, as shown in hello example in hello previous section.</span></span> <span data-ttu-id="1d150-163">Criar serviço Olá URI e, em seguida, utilizar Olá [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) cliente de espaço de nomes do classe toocreate Olá.</span><span class="sxs-lookup"><span data-stu-id="1d150-163">Create hello service URI, and then use hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class toocreate hello namespace client.</span></span> <span data-ttu-id="1d150-164">Em seguida, pode criar um tópico com Olá [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) método.</span><span class="sxs-lookup"><span data-stu-id="1d150-164">You can then create a topic using hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) method.</span></span> <span data-ttu-id="1d150-165">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="1d150-165">For example:</span></span>

```csharp
TopicDescription dataCollectionTopic = namespaceClient.CreateTopic("DataCollectionTopic");
```

<span data-ttu-id="1d150-166">Em seguida, adicione as subscrições como pretendido:</span><span class="sxs-lookup"><span data-stu-id="1d150-166">Next, add subscriptions as desired:</span></span>

```csharp
SubscriptionDescription myAgentSubscription = namespaceClient.CreateSubscription(myTopic.Path, "Inventory");
SubscriptionDescription myAuditSubscription = namespaceClient.CreateSubscription(myTopic.Path, "Dashboard");
```

<span data-ttu-id="1d150-167">Em seguida, pode criar um cliente de tópico.</span><span class="sxs-lookup"><span data-stu-id="1d150-167">You can then create a topic client.</span></span> <span data-ttu-id="1d150-168">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="1d150-168">For example:</span></span>

```csharp
MessagingFactory factory = MessagingFactory.Create(serviceUri, tokenProvider);
TopicClient myTopicClient = factory.CreateTopicClient(myTopic.Path)
```

<span data-ttu-id="1d150-169">Utilizar o remetente da mensagem Olá, pode enviar e receber mensagens tooand de tópico Olá, conforme mostrado na secção anterior Olá.</span><span class="sxs-lookup"><span data-stu-id="1d150-169">Using hello message sender, you can send and receive messages tooand from hello topic, as shown in hello previous section.</span></span> <span data-ttu-id="1d150-170">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="1d150-170">For example:</span></span>

```csharp
foreach (BrokeredMessage message in messageList)
{
    myTopicClient.Send(message);
    Console.WriteLine(
    string.Format("Message sent: Id = {0}, Body = {1}", message.MessageId, message.GetBody<string>()));
}
```

<span data-ttu-id="1d150-171">Tooqueues semelhantes, as mensagens são recebidos a partir de uma subscrição a utilizar um [SubscriptionClient](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient) objeto em vez de um [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) objeto.</span><span class="sxs-lookup"><span data-stu-id="1d150-171">Similar tooqueues, messages are received from a subscription using a [SubscriptionClient](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient) object instead of a [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) object.</span></span> <span data-ttu-id="1d150-172">Criar o cliente de subscrição de Olá, transmitir o nome de Olá tópico Olá, nome de Olá da subscrição de Olá, e (opcionalmente) Olá receber o modo como parâmetros.</span><span class="sxs-lookup"><span data-stu-id="1d150-172">Create hello subscription client, passing hello name of hello topic, hello name of hello subscription, and (optionally) hello receive mode as parameters.</span></span> <span data-ttu-id="1d150-173">Por exemplo, com Olá **inventário** subscrição:</span><span class="sxs-lookup"><span data-stu-id="1d150-173">For example, with hello **Inventory** subscription:</span></span>

```csharp
// Create hello subscription client
MessagingFactory factory = MessagingFactory.Create(serviceUri, tokenProvider); 

SubscriptionClient agentSubscriptionClient = factory.CreateSubscriptionClient("IssueTrackingTopic", "Inventory", ReceiveMode.PeekLock);
SubscriptionClient auditSubscriptionClient = factory.CreateSubscriptionClient("IssueTrackingTopic", "Dashboard", ReceiveMode.ReceiveAndDelete); 

while ((message = agentSubscriptionClient.Receive(TimeSpan.FromSeconds(5))) != null)
{
    Console.WriteLine("\nReceiving message from Inventory...");
    Console.WriteLine(string.Format("Message received: Id = {0}, Body = {1}", message.MessageId, message.GetBody<string>()));
    message.Complete();
}          

// Create a receiver using ReceiveAndDelete mode
while ((message = auditSubscriptionClient.Receive(TimeSpan.FromSeconds(5))) != null)
{
    Console.WriteLine("\nReceiving message from Dashboard...");
    Console.WriteLine(string.Format("Message received: Id = {0}, Body = {1}", message.MessageId, message.GetBody<string>()));
}
```

### <a name="rules-and-actions"></a><span data-ttu-id="1d150-174">Regras e ações</span><span class="sxs-lookup"><span data-stu-id="1d150-174">Rules and actions</span></span>
<span data-ttu-id="1d150-175">Em vários cenários, as mensagens com características específicas tem de ser processadas de formas diferentes.</span><span class="sxs-lookup"><span data-stu-id="1d150-175">In many scenarios, messages that have specific characteristics must be processed in different ways.</span></span> <span data-ttu-id="1d150-176">tooenable, pode configurar subscrições toofind mensagens tem pretendido propriedades e, em seguida, efetuar determinadas propriedades de toothose modificações.</span><span class="sxs-lookup"><span data-stu-id="1d150-176">tooenable this, you can configure subscriptions toofind messages that have desired properties and then perform certain modifications toothose properties.</span></span> <span data-ttu-id="1d150-177">Enquanto as subscrições do Service Bus ver todas as mensagens enviadas toohello tópico, só poderá copiar um subconjunto de a fila de mensagens toohello virtual da subscrição.</span><span class="sxs-lookup"><span data-stu-id="1d150-177">While Service Bus subscriptions see all messages sent toohello topic, you can only copy a subset of those messages toohello virtual subscription queue.</span></span> <span data-ttu-id="1d150-178">Isto é conseguido utilizando filtros de subscrição.</span><span class="sxs-lookup"><span data-stu-id="1d150-178">This is accomplished using subscription filters.</span></span> <span data-ttu-id="1d150-179">Essas alterações são denominadas *filtrar ações*.</span><span class="sxs-lookup"><span data-stu-id="1d150-179">Such modifications are called *filter actions*.</span></span> <span data-ttu-id="1d150-180">Quando é criada uma subscrição, pode fornecer uma expressão de filtro que opera em Olá as propriedades da mensagem de saudação, ambos Olá propriedades do sistema (por exemplo, **etiqueta**) e as propriedades de aplicação personalizada (por exemplo, **StoreName**.) Olá expressão de filtro do SQL Server é opcional neste caso; sem uma expressão de filtro do SQL Server, será efetuada qualquer ação do filtro definida em subscrições em todas as mensagens de Olá dessa subscrição.</span><span class="sxs-lookup"><span data-stu-id="1d150-180">When a subscription is created, you can supply a filter expression that operates on hello properties of hello message, both hello system properties (for example, **Label**) and custom application properties (for example, **StoreName**.) hello SQL filter expression is optional in this case; without a SQL filter expression, any filter action defined on a subscription will be performed on all hello messages for that subscription.</span></span>

<span data-ttu-id="1d150-181">Utilizando o exemplo anterior Olá, mensagens de toofilter apenas feitos **Store1**, poderá criar subscrição de Dashboard Olá da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="1d150-181">Using hello previous example, toofilter messages coming only from **Store1**, you would create hello Dashboard subscription as follows:</span></span>

```csharp
namespaceManager.CreateSubscription("IssueTrackingTopic", "Dashboard", new SqlFilter("StoreName = 'Store1'"));
```

<span data-ttu-id="1d150-182">Com este filtro de subscrição no local, apenas as mensagens hello `StoreName` propriedade definida demasiado`Store1` são copiados toohello fila virtual para Olá `Dashboard` subscrição.</span><span class="sxs-lookup"><span data-stu-id="1d150-182">With this subscription filter in place, only messages that have hello `StoreName` property set too`Store1` are copied toohello virtual queue for hello `Dashboard` subscription.</span></span>

<span data-ttu-id="1d150-183">Para obter mais informações sobre os valores de filtro possíveis, consulte a documentação de Olá para Olá [SqlFilter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter) e [SqlRuleAction](/dotnet/api/microsoft.servicebus.messaging.sqlruleaction) classes.</span><span class="sxs-lookup"><span data-stu-id="1d150-183">For more information about possible filter values, see hello documentation for hello [SqlFilter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter) and [SqlRuleAction](/dotnet/api/microsoft.servicebus.messaging.sqlruleaction) classes.</span></span> <span data-ttu-id="1d150-184">Além disso, consulte Olá [mensagens mediadas: filtros avançados](http://code.msdn.microsoft.com/Brokered-Messaging-6b0d2749) e [filtros de tópico](https://github.com/Azure-Samples/azure-servicebus-messaging-samples/tree/master/TopicFilters) amostras.</span><span class="sxs-lookup"><span data-stu-id="1d150-184">Also, see hello [Brokered Messaging: Advanced Filters](http://code.msdn.microsoft.com/Brokered-Messaging-6b0d2749) and [Topic Filters](https://github.com/Azure-Samples/azure-servicebus-messaging-samples/tree/master/TopicFilters) samples.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1d150-185">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="1d150-185">Next steps</span></span>
<span data-ttu-id="1d150-186">Consulte o artigo seguinte Olá avançadas tópicos para obter mais informações e exemplos de como utilizar mensagens do Service Bus.</span><span class="sxs-lookup"><span data-stu-id="1d150-186">See hello following advanced topics for more information and examples of using Service Bus messaging.</span></span>

* [<span data-ttu-id="1d150-187">Descrição geral das mensagens do Service Bus</span><span class="sxs-lookup"><span data-stu-id="1d150-187">Service Bus messaging overview</span></span>](service-bus-messaging-overview.md)
* [<span data-ttu-id="1d150-188">Tutorial de .NET de mensagens mediadas do Service Bus</span><span class="sxs-lookup"><span data-stu-id="1d150-188">Service Bus brokered messaging .NET tutorial</span></span>](service-bus-brokered-tutorial-dotnet.md)
* [<span data-ttu-id="1d150-189">Tutorial de REST de mensagens mediadas do Service Bus</span><span class="sxs-lookup"><span data-stu-id="1d150-189">Service Bus brokered messaging REST tutorial</span></span>](service-bus-brokered-tutorial-rest.md)
* [<span data-ttu-id="1d150-190">Exemplo de filtros de tópico</span><span class="sxs-lookup"><span data-stu-id="1d150-190">Topic Filters sample </span></span>](https://github.com/Azure/azure-service-bus/tree/master/samples/DotNet/Microsoft.ServiceBus.Messaging/TopicFilters)
* [<span data-ttu-id="1d150-191">Mensagens mediadas: Exemplo de filtros de avançadas</span><span class="sxs-lookup"><span data-stu-id="1d150-191">Brokered Messaging: Advanced Filters sample</span></span>](http://code.msdn.microsoft.com/Brokered-Messaging-6b0d2749)

