---
title: "implementação de aaaFlighting (beta teste) no App Service do Azure"
description: "Saiba como tooflight novas funcionalidades na sua aplicação ou beta testar as atualizações neste tutorial ponto-a-ponto. -Reúne as funcionalidades do serviço de aplicações como publicação contínua, ranhuras, o encaminhamento de tráfego e a integração do Application Insights."
services: app-service\web
documentationcenter: 
author: cephalin
manager: erikre
editor: 
ms.assetid: 17953c51-38f8-442d-bb0b-f69c1542f0e9
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/02/2016
ms.author: cephalin
ms.openlocfilehash: e83477b1fe46be09e5baa7bc2bd239b840b05cf7
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="flighting-deployment-beta-testing-in-azure-app-service"></a><span data-ttu-id="66a5e-104">Implementação de distribuição de pacotes piloto (beta teste) no App Service do Azure</span><span class="sxs-lookup"><span data-stu-id="66a5e-104">Flighting deployment (beta testing) in Azure App Service</span></span>
<span data-ttu-id="66a5e-105">Este tutorial mostra como toodo *implementações de distribuição de pacotes piloto* através da integração Olá diversas capacidades de [App Service do Azure](http://go.microsoft.com/fwlink/?LinkId=529714) e [Azure Application Insights](/services/application-insights/).</span><span class="sxs-lookup"><span data-stu-id="66a5e-105">This tutorial shows you how toodo *flighting deployments* by integrating hello various capabilities of [Azure App Service](http://go.microsoft.com/fwlink/?LinkId=529714) and [Azure Application Insights](/services/application-insights/).</span></span>

<span data-ttu-id="66a5e-106">*Distribuição de pacotes piloto* é um processo de implementação que valida a uma nova funcionalidade ou altere com um número limitado de clientes reais e é um teste principais no cenário de produção.</span><span class="sxs-lookup"><span data-stu-id="66a5e-106">*Flighting* is a deployment process that validates a new feature or change with a limited number of real customers, and is a major testing in production scenario.</span></span> <span data-ttu-id="66a5e-107">É akin toobeta testar e é por vezes conhecida como "teste controlada voo".</span><span class="sxs-lookup"><span data-stu-id="66a5e-107">It is akin toobeta testing and is sometimes known as "controlled test flight".</span></span> <span data-ttu-id="66a5e-108">Muitas empresas de grandes dimensão com uma presença na web, utilize esta abordagem para obter validação antecipada sobre as atualizações de aplicações na respetiva prática de [desenvolvimento seja ágil](https://en.wikipedia.org/wiki/Agile_software_development).</span><span class="sxs-lookup"><span data-stu-id="66a5e-108">Many large enterprises with a web presence use this approach to get early validation on their app updates in their practice of [agile development](https://en.wikipedia.org/wiki/Agile_software_development).</span></span> <span data-ttu-id="66a5e-109">App Service do Azure permite-lhe toointegrate teste em produção com a publicação contínua e Application Insights tooimplement Olá mesmo cenário de DevOps.</span><span class="sxs-lookup"><span data-stu-id="66a5e-109">Azure App Service enables you toointegrate test in production with continous publishing and Application Insights tooimplement hello same DevOps scenario.</span></span> <span data-ttu-id="66a5e-110">Vantagens desta abordagem incluem:</span><span class="sxs-lookup"><span data-stu-id="66a5e-110">Benefits of this approach include:</span></span>

* <span data-ttu-id="66a5e-111">**Obter comentários real *antes* atualizações são publicada tooproduction** -Olá só coisa melhor do que obtenham comentários, assim que a versão é obter comentários antes de a versão.</span><span class="sxs-lookup"><span data-stu-id="66a5e-111">**Gain real feedback *before* updates are released tooproduction** - hello only thing better than gaining feedback as soon as you release is gaining feedback before you release.</span></span> <span data-ttu-id="66a5e-112">Pode testar as atualizações com o tráfego de utilizador reais e comportamentos antecipadamente que desejar no ciclo de vida do produto Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-112">You can test updates with real user traffic and behaviors as early as you desire in hello product life cycle.</span></span>
* <span data-ttu-id="66a5e-113">**Melhorar [desenvolvimento contínuo condicionada no teste (CTDD)](https://en.wikipedia.org/wiki/Continuous_test-driven_development)**  - através da integração teste em produção com a integração contínua e instrumentação com o Application Insights, validação de utilizador acontece numa fase inicial e automaticamente no seu ciclo de vida do produto.</span><span class="sxs-lookup"><span data-stu-id="66a5e-113">**Enhance [continuous test-driven development (CTDD)](https://en.wikipedia.org/wiki/Continuous_test-driven_development)** - By integrating test in production with continuous integration and instrumentation with Application Insights, user validation happens early and automatically in your product life cycle.</span></span> <span data-ttu-id="66a5e-114">Isto ajuda a reduzir os investimentos de tempo na execução do teste manual.</span><span class="sxs-lookup"><span data-stu-id="66a5e-114">This helps reduce time investments in manual test execution.</span></span>
* <span data-ttu-id="66a5e-115">**Otimizar o fluxo de trabalho de teste** -ao automatizar teste em produção com instrumentação de monitorização contínua, pode potencialmente realizar objetivos Olá dos vários tipos de testes num único processo, tal como [integração](https://en.wikipedia.org/wiki/Integration_testing), [regressão](https://en.wikipedia.org/wiki/Regression_testing), [usabilidade](https://en.wikipedia.org/wiki/Usability_testing), acessibilidade, localização, [desempenho](https://en.wikipedia.org/wiki/Software_performance_testing), [segurança](https://en.wikipedia.org/wiki/Security_testing), e [ aceitação](https://en.wikipedia.org/wiki/Acceptance_testing).</span><span class="sxs-lookup"><span data-stu-id="66a5e-115">**Optimize test workflow** - By automating test in production with continuous monitoring instrumentation, you can potentially accomplish hello goals of various kinds of tests in a single process, such as [integration](https://en.wikipedia.org/wiki/Integration_testing), [regression](https://en.wikipedia.org/wiki/Regression_testing), [usability](https://en.wikipedia.org/wiki/Usability_testing), accessibility, localization, [performance](https://en.wikipedia.org/wiki/Software_performance_testing), [security](https://en.wikipedia.org/wiki/Security_testing), and [acceptance](https://en.wikipedia.org/wiki/Acceptance_testing).</span></span>

<span data-ttu-id="66a5e-116">Não é de uma implementação flighting encaminhamento praticamente tráfego em direto.</span><span class="sxs-lookup"><span data-stu-id="66a5e-116">A flighting deployment is not just about routing live traffic.</span></span> <span data-ttu-id="66a5e-117">Neste tipo de implementação que pretende toogain insight mais rapidamente possível, se este ser um erro inesperado, degradação do desempenho, problemas de experiência de utilizador.</span><span class="sxs-lookup"><span data-stu-id="66a5e-117">In such a deployment you want toogain insight as quickly as possible, whether it be an unexpected bug, performance degradation, user experience issues.</span></span> <span data-ttu-id="66a5e-118">Lembre-se de que estão a lidar com os clientes reais.</span><span class="sxs-lookup"><span data-stu-id="66a5e-118">Remember, you are dealing with real customers.</span></span> <span data-ttu-id="66a5e-119">Por isso, toodo-lo à direita, tem de se certificar que configurou o toogather implementação flighting todos os dados de Olá que necessita na ordem toomake uma decisão informada para o próximo passo.</span><span class="sxs-lookup"><span data-stu-id="66a5e-119">So toodo it right, you must make sure that you have set up your flighting deployment toogather all hello data you need in order toomake an informed decision for your next step.</span></span> <span data-ttu-id="66a5e-120">Este tutorial mostra como toocollect dados com o Application Insights, mas podem utilizar New Relic ou outras tecnologias que se adequa aos seus cenário.</span><span class="sxs-lookup"><span data-stu-id="66a5e-120">This tutorial shows you how toocollect data with Application Insights, but you can use New Relic or other technologies that suits your scenario.</span></span>

## <a name="what-you-will-do"></a><span data-ttu-id="66a5e-121">O que irá fazer</span><span class="sxs-lookup"><span data-stu-id="66a5e-121">What you will do</span></span>
<span data-ttu-id="66a5e-122">Neste tutorial, ficará a saber como toobring Olá, os seguintes cenários de tootest em conjunto, a aplicação de serviço de aplicações na produção:</span><span class="sxs-lookup"><span data-stu-id="66a5e-122">In this tutorial, you will learn how toobring hello following scenarios together tootest your App Service app in production:</span></span>

* <span data-ttu-id="66a5e-123">[Encaminhar o tráfego de produção](app-service-web-test-in-production-get-start.md) tooyour beta aplicação</span><span class="sxs-lookup"><span data-stu-id="66a5e-123">[Route production traffic](app-service-web-test-in-production-get-start.md) tooyour beta app</span></span>
* <span data-ttu-id="66a5e-124">[Instrumente a sua aplicação](../application-insights/app-insights-web-track-usage.md) métricas úteis tooobtain</span><span class="sxs-lookup"><span data-stu-id="66a5e-124">[Instrument your app](../application-insights/app-insights-web-track-usage.md) tooobtain useful metrics</span></span>
* <span data-ttu-id="66a5e-125">Continuamente implementar a sua aplicação beta e monitorizar as métricas da aplicação em direto</span><span class="sxs-lookup"><span data-stu-id="66a5e-125">Continuously deploy your beta app and track live app metrics</span></span>
* <span data-ttu-id="66a5e-126">Métricas de comparação entre Olá aplicação de produção e Olá beta aplicação toosee como alterações de código traduzir tooresults</span><span class="sxs-lookup"><span data-stu-id="66a5e-126">Compare metrics between hello production app and hello beta app toosee how code changes translate tooresults</span></span>

## <a name="what-you-will-need"></a><span data-ttu-id="66a5e-127">O que precisa</span><span class="sxs-lookup"><span data-stu-id="66a5e-127">What you will need</span></span>
* <span data-ttu-id="66a5e-128">Uma conta do Azure</span><span class="sxs-lookup"><span data-stu-id="66a5e-128">An Azure account</span></span>
* <span data-ttu-id="66a5e-129">A [GitHub](https://github.com/) conta</span><span class="sxs-lookup"><span data-stu-id="66a5e-129">A [GitHub](https://github.com/) account</span></span>
* <span data-ttu-id="66a5e-130">Visual Studio 2015 - pode transferir Olá [edição Community](https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx).</span><span class="sxs-lookup"><span data-stu-id="66a5e-130">Visual Studio 2015 - you can download hello [Community edition](https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx).</span></span>
* <span data-ttu-id="66a5e-131">Shell do Git (instalado com [GitHub para Windows](https://windows.github.com/))-permite toorun ambos os comandos de Git e PowerShell Olá no Olá mesma sessão</span><span class="sxs-lookup"><span data-stu-id="66a5e-131">Git Shell (installed with [GitHub for Windows](https://windows.github.com/)) - this enables you toorun both hello Git and PowerShell commands in hello same session</span></span>
* <span data-ttu-id="66a5e-132">Mais recente [Azure PowerShell](https://github.com/Azure/azure-powershell/releases/download/v0.9.8-September2015/azure-powershell.0.9.8.msi) bits</span><span class="sxs-lookup"><span data-stu-id="66a5e-132">Latest [Azure PowerShell](https://github.com/Azure/azure-powershell/releases/download/v0.9.8-September2015/azure-powershell.0.9.8.msi) bits</span></span>
* <span data-ttu-id="66a5e-133">Compreensão básica do seguinte Olá:</span><span class="sxs-lookup"><span data-stu-id="66a5e-133">Basic understanding of hello following:</span></span>
  * <span data-ttu-id="66a5e-134">[O Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) implementação do modelo (consulte [implementar uma aplicação complexa previsibilidade no Azure](app-service-deploy-complex-application-predictably.md))</span><span class="sxs-lookup"><span data-stu-id="66a5e-134">[Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) template deployment (see [Deploy a complex application predictably in Azure](app-service-deploy-complex-application-predictably.md))</span></span>
  * [<span data-ttu-id="66a5e-135">Git</span><span class="sxs-lookup"><span data-stu-id="66a5e-135">Git</span></span>](http://git-scm.com/documentation)
  * [<span data-ttu-id="66a5e-136">PowerShell</span><span class="sxs-lookup"><span data-stu-id="66a5e-136">PowerShell</span></span>](https://technet.microsoft.com/library/bb978526.aspx)

> [!NOTE]
> <span data-ttu-id="66a5e-137">Precisa de uma conta do Azure toocomplete neste tutorial:</span><span class="sxs-lookup"><span data-stu-id="66a5e-137">You need an Azure account toocomplete this tutorial:</span></span>
>
> * <span data-ttu-id="66a5e-138">Pode [abrir uma conta do Azure gratuitamente](https://azure.microsoft.com/pricing/free-trial/) -receberá créditos pode utilizar tootry saída paga serviços do Azure e, mesmo depois cópias de segurança, pode manter Olá conta e utilizar serviços gratuitos do Azure, tais como Web Apps.</span><span class="sxs-lookup"><span data-stu-id="66a5e-138">You can [open an Azure account for free](https://azure.microsoft.com/pricing/free-trial/) - You get credits you can use tootry out paid Azure services, and even after they're used up you can keep hello account and use free Azure services, such as Web Apps.</span></span>
> * <span data-ttu-id="66a5e-139">Pode [ativar os benefícios de subscritor do Visual Studio](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) -o Visual Studio subscrição dá-lhe créditos todos os meses que pode utilizar para serviços pagos do Azure.</span><span class="sxs-lookup"><span data-stu-id="66a5e-139">You can [activate Visual Studio subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) - Your Visual Studio subscription gives you credits every month that you can use for paid Azure services.</span></span>
>
> <span data-ttu-id="66a5e-140">Se quiser tooget iniciado com o App Service do Azure antes de inscrever-se numa conta do Azure, aceda demasiado[experimentar o App Service](https://azure.microsoft.com/try/app-service/), onde, pode criar imediatamente uma aplicação web de arranque de curta duração no App Service.</span><span class="sxs-lookup"><span data-stu-id="66a5e-140">If you want tooget started with Azure App Service before signing up for an Azure account, go too[Try App Service](https://azure.microsoft.com/try/app-service/), where you can immediately create a short-lived starter web app in App Service.</span></span> <span data-ttu-id="66a5e-141">Sem cartões de crédito; sem compromissos.</span><span class="sxs-lookup"><span data-stu-id="66a5e-141">No credit cards required; no commitments.</span></span>
>
>

## <a name="set-up-your-production-web-app"></a><span data-ttu-id="66a5e-142">Configurar a sua aplicação web de produção</span><span class="sxs-lookup"><span data-stu-id="66a5e-142">Set up your production web app</span></span>
> [!NOTE]
> <span data-ttu-id="66a5e-143">script de Olá utilizado neste tutorial automaticamente irá configurar a publicação contínua do seu repositório do GitHub.</span><span class="sxs-lookup"><span data-stu-id="66a5e-143">hello script used in this tutorial will automatically configure continuous publishing from your GitHub repository.</span></span> <span data-ttu-id="66a5e-144">Isto requer que as suas credenciais de GitHub já são armazenados no Azure, caso contrário, a implementação de Olá convertidos em script falhará quando tentar tooconfigure definições de controlo de origem para aplicações web de Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-144">This requires that your GitHub credentials are already stored in Azure, otherwise hello scripted deployment will fail when attempting tooconfigure source control settings for hello web apps.</span></span>
>
> <span data-ttu-id="66a5e-145">toostore o GitHub credenciais no Azure, criar uma aplicação web no Olá [Portal do Azure](https://portal.azure.com/) e [configurar a implementação de GitHub](app-service-continuous-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="66a5e-145">toostore your GitHub credentials in Azure, create a web app in hello [Azure Portal](https://portal.azure.com/) and [configure GitHub deployment](app-service-continuous-deployment.md).</span></span> <span data-ttu-id="66a5e-146">Basta toodo numa vez.</span><span class="sxs-lookup"><span data-stu-id="66a5e-146">You only need toodo this once.</span></span>
>
>

<span data-ttu-id="66a5e-147">Um cenário típico de DevOps, que tem uma aplicação que está em execução no Azure e pretender toomake alterações tooit através da publicação contínua.</span><span class="sxs-lookup"><span data-stu-id="66a5e-147">In a typical DevOps scenario, you have an application that’s running live in Azure, and you want toomake changes tooit through continuous publishing.</span></span> <span data-ttu-id="66a5e-148">Neste cenário, irá implementar tooproduction um modelo que tenha desenvolvidas e testado.</span><span class="sxs-lookup"><span data-stu-id="66a5e-148">In this scenario, you will deploy tooproduction a template that you have developed and tested.</span></span>

1. <span data-ttu-id="66a5e-149">Criar a suas próprias bifurcação de Olá [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) repositório.</span><span class="sxs-lookup"><span data-stu-id="66a5e-149">Create your own fork of hello [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) repository.</span></span> <span data-ttu-id="66a5e-150">Para obter informações sobre como criar o repositório de cópia, consulte [Bifurcar um repositório](https://help.github.com/articles/fork-a-repo/).</span><span class="sxs-lookup"><span data-stu-id="66a5e-150">For information on creating your fork, see [Fork a Repo](https://help.github.com/articles/fork-a-repo/).</span></span> <span data-ttu-id="66a5e-151">Assim que o repositório de cópia for criado, pode vê-lo no seu browser.</span><span class="sxs-lookup"><span data-stu-id="66a5e-151">Once your fork is created, you can see it in your browser.</span></span>

   ![](./media/app-service-agile-software-development/production-1-private-repo.png)
2. <span data-ttu-id="66a5e-152">Abra uma sessão de Shell de Git.</span><span class="sxs-lookup"><span data-stu-id="66a5e-152">Open a Git Shell session.</span></span> <span data-ttu-id="66a5e-153">Se ainda não tiver a Shell de Git, instale [GitHub para Windows](https://windows.github.com/) agora.</span><span class="sxs-lookup"><span data-stu-id="66a5e-153">If you don't have Git Shell yet, install [GitHub for Windows](https://windows.github.com/) now.</span></span>
3. <span data-ttu-id="66a5e-154">Crie um clone local da sua bifurcação executando Olá os seguintes comandos:</span><span class="sxs-lookup"><span data-stu-id="66a5e-154">Create a local clone of your fork by executing hello following command:</span></span>

     <span data-ttu-id="66a5e-155">Git clone https://github.com/<your_fork>/ToDoApp.git</span><span class="sxs-lookup"><span data-stu-id="66a5e-155">git clone https://github.com/<your_fork>/ToDoApp.git</span></span>
4. <span data-ttu-id="66a5e-156">Assim que tiver o clone local, navegue até demasiado*&lt;repository_root >*\ARMTemplates e execução Olá deploy.ps1 script com um sufixo exclusivo, como mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="66a5e-156">Once you have your local clone, navigate too*&lt;repository_root>*\ARMTemplates, and run hello deploy.ps1 script with a unique suffix, as shown below:</span></span>

     <span data-ttu-id="66a5e-157">.\deploy.ps1 – RepoUrl https://github.com/<your_fork>/todoapp.git - ResourceGroupSuffix < your_suffix ></span><span class="sxs-lookup"><span data-stu-id="66a5e-157">.\deploy.ps1 –RepoUrl https://github.com/<your_fork>/todoapp.git -ResourceGroupSuffix <your_suffix></span></span>
5. <span data-ttu-id="66a5e-158">Quando lhe for pedido, o tipo de Olá pretendido nome de utilizador e palavra-passe para acesso de base de dados.</span><span class="sxs-lookup"><span data-stu-id="66a5e-158">When prompted, type in hello desired username and password for database access.</span></span> <span data-ttu-id="66a5e-159">Lembre-se de que as credenciais da base de dados porque precisa de toospecify-las novamente quando a atualização Olá grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="66a5e-159">Remember your database credentials because you will need toospecify them again when updating hello resource group.</span></span>

   <span data-ttu-id="66a5e-160">Deverá ver Olá aprovisionamento progresso de vários recursos do Azure.</span><span class="sxs-lookup"><span data-stu-id="66a5e-160">You should see hello provisioning progress of various Azure resources.</span></span> <span data-ttu-id="66a5e-161">Quando tiver concluído a implementação, o script de Olá iniciar aplicação Olá no browser Olá e dão-lhe um beep amigável.</span><span class="sxs-lookup"><span data-stu-id="66a5e-161">When deployment completes, hello script will launch hello application in hello browser and give you a friendly beep.</span></span>
   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.1-app-in-browser.png)
6. <span data-ttu-id="66a5e-162">Novamente na sua sessão do Git Shell, execute:</span><span class="sxs-lookup"><span data-stu-id="66a5e-162">Back in your Git Shell session, run:</span></span>

     <span data-ttu-id="66a5e-163">. \swap – nome ToDoApp < your_suffix ></span><span class="sxs-lookup"><span data-stu-id="66a5e-163">.\swap –Name ToDoApp<your_suffix></span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.2-swap-to-production.png)
7. <span data-ttu-id="66a5e-164">Quando o script de Olá é concluída, volte atrás endereço do toobrowse toohello front-end (http://ToDoApp*&lt;your_suffix >*.azurewebsites.net/) aplicações de Olá toosee em execução na produção.</span><span class="sxs-lookup"><span data-stu-id="66a5e-164">When hello script finishes, go back toobrowse toohello frontend’s address (http://ToDoApp*&lt;your_suffix>*.azurewebsites.net/) toosee hello application running in production.</span></span>
8. <span data-ttu-id="66a5e-165">Iniciar sessão Olá [Portal do Azure](https://portal.azure.com/) e observe o que é criado.</span><span class="sxs-lookup"><span data-stu-id="66a5e-165">Log into hello [Azure Portal](https://portal.azure.com/) and take a look at what’s created.</span></span>

   <span data-ttu-id="66a5e-166">Deve ser capaz de toosee dois web apps no Olá mesmo grupo de recursos, uma com Olá `Api` sufixo no nome de Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-166">You should be able toosee two web apps in hello same resource group, one with hello `Api` suffix in hello name.</span></span> <span data-ttu-id="66a5e-167">Se observar a vista de grupo de recursos de Olá, também verá Olá base de dados do SQL Server e servidor, Olá plano do App Service e ranhuras de teste de Olá para aplicações web de Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-167">If you look at hello resource group view, you will also see hello SQL Database and server, hello App Service plan, and hello staging slots for hello web apps.</span></span> <span data-ttu-id="66a5e-168">Procurar através de recursos diferentes Olá e compará-los com  *&lt;repository_root >*toosee \ARMTemplates\ProdAndStage.json como estão configuradas no modelo de Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-168">Browse through hello different resources and compare them with *&lt;repository_root>*\ARMTemplates\ProdAndStage.json toosee how they are configured in hello template.</span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.3-resource-group-view.png)

<span data-ttu-id="66a5e-169">Configurou a aplicação de produção Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-169">You have set up hello production app.</span></span>  <span data-ttu-id="66a5e-170">Agora, Vamos imaginar que receber comentários que a facilidade de utilização é fraca para a aplicação Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-170">Now, let's imagine that you receive feedback that usability is poor for hello app.</span></span> <span data-ttu-id="66a5e-171">Para decidir tooinvestigate.</span><span class="sxs-lookup"><span data-stu-id="66a5e-171">So you decide tooinvestigate.</span></span> <span data-ttu-id="66a5e-172">Vai tooinstrument toogive sua aplicação, comentários.</span><span class="sxs-lookup"><span data-stu-id="66a5e-172">You're going tooinstrument your app toogive you feedback.</span></span>

## <a name="investigate-instrument-your-client-app-for-monitoringmetrics"></a><span data-ttu-id="66a5e-173">Investigar: Instrumente a sua aplicação de cliente de monitorização/com base nas métricas</span><span class="sxs-lookup"><span data-stu-id="66a5e-173">Investigate: Instrument your client app for monitoring/metrics</span></span>
1. <span data-ttu-id="66a5e-174">Abra  *&lt;repository_root >*\src\MultiChannelToDo.sln no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="66a5e-174">Open *&lt;repository_root>*\src\MultiChannelToDo.sln in Visual Studio.</span></span>
2. <span data-ttu-id="66a5e-175">Restaurar todos os pacotes de Nuget clicando solução > **gerir pacotes NuGet para solução** > **restaurar**.</span><span class="sxs-lookup"><span data-stu-id="66a5e-175">Restore all Nuget packages by right-clicking solution > **Manage NuGet Packages for Solution** > **Restore**.</span></span>
3. <span data-ttu-id="66a5e-176">Clique com botão direito **MultiChannelToDo.Web** > **adicionar telemetria do Application Insights** > **configurar definições de** > grupo de recursos de alteração tooToDoApp*&lt;your_suffix >* > **tooProject de adicionar o Application Insights**.</span><span class="sxs-lookup"><span data-stu-id="66a5e-176">Right-click **MultiChannelToDo.Web** > **Add Application Insights Telemetry** > **Configure Settings** > Change resource group tooToDoApp*&lt;your_suffix>* > **Add Application Insights tooProject**.</span></span>
4. <span data-ttu-id="66a5e-177">No Portal do Azure Olá, abra o painel Olá Olá **MultiChannelToDo.Web** recurso do Application Insight.</span><span class="sxs-lookup"><span data-stu-id="66a5e-177">In hello Azure Portal, open hello blade for hello **MultiChannelToDo.Web** Application Insight resource.</span></span> <span data-ttu-id="66a5e-178">Em seguida, no Olá **estado de funcionamento da aplicação** parte, clique em **saber como a página de browser toocollect carregar dados** > copiar o código.</span><span class="sxs-lookup"><span data-stu-id="66a5e-178">Then in hello **Application health** part, click **Learn how toocollect browser page load data** > copy code.</span></span>
5. <span data-ttu-id="66a5e-179">Adicionar Olá copiados código de instrumentação JS demasiado*&lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml, imediatamente antes de fecho de Olá `<heading>` etiquetas.</span><span class="sxs-lookup"><span data-stu-id="66a5e-179">Add hello copied JS instrumentation code too*&lt;repository_root>*\src\MultiChannelToDo.Web\app\Index.cshtml, just before hello closing `<heading>` tag.</span></span> <span data-ttu-id="66a5e-180">Esta deve conter a chave de instrumentação exclusivo de Olá do seu recurso do Application Insight.</span><span class="sxs-lookup"><span data-stu-id="66a5e-180">It should contain hello unique instrumentation key of your Application Insight resource.</span></span>

        <script type="text/javascript">
        var appInsights=window.appInsights||function(config){
            function s(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},r=document,f=window,e="script",o=r.createElement(e),i,u;for(o.src=config.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",r.getElementsByTagName(e)[0].parentNode.appendChild(o),t.cookie=r.cookie,t.queue=[],i=["Event","Exception","Metric","PageView","Trace"];i.length;)s("track"+i.pop());return config.disableExceptionTracking||(i="onerror",s("_"+i),u=f[i],f[i]=function(config,r,f,e,o){var s=u&&u(config,r,f,e,o);return s!==!0&&t["_"+i](config,r,f,e,o),s}),t
        }({
            instrumentationKey:"<your_unique_instrumentation_key>"
        });

        window.appInsights=appInsights;
        appInsights.trackPageView();
        </script>
6. <span data-ttu-id="66a5e-181">Envie eventos personalizados tooApplication Insights para cliques do rato adicionando Olá parte inferior do toohello de código do corpo os seguintes:</span><span class="sxs-lookup"><span data-stu-id="66a5e-181">Send custom events tooApplication Insights for mouse clicks by adding hello following code toohello bottom of body:</span></span>

       <script>
           $(document.body).find("*").click(function(event) {

               appInsights.trackEvent(event.target.tagName + ": " + event.target.className);
           });
       </script>

   <span data-ttu-id="66a5e-182">Este fragmento do JavaScript envia um evento personalizado tooApplication Insights sempre que um utilizador clica em qualquer parte na aplicação web de Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-182">This JavaScript snippet sends a custom event tooApplication Insights every time a user clicks anywhere in hello web app.</span></span>
7. <span data-ttu-id="66a5e-183">Na Shell de Git, consolide e emita o repositório de cópia de tooyour alterações no GitHub.</span><span class="sxs-lookup"><span data-stu-id="66a5e-183">In Git Shell, commit and push your changes tooyour fork in GitHub.</span></span> <span data-ttu-id="66a5e-184">Em seguida, aguarde browser toorefresh de clientes.</span><span class="sxs-lookup"><span data-stu-id="66a5e-184">Then, wait for clients toorefresh browser.</span></span>

       git add -A :/
       git commit -m "add AI configuration for client app"
       git push origin master
8. <span data-ttu-id="66a5e-185">Comutação Olá implementado tooproduction de alterações de aplicação:</span><span class="sxs-lookup"><span data-stu-id="66a5e-185">Swap hello deployed app changes tooproduction:</span></span>

     <span data-ttu-id="66a5e-186">. \swap – nome ToDoApp < your_suffix ></span><span class="sxs-lookup"><span data-stu-id="66a5e-186">.\swap –Name ToDoApp<your_suffix></span></span>
9. <span data-ttu-id="66a5e-187">Procure o recurso do Application Insights toohello que configurou.</span><span class="sxs-lookup"><span data-stu-id="66a5e-187">Browse toohello Application Insights resource that you configured.</span></span> <span data-ttu-id="66a5e-188">Clique em Personalizar eventos.</span><span class="sxs-lookup"><span data-stu-id="66a5e-188">Click Custom events.</span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/01-custom-events.png)

   <span data-ttu-id="66a5e-189">Se não vir métricas para eventos personalizados, aguarde alguns minutos e clique em **atualizar**.</span><span class="sxs-lookup"><span data-stu-id="66a5e-189">If you don't see metrics for custom events, wait a few minutes and click **Refresh**.</span></span>

<span data-ttu-id="66a5e-190">Suponha que vê um gráfico, conforme mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="66a5e-190">Suppose you see a chart like below:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/02-custom-events-chart-view.png)

<span data-ttu-id="66a5e-191">E Olá grelha de eventos abaixo do mesmo:</span><span class="sxs-lookup"><span data-stu-id="66a5e-191">And hello event grid below it:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/03-custom-event-grid-view.png)

<span data-ttu-id="66a5e-192">De acordo com código da aplicação tooyour ToDoApp, Olá **botão** eventos corresponde toohello botão para submeter e Olá **entrada** eventos corresponde toohello caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="66a5e-192">According tooyour ToDoApp application code, hello **BUTTON** event corresponds toohello submit button, and hello **INPUT** event corresponds toohello textbox.</span></span> <span data-ttu-id="66a5e-193">Até ao momento, coisas fazem sentido.</span><span class="sxs-lookup"><span data-stu-id="66a5e-193">So far, things make sense.</span></span> <span data-ttu-id="66a5e-194">No entanto, esta parece não haver uma quantidade boa de cliques e muito poucos cliques nos itens de tarefas Olá (Olá **LI** eventos).</span><span class="sxs-lookup"><span data-stu-id="66a5e-194">However, it looks like there's a good amount of clicks and very few clicks on hello to-do items (hello **LI** events).</span></span>

<span data-ttu-id="66a5e-195">Com base neste, formulário sua hipótese que alguns utilizadores sejam confundido que parte da Olá IU é clicável e porque cursor Olá é escovado para selecção de texto quando se passa em itens de lista de Olá e os respetivos ícones.</span><span class="sxs-lookup"><span data-stu-id="66a5e-195">Based on this, you form your hypothesis that some users are confused which part of hello UI is clickable and it is because hello cursor is styled for text selection when it hovers on hello list items and their icons.</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/04-to-do-list-item-ui.png)

<span data-ttu-id="66a5e-196">Esta situação pode ser um exemplo contrived.</span><span class="sxs-lookup"><span data-stu-id="66a5e-196">This might be a contrived example.</span></span> <span data-ttu-id="66a5e-197">Contudo, está a toomake do uma aplicação de tooyour melhoramento e, em seguida, execute um flighting comentários de Facilidade de utilização de tooget de implementação de clientes em direto.</span><span class="sxs-lookup"><span data-stu-id="66a5e-197">Nevertheless, you're going toomake an improvement tooyour app, and then perform a flighting deployment tooget usability feedback from live customers.</span></span>

### <a name="instrument-your-server-app-for-monitoringmetrics"></a><span data-ttu-id="66a5e-198">Instrumente a sua aplicação de servidor de monitorização/com base nas métricas</span><span class="sxs-lookup"><span data-stu-id="66a5e-198">Instrument your server app for monitoring/metrics</span></span>
<span data-ttu-id="66a5e-199">Este é um tangente, uma vez que o cenário de Olá demonstrado neste tutorial apenas lida com a aplicação de cliente Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-199">This is a tangent since hello scenario demonstrated in this tutorial only deals with hello client app.</span></span> <span data-ttu-id="66a5e-200">No entanto, por questões de exaustividade, irá configurar aplicação do lado do servidor de Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-200">However, for completeness you will set up hello server-side app.</span></span>

1. <span data-ttu-id="66a5e-201">Clique com botão direito **MultiChannelToDo** > **adicionar telemetria do Application Insights** > **configurar definições de** > grupo de recursos de alteração tooToDoApp*&lt;your_suffix >* > **tooProject de adicionar o Application Insights**.</span><span class="sxs-lookup"><span data-stu-id="66a5e-201">Right-click **MultiChannelToDo** > **Add Application Insights Telemetry** > **Configure Settings** > Change resource group tooToDoApp*&lt;your_suffix>* > **Add Application Insights tooProject**.</span></span>
2. <span data-ttu-id="66a5e-202">Na Shell de Git, consolide e emita o repositório de cópia de tooyour alterações no GitHub.</span><span class="sxs-lookup"><span data-stu-id="66a5e-202">In Git Shell, commit and push your changes tooyour fork in GitHub.</span></span> <span data-ttu-id="66a5e-203">Em seguida, aguarde browser toorefresh de clientes.</span><span class="sxs-lookup"><span data-stu-id="66a5e-203">Then, wait for clients toorefresh browser.</span></span>

       git add -A :/
       git commit -m "add AI configuration for server app"
       git push origin master
3. <span data-ttu-id="66a5e-204">Comutação Olá implementado tooproduction de alterações de aplicação:</span><span class="sxs-lookup"><span data-stu-id="66a5e-204">Swap hello deployed app changes tooproduction:</span></span>

     <span data-ttu-id="66a5e-205">. \swap – nome ToDoApp < your_suffix ></span><span class="sxs-lookup"><span data-stu-id="66a5e-205">.\swap –Name ToDoApp<your_suffix></span></span>

<span data-ttu-id="66a5e-206">Já está!</span><span class="sxs-lookup"><span data-stu-id="66a5e-206">That's it!</span></span>

## <a name="investigate-add-slot-specific-tags-tooyour-client-app-metrics"></a><span data-ttu-id="66a5e-207">Investigar: Adicionar métricas de aplicação de cliente de tooyour etiquetas específicos da ranhura</span><span class="sxs-lookup"><span data-stu-id="66a5e-207">Investigate: Add slot-specific tags tooyour client app metrics</span></span>
<span data-ttu-id="66a5e-208">Nesta secção, irá configurar Olá implementação diferentes ranhuras toosend específicos da ranhura de telemetria toohello mesmo recurso do Application Insights.</span><span class="sxs-lookup"><span data-stu-id="66a5e-208">In this section, you will configure hello different deployment slots toosend slot-specific telemetry toohello same Application Insights resource.</span></span> <span data-ttu-id="66a5e-209">Desta forma, pode comparar a telemetria de dados entre o tráfego de ranhuras diferente (ambientes de implementação) tooeasily Consulte efeito Olá das alterações de aplicação.</span><span class="sxs-lookup"><span data-stu-id="66a5e-209">This way, you can compare telemetry data between traffic from different slots (deployment environments) tooeasily see hello effect of your app changes.</span></span> <span data-ttu-id="66a5e-210">AT Olá mesmo tempo, pode a separar o tráfego de produção Olá de rest de Olá para poder continuar toomonitor a aplicação de produção conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="66a5e-210">At hello same time, you can separate hello production traffic from hello rest so you can continue toomonitor your production app as needed.</span></span>

<span data-ttu-id="66a5e-211">Uma vez que está a recolher dados sobre o comportamento do cliente, terá de [adicionar um tooyour de inicializador de telemetria código JavaScript](../application-insights/app-insights-api-filtering-sampling.md) no Index. cshtml.</span><span class="sxs-lookup"><span data-stu-id="66a5e-211">Since you're gathering data on client behavior, you will [add a telemetry initializer tooyour JavaScript code](../application-insights/app-insights-api-filtering-sampling.md) in index.cshtml.</span></span> <span data-ttu-id="66a5e-212">Se pretender que o desempenho do lado do servidor de tootest, por exemplo, também pode fazer da mesma forma no seu código de servidor (consulte [API do Application Insights para as métricas e eventos personalizados](../application-insights/app-insights-api-custom-events-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="66a5e-212">If you want tootest server-side performance, for example, you can also do similarly in your server code (see [Application Insights API for custom events and metrics](../application-insights/app-insights-api-custom-events-metrics.md).</span></span>

1. <span data-ttu-id="66a5e-213">Primeiro, adicione Olá de bewteen Olá código dois `//` comentários abaixo no bloco de JavaScript Olá que adicionou toohello `<heading>` tag anteriormente.</span><span class="sxs-lookup"><span data-stu-id="66a5e-213">First, add hello code bewteen hello two `//` comments below in hello JavaScript block that you added toohello `<heading>` tag earlier.</span></span>

        window.appInsights = appInsights;

        // Begin new code
        appInsights.queue.push(function () {
            appInsights.context.addTelemetryInitializer(function (envelope) {
                var telemetryItem = envelope.data.baseData;
                telemetryItem.properties = telemetryItem.properties || {};
                telemetryItem.properties["Environment"] = "@System.Configuration.ConfigurationManager.AppSettings["environment"]";
            });
        });
        // End new code

        appInsights.trackPageView();

    <span data-ttu-id="66a5e-214">Este código de inicializador faz com que Olá `appInsights` objeto tooadd Olá uma propriedade personalizada denominada `Environment` tooevery peça de telemetria que envia.</span><span class="sxs-lookup"><span data-stu-id="66a5e-214">This initializer code causes hello `appInsights` object tooadd hello a custom property called `Environment` tooevery piece of telemetry it sends.</span></span>
2. <span data-ttu-id="66a5e-215">Em seguida, adicione a propriedade personalizada como um [espaço definição](web-sites-staged-publishing.md#AboutConfiguration) para a sua aplicação web no Azure.</span><span class="sxs-lookup"><span data-stu-id="66a5e-215">Next, add this custom property as a [slot setting](web-sites-staged-publishing.md#AboutConfiguration) for your web app in Azure.</span></span> <span data-ttu-id="66a5e-216">toodo, Olá execute os seguintes comandos na sessão do Git Shell.</span><span class="sxs-lookup"><span data-stu-id="66a5e-216">toodo this, run hello following commands in your Git Shell session.</span></span>

        $app = Get-AzureWebsite -Name todoapp<your_suffix> -Slot production
        $app.AppSettings.Add("environment", "Production")
        $app.SlotStickyAppSettingNames.Add("environment")
        $app | Set-AzureWebsite -Name todoapp<your_suffix> -Slot production

    <span data-ttu-id="66a5e-217">Olá Web. config no seu projeto já define Olá `environment` definição de aplicação.</span><span class="sxs-lookup"><span data-stu-id="66a5e-217">hello Web.config in your project already defines hello `environment` app setting.</span></span> <span data-ttu-id="66a5e-218">Com esta definição, quando o testar localmente, a aplicação Olá métricas serão etiquetadas com `VS Debugger`.</span><span class="sxs-lookup"><span data-stu-id="66a5e-218">With this setting, when you test hello app locally, your metrics will be tagged with `VS Debugger`.</span></span> <span data-ttu-id="66a5e-219">No entanto, quando enviar o tooAzure de alterações, Azure irá localizar e utilizar Olá `environment` na configuração da aplicação web Olá em vez disso, a definição de aplicação e as métricas serão etiquetadas com `Production`.</span><span class="sxs-lookup"><span data-stu-id="66a5e-219">However, when you push your changes tooAzure, Azure will find and use hello `environment` app setting in hello web app's configuration instead, and your metrics will be tagged with `Production`.</span></span>
3. <span data-ttu-id="66a5e-220">Consolidar push sua bifurcação de tooyour de alterações de código no GitHub e, em seguida, aguarde que os utilizadores toouse Olá nova aplicação (necessidade toorefresh Olá browser).</span><span class="sxs-lookup"><span data-stu-id="66a5e-220">Commit and push your code changes tooyour fork on GitHub, and then wait for your users toouse hello new app (need toorefresh hello browser).</span></span> <span data-ttu-id="66a5e-221">Demora cerca de 15 minutos para Olá nova propriedade tooshow cópias de segurança no seu Application Insights `MultiChannelToDo.Web` recursos.</span><span class="sxs-lookup"><span data-stu-id="66a5e-221">It takes about 15 minutes for hello new property tooshow up in your Application Insights `MultiChannelToDo.Web` resource.</span></span>

        git add -A :/
        git commit -m "add environment property tooAI events for client app"
        git push origin master
4. <span data-ttu-id="66a5e-222">Agora, visite toohello **personalizar eventos** painel novamente e filtrar Olá métricas no `Environment=Production`.</span><span class="sxs-lookup"><span data-stu-id="66a5e-222">Now, go toohello **Custom events** blade again and filter hello metrics on `Environment=Production`.</span></span> <span data-ttu-id="66a5e-223">Agora deve ser capaz de toosee todos os Olá novos eventos personalizados na produção Olá espaço com este filtro.</span><span class="sxs-lookup"><span data-stu-id="66a5e-223">You should now be able toosee all hello new custom events in hello production slot with this filter.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/05-filter-on-production-environment.png)
5. <span data-ttu-id="66a5e-224">Clique em Olá **Favoritos** como o botão toosave Olá atual Explorador de métricas definições toosomething **eventos personalizados: produção**.</span><span class="sxs-lookup"><span data-stu-id="66a5e-224">Click hello **Favorites** button toosave hello current Metrics Explorer settings toosomething like **Custom events: Production**.</span></span> <span data-ttu-id="66a5e-225">Pode facilmente mudar entre esta vista e uma vista de ranhura de implementação mais tarde.</span><span class="sxs-lookup"><span data-stu-id="66a5e-225">You can easily switch between this view and a deployment slot view later.</span></span>

   > [!TIP]
   > <span data-ttu-id="66a5e-226">Para a análise ainda mais poderoso, considere [integrar o recurso do Application Insights com o Power BI](../application-insights/app-insights-export-power-bi.md).</span><span class="sxs-lookup"><span data-stu-id="66a5e-226">For even more powerful analytics, consider [integrating your Application Insights resource with Power BI](../application-insights/app-insights-export-power-bi.md).</span></span>
   >
   >

### <a name="add-slot-specific-tags-tooyour-server-app-metrics"></a><span data-ttu-id="66a5e-227">Adicione as métricas de aplicação do servidor de tooyour etiquetas específicos da ranhura</span><span class="sxs-lookup"><span data-stu-id="66a5e-227">Add slot-specific tags tooyour server app metrics</span></span>
<span data-ttu-id="66a5e-228">Novamente, por questões de exaustividade, irá configurar aplicação do lado do servidor de Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-228">Again, for completeness you will set up hello server-side app.</span></span> <span data-ttu-id="66a5e-229">Ao contrário Olá as aplicações cliente que estão instrumentada em JavaScript, etiquetas específicos da ranhura de aplicação de servidor Olá está instrumentada com o código de .NET.</span><span class="sxs-lookup"><span data-stu-id="66a5e-229">Unlike hello client app which is instrumented in JavaScript, slot-specific tags for hello server app is instrumented with .NET code.</span></span>

1. <span data-ttu-id="66a5e-230">Abra  *&lt;repository_root >*\src\MultiChannelToDo\Global.asax.cs.</span><span class="sxs-lookup"><span data-stu-id="66a5e-230">Open *&lt;repository_root>*\src\MultiChannelToDo\Global.asax.cs.</span></span> <span data-ttu-id="66a5e-231">Adicione bloco de código Olá abaixo, imediatamente antes da Olá Fechar chaveta de espaço de nomes.</span><span class="sxs-lookup"><span data-stu-id="66a5e-231">Add hello code block below, just before hello closing namespace curly brace.</span></span>

        namespace MultiChannelToDo
        {
                ...

                // Begin new code
            public class ConfigInitializer
            : ITelemetryInitializer
            {
                void ITelemetryInitializer.Initialize(ITelemetry telemetry)
                {
                    telemetry.Context.Properties["Environment"] = System.Configuration.ConfigurationManager.AppSettings["environment"];
                }
            }
                // End new code
        }
2. <span data-ttu-id="66a5e-232">Corrija os erros de resolução de nomes de Olá adicionando Olá `using` as instruções abaixo toohello início do ficheiro de Olá:</span><span class="sxs-lookup"><span data-stu-id="66a5e-232">Correct hello name resolution errors by adding hello `using` statements below toohello beginning of hello file:</span></span>

        using Microsoft.ApplicationInsights.Channel;
        using Microsoft.ApplicationInsights.Extensibility;
3. <span data-ttu-id="66a5e-233">Adicione o código de Olá abaixo início toohello Olá `Application_Start()` método:</span><span class="sxs-lookup"><span data-stu-id="66a5e-233">Add hello code below toohello beginning of hello `Application_Start()` method:</span></span>

        TelemetryConfiguration.Active.TelemetryInitializers.Add(new ConfigInitializer());
4. <span data-ttu-id="66a5e-234">Consolidar push sua bifurcação de tooyour de alterações de código no GitHub e, em seguida, aguarde que os utilizadores toouse Olá nova aplicação (necessidade toorefresh Olá browser).</span><span class="sxs-lookup"><span data-stu-id="66a5e-234">Commit and push your code changes tooyour fork on GitHub, and then wait for your users toouse hello new app (need toorefresh hello browser).</span></span> <span data-ttu-id="66a5e-235">Demora cerca de 15 minutos para Olá nova propriedade tooshow cópias de segurança no seu Application Insights `MultiChannelToDo` recursos.</span><span class="sxs-lookup"><span data-stu-id="66a5e-235">It takes about 15 minutes for hello new property tooshow up in your Application Insights `MultiChannelToDo` resource.</span></span>

        git add -A :/
        git commit -m "add environment property tooAI events for server app"
        git push origin master

## <a name="update-set-up-your-beta-branch"></a><span data-ttu-id="66a5e-236">Atualização: Configurar a sua sucursal beta</span><span class="sxs-lookup"><span data-stu-id="66a5e-236">Update: Set up your beta branch</span></span>
1. <span data-ttu-id="66a5e-237">Abra  *&lt;repository_root >*Olá \ARMTemplates\ProdAndStagetest.json e localizar `appsettings` recursos (procure `"name": "appsettings"`).</span><span class="sxs-lookup"><span data-stu-id="66a5e-237">Open *&lt;repository_root>*\ARMTemplates\ProdAndStagetest.json and find hello `appsettings` resources (search for `"name": "appsettings"`).</span></span> <span data-ttu-id="66a5e-238">Existem 4 deles, um para cada bloco.</span><span class="sxs-lookup"><span data-stu-id="66a5e-238">There are 4 of them, one for each slot.</span></span>
2. <span data-ttu-id="66a5e-239">Para cada `appsettings` recursos, adicione um `"environment": "[parameters('slotName')]"` final toohello de definição de aplicação de Olá `properties` matriz.</span><span class="sxs-lookup"><span data-stu-id="66a5e-239">For each `appsettings` resource, add an  `"environment": "[parameters('slotName')]"` app setting toohello end of hello `properties` array.</span></span> <span data-ttu-id="66a5e-240">Não se esqueça tooend linha anterior de Olá com uma vírgula.</span><span class="sxs-lookup"><span data-stu-id="66a5e-240">Don't forget tooend hello previous line with a comma.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/06-arm-app-setting-with-slot-name.png)

    <span data-ttu-id="66a5e-241">Acabou de adicionar Olá `environment` definição tooall ranhuras Olá no modelo de Olá de aplicação.</span><span class="sxs-lookup"><span data-stu-id="66a5e-241">You have just added hello `environment` app setting tooall hello slots in hello template.</span></span>
3. <span data-ttu-id="66a5e-242">No mesmo ficheiro de Olá, determinar Olá `slotconfignames` recursos (procure `"name": "slotconfignames"`).</span><span class="sxs-lookup"><span data-stu-id="66a5e-242">In hello same file, find hello `slotconfignames` resources (search for `"name": "slotconfignames"`).</span></span> <span data-ttu-id="66a5e-243">Existem 2 deles, um para cada aplicação.</span><span class="sxs-lookup"><span data-stu-id="66a5e-243">There are 2 of them, one for each app.</span></span>
4. <span data-ttu-id="66a5e-244">Para cada `slotconfignames` recursos, adicione `"environment"` final toohello Olá `appSettingNames` matriz.</span><span class="sxs-lookup"><span data-stu-id="66a5e-244">For each `slotconfignames` resource, add `"environment"` toohello end of hello `appSettingNames` array.</span></span> <span data-ttu-id="66a5e-245">Não se esqueça tooend linha anterior de Olá com uma vírgula.</span><span class="sxs-lookup"><span data-stu-id="66a5e-245">Don't forget tooend hello previous line with a comma.</span></span>

    <span data-ttu-id="66a5e-246">Apenas efetuou Olá `environment` aplicação definição pen tooits respetivos ranhura de implementação para ambas as aplicações.</span><span class="sxs-lookup"><span data-stu-id="66a5e-246">You have just made hello `environment` app setting stick tooits respective deployment slot for both apps.</span></span>  
5. <span data-ttu-id="66a5e-247">Na sua sessão do Git Shell, seguinte Olá executar os comandos com Olá mesmo sufixo do grupo de recursos que usou antes.</span><span class="sxs-lookup"><span data-stu-id="66a5e-247">In your Git Shell session, run hello following commands with hello same resource group suffix that you used before.</span></span>

        git checkout -b beta
        git push origin beta
        .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch beta
6. <span data-ttu-id="66a5e-248">Quando lhe for pedido, especifique Olá as mesmas credenciais de base de dados do SQL Server como anteriormente.</span><span class="sxs-lookup"><span data-stu-id="66a5e-248">When prompted, specify hello same SQL database credentials as before.</span></span> <span data-ttu-id="66a5e-249">Em seguida, quando lhe for perguntado tooupdate Olá grupo de recursos tipo `Y`, em seguida, `ENTER`.</span><span class="sxs-lookup"><span data-stu-id="66a5e-249">Then, when asked tooupdate hello resource group, type `Y`, then `ENTER`.</span></span>

    <span data-ttu-id="66a5e-250">Assim que o script de Olá é concluída, todos os recursos no grupo de recursos original Olá são mantidos, mas uma nova ranhura denominada "beta" é criada no mesmo com Olá mesmo configuração como ranhura de "Transição" Olá que foi criada no início de Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-250">Once hello script finishes, all your resources in hello original resource group are retained, but a new slot named "beta" is created in it with hello same configuration as hello "Staging" slot that was created in hello beginning.</span></span>

   > [!NOTE]
   > <span data-ttu-id="66a5e-251">Este método de criação de ambientes de implementação diferentes é diferente do método Olá [desenvolvimento de software seja ágil App Service do Azure](app-service-agile-software-development.md).</span><span class="sxs-lookup"><span data-stu-id="66a5e-251">This method of creating different deployment environments is different from hello method in [Agile software development with Azure App Service](app-service-agile-software-development.md).</span></span> <span data-ttu-id="66a5e-252">Aqui, pode criar ambientes de implementação com as ranhuras de implementação, onde existe como criar ambientes de implementação com grupos de recursos.</span><span class="sxs-lookup"><span data-stu-id="66a5e-252">Here, you create deployment environments with deployment slots, where as there you create deployment environments with resource groups.</span></span> <span data-ttu-id="66a5e-253">Gerir ambientes de implementação com grupos de recursos permite-lhe toodevelopers de ambiente de produção Olá do tookeep off-limits, mas não é fácil toodo na produção, que pode fazê-lo facilmente com ranhuras de teste.</span><span class="sxs-lookup"><span data-stu-id="66a5e-253">Managing deployment environments with resource groups enables you tookeep hello production environment off-limits toodevelopers, but it's not easy toodo testing in production, which you can do easily with slots.</span></span>
   >
   >

<span data-ttu-id="66a5e-254">Se assim o desejar, também pode criar uma aplicação alfa executando</span><span class="sxs-lookup"><span data-stu-id="66a5e-254">If you wish, you can also create an alpha app by running</span></span>

    git checkout -b alpha
    git push origin alpha
    .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch alpha

<span data-ttu-id="66a5e-255">Para este tutorial, que será apenas manter a utilizar a aplicação de beta.</span><span class="sxs-lookup"><span data-stu-id="66a5e-255">For this tutorial, you will just keep using your beta app.</span></span>

## <a name="update-push-your-updates-toohello-beta-app"></a><span data-ttu-id="66a5e-256">Atualização: Push a aplicação de beta toohello atualizações</span><span class="sxs-lookup"><span data-stu-id="66a5e-256">Update: Push your updates toohello beta app</span></span>
<span data-ttu-id="66a5e-257">Criar uma aplicação tooyour que pretende que o tooimprove.</span><span class="sxs-lookup"><span data-stu-id="66a5e-257">Back tooyour app that you want tooimprove.</span></span>

1. <span data-ttu-id="66a5e-258">Certifique-se de que está agora no seu ramo beta</span><span class="sxs-lookup"><span data-stu-id="66a5e-258">Make sure you're now in your beta branch</span></span>

        git checkout beta
2. <span data-ttu-id="66a5e-259">No  *&lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml, localizar Olá `<li>` assinalar e adicionar Olá `style="cursor:pointer"` atributo, conforme mostrado abaixo.</span><span class="sxs-lookup"><span data-stu-id="66a5e-259">In *&lt;repository_root>*\src\MultiChannelToDo.Web\app\Index.cshtml, find hello `<li>` tag and add hello `style="cursor:pointer"` attribute, as shown below.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/07-change-cursor-style-on-li.png)
3. <span data-ttu-id="66a5e-260">Consolide e emita tooAzure.</span><span class="sxs-lookup"><span data-stu-id="66a5e-260">commit and push tooAzure.</span></span>
4. <span data-ttu-id="66a5e-261">Certifique-se de que a alteração de Olá agora é refletida na ranhura de beta Olá navegando toohttp://todoapp*&lt;your_suffix >*-beta.azurewebsites.net/.</span><span class="sxs-lookup"><span data-stu-id="66a5e-261">Verify that hello change is now reflected in hello beta slot by navigating toohttp://todoapp*&lt;your_suffix>*-beta.azurewebsites.net/.</span></span> <span data-ttu-id="66a5e-262">Se não vir Olá alterar ainda, atualize o browser tooget Olá novo no código javascript.</span><span class="sxs-lookup"><span data-stu-id="66a5e-262">If you don't see hello change yet, refresh your browser tooget hello new javascript code.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/08-verify-change-in-beta-site.png)

<span data-ttu-id="66a5e-263">Agora que configurou a sua alteração em execução na ranhura de beta Olá, está pronto tooperform uma implementação flighting.</span><span class="sxs-lookup"><span data-stu-id="66a5e-263">Now that you have your change running in hello beta slot, you are ready tooperform a flighting deployment.</span></span>

## <a name="validate-route-traffic-toohello-beta-app"></a><span data-ttu-id="66a5e-264">Validar: Encaminhar o tráfego toohello beta aplicação</span><span class="sxs-lookup"><span data-stu-id="66a5e-264">Validate: Route traffic toohello beta app</span></span>
<span data-ttu-id="66a5e-265">Nesta secção, irá encaminhar tráfego toohello beta aplicação.</span><span class="sxs-lookup"><span data-stu-id="66a5e-265">In this section, you will route traffic toohello beta app.</span></span> <span data-ttu-id="66a5e-266">For sake of efeitos de clareza de demonstração, vai tooroute uma parte significativa de Olá utilizador tráfego tooit.</span><span class="sxs-lookup"><span data-stu-id="66a5e-266">For sake of clarity of demonstration, you're going tooroute a significant portion of hello user traffic tooit.</span></span> <span data-ttu-id="66a5e-267">Na realidade, Olá quantidade de tráfego que pretende tooroute dependerá da sua situação específica.</span><span class="sxs-lookup"><span data-stu-id="66a5e-267">In reality, hello amount of traffic you want tooroute will depend on your specific situation.</span></span> <span data-ttu-id="66a5e-268">Por exemplo, se o site é à escala Olá de microsoft.com, em seguida, poderá ter menos de uma percentagem do tráfego total de dados úteis de toogain de ordem.</span><span class="sxs-lookup"><span data-stu-id="66a5e-268">For example, if your site is at hello scale of microsoft.com, then you may need less than one percent of your total traffic in order toogain useful data.</span></span>

1. <span data-ttu-id="66a5e-269">Na sua sessão do Git Shell, execute Olá os seguintes comandos tooroute metade da ranhura de beta do Olá produção tráfego toohello:</span><span class="sxs-lookup"><span data-stu-id="66a5e-269">In your Git Shell session, run hello following commands tooroute half of hello production traffic toohello beta slot:</span></span>

        $siteName = "ToDoApp<your suffix>"
        $rule = New-Object Microsoft.WindowsAzure.Commands.Utilities.Websites.Services.WebEntities.RampUpRule
        $rule.ActionHostName = "$siteName-beta.azurewebsites.net"
        $rule.ReroutePercentage = 50
        $rule.Name = "beta"
        Set-AzureWebsite $siteName -Slot Production -RoutingRules $rule

   <span data-ttu-id="66a5e-270">Olá `ReroutePercentage=50` propriedade especifica que a 50% do tráfego de produção Olá será URL da aplicação de beta toohello encaminhadas (especificado pelo Olá `ActionHostName` propriedade).</span><span class="sxs-lookup"><span data-stu-id="66a5e-270">hello `ReroutePercentage=50` property specifies that 50% of hello production traffic will be routed toohello beta app's URL (specified by hello `ActionHostName` property).</span></span>
2. <span data-ttu-id="66a5e-271">Agora navegar toohttp://ToDoApp*&lt;your_suffix >*. azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="66a5e-271">Now navigate toohttp://ToDoApp*&lt;your_suffix>*.azurewebsites.net.</span></span> <span data-ttu-id="66a5e-272">50% do tráfego de Olá deve ser redirecionada toohello ranhura de beta.</span><span class="sxs-lookup"><span data-stu-id="66a5e-272">50% of hello traffic should now be redirected toohello beta slot.</span></span>
3. <span data-ttu-id="66a5e-273">No recurso do Application Insights, filtrar as métricas de Olá pelo ambiente = "beta".</span><span class="sxs-lookup"><span data-stu-id="66a5e-273">In your Application Insights resource, filter hello metrics by environment="beta".</span></span>

   > [!NOTE]
   > <span data-ttu-id="66a5e-274">Se guardar esta vista filtrada como favorito outro, em seguida, pode facilmente inverte vistas do Explorador de métrica de Olá entre a produção e vistas de beta.</span><span class="sxs-lookup"><span data-stu-id="66a5e-274">If you save this filtered view as another favorite, then you can easily flip hello metric explorer views between production and beta views.</span></span>
   >
   >

<span data-ttu-id="66a5e-275">Suponha no Application Insights, verá algo semelhante toohello seguinte:</span><span class="sxs-lookup"><span data-stu-id="66a5e-275">Suppose in Application Insights you see something similar toohello following:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/09-test-beta-site-in-production.png)

<span data-ttu-id="66a5e-276">Não só é isto que mostra que existem muitos cliques mais no Olá `<li>` etiquetas, mas parece toobe com um aumento de cliques nos `<li>` etiquetas.</span><span class="sxs-lookup"><span data-stu-id="66a5e-276">Not only is this showing that there are many more clicks on hello `<li>` tags, but there seems toobe a surge of clicks on `<li>` tags.</span></span> <span data-ttu-id="66a5e-277">Em seguida, pode concluir que pessoas tenham detetados Olá novo `<li>` etiquetas são clicáveis e são agora limpar todas as suas tarefas anteriormente concluída na aplicação Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-277">You can then conclude that people have discovered hello new `<li>` tags are clickable and are now clearing all their previously-completed tasks in hello app.</span></span>

<span data-ttu-id="66a5e-278">Com base nos dados de Olá da sua implementação flighting, decidir que a nova IU está pronta para produção.</span><span class="sxs-lookup"><span data-stu-id="66a5e-278">Based on hello data of your flighting deployment, you decide that your new UI is ready for production.</span></span>

## <a name="go-live-move-your-new-code-into-production"></a><span data-ttu-id="66a5e-279">Vá em direto: mover o novo código em produção</span><span class="sxs-lookup"><span data-stu-id="66a5e-279">Go live: Move your new code into production</span></span>
<span data-ttu-id="66a5e-280">Está agora pronto toomove tooproduction a atualização.</span><span class="sxs-lookup"><span data-stu-id="66a5e-280">You're now ready toomove your update tooproduction.</span></span> <span data-ttu-id="66a5e-281">O que é uma grande é que, agora que sabe que a atualização já foi validada *antes* é feita tooproduction.</span><span class="sxs-lookup"><span data-stu-id="66a5e-281">What's great is that now you know that your update has already been validated *before* it is pushed tooproduction.</span></span> <span data-ttu-id="66a5e-282">Por isso, agora, pode implementar com confidencialidade-lo.</span><span class="sxs-lookup"><span data-stu-id="66a5e-282">So now you can confidently deploy it.</span></span> <span data-ttu-id="66a5e-283">Uma vez que efetuou uma aplicação de cliente do atualização toohello AngularJS, apenas validada código do lado do cliente de Olá.</span><span class="sxs-lookup"><span data-stu-id="66a5e-283">Since you made an update toohello AngularJS client app, you only validated hello client-side code.</span></span> <span data-ttu-id="66a5e-284">Se as alterações de toomake toohello aplicações de Web API de back-end, foi possível validar as alterações da mesma forma e fácil.</span><span class="sxs-lookup"><span data-stu-id="66a5e-284">If you were toomake changes toohello back-end Web API app, you could validate your changes similarly and easily.</span></span>

1. <span data-ttu-id="66a5e-285">Na Shell de Git, remova a regra de encaminhamento de tráfego de Olá executando Olá os seguintes comandos:</span><span class="sxs-lookup"><span data-stu-id="66a5e-285">In Git Shell, remove hello traffic routing rule by running hello following command:</span></span>

        Set-AzureWebsite $siteName -Slot Production -RoutingRules @()
2. <span data-ttu-id="66a5e-286">Execute os comandos de Git Olá:</span><span class="sxs-lookup"><span data-stu-id="66a5e-286">Run hello Git commands:</span></span>

        git checkout master
        git pull origin master
        git merge beta
        git push origin master
3. <span data-ttu-id="66a5e-287">Aguarde alguns minutos para Olá novo código toohello toobe implementado ranhura de teste, em seguida, iniciar http://ToDoApp*&lt;your_suffix >*-tooverify staging.azurewebsites.net que Olá nova atualização é preparada no modo de transição de Olá ranhura.</span><span class="sxs-lookup"><span data-stu-id="66a5e-287">Wait for a few minutes for hello new code toobe deployed toohello staging slot, then launch http://ToDoApp*&lt;your_suffix>*-staging.azurewebsites.net tooverify that hello new update is warmed up in hello staging slot.</span></span> <span data-ttu-id="66a5e-288">Lembre-se de que Olá ramo principal o repositório de cópia é ligado toohello transição ranhura da sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="66a5e-288">Remember that hello your fork's master branch is linked toohello staging slot of your app.</span></span>
4. <span data-ttu-id="66a5e-289">Agora, comutação Olá ranhura de teste em produção</span><span class="sxs-lookup"><span data-stu-id="66a5e-289">Now, swap hello staging slot into production</span></span>

        cd <ROOT>\ToDoApp\ARMTemplates
        .\swap.ps1 -Name todoapp<your_suffix>

## <a name="summary"></a><span data-ttu-id="66a5e-290">Resumo</span><span class="sxs-lookup"><span data-stu-id="66a5e-290">Summary</span></span>
<span data-ttu-id="66a5e-291">App Service do Azure torna mais fácil para empresas pequena toomedium-tamanho tootest as suas aplicações direcionadas para o cliente na produção, algo que tiver sido realizada tradicionalmente em grandes empresas.</span><span class="sxs-lookup"><span data-stu-id="66a5e-291">Azure App Service makes it easy for small- toomedium-sized businesses tootest their customer-facing apps in production, something that has been traditionally done in big enterprises.</span></span> <span data-ttu-id="66a5e-292">Hopefully, este tutorial lhe forneceu Olá conhecimento terá toobring em conjunto do serviço de aplicações e o Application Insights toomake distribuição de pacotes piloto implementação possível e mesmo a outros cenários de teste em produção, no seu mundo de DevOps.</span><span class="sxs-lookup"><span data-stu-id="66a5e-292">Hopefully, this tutorial has given you hello knowledge you need toobring together App Service and Application Insights toomake possible flighting deployment, and even other test-in-production scenarios, in your DevOps world.</span></span>

## <a name="more-resources"></a><span data-ttu-id="66a5e-293">Mais recursos</span><span class="sxs-lookup"><span data-stu-id="66a5e-293">More resources</span></span>
* [<span data-ttu-id="66a5e-294">Desenvolvimento de software seja ágil App Service do Azure</span><span class="sxs-lookup"><span data-stu-id="66a5e-294">Agile software development with Azure App Service</span></span>](app-service-agile-software-development.md)
* [<span data-ttu-id="66a5e-295">Configurar ambientes para web apps no App Service do Azure de teste</span><span class="sxs-lookup"><span data-stu-id="66a5e-295">Set up staging environments for web apps in Azure App Service</span></span>](web-sites-staged-publishing.md)
* [<span data-ttu-id="66a5e-296">Implementar uma aplicação complexa previsibilidade no Azure</span><span class="sxs-lookup"><span data-stu-id="66a5e-296">Deploy a complex application predictably in Azure</span></span>](app-service-deploy-complex-application-predictably.md)
* [<span data-ttu-id="66a5e-297">Criação de modelos Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="66a5e-297">Authoring Azure Resource Manager Templates</span></span>](../azure-resource-manager/resource-group-authoring-templates.md)
* [<span data-ttu-id="66a5e-298">JSONLint - Olá validador JSON</span><span class="sxs-lookup"><span data-stu-id="66a5e-298">JSONLint - hello JSON Validator</span></span>](http://jsonlint.com/)
* [<span data-ttu-id="66a5e-299">A ramificação Git – básico ramificação e intercalação</span><span class="sxs-lookup"><span data-stu-id="66a5e-299">Git Branching – Basic Branching and Merging</span></span>](http://www.git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging)
* [<span data-ttu-id="66a5e-300">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="66a5e-300">Azure PowerShell</span></span>](/powershell/azure/overview)
* [<span data-ttu-id="66a5e-301">Wiki do Kudu projeto</span><span class="sxs-lookup"><span data-stu-id="66a5e-301">Project Kudu Wiki</span></span>](https://github.com/projectkudu/kudu/wiki)
