---
title: aaaConfigure uma rede Virtual para uma Cache de Redis do Azure Premium | Microsoft Docs
description: "Saiba como toocreate e gerir o suporte de rede Virtual para as instâncias de Cache de Redis do Azure do escalão Premium"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 8b1e43a0-a70e-41e6-8994-0ac246d8bf7f
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 05/15/2017
ms.author: sdanie
ms.openlocfilehash: fab715f4d9365ee4c2f8b89d2e2e58768c25b671
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-virtual-network-support-for-a-premium-azure-redis-cache"></a><span data-ttu-id="f2e85-103">Como tooconfigure suporta a rede Virtual para uma Cache de Redis do Azure Premium</span><span class="sxs-lookup"><span data-stu-id="f2e85-103">How tooconfigure Virtual Network Support for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="f2e85-104">Cache de Redis do Azure tem ofertas de cache diferente, que fornecem flexibilidade na escolha de Olá de tamanho da cache e funcionalidades, incluindo as funcionalidades do escalão Premium, tais como clustering, persistência e suporte de rede virtual.</span><span class="sxs-lookup"><span data-stu-id="f2e85-104">Azure Redis Cache has different cache offerings, which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="f2e85-105">Uma VNet é uma rede privada na nuvem de Olá.</span><span class="sxs-lookup"><span data-stu-id="f2e85-105">A VNet is a private network in hello cloud.</span></span> <span data-ttu-id="f2e85-106">Quando uma instância da Cache de Redis do Azure está configurada com uma VNet, não é acessível publicamente e só pode ser acedido a partir de máquinas virtuais e aplicações dentro de Olá VNet.</span><span class="sxs-lookup"><span data-stu-id="f2e85-106">When an Azure Redis Cache instance is configured with a VNet, it is not publicly addressable and can only be accessed from virtual machines and applications within hello VNet.</span></span> <span data-ttu-id="f2e85-107">Este artigo descreve como a rede virtual tooconfigure suportam para uma instância de Cache de Redis do Azure premium.</span><span class="sxs-lookup"><span data-stu-id="f2e85-107">This article describes how tooconfigure virtual network support for a premium Azure Redis Cache instance.</span></span>

> [!NOTE]
> <span data-ttu-id="f2e85-108">Cache de Redis do Azure suporta tanto clássico e as VNets do Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="f2e85-108">Azure Redis Cache supports both classic and Resource Manager VNets.</span></span>
> 
> 

<span data-ttu-id="f2e85-109">Para obter informações sobre outras funcionalidades de cache premium, consulte [introdução toohello Azure Redis escalão Premium da Cache](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="f2e85-109">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="why-vnet"></a><span data-ttu-id="f2e85-110">Por que motivo VNet?</span><span class="sxs-lookup"><span data-stu-id="f2e85-110">Why VNet?</span></span>
<span data-ttu-id="f2e85-111">[Rede Virtual do Azure (VNet)](https://azure.microsoft.com/services/virtual-network/) implementação proporciona maior segurança e isolamento para a Cache de Redis do Azure, bem como sub-redes, políticas de controlo de acesso e outra funcionalidades toofurther restringir o acesso.</span><span class="sxs-lookup"><span data-stu-id="f2e85-111">[Azure Virtual Network (VNet)](https://azure.microsoft.com/services/virtual-network/) deployment provides enhanced security and isolation for your Azure Redis Cache, as well as subnets, access control policies, and other features toofurther restrict access.</span></span>

## <a name="virtual-network-support"></a><span data-ttu-id="f2e85-112">Suporte de rede virtual</span><span class="sxs-lookup"><span data-stu-id="f2e85-112">Virtual network support</span></span>
<span data-ttu-id="f2e85-113">Suporte da virtual Network (VNet) é configurado no Olá **nova Cache de Redis** painel durante a criação da cache.</span><span class="sxs-lookup"><span data-stu-id="f2e85-113">Virtual Network (VNet) support is configured on hello **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="f2e85-114">Assim que tiver selecionado um escalão de preços premium, pode configurar a integração de Redis VNet selecionando uma VNet que está a ser Olá mesma subscrição e localização da cache.</span><span class="sxs-lookup"><span data-stu-id="f2e85-114">Once you have selected a premium pricing tier, you can configure Redis VNet integration by selecting a VNet that is in hello same subscription and location as your cache.</span></span> <span data-ttu-id="f2e85-115">toouse uma nova VNet, criá-la primeiro ao seguir os passos de Olá em [criar uma rede virtual com o portal do Azure de Olá](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) ou [criar uma rede virtual (clássica) utilizando o portal do Azure de Olá](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) e, em seguida, devolver toohello **Nova Cache de Redis** toocreate de painel e configurar a cache de premium.</span><span class="sxs-lookup"><span data-stu-id="f2e85-115">toouse a new VNet, create it first by following hello steps in [Create a virtual network using hello Azure portal](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) or [Create a virtual network (classic) by using hello Azure portal](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) and then return toohello **New Redis Cache** blade toocreate and configure your premium cache.</span></span>

<span data-ttu-id="f2e85-116">tooconfigure Olá VNet para a nova cache, clique em **rede Virtual** no Olá **nova Cache de Redis** painel e selecione Olá pretendido VNet de Olá na lista pendente.</span><span class="sxs-lookup"><span data-stu-id="f2e85-116">tooconfigure hello VNet for your new cache, click **Virtual Network** on hello **New Redis Cache** blade, and select hello desired VNet from hello drop-down list.</span></span>

![Rede virtual][redis-cache-vnet]

<span data-ttu-id="f2e85-118">Selecione Olá sub-rede pretendido de Olá **sub-rede** pendente lista e especifique Olá pretendido **endereço IP estático**.</span><span class="sxs-lookup"><span data-stu-id="f2e85-118">Select hello desired subnet from hello **Subnet** drop-down list, and specify hello desired **Static IP address**.</span></span> <span data-ttu-id="f2e85-119">Se estiver a utilizar um Olá VNet clássica **endereço IP estático** campo é opcional e, se for especificado nenhum, um é escolhido de sub-rede Olá selecionado.</span><span class="sxs-lookup"><span data-stu-id="f2e85-119">If you are using a classic VNet hello **Static IP address** field is optional, and if none is specified, one is chosen from hello selected subnet.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f2e85-120">Quando implementar um tooa a Cache de Redis do Azure VNet do Resource Manager, tem de ser cache Olá numa sub-rede dedicada que contém outros recursos de exceto instâncias de Cache de Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-120">When deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resources except for Azure Redis Cache instances.</span></span> <span data-ttu-id="f2e85-121">Se for feita uma tentativa de toodeploy tooa uma Cache de Redis do Azure VNet do Resource Manager tooa sub-rede que contém outros recursos, a implementação de Olá falha.</span><span class="sxs-lookup"><span data-stu-id="f2e85-121">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet tooa subnet that contains other resources, hello deployment fails.</span></span>
> 
> 

![Rede virtual][redis-cache-vnet-ip]

> [!IMPORTANT]
> <span data-ttu-id="f2e85-123">Azure reserva-se alguns endereços IP dentro de cada sub-rede e estes endereços não podem ser utilizados.</span><span class="sxs-lookup"><span data-stu-id="f2e85-123">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="f2e85-124">Olá primeiro e últimos endereços IP de sub-redes de Olá estão reservados para compatibilidade com o protocolo, juntamente com três endereços mais utilizados para serviços do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-124">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="f2e85-125">Para obter mais informações, consulte [existem restrições sobre como utilizar estas sub-redes de endereços IP?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="f2e85-125">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>
> 
> <span data-ttu-id="f2e85-126">Adição de endereços IP toohello utilizado pela infraestrutura de VNET do Azure Olá, cada Redis instância Olá sub-rede utiliza dois endereços IP por ID de partição horizontal e um endereço IP adicional Olá Balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="f2e85-126">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="f2e85-127">Uma cache agrupado é considerada um de toohave partições horizontais.</span><span class="sxs-lookup"><span data-stu-id="f2e85-127">A non-clustered cache is considered toohave one shard.</span></span>
> 
> 

<span data-ttu-id="f2e85-128">Depois de criar a cache de Olá, pode ver configuração Olá Olá VNet clicando **rede Virtual** de Olá **menu recursos**.</span><span class="sxs-lookup"><span data-stu-id="f2e85-128">After hello cache is created, you can view hello configuration for hello VNet by clicking **Virtual Network** from hello **Resource menu**.</span></span>

![Rede virtual][redis-cache-vnet-info]

<span data-ttu-id="f2e85-130">tooconnect tooyour Azure Redis cache instância quando utilizar uma VNet, especifique o nome de anfitrião de Olá da cache na cadeia de ligação de Olá conforme mostrado no seguinte exemplo de Olá:</span><span class="sxs-lookup"><span data-stu-id="f2e85-130">tooconnect tooyour Azure Redis cache instance when using a VNet, specify hello host name of your cache in hello connection string as shown in hello following example:</span></span>

    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("contoso5premium.redis.cache.windows.net,abortConnect=false,ssl=true,password=password");
    });

    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }

## <a name="azure-redis-cache-vnet-faq"></a><span data-ttu-id="f2e85-131">Cache de Redis do Azure VNet FAQ</span><span class="sxs-lookup"><span data-stu-id="f2e85-131">Azure Redis Cache VNet FAQ</span></span>
<span data-ttu-id="f2e85-132">Olá seguinte lista contém toocommonly respostas perguntas mais sobre o dimensionamento do Olá a Cache de Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-132">hello following list contains answers toocommonly asked questions about hello Azure Redis Cache scaling.</span></span>

* [<span data-ttu-id="f2e85-133">Quais são alguns problemas de configuração incorreta comum com a Cache de Redis do Azure e as VNets?</span><span class="sxs-lookup"><span data-stu-id="f2e85-133">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>](#what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets)
* [<span data-ttu-id="f2e85-134">Como verificar se a minha cache está a funcionar numa VNET?</span><span class="sxs-lookup"><span data-stu-id="f2e85-134">How can I verify that my cache is working in a VNET?</span></span>](#how-can-i-verify-that-my-cache-is-working-in-a-vnet)
* [<span data-ttu-id="f2e85-135">Pode utilizar as VNets com uma cache básica ou padrão?</span><span class="sxs-lookup"><span data-stu-id="f2e85-135">Can I use VNets with a standard or basic cache?</span></span>](#can-i-use-vnets-with-a-standard-or-basic-cache)
* [<span data-ttu-id="f2e85-136">Por que motivo criar uma cache de Redis falha na algumas sub-redes, mas não a outros utilizadores?</span><span class="sxs-lookup"><span data-stu-id="f2e85-136">Why does creating a Redis cache fail in some subnets but not others?</span></span>](#why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others)
* [<span data-ttu-id="f2e85-137">Quais são os requisitos de espaço de endereço de sub-rede Olá?</span><span class="sxs-lookup"><span data-stu-id="f2e85-137">What are hello subnet address space requirements?</span></span>](#what-are-the-subnet-address-space-requirements)
* [<span data-ttu-id="f2e85-138">Todas as funcionalidades de cache funcionam quando alojam uma cache numa VNET?</span><span class="sxs-lookup"><span data-stu-id="f2e85-138">Do all cache features work when hosting a cache in a VNET?</span></span>](#do-all-cache-features-work-when-hosting-a-cache-in-a-vnet)

## <a name="what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets"></a><span data-ttu-id="f2e85-139">Quais são alguns problemas de configuração incorreta comum com a Cache de Redis do Azure e as VNets?</span><span class="sxs-lookup"><span data-stu-id="f2e85-139">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>
<span data-ttu-id="f2e85-140">Quando a Cache de Redis do Azure está alojada numa VNet, portas de Olá no Olá tabelas a seguir são utilizadas.</span><span class="sxs-lookup"><span data-stu-id="f2e85-140">When Azure Redis Cache is hosted in a VNet, hello ports in hello following tables are used.</span></span> 

>[!IMPORTANT]
><span data-ttu-id="f2e85-141">Se estiverem bloqueadas portas Olá Olá tabelas a seguir, a cache de Olá poderá não funcionar corretamente.</span><span class="sxs-lookup"><span data-stu-id="f2e85-141">If hello ports in hello following tables are blocked, hello cache may not function correctly.</span></span> <span data-ttu-id="f2e85-142">Um ou mais destas portas bloqueadas é ter problema de configuração incorreta mais comuns Olá ao utilizar a Cache de Redis do Azure numa VNet.</span><span class="sxs-lookup"><span data-stu-id="f2e85-142">Having one or more of these ports blocked is hello most common misconfiguration issue when using Azure Redis Cache in a VNet.</span></span>
> 
> 

- [<span data-ttu-id="f2e85-143">Requisitos de porta de saída</span><span class="sxs-lookup"><span data-stu-id="f2e85-143">Outbound port requirements</span></span>](#outbound-port-requirements)
- [<span data-ttu-id="f2e85-144">Requisitos de porta de entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-144">Inbound port requirements</span></span>](#inbound-port-requirements)

### <a name="outbound-port-requirements"></a><span data-ttu-id="f2e85-145">Requisitos de porta de saída</span><span class="sxs-lookup"><span data-stu-id="f2e85-145">Outbound port requirements</span></span>

<span data-ttu-id="f2e85-146">Existem sete requisitos de porta de saída.</span><span class="sxs-lookup"><span data-stu-id="f2e85-146">There are seven outbound port requirements.</span></span>

- <span data-ttu-id="f2e85-147">Se assim o desejar, todas as ligações de saída toohello, internet pode ser efetuadas através de um cliente no local auditoria do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f2e85-147">If desired, all outbound connections toohello internet can be made through a client's on-premises auditing device.</span></span>
- <span data-ttu-id="f2e85-148">Três portas Olá encaminhar pontos finais de tooAzure de tráfego de manutenção do armazenamento do Azure e o DNS do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-148">Three of hello ports route traffic tooAzure endpoints servicing Azure Storage and Azure DNS.</span></span>
- <span data-ttu-id="f2e85-149">Olá restantes intervalos de portas e para comunicações de sub-rede internas do Redis.</span><span class="sxs-lookup"><span data-stu-id="f2e85-149">hello remaining port ranges and for internal Redis subnet communications.</span></span> <span data-ttu-id="f2e85-150">Não existem regras NSG de sub-rede são necessárias para comunicações de sub-rede internas do Redis.</span><span class="sxs-lookup"><span data-stu-id="f2e85-150">No subnet NSG rules are required for internal Redis subnet communications.</span></span>

| <span data-ttu-id="f2e85-151">Portas</span><span class="sxs-lookup"><span data-stu-id="f2e85-151">Port(s)</span></span> | <span data-ttu-id="f2e85-152">Direção</span><span class="sxs-lookup"><span data-stu-id="f2e85-152">Direction</span></span> | <span data-ttu-id="f2e85-153">Protocolo de transporte</span><span class="sxs-lookup"><span data-stu-id="f2e85-153">Transport Protocol</span></span> | <span data-ttu-id="f2e85-154">Objetivo</span><span class="sxs-lookup"><span data-stu-id="f2e85-154">Purpose</span></span> | <span data-ttu-id="f2e85-155">Local IP</span><span class="sxs-lookup"><span data-stu-id="f2e85-155">Local IP</span></span> | <span data-ttu-id="f2e85-156">IP remoto</span><span class="sxs-lookup"><span data-stu-id="f2e85-156">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="f2e85-157">80, 443</span><span class="sxs-lookup"><span data-stu-id="f2e85-157">80, 443</span></span> |<span data-ttu-id="f2e85-158">Saída</span><span class="sxs-lookup"><span data-stu-id="f2e85-158">Outbound</span></span> |<span data-ttu-id="f2e85-159">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-159">TCP</span></span> |<span data-ttu-id="f2e85-160">Redis dependências no Azure armazenamento/PKI (Internet)</span><span class="sxs-lookup"><span data-stu-id="f2e85-160">Redis dependencies on Azure Storage/PKI (Internet)</span></span> | <span data-ttu-id="f2e85-161">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-161">(Redis subnet)</span></span> |* |
| <span data-ttu-id="f2e85-162">53</span><span class="sxs-lookup"><span data-stu-id="f2e85-162">53</span></span> |<span data-ttu-id="f2e85-163">Saída</span><span class="sxs-lookup"><span data-stu-id="f2e85-163">Outbound</span></span> |<span data-ttu-id="f2e85-164">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="f2e85-164">TCP/UDP</span></span> |<span data-ttu-id="f2e85-165">Redis dependências no DNS (Internet/VNet)</span><span class="sxs-lookup"><span data-stu-id="f2e85-165">Redis dependencies on DNS (Internet/VNet)</span></span> | <span data-ttu-id="f2e85-166">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-166">(Redis subnet)</span></span> |* |
| <span data-ttu-id="f2e85-167">8443</span><span class="sxs-lookup"><span data-stu-id="f2e85-167">8443</span></span> |<span data-ttu-id="f2e85-168">Saída</span><span class="sxs-lookup"><span data-stu-id="f2e85-168">Outbound</span></span> |<span data-ttu-id="f2e85-169">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-169">TCP</span></span> |<span data-ttu-id="f2e85-170">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="f2e85-170">Internal communications for Redis</span></span> | <span data-ttu-id="f2e85-171">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-171">(Redis subnet)</span></span> | <span data-ttu-id="f2e85-172">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-172">(Redis subnet)</span></span> |
| <span data-ttu-id="f2e85-173">10221-10231</span><span class="sxs-lookup"><span data-stu-id="f2e85-173">10221-10231</span></span> |<span data-ttu-id="f2e85-174">Saída</span><span class="sxs-lookup"><span data-stu-id="f2e85-174">Outbound</span></span> |<span data-ttu-id="f2e85-175">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-175">TCP</span></span> |<span data-ttu-id="f2e85-176">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="f2e85-176">Internal communications for Redis</span></span> | <span data-ttu-id="f2e85-177">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-177">(Redis subnet)</span></span> | <span data-ttu-id="f2e85-178">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-178">(Redis subnet)</span></span> |
| <span data-ttu-id="f2e85-179">20226</span><span class="sxs-lookup"><span data-stu-id="f2e85-179">20226</span></span> |<span data-ttu-id="f2e85-180">Saída</span><span class="sxs-lookup"><span data-stu-id="f2e85-180">Outbound</span></span> |<span data-ttu-id="f2e85-181">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-181">TCP</span></span> |<span data-ttu-id="f2e85-182">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="f2e85-182">Internal communications for Redis</span></span> | <span data-ttu-id="f2e85-183">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-183">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-184">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-184">(Redis subnet)</span></span> |
| <span data-ttu-id="f2e85-185">13000-13999</span><span class="sxs-lookup"><span data-stu-id="f2e85-185">13000-13999</span></span> |<span data-ttu-id="f2e85-186">Saída</span><span class="sxs-lookup"><span data-stu-id="f2e85-186">Outbound</span></span> |<span data-ttu-id="f2e85-187">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-187">TCP</span></span> |<span data-ttu-id="f2e85-188">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="f2e85-188">Internal communications for Redis</span></span> | <span data-ttu-id="f2e85-189">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-189">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-190">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-190">(Redis subnet)</span></span> |
| <span data-ttu-id="f2e85-191">15000-15999</span><span class="sxs-lookup"><span data-stu-id="f2e85-191">15000-15999</span></span> |<span data-ttu-id="f2e85-192">Saída</span><span class="sxs-lookup"><span data-stu-id="f2e85-192">Outbound</span></span> |<span data-ttu-id="f2e85-193">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-193">TCP</span></span> |<span data-ttu-id="f2e85-194">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="f2e85-194">Internal communications for Redis</span></span> | <span data-ttu-id="f2e85-195">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-195">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-196">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-196">(Redis subnet)</span></span> |


### <a name="inbound-port-requirements"></a><span data-ttu-id="f2e85-197">Requisitos de porta de entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-197">Inbound port requirements</span></span>

<span data-ttu-id="f2e85-198">Existem oito requisitos de intervalo de portas de entrada.</span><span class="sxs-lookup"><span data-stu-id="f2e85-198">There are eight inbound port range requirements.</span></span> <span data-ttu-id="f2e85-199">Pedidos de entrada nestes intervalos são uma entrada de outros serviços alojados no Olá mesma VNET ou toohello interno comunicações de sub-rede de Redis.</span><span class="sxs-lookup"><span data-stu-id="f2e85-199">Inbound requests in these ranges are either inbound from other services hosted in hello same VNET or internal toohello Redis subnet communications.</span></span>

| <span data-ttu-id="f2e85-200">Portas</span><span class="sxs-lookup"><span data-stu-id="f2e85-200">Port(s)</span></span> | <span data-ttu-id="f2e85-201">Direção</span><span class="sxs-lookup"><span data-stu-id="f2e85-201">Direction</span></span> | <span data-ttu-id="f2e85-202">Protocolo de transporte</span><span class="sxs-lookup"><span data-stu-id="f2e85-202">Transport Protocol</span></span> | <span data-ttu-id="f2e85-203">Objetivo</span><span class="sxs-lookup"><span data-stu-id="f2e85-203">Purpose</span></span> | <span data-ttu-id="f2e85-204">Local IP</span><span class="sxs-lookup"><span data-stu-id="f2e85-204">Local IP</span></span> | <span data-ttu-id="f2e85-205">IP remoto</span><span class="sxs-lookup"><span data-stu-id="f2e85-205">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="f2e85-206">6379, 6380</span><span class="sxs-lookup"><span data-stu-id="f2e85-206">6379, 6380</span></span> |<span data-ttu-id="f2e85-207">Entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-207">Inbound</span></span> |<span data-ttu-id="f2e85-208">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-208">TCP</span></span> |<span data-ttu-id="f2e85-209">TooRedis de comunicação de cliente, Azure balanceamento de carga</span><span class="sxs-lookup"><span data-stu-id="f2e85-209">Client communication tooRedis, Azure load balancing</span></span> | <span data-ttu-id="f2e85-210">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-210">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-211">Rede virtual, o Balanceador de carga do Azure</span><span class="sxs-lookup"><span data-stu-id="f2e85-211">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="f2e85-212">8443</span><span class="sxs-lookup"><span data-stu-id="f2e85-212">8443</span></span> |<span data-ttu-id="f2e85-213">Entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-213">Inbound</span></span> |<span data-ttu-id="f2e85-214">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-214">TCP</span></span> |<span data-ttu-id="f2e85-215">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="f2e85-215">Internal communications for Redis</span></span> | <span data-ttu-id="f2e85-216">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-216">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-217">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-217">(Redis subnet)</span></span> |
| <span data-ttu-id="f2e85-218">8500</span><span class="sxs-lookup"><span data-stu-id="f2e85-218">8500</span></span> |<span data-ttu-id="f2e85-219">Entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-219">Inbound</span></span> |<span data-ttu-id="f2e85-220">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="f2e85-220">TCP/UDP</span></span> |<span data-ttu-id="f2e85-221">Balanceamento de carga do Azure</span><span class="sxs-lookup"><span data-stu-id="f2e85-221">Azure load balancing</span></span> | <span data-ttu-id="f2e85-222">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-222">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-223">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="f2e85-223">Azure Load Balancer</span></span> |
| <span data-ttu-id="f2e85-224">10221-10231</span><span class="sxs-lookup"><span data-stu-id="f2e85-224">10221-10231</span></span> |<span data-ttu-id="f2e85-225">Entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-225">Inbound</span></span> |<span data-ttu-id="f2e85-226">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-226">TCP</span></span> |<span data-ttu-id="f2e85-227">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="f2e85-227">Internal communications for Redis</span></span> | <span data-ttu-id="f2e85-228">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-228">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-229">(Redis sub-rede), o Balanceador de carga do Azure</span><span class="sxs-lookup"><span data-stu-id="f2e85-229">(Redis subnet), Azure Load Balancer</span></span> |
| <span data-ttu-id="f2e85-230">13000-13999</span><span class="sxs-lookup"><span data-stu-id="f2e85-230">13000-13999</span></span> |<span data-ttu-id="f2e85-231">Entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-231">Inbound</span></span> |<span data-ttu-id="f2e85-232">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-232">TCP</span></span> |<span data-ttu-id="f2e85-233">Comunicação de cliente tooRedis Clusters de balanceamento de carga do Azure</span><span class="sxs-lookup"><span data-stu-id="f2e85-233">Client communication tooRedis Clusters, Azure load balancing</span></span> | <span data-ttu-id="f2e85-234">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-234">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-235">Rede virtual, o Balanceador de carga do Azure</span><span class="sxs-lookup"><span data-stu-id="f2e85-235">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="f2e85-236">15000-15999</span><span class="sxs-lookup"><span data-stu-id="f2e85-236">15000-15999</span></span> |<span data-ttu-id="f2e85-237">Entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-237">Inbound</span></span> |<span data-ttu-id="f2e85-238">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-238">TCP</span></span> |<span data-ttu-id="f2e85-239">TooRedis de comunicação de cliente do Azure, Clusters de balanceamento de carga</span><span class="sxs-lookup"><span data-stu-id="f2e85-239">Client communication tooRedis Clusters, Azure load Balancing</span></span> | <span data-ttu-id="f2e85-240">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-240">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-241">Rede virtual, o Balanceador de carga do Azure</span><span class="sxs-lookup"><span data-stu-id="f2e85-241">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="f2e85-242">16001</span><span class="sxs-lookup"><span data-stu-id="f2e85-242">16001</span></span> |<span data-ttu-id="f2e85-243">Entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-243">Inbound</span></span> |<span data-ttu-id="f2e85-244">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="f2e85-244">TCP/UDP</span></span> |<span data-ttu-id="f2e85-245">Balanceamento de carga do Azure</span><span class="sxs-lookup"><span data-stu-id="f2e85-245">Azure load balancing</span></span> | <span data-ttu-id="f2e85-246">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-246">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-247">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="f2e85-247">Azure Load Balancer</span></span> |
| <span data-ttu-id="f2e85-248">20226</span><span class="sxs-lookup"><span data-stu-id="f2e85-248">20226</span></span> |<span data-ttu-id="f2e85-249">Entrada</span><span class="sxs-lookup"><span data-stu-id="f2e85-249">Inbound</span></span> |<span data-ttu-id="f2e85-250">TCP</span><span class="sxs-lookup"><span data-stu-id="f2e85-250">TCP</span></span> |<span data-ttu-id="f2e85-251">Comunicações internas para Redis</span><span class="sxs-lookup"><span data-stu-id="f2e85-251">Internal communications for Redis</span></span> | <span data-ttu-id="f2e85-252">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-252">(Redis subnet)</span></span> |<span data-ttu-id="f2e85-253">(Redis sub-rede)</span><span class="sxs-lookup"><span data-stu-id="f2e85-253">(Redis subnet)</span></span> |

### <a name="additional-vnet-network-connectivity-requirements"></a><span data-ttu-id="f2e85-254">Requisitos de conectividade de rede VNET adicionais</span><span class="sxs-lookup"><span data-stu-id="f2e85-254">Additional VNET network connectivity requirements</span></span>

<span data-ttu-id="f2e85-255">Existem requisitos de conectividade de rede do Azure Redis Cache que não pode ser cumprido inicialmente numa rede virtual.</span><span class="sxs-lookup"><span data-stu-id="f2e85-255">There are network connectivity requirements for Azure Redis Cache that may not be initially met in a virtual network.</span></span> <span data-ttu-id="f2e85-256">Cache de Redis do Azure requer que todos os Olá os seguintes itens toofunction corretamente quando utilizada dentro de uma rede virtual.</span><span class="sxs-lookup"><span data-stu-id="f2e85-256">Azure Redis Cache requires all hello following items toofunction properly when used within a virtual network.</span></span>

* <span data-ttu-id="f2e85-257">Rede de saída conectividade tooAzure pontos finais do Storage em todo o mundo.</span><span class="sxs-lookup"><span data-stu-id="f2e85-257">Outbound network connectivity tooAzure Storage endpoints worldwide.</span></span> <span data-ttu-id="f2e85-258">Isto inclui pontos finais localizados em Olá mesma região que a instância da Cache de Redis do Azure de Olá, bem como pontos finais de armazenamento localizados na **outros** regiões do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-258">This includes endpoints located in hello same region as hello Azure Redis Cache instance, as well as storage endpoints located in **other** Azure regions.</span></span> <span data-ttu-id="f2e85-259">Pontos finais de armazenamento do Azure resolver em Olá seguintes domínios DNS: *w*, *w*, *q*e *w*.</span><span class="sxs-lookup"><span data-stu-id="f2e85-259">Azure Storage endpoints resolve under hello following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*, and *file.core.windows.net*.</span></span> 
* <span data-ttu-id="f2e85-260">Saída conectividade de rede demasiado*ocsp.msocsp.com*, *mscrl.microsoft.com*, e *crl.microsoft.com*. Este conectividade é a funcionalidade SSL toosupport necessários.</span><span class="sxs-lookup"><span data-stu-id="f2e85-260">Outbound network connectivity too*ocsp.msocsp.com*, *mscrl.microsoft.com*, and *crl.microsoft.com*. This connectivity is needed toosupport SSL functionality.</span></span>
* <span data-ttu-id="f2e85-261">configuração de DNS de Olá de rede virtual Olá deve ser capaz de resolver todos os pontos finais de Olá e domínios mencionados Olá pontos anteriores.</span><span class="sxs-lookup"><span data-stu-id="f2e85-261">hello DNS configuration for hello virtual network must be capable of resolving all of hello endpoints and domains mentioned in hello earlier points.</span></span> <span data-ttu-id="f2e85-262">Podem ser cumpridos estes requisitos de DNS, assegurando que configurada e mantida na rede virtual Olá uma infraestrutura de DNS válida.</span><span class="sxs-lookup"><span data-stu-id="f2e85-262">These DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for hello virtual network.</span></span>
* <span data-ttu-id="f2e85-263">Toohello de conectividade de rede de saída seguindo Azure pontos finais de monitorização, que resolver em Olá seguintes domínios DNS: shoebox2 black.shoebox2.metrics.nsatc.net, Norte-prod2.prod2.metrics.nsatc.net azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, Leste-prod2.prod2.metrics.nsatc.net azglobal-red.azglobal.metrics.nsatc.net.</span><span class="sxs-lookup"><span data-stu-id="f2e85-263">Outbound network connectivity toohello following Azure Monitoring endpoints, which resolve under hello following DNS domains: shoebox2-black.shoebox2.metrics.nsatc.net, north-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, east-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span></span>

### <a name="how-can-i-verify-that-my-cache-is-working-in-a-vnet"></a><span data-ttu-id="f2e85-264">Como verificar se a minha cache está a funcionar numa VNET?</span><span class="sxs-lookup"><span data-stu-id="f2e85-264">How can I verify that my cache is working in a VNET?</span></span>

>[!IMPORTANT]
><span data-ttu-id="f2e85-265">Ao ligar a instância de Cache de Redis do Azure tooan que está alojada numa VNET, cache, os clientes têm de estar em Olá mesma VNET, incluindo aplicações de teste ou ferramentas de diagnóstico efetuando o ping.</span><span class="sxs-lookup"><span data-stu-id="f2e85-265">When connecting tooan Azure Redis Cache instance that is hosted in a VNET, your cache clients must be in hello same VNET, including any test applications or diagnostic pinging tools.</span></span>
>
>

<span data-ttu-id="f2e85-266">Depois dos requisitos de portas de Olá estiverem configurados, conforme descrito na secção anterior Olá, pode verificar a sua cache está a funcionar, efetuando Olá os seguintes passos.</span><span class="sxs-lookup"><span data-stu-id="f2e85-266">Once hello port requirements are configured as described in hello previous section, you can verify that your cache is working by performing hello following steps.</span></span>

- <span data-ttu-id="f2e85-267">[Reiniciar](cache-administration.md#reboot) todas Olá nós em cache.</span><span class="sxs-lookup"><span data-stu-id="f2e85-267">[Reboot](cache-administration.md#reboot) all of hello cache nodes.</span></span> <span data-ttu-id="f2e85-268">Se todos os Olá necessário dependências de cache não não possível aceder (conforme documentado no [requisitos de portas de entrada](cache-how-to-premium-vnet.md#inbound-port-requirements) e [requisitos de porta de saída](cache-how-to-premium-vnet.md#outbound-port-requirements)), cache Olá não será capaz de toorestart com êxito.</span><span class="sxs-lookup"><span data-stu-id="f2e85-268">If all of hello required cache dependencies can't be reached (as documented in [Inbound port requirements](cache-how-to-premium-vnet.md#inbound-port-requirements) and [Outbound port requirements](cache-how-to-premium-vnet.md#outbound-port-requirements)), hello cache won't be able toorestart successfully.</span></span>
- <span data-ttu-id="f2e85-269">Depois de nós de cache de Olá reiniciaram (conforme comunicado pelo Estado da cache Olá Olá portal do Azure), pode efetuar Olá seguintes testes:</span><span class="sxs-lookup"><span data-stu-id="f2e85-269">Once hello cache nodes have restarted (as reported by hello cache status in hello Azure portal), you can perform hello following tests:</span></span>
  - <span data-ttu-id="f2e85-270">enviar um ping Olá ponto final da cache (utilizando a porta 6380) de uma máquina que esteja dentro do Olá mesma VNET, como Olá colocar em cache, utilizando [tcping](https://www.elifulkerson.com/projects/tcping.php).</span><span class="sxs-lookup"><span data-stu-id="f2e85-270">ping hello cache endpoint (using port 6380) from a machine that is within hello same VNET as hello cache, using [tcping](https://www.elifulkerson.com/projects/tcping.php).</span></span> <span data-ttu-id="f2e85-271">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f2e85-271">For example:</span></span>
    
    `tcping.exe contosocache.redis.cache.windows.net 6380`
    
    <span data-ttu-id="f2e85-272">Se hello `tcping` ferramenta relatórios que Olá porta está aberta, a cache de Olá está disponível para a ligação de clientes no Olá VNET.</span><span class="sxs-lookup"><span data-stu-id="f2e85-272">If hello `tcping` tool reports that hello port is open, hello cache is available for connection from clients in hello VNET.</span></span>

  - <span data-ttu-id="f2e85-273">Outra forma tootest é toocreate um cliente de cache de teste (que pode ser uma simples aplicação de consola com stackexchange. redis) que liga toohello cache e adiciona e obtém alguns itens da cache de Olá.</span><span class="sxs-lookup"><span data-stu-id="f2e85-273">Another way tootest is toocreate a test cache client (which could be a simple console application using StackExchange.Redis) that connects toohello cache and adds and retrieves some items from hello cache.</span></span> <span data-ttu-id="f2e85-274">Instalar a aplicação de cliente de exemplo de Olá para uma VM que está a ser Olá mesma VNET, como cache de Olá e execute-a cache de toohello tooverify conectividade.</span><span class="sxs-lookup"><span data-stu-id="f2e85-274">Install hello sample client application onto a VM that is in hello same VNET as hello cache and run it tooverify connectivity toohello cache.</span></span>


### <a name="can-i-use-vnets-with-a-standard-or-basic-cache"></a><span data-ttu-id="f2e85-275">Pode utilizar as VNets com uma cache básica ou padrão?</span><span class="sxs-lookup"><span data-stu-id="f2e85-275">Can I use VNets with a standard or basic cache?</span></span>
<span data-ttu-id="f2e85-276">As VNets só pode ser utilizadas com premium caches.</span><span class="sxs-lookup"><span data-stu-id="f2e85-276">VNets can only be used with premium caches.</span></span>

### <a name="why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others"></a><span data-ttu-id="f2e85-277">Por que motivo criar uma cache de Redis falha na algumas sub-redes, mas não a outros utilizadores?</span><span class="sxs-lookup"><span data-stu-id="f2e85-277">Why does creating a Redis cache fail in some subnets but not others?</span></span>
<span data-ttu-id="f2e85-278">Se estiver a implementar um tooa a Cache de Redis do Azure VNet do Resource Manager, tem de ser cache Olá numa sub-rede dedicada com nenhum outro tipo de recurso.</span><span class="sxs-lookup"><span data-stu-id="f2e85-278">If you are deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resource type.</span></span> <span data-ttu-id="f2e85-279">Se for feita uma tentativa de toodeploy tooa uma Cache de Redis do Azure sub-rede da VNet do Resource Manager que contém outros recursos, a implementação de Olá falha.</span><span class="sxs-lookup"><span data-stu-id="f2e85-279">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet subnet that contains other resources, hello deployment fails.</span></span> <span data-ttu-id="f2e85-280">Tem de eliminar recursos existentes de Olá dentro de sub-rede Olá antes de poder criar uma nova cache de Redis.</span><span class="sxs-lookup"><span data-stu-id="f2e85-280">You must delete hello existing resources inside hello subnet before you can create a new Redis cache.</span></span>

<span data-ttu-id="f2e85-281">Pode implementar vários tipos de recursos tooa VNet clássica, desde que tem suficiente IP endereços disponíveis.</span><span class="sxs-lookup"><span data-stu-id="f2e85-281">You can deploy multiple types of resources tooa classic VNet as long as you have enough IP addresses available.</span></span>

### <a name="what-are-hello-subnet-address-space-requirements"></a><span data-ttu-id="f2e85-282">Quais são os requisitos de espaço de endereço de sub-rede Olá?</span><span class="sxs-lookup"><span data-stu-id="f2e85-282">What are hello subnet address space requirements?</span></span>
<span data-ttu-id="f2e85-283">Azure reserva-se alguns endereços IP dentro de cada sub-rede e estes endereços não podem ser utilizados.</span><span class="sxs-lookup"><span data-stu-id="f2e85-283">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="f2e85-284">Olá primeiro e últimos endereços IP de sub-redes de Olá estão reservados para compatibilidade com o protocolo, juntamente com três endereços mais utilizados para serviços do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-284">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="f2e85-285">Para obter mais informações, consulte [existem restrições sobre como utilizar estas sub-redes de endereços IP?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="f2e85-285">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>

<span data-ttu-id="f2e85-286">Adição de endereços IP toohello utilizado pela infraestrutura de VNET do Azure Olá, cada Redis instância Olá sub-rede utiliza dois endereços IP por ID de partição horizontal e um endereço IP adicional Olá Balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="f2e85-286">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="f2e85-287">Uma cache agrupado é considerada um de toohave partições horizontais.</span><span class="sxs-lookup"><span data-stu-id="f2e85-287">A non-clustered cache is considered toohave one shard.</span></span>

### <a name="do-all-cache-features-work-when-hosting-a-cache-in-a-vnet"></a><span data-ttu-id="f2e85-288">Todas as funcionalidades de cache funcionam quando alojam uma cache numa VNET?</span><span class="sxs-lookup"><span data-stu-id="f2e85-288">Do all cache features work when hosting a cache in a VNET?</span></span>
<span data-ttu-id="f2e85-289">Quando a cache faz parte de uma VNET, apenas os clientes Olá VNET podem aceder à cache de Olá.</span><span class="sxs-lookup"><span data-stu-id="f2e85-289">When your cache is part of a VNET, only clients in hello VNET can access hello cache.</span></span> <span data-ttu-id="f2e85-290">Como resultado, hello seguintes funcionalidades de gestão de cache não funcionam neste momento.</span><span class="sxs-lookup"><span data-stu-id="f2e85-290">As a result, hello following cache management features don't work at this time.</span></span>

* <span data-ttu-id="f2e85-291">Consola de redis - porque consola Redis é executado no seu browser local, o que está fora Olá VNET, não é possível ligar tooyour cache.</span><span class="sxs-lookup"><span data-stu-id="f2e85-291">Redis Console - Because Redis Console runs in your local browser, which is outside hello VNET, it can't connect tooyour cache.</span></span>

## <a name="use-expressroute-with-azure-redis-cache"></a><span data-ttu-id="f2e85-292">Utilizar o ExpressRoute com a Cache de Redis do Azure</span><span class="sxs-lookup"><span data-stu-id="f2e85-292">Use ExpressRoute with Azure Redis Cache</span></span>
<span data-ttu-id="f2e85-293">Os clientes podem ligar-se um [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) infraestrutura de rede virtual tootheir de circuito, deste modo, expandir os respetivos tooAzure de rede no local.</span><span class="sxs-lookup"><span data-stu-id="f2e85-293">Customers can connect an [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) circuit tootheir virtual network infrastructure, thus extending their on-premises network tooAzure.</span></span> 

<span data-ttu-id="f2e85-294">Por predefinição, um circuito ExpressRoute criado recentemente não pratica a imposição do túnel (anúncio de uma rota predefinida, 0.0.0.0/0) na VNET.</span><span class="sxs-lookup"><span data-stu-id="f2e85-294">By default, a newly created ExpressRoute circuit does not perform forced tunneling (advertisement of a default route, 0.0.0.0/0) on a VNET.</span></span> <span data-ttu-id="f2e85-295">Como resultado, conectividade de Internet de saída é permitida diretamente a partir de Olá VNET e aplicações de cliente são tooother tooconnect capaz de Azure pontos finais, incluindo a Cache de Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-295">As a result, outbound Internet connectivity is allowed directly from hello VNET and client applications are able tooconnect tooother Azure endpoints including Azure Redis Cache.</span></span>

<span data-ttu-id="f2e85-296">No entanto uma configuração de cliente comum é toouse imposição do túnel (anunciar uma rota predefinida) que força a saída Internet tráfego tooinstead fluxo no local.</span><span class="sxs-lookup"><span data-stu-id="f2e85-296">However a common customer configuration is toouse forced tunneling (advertise a default route) which forces outbound Internet traffic tooinstead flow on-premises.</span></span> <span data-ttu-id="f2e85-297">Este fluxo de tráfego de quebras de conectividade com a Cache de Redis do Azure se o tráfego de saída Olá, em seguida, bloqueado no local que hello instância da Cache de Redis do Azure não é possível toocommunicate com as respetivas dependências.</span><span class="sxs-lookup"><span data-stu-id="f2e85-297">This traffic flow breaks connectivity with Azure Redis Cache if hello outbound traffic is then blocked on-premises such that hello Azure Redis Cache instance is not able toocommunicate with its dependencies.</span></span>

<span data-ttu-id="f2e85-298">solução de Olá é toodefine um (ou mais) definido pelo utilizador rotas (UDRs) na sub-rede Olá que contém Olá a Cache de Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-298">hello solution is toodefine one (or more) user-defined routes (UDRs) on hello subnet that contains hello Azure Redis Cache.</span></span> <span data-ttu-id="f2e85-299">Um UDR define as rotas de sub-rede específicos que serão cumpridas em vez de rota predefinida de Olá.</span><span class="sxs-lookup"><span data-stu-id="f2e85-299">A UDR defines subnet-specific routes that will be honored instead of hello default route.</span></span>

<span data-ttu-id="f2e85-300">Se for possível, recomenda-se Olá toouse seguinte configuração:</span><span class="sxs-lookup"><span data-stu-id="f2e85-300">If possible, it is recommended toouse hello following configuration:</span></span>

* <span data-ttu-id="f2e85-301">configuração do ExpressRoute Olá anuncia 0.0.0.0/0 e por predefinição, force túneis todos os tráfego de saída no local.</span><span class="sxs-lookup"><span data-stu-id="f2e85-301">hello ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="f2e85-302">Olá UDR aplicada toohello sub-rede que contém Olá a Cache de Redis do Azure define 0.0.0.0/0 com uma rota de trabalho para TCP/IP tráfego toohello internet pública; Por exemplo pela definição Olá próximo salto too'Internet de tipo '.</span><span class="sxs-lookup"><span data-stu-id="f2e85-302">hello UDR applied toohello subnet containing hello Azure Redis Cache defines 0.0.0.0/0 with a working route for TCP/IP traffic toohello public internet; for example by setting hello next hop type too'Internet'.</span></span>

<span data-ttu-id="f2e85-303">Olá efeito combinado destes passos é que o nível de sub-rede Olá UDR tem precedência sobre Olá ExpressRoute imposição do túnel, que garante a saída acesso à Internet de Olá a Cache de Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-303">hello combined effect of these steps is that hello subnet level UDR takes precedence over hello ExpressRoute forced tunneling, thus ensuring outbound Internet access from hello Azure Redis Cache.</span></span>

<span data-ttu-id="f2e85-304">Instância de Cache de Redis do Azure tooan ao ligar a uma aplicação no local com o ExpressRoute não é um cenário de utilização normal devido a razões tooperformance (para um melhor desempenho a Cache de Redis do Azure, os clientes devem estar em Olá mesma região que Olá a Cache de Redis do Azure).</span><span class="sxs-lookup"><span data-stu-id="f2e85-304">Connecting tooan Azure Redis Cache instance from an on-premises application using ExpressRoute is not a typical usage scenario due tooperformance reasons (for best performance Azure Redis Cache clients should be in hello same region as hello Azure Redis Cache).</span></span>

>[!IMPORTANT] 
><span data-ttu-id="f2e85-305">Olá rotas definidas num UDR **tem** ser específico o suficiente tootake precedência sobre qualquer rotas anunciadas pela configuração do ExpressRoute Olá.</span><span class="sxs-lookup"><span data-stu-id="f2e85-305">hello routes defined in a UDR **must** be specific enough tootake precedence over any routes advertised by hello ExpressRoute configuration.</span></span> <span data-ttu-id="f2e85-306">Olá exemplo seguinte utiliza o intervalo de endereços Olá 0.0.0.0/0 abrangente e como tal, pode potencialmente ser acidentalmente substituído pelo anúncios de rota utilizando intervalos de endereços mais específicos.</span><span class="sxs-lookup"><span data-stu-id="f2e85-306">hello following example uses hello broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>

>[!WARNING]  
><span data-ttu-id="f2e85-307">Cache de Redis do Azure não é suportado com configurações de ExpressRoute que **incorretamente cross-anunciar rotas de Olá caminho toohello privada peering caminho de peering público**.</span><span class="sxs-lookup"><span data-stu-id="f2e85-307">Azure Redis Cache is not supported with ExpressRoute configurations that **incorrectly cross-advertise routes from hello public peering path toohello private peering path**.</span></span> <span data-ttu-id="f2e85-308">Configurações de ExpressRoute que tenham o peering público configurado, receber anúncios de rota da Microsoft para um grande conjunto de intervalos de endereços IP do Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-308">ExpressRoute configurations that have public peering configured, receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="f2e85-309">Se estes intervalos de endereços são incorretamente cross-anunciados no caminho de peering privado Olá, o resultado de Olá é que todos os pacotes de rede de saída da sub-rede de instância Cache de Redis do Azure Olá são rede no local de tooa incorretamente force-em túnel do cliente infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="f2e85-309">If these address ranges are incorrectly cross-advertised on hello private peering path, hello result is that all outbound network packets from hello Azure Redis Cache instance's subnet are incorrectly force-tunneled tooa customer's on-premises network infrastructure.</span></span> <span data-ttu-id="f2e85-310">Este fluxo de rede de quebras de Cache de Redis do Azure.</span><span class="sxs-lookup"><span data-stu-id="f2e85-310">This network flow breaks Azure Redis Cache.</span></span> <span data-ttu-id="f2e85-311">problema de toothis Olá solução é rotas de publicidade entre toostop de Olá caminho toohello privada peering caminho de peering público.</span><span class="sxs-lookup"><span data-stu-id="f2e85-311">hello solution toothis problem is toostop cross-advertising routes from hello public peering path toohello private peering path.</span></span>


<span data-ttu-id="f2e85-312">Informações de fundo sobre rotas definidas pelo utilizador estão disponíveis neste [descrição geral](../virtual-network/virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f2e85-312">Background information on user-defined routes is available in this [overview](../virtual-network/virtual-networks-udr-overview.md).</span></span>

<span data-ttu-id="f2e85-313">Para obter mais informações sobre o ExpressRoute, consulte [descrição geral técnica do ExpressRoute](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="f2e85-313">For more information about ExpressRoute, see [ExpressRoute technical overview](../expressroute/expressroute-introduction.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="f2e85-314">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="f2e85-314">Next steps</span></span>
<span data-ttu-id="f2e85-315">Saiba como toouse mais premium cache funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="f2e85-315">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="f2e85-316">Introdução toohello Azure Redis escalão Premium da Cache</span><span class="sxs-lookup"><span data-stu-id="f2e85-316">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-vnet]: ./media/cache-how-to-premium-vnet/redis-cache-vnet.png

[redis-cache-vnet-ip]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-ip.png

[redis-cache-vnet-info]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-info.png

