---
title: "utilização de aaaAdvanced dos Reliable Services | Microsoft Docs"
description: "Saiba mais sobre a utilização avançada de Service Fabric Reliable Services flexibilidade adicional nos seus serviços."
services: Service-Fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: masnider
ms.assetid: f2942871-863d-47c3-b14a-7cdad9a742c7
ms.service: Service-Fabric
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: e6d6310a4deae9edcfcd76551e1337f0e39e9e5d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="advanced-usage-of-hello-reliable-services-programming-model"></a><span data-ttu-id="3c25d-103">Utilização de Olá Reliable Services modelo de programação de avançadas</span><span class="sxs-lookup"><span data-stu-id="3c25d-103">Advanced usage of hello Reliable Services programming model</span></span>
<span data-ttu-id="3c25d-104">Azure Service Fabric simplifica escrever e gerir serviços sem monitorização de estado e com monitorização de estado fiáveis.</span><span class="sxs-lookup"><span data-stu-id="3c25d-104">Azure Service Fabric simplifies writing and managing reliable stateless and stateful services.</span></span> <span data-ttu-id="3c25d-105">Este guia aborda as utilizações avançadas de toogain Reliable Services mais controlo e flexibilidade sobre os serviços.</span><span class="sxs-lookup"><span data-stu-id="3c25d-105">This guide talks about advanced usages of Reliable Services toogain more control and flexibility over your services.</span></span> <span data-ttu-id="3c25d-106">Tooreading antes de este guia, familiarize-se com [o modelo de programação do Olá Reliable Services](service-fabric-reliable-services-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="3c25d-106">Prior tooreading this guide, familiarize yourself with [hello Reliable Services programming model](service-fabric-reliable-services-introduction.md).</span></span>

<span data-ttu-id="3c25d-107">Serviços com monitorização de estado e sem monitorização de estado tem dois pontos de entrada principal para o código de utilizador:</span><span class="sxs-lookup"><span data-stu-id="3c25d-107">Both stateful and stateless services have two primary entry points for user code:</span></span>

* <span data-ttu-id="3c25d-108">`RunAsync(C#) / runAsync(Java)`é um ponto de entrada para fins gerais para o seu código de serviço.</span><span class="sxs-lookup"><span data-stu-id="3c25d-108">`RunAsync(C#) / runAsync(Java)` is a general-purpose entry point for your service code.</span></span>
* <span data-ttu-id="3c25d-109">`CreateServiceReplicaListeners(C#)`e `CreateServiceInstanceListeners(C#) / createServiceInstanceListeners(Java)` é para abrir os serviços de escuta de comunicação para pedidos de cliente.</span><span class="sxs-lookup"><span data-stu-id="3c25d-109">`CreateServiceReplicaListeners(C#)` and `CreateServiceInstanceListeners(C#) / createServiceInstanceListeners(Java)` is for opening communication listeners for client requests.</span></span>

<span data-ttu-id="3c25d-110">Para a maioria dos serviços, estes pontos de duas entrada são suficientes.</span><span class="sxs-lookup"><span data-stu-id="3c25d-110">For most services, these two entry points are sufficient.</span></span> <span data-ttu-id="3c25d-111">Em casos raros quando mais controlo sobre o ciclo de vida de um serviço é necessário, os eventos de ciclo de vida adicionais estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="3c25d-111">In rare cases when more control over a service's lifecycle is required, additional lifecycle events are available.</span></span>

## <a name="stateless-service-instance-lifecycle"></a><span data-ttu-id="3c25d-112">Ciclo de vida de instância de serviço sem monitorização de estado</span><span class="sxs-lookup"><span data-stu-id="3c25d-112">Stateless service instance lifecycle</span></span>
<span data-ttu-id="3c25d-113">Ciclo de vida de um serviço sem monitorização de estado é muito simple.</span><span class="sxs-lookup"><span data-stu-id="3c25d-113">A stateless service's lifecycle is very simple.</span></span> <span data-ttu-id="3c25d-114">Um serviço sem estado só pode ser aberto, fechado ou abortado.</span><span class="sxs-lookup"><span data-stu-id="3c25d-114">A stateless service can only be opened, closed, or aborted.</span></span> <span data-ttu-id="3c25d-115">`RunAsync`num serviço sem monitorização de estado é executado quando uma instância de serviço é aberta e cancelada quando uma instância de serviço está fechada ou abortada.</span><span class="sxs-lookup"><span data-stu-id="3c25d-115">`RunAsync` in a stateless service is executed when a service instance is opened, and canceled when a service instance is closed or aborted.</span></span>

<span data-ttu-id="3c25d-116">Embora `RunAsync` deve ser suficiente na quase todos os casos, Olá aberto, feche e eventos de abortar num serviço sem monitorização de estado também estão disponíveis:</span><span class="sxs-lookup"><span data-stu-id="3c25d-116">Although `RunAsync` should be sufficient in almost all cases, hello open, close, and abort events in a stateless service are also available:</span></span>

* <span data-ttu-id="3c25d-117">`Task OnOpenAsync(IStatelessServicePartition, CancellationToken) - C# / CompletableFuture<String> onOpenAsync(CancellationToken) - Java`OnOpenAsync é chamado quando a instância de serviço sem monitorização de estado de Olá é sobre toobe utilizado.</span><span class="sxs-lookup"><span data-stu-id="3c25d-117">`Task OnOpenAsync(IStatelessServicePartition, CancellationToken) - C# / CompletableFuture<String> onOpenAsync(CancellationToken) - Java` OnOpenAsync is called when hello stateless service instance is about toobe used.</span></span> <span data-ttu-id="3c25d-118">Tarefas de inicialização do serviço expandida podem ser iniciadas neste momento.</span><span class="sxs-lookup"><span data-stu-id="3c25d-118">Extended service initialization tasks can be started at this time.</span></span>
* <span data-ttu-id="3c25d-119">`Task OnCloseAsync(CancellationToken) - C# / CompletableFuture onCloseAsync(CancellationToken) - Java`OnCloseAsync é chamado quando a instância de serviço sem monitorização de estado de Olá vai toobe corretamente encerrado para baixo.</span><span class="sxs-lookup"><span data-stu-id="3c25d-119">`Task OnCloseAsync(CancellationToken) - C# / CompletableFuture onCloseAsync(CancellationToken) - Java` OnCloseAsync is called when hello stateless service instance is going toobe gracefully shut down.</span></span> <span data-ttu-id="3c25d-120">Isto pode ocorrer quando o código do serviço de Olá está a ser atualizado, instância de serviço Olá está a ser movida devido tooload balanceamento ou foi detetado um erro transitório.</span><span class="sxs-lookup"><span data-stu-id="3c25d-120">This can occur when hello service's code is being upgraded, hello service instance is being moved due tooload balancing, or a transient fault is detected.</span></span> <span data-ttu-id="3c25d-121">OnCloseAsync podem utilizado toosafely feche quaisquer recursos, pare qualquer processamento em segundo plano, concluir guardar Estado externo ou fechar-se para baixo de ligações existentes.</span><span class="sxs-lookup"><span data-stu-id="3c25d-121">OnCloseAsync can be used toosafely close any resources, stop any background processing, finish saving external state, or close down existing connections.</span></span>
* <span data-ttu-id="3c25d-122">`void OnAbort() - C# / void onAbort() - Java`OnAbort é chamado quando a instância de serviço sem monitorização de estado de Olá está a ser forçadamente encerrada.</span><span class="sxs-lookup"><span data-stu-id="3c25d-122">`void OnAbort() - C# / void onAbort() - Java` OnAbort is called when hello stateless service instance is being forcefully shut down.</span></span> <span data-ttu-id="3c25d-123">Esta opção geralmente é chamada quando é detetada uma falha permanente num nó de hello, ou quando o Service Fabric fiável não pode gerir o ciclo de vida de instância de serviço a Olá devido a falhas de toointernal.</span><span class="sxs-lookup"><span data-stu-id="3c25d-123">This is generally called when a permanent fault is detected on hello node, or when Service Fabric cannot reliably manage hello service instance's lifecycle due toointernal failures.</span></span>

## <a name="stateful-service-replica-lifecycle"></a><span data-ttu-id="3c25d-124">Ciclo de vida de réplica de serviço com estado</span><span class="sxs-lookup"><span data-stu-id="3c25d-124">Stateful service replica lifecycle</span></span>

> [!NOTE]
> <span data-ttu-id="3c25d-125">Serviços fiáveis com monitorização de estado não são suportados ainda em Java.</span><span class="sxs-lookup"><span data-stu-id="3c25d-125">Stateful reliable services are not supported in Java yet.</span></span>
>
>

<span data-ttu-id="3c25d-126">Ciclo de vida de uma réplica de serviço com estado é muito mais complexo do que uma instância de serviço sem estado.</span><span class="sxs-lookup"><span data-stu-id="3c25d-126">A stateful service replica's lifecycle is much more complex than a stateless service instance.</span></span> <span data-ttu-id="3c25d-127">Além disso tooopen, fechar e abortar eventos, uma réplica de serviço com estado sofre alterações de função durante a respetiva duração.</span><span class="sxs-lookup"><span data-stu-id="3c25d-127">In addition tooopen, close, and abort events, a stateful service replica undergoes role changes during its lifetime.</span></span> <span data-ttu-id="3c25d-128">Quando uma réplica de serviço com estado é alterado função, Olá `OnChangeRoleAsync` evento é acionado:</span><span class="sxs-lookup"><span data-stu-id="3c25d-128">When a stateful service replica changes role, hello `OnChangeRoleAsync` event is triggered:</span></span>

* <span data-ttu-id="3c25d-129">`Task OnChangeRoleAsync(ReplicaRole, CancellationToken)`OnChangeRoleAsync é chamado quando a réplica de serviço com estado Olá está a alterar função, por exemplo, tooprimary ou secundário.</span><span class="sxs-lookup"><span data-stu-id="3c25d-129">`Task OnChangeRoleAsync(ReplicaRole, CancellationToken)` OnChangeRoleAsync is called when hello stateful service replica is changing role, for example tooprimary or secondary.</span></span> <span data-ttu-id="3c25d-130">Réplicas primárias recebem o estado de escrita (são permitidos toocreate e escrever tooReliable coleções).</span><span class="sxs-lookup"><span data-stu-id="3c25d-130">Primary replicas are given write status (are allowed toocreate and write tooReliable Collections).</span></span> <span data-ttu-id="3c25d-131">As réplicas secundárias são indicadas o estado de leitura (pode apenas ler a partir do coleções fiável existente).</span><span class="sxs-lookup"><span data-stu-id="3c25d-131">Secondary replicas are given read status (can only read from existing Reliable Collections).</span></span> <span data-ttu-id="3c25d-132">A maioria das trabalho num serviço de monitorização de estado é efetuado na réplica primária Olá.</span><span class="sxs-lookup"><span data-stu-id="3c25d-132">Most work in a stateful service is performed at hello primary replica.</span></span> <span data-ttu-id="3c25d-133">As réplicas secundárias podem efetuar a validação de só de leitura, a geração de relatórios, extração de dados ou outras tarefas só de leitura.</span><span class="sxs-lookup"><span data-stu-id="3c25d-133">Secondary replicas can perform read-only validation, report generation, data mining, or other read-only jobs.</span></span>

<span data-ttu-id="3c25d-134">Num serviço com monitorização de estado, apenas Olá réplica primária tem acesso de escrita toostate e por isso, normalmente, quando o serviço de Olá está a efetuar o trabalho real.</span><span class="sxs-lookup"><span data-stu-id="3c25d-134">In a stateful service, only hello primary replica has write access toostate and thus is generally when hello service is performing actual work.</span></span> <span data-ttu-id="3c25d-135">Olá `RunAsync` método num serviço de monitorização de estado é executado apenas quando a réplica de serviço com estado Olá é primária.</span><span class="sxs-lookup"><span data-stu-id="3c25d-135">hello `RunAsync` method in a stateful service is executed only when hello stateful service replica is primary.</span></span> <span data-ttu-id="3c25d-136">Olá `RunAsync` método é cancelado quando as alterações da função de uma réplica primária na direção oposta ao site primário, bem como durante Olá fecham e eventos de abortar.</span><span class="sxs-lookup"><span data-stu-id="3c25d-136">hello `RunAsync` method is canceled when a primary replica's role changes away from primary, as well as during hello close and abort events.</span></span>

<span data-ttu-id="3c25d-137">Utilizar Olá `OnChangeRoleAsync` eventos permite-lhe tooperform trabalho dependendo da função de réplica, bem como em alteração toorole de resposta.</span><span class="sxs-lookup"><span data-stu-id="3c25d-137">Using hello `OnChangeRoleAsync` event allows you tooperform work depending on replica role as well as in response toorole change.</span></span>

<span data-ttu-id="3c25d-138">Um serviço com estado fornece também eventos de ciclo de vida de Olá quatro mesmo como um serviço sem monitorização de estado, com Olá a mesma semântica e casos de utilização:</span><span class="sxs-lookup"><span data-stu-id="3c25d-138">A stateful service also provides hello same four lifecycle events as a stateless service, with hello same semantics and use cases:</span></span>

```csharp
* Task OnOpenAsync(IStatefulServicePartition, CancellationToken)
* Task OnCloseAsync(CancellationToken)
* void OnAbort()
```

## <a name="next-steps"></a><span data-ttu-id="3c25d-139">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="3c25d-139">Next steps</span></span>
<span data-ttu-id="3c25d-140">Para mais avançada Tópicos relacionados tooService recursos de infraestrutura, consulte Olá seguintes artigos:</span><span class="sxs-lookup"><span data-stu-id="3c25d-140">For more advanced topics related tooService Fabric, see hello following articles:</span></span>

* [<span data-ttu-id="3c25d-141">Configurar Reliable Services com monitorização de estado</span><span class="sxs-lookup"><span data-stu-id="3c25d-141">Configuring stateful Reliable Services</span></span>](service-fabric-reliable-services-configuration.md)
* [<span data-ttu-id="3c25d-142">Introdução de estado de funcionamento do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="3c25d-142">Service Fabric health introduction</span></span>](service-fabric-health-introduction.md)
* [<span data-ttu-id="3c25d-143">Utilizar relatórios de estado de funcionamento do sistema para resolução de problemas</span><span class="sxs-lookup"><span data-stu-id="3c25d-143">Using system health reports for troubleshooting</span></span>](service-fabric-understand-and-troubleshoot-with-system-health-reports.md)
* [<span data-ttu-id="3c25d-144">Configurar os serviços com Olá Gestor de recursos de Cluster do Service Fabric</span><span class="sxs-lookup"><span data-stu-id="3c25d-144">Configuring Services with hello Service Fabric Cluster Resource Manager</span></span>](service-fabric-cluster-resource-manager-configure-services.md)
