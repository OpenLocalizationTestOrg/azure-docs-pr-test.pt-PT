---
title: aaaMonitor progresso da tarefa por contagem de tarefas por Estado - Azure Batch | Microsoft Docs
description: "Monitorizar o progresso de Olá de uma tarefa chamando a operação de obter a contagem de tarefas Olá toocount tarefas para uma tarefa. Pode obter uma contagem de tarefas do Active Directory, em execução e foi concluídas e, por tarefas que foi concluída com êxito ou falha."
services: batch
author: tamram
manager: timlt
ms.service: batch
ms.topic: article
ms.date: 08/02/2017
ms.author: tamram
ms.openlocfilehash: 03957d8a3d678bf44587f3bc7f988a76885c2af0
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="count-tasks-by-state-toomonitor-a-jobs-progress-preview"></a><span data-ttu-id="4729e-104">Contagem de tarefas por toomonitor de estado de progresso de uma tarefa (pré-visualização)</span><span class="sxs-lookup"><span data-stu-id="4729e-104">Count tasks by state toomonitor a job's progress (Preview)</span></span>

<span data-ttu-id="4729e-105">O Azure Batch fornece um forma eficiente toomonitor Olá progresso uma tarefa executa as respetivas tarefas.</span><span class="sxs-lookup"><span data-stu-id="4729e-105">Azure Batch provides an efficient way toomonitor hello progress of a job as it runs its tasks.</span></span> <span data-ttu-id="4729e-106">Pode chamar Olá [obter contagens de tarefa] [ rest_get_task_counts] operação toofind como muitas tarefas estão num Estado em execução, Active Directory ou foi concluído e tem quantos foi concluída com êxito ou falha.</span><span class="sxs-lookup"><span data-stu-id="4729e-106">You can call hello [Get Task Counts][rest_get_task_counts] operation toofind out how many tasks are in an active, running, or completed state, and how many have succeeded or failed.</span></span> <span data-ttu-id="4729e-107">Por número de Olá das tarefas em cada Estado de contagem, mais facilmente pode apresentar o utilizador de tooa de progresso da tarefa de Olá ou detetar atrasos inesperados ou falhas que podem afetar a tarefa de Olá.</span><span class="sxs-lookup"><span data-stu-id="4729e-107">By counting hello number of tasks in each state, you can more easily display hello job's progress tooa user, or detect unexpected delays or failures that may affect hello job.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4729e-108">Olá operação obter contagens de tarefa está atualmente em pré-visualização e ainda não está disponível no Azure Government, Azure China e Datacenters do Azure.</span><span class="sxs-lookup"><span data-stu-id="4729e-108">hello Get Task Counts operation is currently in preview, and is not yet available in Azure Government, Azure China, and Azure Germany.</span></span> 
>
>

## <a name="how-tasks-are-counted"></a><span data-ttu-id="4729e-109">Como as tarefas são contadas</span><span class="sxs-lookup"><span data-stu-id="4729e-109">How tasks are counted</span></span>

<span data-ttu-id="4729e-110">Olá obter contagens de tarefa operação contagens tarefas por Estado, da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="4729e-110">hello Get Task Counts operation counts tasks by state, as follows:</span></span>

- <span data-ttu-id="4729e-111">Uma tarefa é contabilizada como **Active Directory** quando é toorun em fila e podem, mas não está atualmente atribuída nó de computação tooa.</span><span class="sxs-lookup"><span data-stu-id="4729e-111">A task is counted as **active** when it is queued and able toorun, but is not currently assigned tooa compute node.</span></span> <span data-ttu-id="4729e-112">Uma tarefa também é contabilizada como **Active Directory** se está dependente de uma tarefa principal que ainda não foi concluído.</span><span class="sxs-lookup"><span data-stu-id="4729e-112">A task is also counted as **active** if it is dependent on a parent task that has not yet completed.</span></span> <span data-ttu-id="4729e-113">Para obter mais informações sobre as dependências de tarefas, consulte [criar as dependências de tarefas toorun tarefas que dependem de outras tarefas](batch-task-dependencies.md).</span><span class="sxs-lookup"><span data-stu-id="4729e-113">For more information on task dependencies, see [Create task dependencies toorun tasks that depend on other tasks](batch-task-dependencies.md).</span></span> 
- <span data-ttu-id="4729e-114">Uma tarefa é contabilizada como **executar** quando este foi atribuído um nó de computação tooa, mas ainda não foi concluído.</span><span class="sxs-lookup"><span data-stu-id="4729e-114">A task is counted as **running** when it has been assigned tooa compute node, but has not yet completed.</span></span> <span data-ttu-id="4729e-115">Uma tarefa é contabilizada como **executar** quando o estado é `preparing` ou `running`, conforme indicado pelo Olá [obter informações sobre uma tarefa] [ rest_get_task] operação.</span><span class="sxs-lookup"><span data-stu-id="4729e-115">A task is counted as **running** when its state is either `preparing` or `running`, as indicated by hello [Get information about a task][rest_get_task] operation.</span></span>
- <span data-ttu-id="4729e-116">Uma tarefa é contabilizada como **concluída** quando já não está toorun elegível.</span><span class="sxs-lookup"><span data-stu-id="4729e-116">A task is counted as **completed** when it is no longer eligible toorun.</span></span> <span data-ttu-id="4729e-117">Uma tarefa contabilizado como **concluída** tem normalmente concluída com êxito, ou foi concluída sem êxito e também esgotou o respetivo limite de repetição.</span><span class="sxs-lookup"><span data-stu-id="4729e-117">A task counted as **completed** has typically either finished successfully, or has finished unsuccessfully and has also exhausted its retry limit.</span></span> 

<span data-ttu-id="4729e-118">Olá operação obter contagens de tarefas relatórios também como muitas tarefas tem êxito ou falhou.</span><span class="sxs-lookup"><span data-stu-id="4729e-118">hello Get Task Counts operation also reports how many tasks have succeeded or failed.</span></span> <span data-ttu-id="4729e-119">Batch determina se uma tarefa teve êxito ou falha ao verificar Olá **resultado** propriedade Olá [executionInfo] [https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo] propriedade:</span><span class="sxs-lookup"><span data-stu-id="4729e-119">Batch determines whether a task has succeeded or failed by checking hello **result** property of hello [executionInfo][https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo] property:</span></span>

    - <span data-ttu-id="4729e-120">Uma tarefa é contabilizada como **foi concluída com êxito** se Olá resultado da execução da tarefa é `success`.</span><span class="sxs-lookup"><span data-stu-id="4729e-120">A task is counted as **succeeded** if hello result of task execution is `success`.</span></span>
    - <span data-ttu-id="4729e-121">Uma tarefa é contabilizada como **falha** se Olá resultado da execução da tarefa é `failure`.</span><span class="sxs-lookup"><span data-stu-id="4729e-121">A task is counted as **failed** if hello result of task execution is `failure`.</span></span>

<span data-ttu-id="4729e-122">Para mais informações sobre os Estados de tarefas, consulte [obter informações sobre uma tarefa][rest_get_task].</span><span class="sxs-lookup"><span data-stu-id="4729e-122">For more information about task states, see [Get information about a task][rest_get_task].</span></span>

<span data-ttu-id="4729e-123">Olá .NET código exemplo seguinte mostra como tarefa tooretrieve contagens por Estado:</span><span class="sxs-lookup"><span data-stu-id="4729e-123">hello following .NET code sample shows how tooretrieve task counts by state:</span></span> 

```csharp
var taskCounts = await batchClient.JobOperations.GetTaskCountsAsync("job-1");

Console.WriteLine("Task count in active state: {0}", taskCounts.Active);
Console.WriteLine("Task count in preparing or running state: {0}", taskCounts.Running);
Console.WriteLine("Task count in completed state: {0}", taskCounts.Completed);
Console.WriteLine("Succeeded task count: {0}", taskCounts.Succeeded);
Console.WriteLine("Failed task count: {0}", taskCounts.Failed);
Console.WriteLine("ValidationStatus: {0}", taskCounts.ValidationStatus);
```

> [!NOTE]
> <span data-ttu-id="4729e-124">Pode utilizar um padrão semelhante para REST e outras linguagens tooget tarefas contagem de uma tarefa.</span><span class="sxs-lookup"><span data-stu-id="4729e-124">You can use a similar pattern for REST and other supported languages tooget task counts for a job.</span></span> 
> 
> 

## <a name="consistency-checking-for-task-counts"></a><span data-ttu-id="4729e-125">Verificação de contagens de tarefa de consistência</span><span class="sxs-lookup"><span data-stu-id="4729e-125">Consistency checking for task counts</span></span>

<span data-ttu-id="4729e-126">serviço de Batch de Olá agrega contagens de tarefa por a recolha de dados de várias partes de um sistema distribuída assíncrona.</span><span class="sxs-lookup"><span data-stu-id="4729e-126">hello Batch service aggregates task counts by gathering data from multiple parts of an asynchronous distributed system.</span></span> <span data-ttu-id="4729e-127">tooensure contagens de tarefas estão corretos, o Batch fornece validação adicional para contagens de estado, efetuando as verificações de consistência contra vários componentes do sistema de Olá.</span><span class="sxs-lookup"><span data-stu-id="4729e-127">tooensure that task counts are correct, Batch provides additional validation for state counts by performing consistency checks against multiple components of hello system.</span></span> <span data-ttu-id="4729e-128">Batch executa estas verificações de consistência, desde que existem menos de 200 000 tarefas na tarefa de Olá.</span><span class="sxs-lookup"><span data-stu-id="4729e-128">Batch performs these consistency checks as long as there are fewer than 200,000 tasks in hello job.</span></span> <span data-ttu-id="4729e-129">No Olá improvável eventualidade que a verificação de consistência Olá encontra erros, o Batch corrige resultado de Olá da operação de obter a contagem de tarefas de Olá com base nos resultados de Olá de verificação de consistência Olá.</span><span class="sxs-lookup"><span data-stu-id="4729e-129">In hello unlikely event that hello consistency check finds errors, Batch corrects hello result of hello Get Tasks Counts operation based on hello results of hello consistency check.</span></span> <span data-ttu-id="4729e-130">Olá verificação de consistência é uma tooensure medidas adicionais que os clientes que dependem de Olá operação obter contagens de tarefa obter informações corretas Olá que necessitam para a solução.</span><span class="sxs-lookup"><span data-stu-id="4729e-130">hello consistency check is an extra measure tooensure that customers who rely on hello Get Task Counts operation get hello right information they need for their solution.</span></span>

<span data-ttu-id="4729e-131">Olá **validationStatus** propriedade na resposta Olá indica se o Batch tem efetuar verificação de consistência Olá.</span><span class="sxs-lookup"><span data-stu-id="4729e-131">hello **validationStatus** property in hello response indicates whether Batch has performed hello consistency check.</span></span> <span data-ttu-id="4729e-132">Se o lote não foi possível toocheck Estado contagens contra Estados real Olá contidos num sistema Olá, em seguida, Olá **validationStatus** for definida demasiado`unvalidated`.</span><span class="sxs-lookup"><span data-stu-id="4729e-132">If Batch has not been able toocheck state counts against hello actual states held in hello system, then hello **validationStatus** property is set too`unvalidated`.</span></span> <span data-ttu-id="4729e-133">Por motivos de desempenho, Batch não irá efetuar verificação de consistência Olá se Olá trabalho inclui mais de 200 000 tarefas, por isso, Olá **validationStatus** propriedade pode ser definida demasiado`unvalidated` neste caso.</span><span class="sxs-lookup"><span data-stu-id="4729e-133">For performance reasons, Batch will not perform hello consistency check if hello job includes more than 200,000 tasks, so hello **validationStatus** property may be set too`unvalidated` in this case.</span></span> <span data-ttu-id="4729e-134">No entanto, contagem de tarefas Olá não é necessariamente errada neste caso, dado que, mesmo a perda de dados muito limitado é muito pouco provável.</span><span class="sxs-lookup"><span data-stu-id="4729e-134">However, hello task count is not necessarily wrong in this case, as even a very limited data loss is highly unlikely.</span></span> 

<span data-ttu-id="4729e-135">Quando uma tarefa muda de estado, o pipeline de agregação de Olá processa Olá alteração dentro de alguns segundos.</span><span class="sxs-lookup"><span data-stu-id="4729e-135">When a task changes state, hello aggregation pipeline processes hello change within few seconds.</span></span> <span data-ttu-id="4729e-136">Olá obter contagens de tarefa operação reflete contagens de tarefa Olá atualizado durante esse período.</span><span class="sxs-lookup"><span data-stu-id="4729e-136">hello Get Task Counts operation reflects hello updated task counts within that period.</span></span> <span data-ttu-id="4729e-137">No entanto, se o pipeline de agregação de Olá pedidos sem êxito uma alteração de estado de tarefas, em seguida, que a alteração não é registado até a passagem de validação seguinte Olá.</span><span class="sxs-lookup"><span data-stu-id="4729e-137">However, if hello aggregation pipeline misses a change in a task state, then that change is not registered until hello next validation pass.</span></span> <span data-ttu-id="4729e-138">Durante este período, contagens de tarefas podem ser ligeiramente incorretas devido toohello de evento em falta, mas estes são corrigidas na passagem de validação seguinte Olá.</span><span class="sxs-lookup"><span data-stu-id="4729e-138">During this time, task counts may be slightly inaccurate due toohello missed event, but they are corrected on hello next validation pass.</span></span>

## <a name="best-practices-for-counting-a-jobs-tasks"></a><span data-ttu-id="4729e-139">Melhores práticas para tarefas do trabalho de contagem</span><span class="sxs-lookup"><span data-stu-id="4729e-139">Best practices for counting a job's tasks</span></span>

<span data-ttu-id="4729e-140">Chamar a operação de obter a contagem de tarefas Olá é Olá tooreturn da forma mais eficiente uma contagem das tarefas de uma tarefa pelo Estado básica.</span><span class="sxs-lookup"><span data-stu-id="4729e-140">Calling hello Get Task Counts operation is hello most efficient way tooreturn a basic count of a job's tasks by state.</span></span> <span data-ttu-id="4729e-141">Se estiver a utilizar versão de serviço de Batch de 2017-06-01.5.1, recomendamos que escrever ou atualizar a sua toouse código obter contagens de tarefas.</span><span class="sxs-lookup"><span data-stu-id="4729e-141">If you are using Batch service version 2017-06-01.5.1, we recommend writing or updating your code toouse Get Task Counts.</span></span>

<span data-ttu-id="4729e-142">Olá obter contagens de tarefa operação anterior ao 2017-06-01.5.1 não está disponível nas versões do serviço de Batch.</span><span class="sxs-lookup"><span data-stu-id="4729e-142">hello Get Task Counts operation is not available in Batch service versions earlier than 2017-06-01.5.1.</span></span> <span data-ttu-id="4729e-143">Se estiver a utilizar uma versão antiga do serviço de Olá, em seguida, utilize uma lista consulta toocount tarefas numa tarefa em vez disso.</span><span class="sxs-lookup"><span data-stu-id="4729e-143">If you are using an older version of hello service, then use a list query toocount tasks in a job instead.</span></span> <span data-ttu-id="4729e-144">Para obter mais informações, consulte [criar eficazmente os recursos do Batch toolist consultas](batch-efficient-list-queries.md).</span><span class="sxs-lookup"><span data-stu-id="4729e-144">For more information, see [Create queries toolist Batch resources efficiently](batch-efficient-list-queries.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="4729e-145">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="4729e-145">Next steps</span></span>

* <span data-ttu-id="4729e-146">Consulte Olá [descrição geral da funcionalidade do Batch](batch-api-basics.md) toolearn mais sobre as funcionalidades e conceitos do serviço Batch.</span><span class="sxs-lookup"><span data-stu-id="4729e-146">See hello [Batch feature overview](batch-api-basics.md) toolearn more about Batch service concepts and features.</span></span> <span data-ttu-id="4729e-147">Olá artigo aborda Olá recursos do Batch principais como conjuntos, nós de computação, trabalhos e tarefas e fornece uma descrição geral das funcionalidades do serviço de Olá.</span><span class="sxs-lookup"><span data-stu-id="4729e-147">hello article discusses hello primary Batch resources such as pools, compute nodes, jobs, and tasks, and provides an overview of hello service's features.</span></span>
* <span data-ttu-id="4729e-148">Saiba Olá Noções básicas sobre desenvolver uma aplicação preparada para Batch utilizando Olá [biblioteca de cliente .NET do Batch](batch-dotnet-get-started.md) ou [Python](batch-python-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="4729e-148">Learn hello basics of developing a Batch-enabled application using hello [Batch .NET client library](batch-dotnet-get-started.md) or [Python](batch-python-tutorial.md).</span></span> <span data-ttu-id="4729e-149">Estes artigos introdutórias ajudá-lo através de uma aplicação de trabalho que utiliza tooexecute de serviço de Batch de Olá uma carga de trabalho em vários nós de computação.</span><span class="sxs-lookup"><span data-stu-id="4729e-149">These introductory articles guide you through a working application that uses hello Batch service tooexecute a workload on multiple compute nodes.</span></span>


[rest_get_task_counts]: https://docs.microsoft.com/rest/api/batchservice/get-the-task-counts-for-a-job
[rest_get_task]: https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task
[rest_list_tasks]: https://docs.microsoft.com/rest/api/batchservice/list-the-tasks-associated-with-a-job
