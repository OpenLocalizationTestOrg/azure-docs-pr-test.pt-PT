---
title: "aaaStart criar soluções do Batch com modelos de projeto do Visual Studio - Azure | Microsoft Docs"
description: "Saiba como modelos de projeto do Visual Studio podem ajudá-lo de implementar e executar as cargas de trabalho intensivas de computação do Azure batch."
services: batch
documentationcenter: .net
author: fayora
manager: timlt
editor: 
ms.assetid: 5e041ae2-25af-4882-a79e-3aa63c4bfb20
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 02/27/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: a61c480ddc4dffd66c01220a137a3e852e39c338
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="use-visual-studio-project-templates-toojump-start-batch-solutions"></a><span data-ttu-id="d13d3-103">Utilizar as soluções do Batch de toojump start modelos do Visual Studio projeto</span><span class="sxs-lookup"><span data-stu-id="d13d3-103">Use Visual Studio project templates toojump-start Batch solutions</span></span>

<span data-ttu-id="d13d3-104">Olá **Gestor de tarefas** e **modelos de tarefas processador Visual Studio** Batch proporcionam toohelp de código tooimplement e execute as cargas de trabalho intensivas de computação no Batch com menos Olá quantidade de esforço.</span><span class="sxs-lookup"><span data-stu-id="d13d3-104">hello **Job Manager** and **Task Processor Visual Studio templates** for Batch provide code toohelp you tooimplement and run your compute-intensive workloads on Batch with hello least amount of effort.</span></span> <span data-ttu-id="d13d3-105">Este documento descreve estes modelos e fornece orientações para como toouse-los.</span><span class="sxs-lookup"><span data-stu-id="d13d3-105">This document describes these templates and provides guidance for how toouse them.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d13d3-106">Este artigo descreve apenas modelos de toothese aplicáveis dois de informações e parte do princípio de que está familiarizado com o serviço de Batch de Olá e tooit relacionados conceitos-chave: conjuntos, nós de computação, trabalhos e tarefas, tarefas do Gestor, variáveis de ambiente e outros informações relevantes.</span><span class="sxs-lookup"><span data-stu-id="d13d3-106">This article discusses only information applicable toothese two templates, and assumes that you are familiar with hello Batch service and key concepts related tooit: pools, compute nodes, jobs and tasks, job manager tasks, environment variables, and other relevant information.</span></span> <span data-ttu-id="d13d3-107">Pode encontrar mais informações em [Noções básicas do Azure Batch](batch-technical-overview.md), [descrição geral da funcionalidade Batch para programadores](batch-api-basics.md), e [introdução à biblioteca do Azure Batch Olá para .NET](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="d13d3-107">You can find more information in [Basics of Azure Batch](batch-technical-overview.md), [Batch feature overview for developers](batch-api-basics.md), and [Get started with hello Azure Batch library for .NET](batch-dotnet-get-started.md).</span></span>
> 
> 

## <a name="high-level-overview"></a><span data-ttu-id="d13d3-108">Descrição geral de alto nível</span><span class="sxs-lookup"><span data-stu-id="d13d3-108">High-level overview</span></span>
<span data-ttu-id="d13d3-109">modelos de Gestor de tarefas e tarefas processador Olá podem ser utilizado toocreate dois componentes úteis:</span><span class="sxs-lookup"><span data-stu-id="d13d3-109">hello Job Manager and Task Processor templates can be used toocreate two useful components:</span></span>

* <span data-ttu-id="d13d3-110">Uma tarefa do Gestor de tarefas que implementa o divisor uma tarefa que pode dividir uma tarefa em várias tarefas que podem ser executadas de forma independente, em paralelo.</span><span class="sxs-lookup"><span data-stu-id="d13d3-110">A job manager task that implements a job splitter that can break a job down into multiple tasks that can run independently, in parallel.</span></span>
* <span data-ttu-id="d13d3-111">Um processador de tarefas que pode ser utilizados tooperform pré- processamento de e pós-processamento em torno de uma linha de comandos de aplicação.</span><span class="sxs-lookup"><span data-stu-id="d13d3-111">A task processor that can be used tooperform pre-processing and post-processing around an application command line.</span></span>

<span data-ttu-id="d13d3-112">Por exemplo, num cenário de composição de filmes, Divisor da tarefa de Olá seria ativar uma tarefa de filmes único para centenas ou milhares de tarefas separadas que seriam processam frames individuais separadamente.</span><span class="sxs-lookup"><span data-stu-id="d13d3-112">For example, in a movie rendering scenario, hello job splitter would turn a single movie job into hundreds or thousands of separate tasks that would process individual frames separately.</span></span> <span data-ttu-id="d13d3-113">Proporcionalmente, processadores de tarefa Olá seriam invocar Olá compor a aplicação e todos os processos dependentes que são necessário toorender cada moldura, bem como realizar quaisquer ações adicionais (por exemplo, copiar Olá composto moldura tooa localização de armazenamento).</span><span class="sxs-lookup"><span data-stu-id="d13d3-113">Correspondingly, hello task processor would invoke hello rendering application and all dependent processes that are needed toorender each frame, as well as perform any additional actions (for example, copying hello rendered frame tooa storage location).</span></span>

> [!NOTE]
> <span data-ttu-id="d13d3-114">modelos de Gestor de tarefas e tarefas processador Olá são independentes entre si, para que possa escolher toouse ambos ou apenas um deles, consoante os requisitos de Olá do seu trabalho de computação e nas suas preferências.</span><span class="sxs-lookup"><span data-stu-id="d13d3-114">hello Job Manager and Task Processor templates are independent of each other, so you can choose toouse both, or only one of them, depending on hello requirements of your compute job and on your preferences.</span></span>
> 
> 

<span data-ttu-id="d13d3-115">Como é mostrado no diagrama de Olá abaixo, uma tarefa de computação que utiliza estes modelos passarão três fases:</span><span class="sxs-lookup"><span data-stu-id="d13d3-115">As shown in hello diagram below, a compute job that uses these templates will go through three stages:</span></span>

1. <span data-ttu-id="d13d3-116">código de cliente Olá (por exemplo, aplicações, serviço web, etc.) submete uma tarefa toohello serviço Batch no Azure, especificando como respectivo programa de tarefa de Gestor do tarefa manager tarefas Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-116">hello client code (e.g., application, web service, etc.) submits a job toohello Batch service on Azure, specifying as its job manager task hello job manager program.</span></span>
2. <span data-ttu-id="d13d3-117">serviço de Batch de Olá Olá tarefa do Gestor de tarefas é executada num nó de computação e hello tarefa divisor inicia Olá especificado diversas tarefas de processador de tarefas, na como muitas nós de computação conforme necessário, com base nos parâmetros de Olá e especificações no código do Olá tarefa divisor.</span><span class="sxs-lookup"><span data-stu-id="d13d3-117">hello Batch service runs hello job manager task on a compute node and hello job splitter launches hello specified number of task processor tasks, on as many compute nodes as required, based on hello parameters and specifications in hello job splitter code.</span></span>
3. <span data-ttu-id="d13d3-118">Olá tarefas processador tarefas são executadas de forma independente, em paralelo, tooprocess dados de entrada Olá e geram Olá dados de saída.</span><span class="sxs-lookup"><span data-stu-id="d13d3-118">hello task processor tasks run independently, in parallel, tooprocess hello input data and generate hello output data.</span></span>

![Diagrama que mostra como o código de cliente interage com Olá serviço Batch][diagram01]

## <a name="prerequisites"></a><span data-ttu-id="d13d3-120">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="d13d3-120">Prerequisites</span></span>
<span data-ttu-id="d13d3-121">modelos de Batch de Olá toouse, terá de seguinte Olá:</span><span class="sxs-lookup"><span data-stu-id="d13d3-121">toouse hello Batch templates, you will need hello following:</span></span>

* <span data-ttu-id="d13d3-122">Um computador com o Visual Studio 2015, instalado.</span><span class="sxs-lookup"><span data-stu-id="d13d3-122">A computer with Visual Studio 2015 installed.</span></span> <span data-ttu-id="d13d3-123">Os modelos de lote são atualmente suportados apenas para o Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="d13d3-123">Batch templates are currently only supported for Visual Studio 2015.</span></span>
* <span data-ttu-id="d13d3-124">modelos de Batch de Olá, que estão disponíveis no Olá [galeria do Visual Studio] [ vs_gallery] como extensões de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d13d3-124">hello Batch templates, which are available from hello [Visual Studio Gallery][vs_gallery] as Visual Studio extensions.</span></span> <span data-ttu-id="d13d3-125">Existem duas formas modelos de Olá tooget:</span><span class="sxs-lookup"><span data-stu-id="d13d3-125">There are two ways tooget hello templates:</span></span>
  
  * <span data-ttu-id="d13d3-126">Instalar os modelos de Olá utilizando Olá **extensões e atualizações** caixa de diálogo no Visual Studio (para obter mais informações, consulte [a localizar e utilizar extensões de Visual Studio][vs_find_use_ext]).</span><span class="sxs-lookup"><span data-stu-id="d13d3-126">Install hello templates using hello **Extensions and Updates** dialog box in Visual Studio (for more information, see [Finding and Using Visual Studio Extensions][vs_find_use_ext]).</span></span> <span data-ttu-id="d13d3-127">No Olá **extensões e atualizações** caixa de diálogo, procurar e transferir Olá duas extensões os seguintes:</span><span class="sxs-lookup"><span data-stu-id="d13d3-127">In hello **Extensions and Updates** dialog box, search and download hello following two extensions:</span></span>
    
    * <span data-ttu-id="d13d3-128">Gestor de tarefas de lote do Azure com o divisor da tarefa</span><span class="sxs-lookup"><span data-stu-id="d13d3-128">Azure Batch Job Manager with Job Splitter</span></span>
    * <span data-ttu-id="d13d3-129">Processador de tarefa de lote do Azure</span><span class="sxs-lookup"><span data-stu-id="d13d3-129">Azure Batch Task Processor</span></span>
  * <span data-ttu-id="d13d3-130">Transferir os modelos de Olá da Galeria online Olá para Visual Studio: [modelos de projeto do Microsoft Azure Batch][vs_gallery_templates]</span><span class="sxs-lookup"><span data-stu-id="d13d3-130">Download hello templates from hello online gallery for Visual Studio: [Microsoft Azure Batch Project Templates][vs_gallery_templates]</span></span>
* <span data-ttu-id="d13d3-131">Se planear toouse Olá [pacotes de aplicações](batch-application-packages.md) nós de computação do Gestor de tarefas do funcionalidade toodeploy Olá e tarefas processador toohello Batch, tem de toolink um tooyour de conta de armazenamento conta do Batch.</span><span class="sxs-lookup"><span data-stu-id="d13d3-131">If you plan toouse hello [Application Packages](batch-application-packages.md) feature toodeploy hello job manager and task processor toohello Batch compute nodes, you need toolink a storage account tooyour Batch account.</span></span>

## <a name="preparation"></a><span data-ttu-id="d13d3-132">Preparação</span><span class="sxs-lookup"><span data-stu-id="d13d3-132">Preparation</span></span>
<span data-ttu-id="d13d3-133">Recomendamos a criação de uma solução que pode conter o seu Gestor de tarefas, bem como o processador de tarefa, porque esta pode tornar mais fácil tooshare código entre o Gestor de tarefas e programas de processador de tarefas.</span><span class="sxs-lookup"><span data-stu-id="d13d3-133">We recommend creating a solution that can contain your job manager as well as your task processor, because this can make it easier tooshare code between your job manager and task processor programs.</span></span> <span data-ttu-id="d13d3-134">toocreate nesta solução, siga estes passos:</span><span class="sxs-lookup"><span data-stu-id="d13d3-134">toocreate this solution, follow these steps:</span></span>

1. <span data-ttu-id="d13d3-135">Abra o Visual Studio e selecione **ficheiro** > **novo** > **projeto**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-135">Open Visual Studio and select **File** > **New** > **Project**.</span></span>
2. <span data-ttu-id="d13d3-136">Em **modelos**, expanda **outros tipos de projeto**, clique em **soluções do Visual Studio**e, em seguida, selecione **solução em branco**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-136">Under **Templates**, expand **Other Project Types**, click **Visual Studio Solutions**, and then select **Blank Solution**.</span></span>
3. <span data-ttu-id="d13d3-137">Escreva um nome que descreva o objetivo de aplicação e Olá desta solução (por exemplo, "LitwareBatchTaskPrograms").</span><span class="sxs-lookup"><span data-stu-id="d13d3-137">Type a name that describes your application and hello purpose of this solution (e.g., "LitwareBatchTaskPrograms").</span></span>
4. <span data-ttu-id="d13d3-138">toocreate Olá nova solução, clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-138">toocreate hello new solution, click **OK**.</span></span>

## <a name="job-manager-template"></a><span data-ttu-id="d13d3-139">Modelo de Gestor de tarefas</span><span class="sxs-lookup"><span data-stu-id="d13d3-139">Job Manager template</span></span>
<span data-ttu-id="d13d3-140">modelo de tarefa do Gestor de Olá ajuda tooimplement uma tarefa do Gestor de tarefas que pode realizar Olá seguintes ações:</span><span class="sxs-lookup"><span data-stu-id="d13d3-140">hello Job Manager template helps you tooimplement a job manager task that can perform hello following actions:</span></span>

* <span data-ttu-id="d13d3-141">Divida uma tarefa em várias tarefas.</span><span class="sxs-lookup"><span data-stu-id="d13d3-141">Split a job into multiple tasks.</span></span>
* <span data-ttu-id="d13d3-142">Submeta toorun essas tarefas no Batch.</span><span class="sxs-lookup"><span data-stu-id="d13d3-142">Submit those tasks toorun on Batch.</span></span>

> [!NOTE]
> <span data-ttu-id="d13d3-143">Para mais informações sobre o Gestor de tarefas, consulte [descrição geral da funcionalidade Batch para programadores](batch-api-basics.md#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="d13d3-143">For more information about job manager tasks, see [Batch feature overview for developers](batch-api-basics.md#job-manager-task).</span></span>
> 
> 

### <a name="create-a-job-manager-using-hello-template"></a><span data-ttu-id="d13d3-144">Criar um Gestor de tarefas utilizando o modelo de Olá</span><span class="sxs-lookup"><span data-stu-id="d13d3-144">Create a Job Manager using hello template</span></span>
<span data-ttu-id="d13d3-145">tooadd uma solução de toohello do Gestor de tarefas que criou anteriormente, siga estes passos:</span><span class="sxs-lookup"><span data-stu-id="d13d3-145">tooadd a job manager toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="d13d3-146">Abra a solução existente no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d13d3-146">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="d13d3-147">No Explorador de soluções, solução de Olá rato, clique em **adicionar** > **novo projeto**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-147">In Solution Explorer, right-click hello solution, click **Add** > **New Project**.</span></span>
3. <span data-ttu-id="d13d3-148">Em **Visual c#**, clique em **nuvem**e, em seguida, clique em **Gestor de tarefas de lote do Azure com a tarefa divisor**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-148">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Job Manager with Job Splitter**.</span></span>
4. <span data-ttu-id="d13d3-149">Escreva um nome que descreve a aplicação e identifica este projeto como Gestor de tarefas Olá (por exemplo "LitwareJobManager").</span><span class="sxs-lookup"><span data-stu-id="d13d3-149">Type a name that describes your application and identifies this project as hello job manager (e.g. "LitwareJobManager").</span></span>
5. <span data-ttu-id="d13d3-150">projeto de Olá toocreate, clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-150">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="d13d3-151">Por fim, referenciado de compilação Olá projeto tooforce Visual Studio tooload todos os pacotes NuGet e tooverify Olá projeto é válido antes de começar a modificá-lo.</span><span class="sxs-lookup"><span data-stu-id="d13d3-151">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="job-manager-template-files-and-their-purpose"></a><span data-ttu-id="d13d3-152">Ficheiros de modelo de Gestor de tarefas e respetivo objetivo</span><span class="sxs-lookup"><span data-stu-id="d13d3-152">Job Manager template files and their purpose</span></span>
<span data-ttu-id="d13d3-153">Quando cria um projeto com o modelo de tarefa do Gestor de Olá, gera três grupos de ficheiros de código:</span><span class="sxs-lookup"><span data-stu-id="d13d3-153">When you create a project using hello Job Manager template, it generates three groups of code files:</span></span>

* <span data-ttu-id="d13d3-154">ficheiros de programa principal Olá (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="d13d3-154">hello main program file (Program.cs).</span></span> <span data-ttu-id="d13d3-155">Contém o ponto de entrada do programa Olá e processamento de exceções de nível superior.</span><span class="sxs-lookup"><span data-stu-id="d13d3-155">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="d13d3-156">Não deve normalmente terá toomodify isto.</span><span class="sxs-lookup"><span data-stu-id="d13d3-156">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="d13d3-157">diretório de Framework Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-157">hello Framework directory.</span></span> <span data-ttu-id="d13d3-158">Contém os ficheiros de Olá responsáveis pelo trabalho de 'automático' Olá efetuado pelo programa de Gestor de tarefas Olá – unpacking parâmetros, a adição de um trabalho do Batch toohello tarefas, etc. Normalmente, não deverá ser preciso toomodify estes ficheiros.</span><span class="sxs-lookup"><span data-stu-id="d13d3-158">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="d13d3-159">Olá tarefa divisor o ficheiro (JobSplitter.cs).</span><span class="sxs-lookup"><span data-stu-id="d13d3-159">hello job splitter file (JobSplitter.cs).</span></span> <span data-ttu-id="d13d3-160">Esta é a localização onde irá colocar a lógica de aplicação específicos para dividir uma tarefa para tarefas.</span><span class="sxs-lookup"><span data-stu-id="d13d3-160">This is where you will put your application-specific logic for splitting a job into tasks.</span></span>

<span data-ttu-id="d13d3-161">Obviamente pode adicionar ficheiros adicionais conforme necessário toosupport código divisor tarefa, consoante a complexidade de Olá da tarefa de Olá dividir lógica.</span><span class="sxs-lookup"><span data-stu-id="d13d3-161">Of course you can add additional files as required toosupport your job splitter code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="d13d3-162">o modelo de Olá também gera ficheiros de projeto .NET padrão, tais como um ficheiro. csproj, App. config, Packages, etc.</span><span class="sxs-lookup"><span data-stu-id="d13d3-162">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="d13d3-163">rest Olá desta secção descreve os diferentes ficheiros de Olá e respetiva estrutura de código e explica o que faz cada classe.</span><span class="sxs-lookup"><span data-stu-id="d13d3-163">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Visual Studio Solution Explorer que mostra a solução de modelo de tarefa do Gestor de Olá][solution_explorer01]

<span data-ttu-id="d13d3-165">**Ficheiros de Framework**</span><span class="sxs-lookup"><span data-stu-id="d13d3-165">**Framework files**</span></span>

* <span data-ttu-id="d13d3-166">`Configuration.cs`: Encapsula carregamento Olá tarefa dos dados de configuração, tais como os detalhes da conta do Batch, as credenciais da conta de armazenamento ligado, tarefas e informações e parâmetros da tarefa.</span><span class="sxs-lookup"><span data-stu-id="d13d3-166">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="d13d3-167">Também fornece acesso variáveis de ambiente definidas pelo tooBatch (consulte as definições de ambiente para tarefas, na documentação de Batch de Olá) através de classe de Configuration.EnvironmentVariable Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-167">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="d13d3-168">`IConfiguration.cs`: Deduz Olá a implementação de Olá classe de configuração, para que possa unidade testar o divisor de tarefa com um objeto de configuração falsificados ou mock.</span><span class="sxs-lookup"><span data-stu-id="d13d3-168">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="d13d3-169">`JobManager.cs`: Os componentes de Olá do programa de Gestor de tarefas Olá orquestra.</span><span class="sxs-lookup"><span data-stu-id="d13d3-169">`JobManager.cs`: Orchestrates hello components of hello job manager program.</span></span> <span data-ttu-id="d13d3-170">É responsável pela Olá inicializar divisor de tarefa Olá, invocar divisor da tarefa de Olá, e emissão tarefas Olá devolvido por Olá tarefa divisor toohello submissor da tarefa de.</span><span class="sxs-lookup"><span data-stu-id="d13d3-170">It is responsible for hello initializing hello job splitter, invoking hello job splitter, and dispatching hello tasks returned by hello job splitter toohello task submitter.</span></span>
* <span data-ttu-id="d13d3-171">`JobManagerException.cs`: Representa um erro que exige Olá tarefa manager tooterminate.</span><span class="sxs-lookup"><span data-stu-id="d13d3-171">`JobManagerException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="d13d3-172">JobManagerException é utilizado toowrap 'era esperado' erros onde as informações de diagnóstico específicas podem ser fornecidas como parte de terminação.</span><span class="sxs-lookup"><span data-stu-id="d13d3-172">JobManagerException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>
* <span data-ttu-id="d13d3-173">`TaskSubmitter.cs`: Esta classe é tarefas tooadding responsável devolvidas pelo Olá tarefa divisor toohello um trabalho do Batch.</span><span class="sxs-lookup"><span data-stu-id="d13d3-173">`TaskSubmitter.cs`: This class is responsible tooadding tasks returned by hello job splitter toohello Batch job.</span></span> <span data-ttu-id="d13d3-174">classe de JobManager Olá agrega sequência Olá das tarefas em lotes para a tarefa de toohello adição eficiente mas atempada, em seguida, chama TaskSubmitter.SubmitTasks no thread de segundo plano para cada lote.</span><span class="sxs-lookup"><span data-stu-id="d13d3-174">hello JobManager class aggregates hello sequence of tasks into batches for efficient but timely addition toohello job, then calls TaskSubmitter.SubmitTasks on a background thread for each batch.</span></span>

<span data-ttu-id="d13d3-175">**Tarefa divisor**</span><span class="sxs-lookup"><span data-stu-id="d13d3-175">**Job Splitter**</span></span>

<span data-ttu-id="d13d3-176">`JobSplitter.cs`: Esta classe contém específicas da aplicação lógica para dividir a tarefa de Olá para tarefas.</span><span class="sxs-lookup"><span data-stu-id="d13d3-176">`JobSplitter.cs`: This class contains application-specific logic for splitting hello job into tasks.</span></span> <span data-ttu-id="d13d3-177">Olá framework invoca Olá JobSplitter.Split método tooobtain uma sequência de tarefas, que adiciona toohello tarefa como método de Olá devolve-os.</span><span class="sxs-lookup"><span data-stu-id="d13d3-177">hello framework invokes hello JobSplitter.Split method tooobtain a sequence of tasks, which it adds toohello job as hello method returns them.</span></span> <span data-ttu-id="d13d3-178">Esta é a classe de olá onde irá inserir lógica Olá da tarefa.</span><span class="sxs-lookup"><span data-stu-id="d13d3-178">This is hello class where you will inject hello logic of your job.</span></span> <span data-ttu-id="d13d3-179">Implemente Olá divisão método tooreturn uma sequência de instâncias de CloudTask que representa as tarefas de Olá na qual pretende que a tarefa de Olá toopartition.</span><span class="sxs-lookup"><span data-stu-id="d13d3-179">Implement hello Split method tooreturn a sequence of CloudTask instances representing hello tasks into which you want toopartition hello job.</span></span>

<span data-ttu-id="d13d3-180">**Ficheiros de projeto de linha de comandos do padrão .NET**</span><span class="sxs-lookup"><span data-stu-id="d13d3-180">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="d13d3-181">`App.config`: Ficheiro de configuração da aplicação .NET padrão.</span><span class="sxs-lookup"><span data-stu-id="d13d3-181">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="d13d3-182">`Packages.config`: Ficheiro de dependência de pacote NuGet padrão.</span><span class="sxs-lookup"><span data-stu-id="d13d3-182">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="d13d3-183">`Program.cs`: Contém o ponto de entrada do programa de Olá e processamento de exceções de nível superior.</span><span class="sxs-lookup"><span data-stu-id="d13d3-183">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

### <a name="implementing-hello-job-splitter"></a><span data-ttu-id="d13d3-184">Implementar o divisor da tarefa de Olá</span><span class="sxs-lookup"><span data-stu-id="d13d3-184">Implementing hello job splitter</span></span>
<span data-ttu-id="d13d3-185">Quando abrir projeto de modelo de tarefa do Gestor de Olá, projeto Olá terá ficheiros de JobSplitter.cs Olá abrir por predefinição.</span><span class="sxs-lookup"><span data-stu-id="d13d3-185">When you open hello Job Manager template project, hello project will have hello JobSplitter.cs file open by default.</span></span> <span data-ttu-id="d13d3-186">Pode implementar Olá dividir lógica para tarefas de Olá na sua carga de trabalho utilizando mostrar de método de Split() Olá abaixo:</span><span class="sxs-lookup"><span data-stu-id="d13d3-186">You can implement hello split logic for hello tasks in your workload by using hello Split() method show below:</span></span>

```csharp
/// <summary>
/// Gets hello tasks into which toosplit hello job. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello job manager framework invokes hello Split method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation should return tasks lazily, for example using a C#
/// iterator and hello "yield return" statement; this allows tasks toobe added
/// and toostart running while splitting is still in progress.
/// </summary>
/// <returns>hello tasks toobe added toohello job. Tasks are added automatically
/// by hello job manager framework as they are returned by this method.</returns>
public IEnumerable<CloudTask> Split()
{
    // Your code for hello split logic goes here.
    int startFrame = Convert.ToInt32(_parameters["StartFrame"]);
    int endFrame = Convert.ToInt32(_parameters["EndFrame"]);

    for (int i = startFrame; i <= endFrame; i++)
    {
        yield return new CloudTask("myTask" + i, "cmd /c dir");
    }
}
```

> [!NOTE]
> <span data-ttu-id="d13d3-187">Olá anotado secção Olá `Split()` método é a secção apenas Olá Olá código de modelo de Gestor de tarefas que foi concebido para lhe toomodify adicionando Olá lógica toosplit as tarefas para tarefas diferentes.</span><span class="sxs-lookup"><span data-stu-id="d13d3-187">hello annotated section in hello `Split()` method is hello only section of hello Job Manager template code that is intended for you toomodify by adding hello logic toosplit your jobs into different tasks.</span></span> <span data-ttu-id="d13d3-188">Se quiser toomodify secção diferente do modelo de Olá, certifique-se são familiarized com como funciona o Batch e experimente algumas das Olá [exemplos de código do Batch][github_samples].</span><span class="sxs-lookup"><span data-stu-id="d13d3-188">If you want toomodify a different section of hello template, please ensure you are familiarized with how Batch works, and try out a few of hello [Batch code samples][github_samples].</span></span>
> 
> 

<span data-ttu-id="d13d3-189">A implementação de Split() tem acesso ao:</span><span class="sxs-lookup"><span data-stu-id="d13d3-189">Your Split() implementation has access to:</span></span>

* <span data-ttu-id="d13d3-190">Olá parâmetros da tarefa, através de Olá `_parameters` campo.</span><span class="sxs-lookup"><span data-stu-id="d13d3-190">hello job parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="d13d3-191">Olá CloudJob objeto que representa Olá tarefa através de Olá `_job` campo.</span><span class="sxs-lookup"><span data-stu-id="d13d3-191">hello CloudJob object representing hello job, via hello `_job` field.</span></span>
* <span data-ttu-id="d13d3-192">Olá CloudTask objeto que representa Olá tarefa do Gestor de tarefas, através de Olá `_jobManagerTask` campo.</span><span class="sxs-lookup"><span data-stu-id="d13d3-192">hello CloudTask object representing hello job manager task, via hello `_jobManagerTask` field.</span></span>

<span data-ttu-id="d13d3-193">O `Split()` implementação não precisa de tarefa de toohello tooadd tarefas diretamente.</span><span class="sxs-lookup"><span data-stu-id="d13d3-193">Your `Split()` implementation does not need tooadd tasks toohello job directly.</span></span> <span data-ttu-id="d13d3-194">Em vez disso, o código deverá devolver uma sequência de objetos de CloudTask e estes serão adicionados toohello tarefa automaticamente por classes de estrutura de Olá invocam divisor da tarefa de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-194">Instead, your code should return a sequence of CloudTask objects, and these will be added toohello job automatically by hello framework classes that invoke hello job splitter.</span></span> <span data-ttu-id="d13d3-195">É comum toouse do # iterator (`yield return`) funcionalidade splitters de tarefa tooimplement como isto permite Olá toostart de tarefas em execução logo que possível, em vez de aguardar que todas as tarefas toobe calculado.</span><span class="sxs-lookup"><span data-stu-id="d13d3-195">It's common toouse C#'s iterator (`yield return`) feature tooimplement job splitters as this allows hello tasks toostart running as soon as possible rather than waiting for all tasks toobe calculated.</span></span>

<span data-ttu-id="d13d3-196">**Falha da tarefa divisor**</span><span class="sxs-lookup"><span data-stu-id="d13d3-196">**Job splitter failure**</span></span>

<span data-ttu-id="d13d3-197">Se o divisor da tarefa encontra um erro, quer devia:</span><span class="sxs-lookup"><span data-stu-id="d13d3-197">If your job splitter encounters an error, it should either:</span></span>

* <span data-ttu-id="d13d3-198">Terminar a sequência de Olá utilizando Olá c# `yield break` declaração, em que o Gestor de tarefas Olá maiúsculas e será tratado como êxito; ou</span><span class="sxs-lookup"><span data-stu-id="d13d3-198">Terminate hello sequence using hello C# `yield break` statement, in which case hello job manager will be treated as successful; or</span></span>
* <span data-ttu-id="d13d3-199">Gerar uma exceção, em que o Gestor de tarefas Olá maiúsculas será tratado como falhado e pode ser repetido dependendo de como cliente Olá configurou-lo).</span><span class="sxs-lookup"><span data-stu-id="d13d3-199">Throw an exception, in which case hello job manager will be treated as failed and may be retried depending on how hello client has configured it).</span></span>

<span data-ttu-id="d13d3-200">Em ambos os casos, todas as tarefas já devolvidos pelo divisor da tarefa de Olá e tarefa de lote toohello adicionada será toorun elegível.</span><span class="sxs-lookup"><span data-stu-id="d13d3-200">In both cases, any tasks already returned by hello job splitter and added toohello Batch job will be eligible toorun.</span></span> <span data-ttu-id="d13d3-201">Se não pretender que esta toohappen, em seguida, pode:</span><span class="sxs-lookup"><span data-stu-id="d13d3-201">If you don't want this toohappen, then you could:</span></span>

* <span data-ttu-id="d13d3-202">Terminar a tarefa de Olá antes da devolução do divisor da tarefa de Olá</span><span class="sxs-lookup"><span data-stu-id="d13d3-202">Terminate hello job before returning from hello job splitter</span></span>
* <span data-ttu-id="d13d3-203">Formular a coleção de tarefas todo Olá antes de o devolver (ou seja, devolver um `ICollection<CloudTask>` ou `IList<CloudTask>` em vez de implementar o divisor tarefa utilizando um iterator c#)</span><span class="sxs-lookup"><span data-stu-id="d13d3-203">Formulate hello entire task collection before returning it (that is, return an `ICollection<CloudTask>` or `IList<CloudTask>` instead of implementing your job splitter using a C# iterator)</span></span>
* <span data-ttu-id="d13d3-204">Utilizar toomake de dependências de tarefas todas as tarefas dependem após a conclusão com êxito Olá do Gestor de tarefas Olá</span><span class="sxs-lookup"><span data-stu-id="d13d3-204">Use task dependencies toomake all tasks depend on hello successful completion of hello job manager</span></span>

<span data-ttu-id="d13d3-205">**Tentativas de Gestor de tarefas**</span><span class="sxs-lookup"><span data-stu-id="d13d3-205">**Job manager retries**</span></span>

<span data-ttu-id="d13d3-206">Se o Gestor de tarefas Olá falhar, pode ser repetida pelo serviço de Batch de Olá dependendo das definições de repetição do cliente Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-206">If hello job manager fails, it may be retried by hello Batch service depending on hello client retry settings.</span></span> <span data-ttu-id="d13d3-207">Em geral, isto é seguro, porque quando o framework Olá adiciona uma tarefa de toohello de tarefas, ignora todas as tarefas que já existem.</span><span class="sxs-lookup"><span data-stu-id="d13d3-207">In general, this is safe, because when hello framework adds tasks toohello job, it ignores any tasks that already exist.</span></span> <span data-ttu-id="d13d3-208">No entanto, esteja calcular tarefas dispendiosas, poderá não pretende custo Olá tooincur recalcular as tarefas que já foram adicionadas toohello tarefa; por outro lado, se Olá volte a executar é toogenerate não garantida Olá mesmos IDs de tarefas, em seguida, o comportamento de 'Ignorar duplicados' Olá não irá iniciar.</span><span class="sxs-lookup"><span data-stu-id="d13d3-208">However, if calculating tasks is expensive, you may not wish tooincur hello cost of recalculating tasks that have already been added toohello job; conversely, if hello re-run is not guaranteed toogenerate hello same task IDs then hello 'ignore duplicates' behavior will not kick in.</span></span> <span data-ttu-id="d13d3-209">Nestes casos deve conceber a sua tarefa divisor toodetect Olá trabalho já foi executado e repita-lo, por exemplo, efetuando uma CloudJob.ListTasks antes de iniciar tooyield tarefas.</span><span class="sxs-lookup"><span data-stu-id="d13d3-209">In these cases you should design your job splitter toodetect hello work that has already been done and not repeat it, for example by performing a CloudJob.ListTasks before starting tooyield tasks.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-job-manager-template"></a><span data-ttu-id="d13d3-210">Sair códigos e exceções no modelo de tarefa do Gestor de Olá</span><span class="sxs-lookup"><span data-stu-id="d13d3-210">Exit codes and exceptions in hello Job Manager template</span></span>
<span data-ttu-id="d13d3-211">Códigos de saída e exceções de fornecem um mecanismo toodetermine Olá resultado executarem um programa e podem ajudar tooidentify quaisquer problemas com a execução de Olá do programa de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-211">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help tooidentify any problems with hello execution of hello program.</span></span> <span data-ttu-id="d13d3-212">modelo de tarefa do Gestor de Olá implementa códigos de saída Olá e exceções descritas nesta secção.</span><span class="sxs-lookup"><span data-stu-id="d13d3-212">hello Job Manager template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="d13d3-213">Uma tarefa do Gestor de tarefas que é implementado com o modelo de tarefa do Gestor de Olá pode devolver as três códigos de saída possíveis:</span><span class="sxs-lookup"><span data-stu-id="d13d3-213">A job manager task that is implemented with hello Job Manager template can return three possible exit codes:</span></span>

| <span data-ttu-id="d13d3-214">Código</span><span class="sxs-lookup"><span data-stu-id="d13d3-214">Code</span></span> | <span data-ttu-id="d13d3-215">Descrição</span><span class="sxs-lookup"><span data-stu-id="d13d3-215">Description</span></span> |
| --- | --- |
| <span data-ttu-id="d13d3-216">0</span><span class="sxs-lookup"><span data-stu-id="d13d3-216">0</span></span> |<span data-ttu-id="d13d3-217">Gestor de tarefas de Olá foi concluído com êxito.</span><span class="sxs-lookup"><span data-stu-id="d13d3-217">hello job manager completed successfully.</span></span> <span data-ttu-id="d13d3-218">Código do divisor da tarefa foi executada toocompletion e todas as tarefas foram adicionadas toohello tarefa.</span><span class="sxs-lookup"><span data-stu-id="d13d3-218">Your job splitter code ran toocompletion, and all tasks were added toohello job.</span></span> |
| <span data-ttu-id="d13d3-219">1</span><span class="sxs-lookup"><span data-stu-id="d13d3-219">1</span></span> |<span data-ttu-id="d13d3-220">Olá tarefa do Gestor de tarefas falhou com uma exceção numa parte do programa de Olá 'esperada'.</span><span class="sxs-lookup"><span data-stu-id="d13d3-220">hello job manager task failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="d13d3-221">Exceção de Olá foi traduzida tooa JobManagerException com informações de diagnóstico e, sempre que possível, sugestões para resolver Olá falha.</span><span class="sxs-lookup"><span data-stu-id="d13d3-221">hello exception was translated tooa JobManagerException with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="d13d3-222">2</span><span class="sxs-lookup"><span data-stu-id="d13d3-222">2</span></span> |<span data-ttu-id="d13d3-223">Olá tarefa do Gestor de tarefas falhou com uma exceção 'inesperada'.</span><span class="sxs-lookup"><span data-stu-id="d13d3-223">hello job manager task failed with an 'unexpected' exception.</span></span> <span data-ttu-id="d13d3-224">Olá exceção foi iniciada toostandard de saída, mas o Gestor de tarefas Olá foi tooadd não é possível quaisquer informações de diagnóstico ou remediação adicionais.</span><span class="sxs-lookup"><span data-stu-id="d13d3-224">hello exception was logged toostandard output, but hello job manager was unable tooadd any additional diagnostic or remediation information.</span></span> |

<span data-ttu-id="d13d3-225">No caso de Olá de falha de tarefa do Gestor de tarefas, algumas tarefas poderão ainda ter sido adicionadas toohello serviço antes de Olá erro.</span><span class="sxs-lookup"><span data-stu-id="d13d3-225">In hello case of job manager task failure, some tasks may still have been added toohello service before hello error occurred.</span></span> <span data-ttu-id="d13d3-226">Estas tarefas serão executadas como normais.</span><span class="sxs-lookup"><span data-stu-id="d13d3-226">These tasks will run as normal.</span></span> <span data-ttu-id="d13d3-227">Consulte "Falha de divisor da tarefa" acima para debate deste caminho de código.</span><span class="sxs-lookup"><span data-stu-id="d13d3-227">See "Job Splitter Failure" above for discussion of this code path.</span></span>

<span data-ttu-id="d13d3-228">Todas as informações de Olá devolvidas pelo exceções são escritas em ficheiros stdout.txt e stderr.txt.</span><span class="sxs-lookup"><span data-stu-id="d13d3-228">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="d13d3-229">Para obter mais informações, consulte [erro processamento](batch-api-basics.md#error-handling).</span><span class="sxs-lookup"><span data-stu-id="d13d3-229">For more information, see [Error Handling](batch-api-basics.md#error-handling).</span></span>

### <a name="client-considerations"></a><span data-ttu-id="d13d3-230">Considerações de cliente</span><span class="sxs-lookup"><span data-stu-id="d13d3-230">Client considerations</span></span>
<span data-ttu-id="d13d3-231">Esta secção descreve alguns requisitos de implementação do cliente ao invocar um Gestor de tarefas com base neste modelo.</span><span class="sxs-lookup"><span data-stu-id="d13d3-231">This section describes some client implementation requirements when invoking a job manager based on this template.</span></span> <span data-ttu-id="d13d3-232">Consulte [como toopass parâmetros e variáveis de ambiente de código de cliente Olá](#pass-environment-settings) para obter detalhes sobre a transmitir parâmetros e definições de ambiente.</span><span class="sxs-lookup"><span data-stu-id="d13d3-232">See [How toopass parameters and environment variables from hello client code](#pass-environment-settings) for details on passing parameters and environment settings.</span></span>

<span data-ttu-id="d13d3-233">**Credenciais obrigatórias**</span><span class="sxs-lookup"><span data-stu-id="d13d3-233">**Mandatory credentials**</span></span>

<span data-ttu-id="d13d3-234">Tarefa de ordem tooadd tarefas toohello do Azure Batch, Olá tarefa do Gestor de tarefas requer o URL da conta do Azure Batch e a chave.</span><span class="sxs-lookup"><span data-stu-id="d13d3-234">In order tooadd tasks toohello Azure Batch job, hello job manager task requires your Azure Batch account URL and key.</span></span> <span data-ttu-id="d13d3-235">Tem de passar estes nas variáveis de ambiente com o nome YOUR_BATCH_URL e YOUR_BATCH_KEY.</span><span class="sxs-lookup"><span data-stu-id="d13d3-235">You must pass these in environment variables named YOUR_BATCH_URL and YOUR_BATCH_KEY.</span></span> <span data-ttu-id="d13d3-236">Pode definir estas no Gestor de tarefas de Olá definições de ambiente de tarefas.</span><span class="sxs-lookup"><span data-stu-id="d13d3-236">You can set these in hello Job Manager task environment settings.</span></span> <span data-ttu-id="d13d3-237">Por exemplo, num c# cliente:</span><span class="sxs-lookup"><span data-stu-id="d13d3-237">For example, in a C# client:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    new EnvironmentSetting("YOUR_BATCH_URL", "https://account.region.batch.azure.com"),
    new EnvironmentSetting("YOUR_BATCH_KEY", "{your_base64_encoded_account_key}"),
};
```
<span data-ttu-id="d13d3-238">**Credenciais do armazenamento**</span><span class="sxs-lookup"><span data-stu-id="d13d3-238">**Storage credentials**</span></span>

<span data-ttu-id="d13d3-239">Normalmente, Olá cliente não precisa de tooprovide Olá armazenamento ligado conta credenciais toohello tarefa do Gestor de tarefas porque (a) a maioria dos gestores de tarefa não é necessário acesso de tooexplicitly Olá ligado conta de armazenamento e (b) hello conta de armazenamento ligado é frequentemente fornecida tarefas de tooall como uma definição de ambiente comuns para a tarefa de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-239">Typically, hello client does not need tooprovide hello linked storage account credentials toohello job manager task because (a) most job managers do not need tooexplicitly access hello linked storage account and (b) hello linked storage account is often provided tooall tasks as a common environment setting for hello job.</span></span> <span data-ttu-id="d13d3-240">Se não está a fornecer Olá ligado a conta de armazenamento através de definições de ambiente comuns Olá e o Gestor de tarefas Olá requer acesso toolinked armazenamento, em seguida, deve fornecer as credenciais do armazenamento de Olá ligado da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="d13d3-240">If you are not providing hello linked storage account via hello common environment settings, and hello job manager requires access toolinked storage, then you should supply hello linked storage credentials as follows:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    /* other environment settings */
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="d13d3-241">**Definições de tarefa do Gestor de tarefas**</span><span class="sxs-lookup"><span data-stu-id="d13d3-241">**Job manager task settings**</span></span>

<span data-ttu-id="d13d3-242">cliente de Olá deve definir o Gestor de tarefas Olá *killJobOnCompletion* sinalizador demasiado**falso**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-242">hello client should set hello job manager *killJobOnCompletion* flag too**false**.</span></span>

<span data-ttu-id="d13d3-243">É normalmente seguro para Olá cliente tooset *runExclusive* demasiado**falso**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-243">It is usually safe for hello client tooset *runExclusive* too**false**.</span></span>

<span data-ttu-id="d13d3-244">cliente de Olá deve utilizar Olá *resourceFiles* ou *applicationPackageReferences* coleção toohave Olá Gestor de tarefas executável (e respetivas DLLs necessários) implementado o nó de computação toohello.</span><span class="sxs-lookup"><span data-stu-id="d13d3-244">hello client should use hello *resourceFiles* or *applicationPackageReferences* collection toohave hello job manager executable (and its required DLLs) deployed toohello compute node.</span></span>

<span data-ttu-id="d13d3-245">Por predefinição, o Gestor de tarefas Olá não será repetido se falhar.</span><span class="sxs-lookup"><span data-stu-id="d13d3-245">By default, hello job manager will not be retried if it fails.</span></span> <span data-ttu-id="d13d3-246">Consoante a lógica de Gestor de tarefas, cliente Olá poderá pretender tooenable tentativas através de *restrições*/*maxTaskRetryCount*.</span><span class="sxs-lookup"><span data-stu-id="d13d3-246">Depending on your job manager logic, hello client may want tooenable retries via *constraints*/*maxTaskRetryCount*.</span></span>

<span data-ttu-id="d13d3-247">**Definições da tarefa**</span><span class="sxs-lookup"><span data-stu-id="d13d3-247">**Job settings**</span></span>

<span data-ttu-id="d13d3-248">Se o divisor da tarefa de Olá emite tarefas com as dependências, cliente Olá tem de definir tootrue de usesTaskDependencies da tarefa de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-248">If hello job splitter emits tasks with dependencies, hello client must set hello job's usesTaskDependencies tootrue.</span></span>

<span data-ttu-id="d13d3-249">No modelo de divisor da tarefa Olá, é pouco usual clientes toowish tooadd tarefas toojobs over and above divisor de tarefa que Olá cria.</span><span class="sxs-lookup"><span data-stu-id="d13d3-249">In hello job splitter model, it is unusual for clients toowish tooadd tasks toojobs over and above what hello job splitter creates.</span></span> <span data-ttu-id="d13d3-250">cliente de Olá, por conseguinte, deve definir normalmente da tarefa de Olá *onAllTasksComplete* demasiado**terminatejob**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-250">hello client should therefore normally set hello job's *onAllTasksComplete* too**terminatejob**.</span></span>

## <a name="task-processor-template"></a><span data-ttu-id="d13d3-251">Modelo de processador de tarefas</span><span class="sxs-lookup"><span data-stu-id="d13d3-251">Task Processor template</span></span>
<span data-ttu-id="d13d3-252">Um modelo de processador de tarefas ajuda-o a tooimplement um processador de tarefas que pode realizar Olá seguintes ações:</span><span class="sxs-lookup"><span data-stu-id="d13d3-252">A Task Processor template helps you tooimplement a task processor that can perform hello following actions:</span></span>

* <span data-ttu-id="d13d3-253">Configure informações de Olá necessárias por cada toorun de tarefa do Batch.</span><span class="sxs-lookup"><span data-stu-id="d13d3-253">Set up hello information required by each Batch task toorun.</span></span>
* <span data-ttu-id="d13d3-254">Execute todas as ações de cada tarefa do Batch.</span><span class="sxs-lookup"><span data-stu-id="d13d3-254">Run all actions required by each Batch task.</span></span>
* <span data-ttu-id="d13d3-255">Guarde as saídas da tarefa toopersistent armazenamento.</span><span class="sxs-lookup"><span data-stu-id="d13d3-255">Save task outputs toopersistent storage.</span></span>

<span data-ttu-id="d13d3-256">Embora um processador de tarefas não é necessário toorun tarefas do batch, Olá das principais vantagens da utilização de um processador de tarefas é que fornece um wrapper tooimplement todas as ações de execução de tarefas numa única localização.</span><span class="sxs-lookup"><span data-stu-id="d13d3-256">Although a task processor is not required toorun tasks on Batch, hello key advantage of using a task processor is that it provides a wrapper tooimplement all task execution actions in one location.</span></span> <span data-ttu-id="d13d3-257">Por exemplo, se precisar de toorun várias aplicações no contexto de Olá de cada tarefa, ou se precisar de toocopy o armazenamento de dados toopersistent depois de concluir cada tarefa.</span><span class="sxs-lookup"><span data-stu-id="d13d3-257">For example, if you need toorun several applications in hello context of each task, or if you need toocopy data toopersistent storage after completing each task.</span></span>

<span data-ttu-id="d13d3-258">as ações de Olá efetuadas pelo processador de tarefa Olá podem ser como simples ou complexas e como muitas ou poucos, conforme necessário, a carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d13d3-258">hello actions performed by hello task processor can be as simple or complex, and as many or as few, as required by your workload.</span></span> <span data-ttu-id="d13d3-259">Além disso, ao implementar todas as ações de tarefas para um processador de tarefas, pode prontamente atualizar ou adicionar ações com base nos requisitos de carga de trabalho ou tooapplications de alterações.</span><span class="sxs-lookup"><span data-stu-id="d13d3-259">Additionally, by implementing all task actions into one task processor, you can readily update or add actions based on changes tooapplications or workload requirements.</span></span> <span data-ttu-id="d13d3-260">No entanto, em alguns casos um processador de tarefas pode não ser solução ideal de Olá da implementação que pode adicionar complexidade desnecessária, por exemplo quando tarefas em execução que podem ser rapidamente iniciadas a partir de uma linha de comandos simple.</span><span class="sxs-lookup"><span data-stu-id="d13d3-260">However, in some cases a task processor might not be hello optimal solution for your implementation as it can add unnecessary complexity, for example when running jobs that can be quickly started from a simple command line.</span></span>

### <a name="create-a-task-processor-using-hello-template"></a><span data-ttu-id="d13d3-261">Criar um processador de tarefas utilizando o modelo de Olá</span><span class="sxs-lookup"><span data-stu-id="d13d3-261">Create a Task Processor using hello template</span></span>
<span data-ttu-id="d13d3-262">tooadd uma solução de toohello de processador de tarefas que criou anteriormente, siga estes passos:</span><span class="sxs-lookup"><span data-stu-id="d13d3-262">tooadd a task processor toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="d13d3-263">Abra a solução existente no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d13d3-263">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="d13d3-264">No Explorador de soluções, solução de Olá rato, clique em **adicionar**e, em seguida, clique em **novo projeto**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-264">In Solution Explorer, right-click hello solution, click **Add**, and then click **New Project**.</span></span>
3. <span data-ttu-id="d13d3-265">Em **Visual c#**, clique em **nuvem**e, em seguida, clique em **processador de tarefa de lote do Azure**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-265">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Task Processor**.</span></span>
4. <span data-ttu-id="d13d3-266">Escreva um nome que descreve a aplicação e identifica este projeto como Olá (por exemplo, o processador de tarefas "LitwareTaskProcessor").</span><span class="sxs-lookup"><span data-stu-id="d13d3-266">Type a name that describes your application and identifies this project as hello task processor (e.g. "LitwareTaskProcessor").</span></span>
5. <span data-ttu-id="d13d3-267">projeto de Olá toocreate, clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="d13d3-267">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="d13d3-268">Por fim, referenciado de compilação Olá projeto tooforce Visual Studio tooload todos os pacotes NuGet e tooverify Olá projeto é válido antes de começar a modificá-lo.</span><span class="sxs-lookup"><span data-stu-id="d13d3-268">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="task-processor-template-files-and-their-purpose"></a><span data-ttu-id="d13d3-269">Ficheiros de modelo de processador de tarefa e respetivo objetivo</span><span class="sxs-lookup"><span data-stu-id="d13d3-269">Task Processor template files and their purpose</span></span>
<span data-ttu-id="d13d3-270">Quando cria um projeto com o modelo de processador de tarefa Olá, gera três grupos de ficheiros de código:</span><span class="sxs-lookup"><span data-stu-id="d13d3-270">When you create a project using hello task processor template, it generates three groups of code files:</span></span>

* <span data-ttu-id="d13d3-271">ficheiros de programa principal Olá (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="d13d3-271">hello main program file (Program.cs).</span></span> <span data-ttu-id="d13d3-272">Contém o ponto de entrada do programa Olá e processamento de exceções de nível superior.</span><span class="sxs-lookup"><span data-stu-id="d13d3-272">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="d13d3-273">Não deve normalmente terá toomodify isto.</span><span class="sxs-lookup"><span data-stu-id="d13d3-273">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="d13d3-274">diretório de Framework Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-274">hello Framework directory.</span></span> <span data-ttu-id="d13d3-275">Contém os ficheiros de Olá responsáveis pelo trabalho de 'automático' Olá efetuado pelo programa de Gestor de tarefas Olá – unpacking parâmetros, a adição de um trabalho do Batch toohello tarefas, etc. Normalmente, não deverá ser preciso toomodify estes ficheiros.</span><span class="sxs-lookup"><span data-stu-id="d13d3-275">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="d13d3-276">ficheiro de processador de tarefa de Olá (TaskProcessor.cs).</span><span class="sxs-lookup"><span data-stu-id="d13d3-276">hello task processor file (TaskProcessor.cs).</span></span> <span data-ttu-id="d13d3-277">Esta é a localização onde irá colocar a lógica de aplicação específicos para executar uma tarefa (normalmente por prós tooan executável de existente).</span><span class="sxs-lookup"><span data-stu-id="d13d3-277">This is where you will put your application-specific logic for executing a task (typically by calling out tooan existing executable).</span></span> <span data-ttu-id="d13d3-278">Código de pré e pós-processamento, tal como a transferência de dados adicionais ou carregar ficheiros de resultado, também aqui.</span><span class="sxs-lookup"><span data-stu-id="d13d3-278">Pre- and post-processing code, such as downloading additional data or uploading result files, also goes here.</span></span>

<span data-ttu-id="d13d3-279">Obviamente pode adicionar ficheiros adicionais conforme necessário toosupport o código de processador de tarefas, dependendo da complexidade Olá da tarefa de Olá dividir lógica.</span><span class="sxs-lookup"><span data-stu-id="d13d3-279">Of course you can add additional files as required toosupport your task processor code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="d13d3-280">o modelo de Olá também gera ficheiros de projeto .NET padrão, tais como um ficheiro. csproj, App. config, Packages, etc.</span><span class="sxs-lookup"><span data-stu-id="d13d3-280">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="d13d3-281">rest Olá desta secção descreve os diferentes ficheiros de Olá e respetiva estrutura de código e explica o que faz cada classe.</span><span class="sxs-lookup"><span data-stu-id="d13d3-281">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Visual Studio Solution Explorer que mostra a solução de modelo de processador de tarefa Olá][solution_explorer02]

<span data-ttu-id="d13d3-283">**Ficheiros de Framework**</span><span class="sxs-lookup"><span data-stu-id="d13d3-283">**Framework files**</span></span>

* <span data-ttu-id="d13d3-284">`Configuration.cs`: Encapsula carregamento Olá tarefa dos dados de configuração, tais como os detalhes da conta do Batch, as credenciais da conta de armazenamento ligado, tarefas e informações e parâmetros da tarefa.</span><span class="sxs-lookup"><span data-stu-id="d13d3-284">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="d13d3-285">Também fornece acesso variáveis de ambiente definidas pelo tooBatch (consulte as definições de ambiente para tarefas, na documentação de Batch de Olá) através de classe de Configuration.EnvironmentVariable Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-285">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="d13d3-286">`IConfiguration.cs`: Deduz Olá a implementação de Olá classe de configuração, para que possa unidade testar o divisor de tarefa com um objeto de configuração falsificados ou mock.</span><span class="sxs-lookup"><span data-stu-id="d13d3-286">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="d13d3-287">`TaskProcessorException.cs`: Representa um erro que exige Olá tarefa manager tooterminate.</span><span class="sxs-lookup"><span data-stu-id="d13d3-287">`TaskProcessorException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="d13d3-288">TaskProcessorException é utilizado toowrap 'era esperado' erros onde as informações de diagnóstico específicas podem ser fornecidas como parte de terminação.</span><span class="sxs-lookup"><span data-stu-id="d13d3-288">TaskProcessorException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>

<span data-ttu-id="d13d3-289">**Processador de tarefas**</span><span class="sxs-lookup"><span data-stu-id="d13d3-289">**Task Processor**</span></span>

* <span data-ttu-id="d13d3-290">`TaskProcessor.cs`: Executa tarefas de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-290">`TaskProcessor.cs`: Runs hello task.</span></span> <span data-ttu-id="d13d3-291">arquitetura de Olá invoca o método de TaskProcessor.Run Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-291">hello framework invokes hello TaskProcessor.Run method.</span></span> <span data-ttu-id="d13d3-292">Esta é a classe de olá onde irá inserir lógica de específicas da aplicação Olá da sua tarefa.</span><span class="sxs-lookup"><span data-stu-id="d13d3-292">This is hello class where you will inject hello application-specific logic of your task.</span></span> <span data-ttu-id="d13d3-293">Implemente o método de execução de Olá para:</span><span class="sxs-lookup"><span data-stu-id="d13d3-293">Implement hello Run method to:</span></span>
  * <span data-ttu-id="d13d3-294">Analisar e validar os parâmetros da tarefa</span><span class="sxs-lookup"><span data-stu-id="d13d3-294">Parse and validate any task parameters</span></span>
  * <span data-ttu-id="d13d3-295">Componha Olá linha de comandos para qualquer programa externo pretende tooinvoke</span><span class="sxs-lookup"><span data-stu-id="d13d3-295">Compose hello command line for any external program you want tooinvoke</span></span>
  * <span data-ttu-id="d13d3-296">Inicie sessão quaisquer informações de diagnóstico que precisa para fins de depuração</span><span class="sxs-lookup"><span data-stu-id="d13d3-296">Log any diagnostic information you may require for debugging purposes</span></span>
  * <span data-ttu-id="d13d3-297">Iniciar um processo com essa linha de comandos</span><span class="sxs-lookup"><span data-stu-id="d13d3-297">Start a process using that command line</span></span>
  * <span data-ttu-id="d13d3-298">Aguarde Olá processo tooexit</span><span class="sxs-lookup"><span data-stu-id="d13d3-298">Wait for hello process tooexit</span></span>
  * <span data-ttu-id="d13d3-299">Capturar o código de saída de Olá de Olá processo toodetermine se esta foi concluída com êxito ou falha</span><span class="sxs-lookup"><span data-stu-id="d13d3-299">Capture hello exit code of hello process toodetermine if it succeeded or failed</span></span>
  * <span data-ttu-id="d13d3-300">Guardar os ficheiros de saída que pretende tookeep toopersistent armazenamento</span><span class="sxs-lookup"><span data-stu-id="d13d3-300">Save any output files you want tookeep toopersistent storage</span></span>

<span data-ttu-id="d13d3-301">**Ficheiros de projeto de linha de comandos do padrão .NET**</span><span class="sxs-lookup"><span data-stu-id="d13d3-301">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="d13d3-302">`App.config`: Ficheiro de configuração da aplicação .NET padrão.</span><span class="sxs-lookup"><span data-stu-id="d13d3-302">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="d13d3-303">`Packages.config`: Ficheiro de dependência de pacote NuGet padrão.</span><span class="sxs-lookup"><span data-stu-id="d13d3-303">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="d13d3-304">`Program.cs`: Contém o ponto de entrada do programa de Olá e processamento de exceções de nível superior.</span><span class="sxs-lookup"><span data-stu-id="d13d3-304">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

## <a name="implementing-hello-task-processor"></a><span data-ttu-id="d13d3-305">Implementar o processador de tarefa Olá</span><span class="sxs-lookup"><span data-stu-id="d13d3-305">Implementing hello task processor</span></span>
<span data-ttu-id="d13d3-306">Quando abrir projeto de modelo de processador de tarefa Olá, projeto Olá terá ficheiros de TaskProcessor.cs Olá abrir por predefinição.</span><span class="sxs-lookup"><span data-stu-id="d13d3-306">When you open hello Task Processor template project, hello project will have hello TaskProcessor.cs file open by default.</span></span> <span data-ttu-id="d13d3-307">Pode implementar a lógica de Olá executar tarefas de Olá na sua carga de trabalho utilizando o método de Run() Olá mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="d13d3-307">You can implement hello run logic for hello tasks in your workload by using hello Run() method shown below:</span></span>

```csharp
/// <summary>
/// Runs hello task processing logic. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello task processor framework invokes hello Run method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation will execute an external program (from resource files or
/// an application package), check hello exit code of that program and
/// save output files toopersistent storage.
/// </summary>
public async Task<int> Run()

{
    try
    {
        //Your code for hello task processor goes here.
        var command = $"compare {_parameters["Frame1"]} {_parameters["Frame2"]} compare.gif";
        using (var process = Process.Start($"cmd /c {command}"))
        {
            process.WaitForExit();
            var taskOutputStorage = new TaskOutputStorage(
            _configuration.StorageAccount,
            _configuration.JobId,
            _configuration.TaskId
            );
            await taskOutputStorage.SaveAsync(
            TaskOutputKind.TaskOutput,
            @"..\stdout.txt",
            @"stdout.txt"
            );
            return process.ExitCode;
        }
    }
    catch (Exception ex)
    {
        throw new TaskProcessorException(
        $"{ex.GetType().Name} exception in run task processor: {ex.Message}",
        ex
        );
    }
}
```
> [!NOTE]
> <span data-ttu-id="d13d3-308">Olá anotada secção Olá Run() método é secção apenas Olá código do modelo de processador de tarefa Olá que foi concebida para lhe toomodify adicionando lógica Olá executar tarefas de Olá na sua carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d13d3-308">hello annotated section in hello Run() method is hello only section of hello Task Processor template code that is intended for you toomodify by adding hello run logic for hello tasks in your workload.</span></span> <span data-ttu-id="d13d3-309">Se quiser toomodify secção diferente do modelo de Olá,. primeiro familiarizar-se com como funciona o Batch ao rever Olá Batch documentação e experimentar alguns dos exemplos de código do Batch Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-309">If you want toomodify a different section of hello template, please first familiarize yourself with how Batch works by reviewing hello Batch documentation and trying out a few of hello Batch code samples.</span></span>
> 
> 

<span data-ttu-id="d13d3-310">Olá Run() método é responsável por iniciar Olá linha de comandos, a partir de um ou mais processos, a aguardar que todos os processos toocomplete, guardar resultados de Olá e, finalmente, devolvendo com um código de saída.</span><span class="sxs-lookup"><span data-stu-id="d13d3-310">hello Run() method is responsible for launching hello command line, starting one or more processes, waiting for all process toocomplete, saving hello results, and finally returning with an exit code.</span></span> <span data-ttu-id="d13d3-311">Olá Run() método é onde implementar Olá lógica para as suas tarefas de processamento.</span><span class="sxs-lookup"><span data-stu-id="d13d3-311">hello Run() method is where you implement hello processing logic for your tasks.</span></span> <span data-ttu-id="d13d3-312">arquitetura de processador de tarefa Olá invoca o método de Run() Olá para si; Não é necessário toocall-lo por si.</span><span class="sxs-lookup"><span data-stu-id="d13d3-312">hello task processor framework invokes hello Run() method for you; you do not need toocall it yourself.</span></span>

<span data-ttu-id="d13d3-313">A implementação de Run() tem acesso ao:</span><span class="sxs-lookup"><span data-stu-id="d13d3-313">Your Run() implementation has access to:</span></span>

* <span data-ttu-id="d13d3-314">Olá parâmetros da tarefa, através de Olá `_parameters` campo.</span><span class="sxs-lookup"><span data-stu-id="d13d3-314">hello task parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="d13d3-315">Olá ids de tarefas e, através de Olá `_jobId` e `_taskId` campos.</span><span class="sxs-lookup"><span data-stu-id="d13d3-315">hello job and task ids, via hello `_jobId` and `_taskId` fields.</span></span>
* <span data-ttu-id="d13d3-316">configuração da tarefa Olá, através de Olá `_configuration` campo.</span><span class="sxs-lookup"><span data-stu-id="d13d3-316">hello task configuration, via hello `_configuration` field.</span></span>

<span data-ttu-id="d13d3-317">**Falha de tarefa**</span><span class="sxs-lookup"><span data-stu-id="d13d3-317">**Task failure**</span></span>

<span data-ttu-id="d13d3-318">Em caso de falha, pode sair o método de Run() Olá ao gerar uma exceção, mas esta opção deixa o processador de excepções de nível superior de Olá no controlo de código de saída de tarefas Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-318">In case of failure, you can exit hello Run() method by throwing an exception, but this leaves hello top level exception handler in control of hello task exit code.</span></span> <span data-ttu-id="d13d3-319">Se precisar de código de saída do toocontrol Olá, de modo a que poder diferenciar os diferentes tipos de falha, por exemplo para fins de diagnóstico ou porque algumas modos de falha devem terminar tarefa Olá e outros não devem, em seguida, deve sair o método de Run() Olá devolvendo um código de saída diferente de zero.</span><span class="sxs-lookup"><span data-stu-id="d13d3-319">If you need toocontrol hello exit code so that you can distinguish different types of failure, for example for diagnostic purposes or because some failure modes should terminate hello job and others should not, then you should exit hello Run() method by returning a non-zero exit code.</span></span> <span data-ttu-id="d13d3-320">Isto torna-se o código de saída de tarefas Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-320">This becomes hello task exit code.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-task-processor-template"></a><span data-ttu-id="d13d3-321">Sair códigos e exceções no modelo de processador de tarefa Olá</span><span class="sxs-lookup"><span data-stu-id="d13d3-321">Exit codes and exceptions in hello Task Processor template</span></span>
<span data-ttu-id="d13d3-322">Códigos de saída e exceções de fornecem um mecanismo toodetermine Olá resultado executarem um programa e pode ajudar a identificar quaisquer problemas com a execução de Olá do programa de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-322">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help identify any problems with hello execution of hello program.</span></span> <span data-ttu-id="d13d3-323">modelo de processador de tarefa Olá implementa códigos de saída Olá e exceções descritas nesta secção.</span><span class="sxs-lookup"><span data-stu-id="d13d3-323">hello Task Processor template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="d13d3-324">Uma tarefa do processador de tarefas que é implementada com o modelo de processador de tarefa Olá pode devolver as três códigos de saída possíveis:</span><span class="sxs-lookup"><span data-stu-id="d13d3-324">A task processor task that is implemented with hello Task Processor template can return three possible exit codes:</span></span>

| <span data-ttu-id="d13d3-325">Código</span><span class="sxs-lookup"><span data-stu-id="d13d3-325">Code</span></span> | <span data-ttu-id="d13d3-326">Descrição</span><span class="sxs-lookup"><span data-stu-id="d13d3-326">Description</span></span> |
| --- | --- |
| <span data-ttu-id="d13d3-327">[Process.ExitCode][process_exitcode]</span><span class="sxs-lookup"><span data-stu-id="d13d3-327">[Process.ExitCode][process_exitcode]</span></span> |<span data-ttu-id="d13d3-328">processador de tarefa Olá ficou toocompletion.</span><span class="sxs-lookup"><span data-stu-id="d13d3-328">hello task processor ran toocompletion.</span></span> <span data-ttu-id="d13d3-329">Tenha em atenção que isto não implica desse programa Olá que é invocado foi concluída com êxito – apenas esse processador de tarefa Olá invocado-lo com êxito e efetuar qualquer processamento posterior sem exceções.</span><span class="sxs-lookup"><span data-stu-id="d13d3-329">Note that this does not imply that hello program you invoked was successful – only that hello task processor invoked it successfully and performed any post-processing without exceptions.</span></span> <span data-ttu-id="d13d3-330">significado Olá do código de saída Olá depende do programa de Olá invocado – o código de saída 0 significa habitualmente programa Olá foi concluída com êxito e outro código de saída significa Olá programa tenha falhado.</span><span class="sxs-lookup"><span data-stu-id="d13d3-330">hello meaning of hello exit code depends on hello invoked program – typically exit code 0 means hello program succeeded and any other exit code means hello program failed.</span></span> |
| <span data-ttu-id="d13d3-331">1</span><span class="sxs-lookup"><span data-stu-id="d13d3-331">1</span></span> |<span data-ttu-id="d13d3-332">processador de tarefa Olá falhou com uma exceção numa parte do programa de Olá 'esperada'.</span><span class="sxs-lookup"><span data-stu-id="d13d3-332">hello task processor failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="d13d3-333">Olá exceção foi tooa traduzida `TaskProcessorException` com informações de diagnóstico e, sempre que possível, sugestões para resolver Olá falha.</span><span class="sxs-lookup"><span data-stu-id="d13d3-333">hello exception was translated tooa `TaskProcessorException` with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="d13d3-334">2</span><span class="sxs-lookup"><span data-stu-id="d13d3-334">2</span></span> |<span data-ttu-id="d13d3-335">processador de tarefa Olá falhou com uma exceção 'inesperada'.</span><span class="sxs-lookup"><span data-stu-id="d13d3-335">hello task processor failed with an 'unexpected' exception.</span></span> <span data-ttu-id="d13d3-336">Olá exceção foi iniciada toostandard de saída, mas o processador de tarefa Olá foi tooadd não é possível quaisquer informações de diagnóstico ou remediação adicionais.</span><span class="sxs-lookup"><span data-stu-id="d13d3-336">hello exception was logged toostandard output, but hello task processor was unable tooadd any additional diagnostic or remediation information.</span></span> |

> [!NOTE]
> <span data-ttu-id="d13d3-337">Se o programa Olá que invocar utiliza saída códigos 1 e 2 tooindicate falha específica modos, em seguida, utilizar códigos de saída a 1 e 2 para erros de processador de tarefas é ambígua.</span><span class="sxs-lookup"><span data-stu-id="d13d3-337">If hello program you invoke uses exit codes 1 and 2 tooindicate specific failure modes, then using exit codes 1 and 2 for task processor errors is ambiguous.</span></span> <span data-ttu-id="d13d3-338">Pode alterar estas tarefas processador códigos toodistinctive saída códigos de erro de editando casos de exceção Olá no ficheiro Program.cs de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-338">You can change these task processor error codes toodistinctive exit codes by editing hello exception cases in hello Program.cs file.</span></span>
> 
> 

<span data-ttu-id="d13d3-339">Todas as informações de Olá devolvidas pelo exceções são escritas em ficheiros stdout.txt e stderr.txt.</span><span class="sxs-lookup"><span data-stu-id="d13d3-339">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="d13d3-340">Para obter mais informações, consulte o erro processar, no Olá documentação do Batch.</span><span class="sxs-lookup"><span data-stu-id="d13d3-340">For more information, see Error Handling, in hello Batch documentation.</span></span>

### <a name="client-considerations"></a><span data-ttu-id="d13d3-341">Considerações de cliente</span><span class="sxs-lookup"><span data-stu-id="d13d3-341">Client considerations</span></span>
<span data-ttu-id="d13d3-342">**Credenciais do armazenamento**</span><span class="sxs-lookup"><span data-stu-id="d13d3-342">**Storage credentials**</span></span>

<span data-ttu-id="d13d3-343">Se o processador de tarefas utiliza saídas de toopersist ao armazenamento de Blobs do Azure, por exemplo utilizando a biblioteca de programa auxiliar de convenções de ficheiro Olá, em seguida, necessita de acesso demasiado*ou* Olá credenciais de conta de armazenamento de nuvem *ou* um URL de contentor do blob que inclui uma assinatura de acesso partilhado (SAS).</span><span class="sxs-lookup"><span data-stu-id="d13d3-343">If your task processor uses Azure blob storage toopersist outputs, for example using hello file conventions helper library, then it needs access too*either* hello cloud storage account credentials *or* a blob container URL that includes a shared access signature (SAS).</span></span> <span data-ttu-id="d13d3-344">modelo de Olá inclui suporte para fornecer credenciais através de variáveis de ambiente comuns.</span><span class="sxs-lookup"><span data-stu-id="d13d3-344">hello template includes support for providing credentials via common environment variables.</span></span> <span data-ttu-id="d13d3-345">O cliente pode passar as credenciais do armazenamento de Olá da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="d13d3-345">Your client can pass hello storage credentials as follows:</span></span>

```csharp
job.CommonEnvironmentSettings = new [] {
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="d13d3-346">conta de armazenamento Olá, em seguida, está disponível no Olá TaskProcessor classe através de Olá `_configuration.StorageAccount` propriedade.</span><span class="sxs-lookup"><span data-stu-id="d13d3-346">hello storage account is then available in hello TaskProcessor class via hello `_configuration.StorageAccount` property.</span></span>

<span data-ttu-id="d13d3-347">Se preferir toouse um URL de contentor com SAS, também pode transmitir este através de uma definição de ambiente comuns de tarefa, mas o modelo de processador de tarefa Olá não atualmente inclui suporte incorporado para este.</span><span class="sxs-lookup"><span data-stu-id="d13d3-347">If you prefer toouse a container URL with SAS, you can also pass this via an job common environment setting, but hello task processor template does not currently include built-in support for this.</span></span>

<span data-ttu-id="d13d3-348">**Configuração de armazenamento**</span><span class="sxs-lookup"><span data-stu-id="d13d3-348">**Storage setup**</span></span>

<span data-ttu-id="d13d3-349">Recomenda-se que Olá cliente ou a tarefa do Gestor de tarefas criar quaisquer contentores necessários pelas tarefas antes de adicionar a tarefa de toohello Olá tarefas.</span><span class="sxs-lookup"><span data-stu-id="d13d3-349">It is recommended that hello client or job manager task create any containers required by tasks before adding hello tasks toohello job.</span></span> <span data-ttu-id="d13d3-350">Isto é obrigatório que se utilizar um URL de contentor com SAS, tal como um URL não inclui contentor de Olá toocreate de permissão.</span><span class="sxs-lookup"><span data-stu-id="d13d3-350">This is mandatory if you use a container URL with SAS, as such a URL does not include permission toocreate hello container.</span></span> <span data-ttu-id="d13d3-351">Recomenda-se, mesmo que se passa credenciais da conta de armazenamento, como ela guarda cada tarefa ter toocall CloudBlobContainer.CreateIfNotExistsAsync no contentor de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-351">It is recommended even if you pass storage account credentials, as it saves every task having toocall CloudBlobContainer.CreateIfNotExistsAsync on hello container.</span></span>

## <a name="pass-parameters-and-environment-variables"></a><span data-ttu-id="d13d3-352">Transmita os parâmetros e variáveis de ambiente</span><span class="sxs-lookup"><span data-stu-id="d13d3-352">Pass parameters and environment variables</span></span>
### <a name="pass-environment-settings"></a><span data-ttu-id="d13d3-353">Transmita as definições de ambiente</span><span class="sxs-lookup"><span data-stu-id="d13d3-353">Pass environment settings</span></span>
<span data-ttu-id="d13d3-354">Um cliente pode transmitir informações toohello tarefa do Gestor de tarefas no formulário de Olá das definições de ambiente.</span><span class="sxs-lookup"><span data-stu-id="d13d3-354">A client can pass information toohello job manager task in hello form of environment settings.</span></span> <span data-ttu-id="d13d3-355">Esta informação, em seguida, pode ser utilizada por Olá tarefa do Gestor de tarefas quando a tarefa de computação de gerar Olá tarefas processador as tarefas que serão executado como parte da Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-355">This information can then be used by hello job manager task when generating hello task processor tasks that will run as part of hello compute job.</span></span> <span data-ttu-id="d13d3-356">Exemplos de informações de Olá que podem passar como definições de ambiente são:</span><span class="sxs-lookup"><span data-stu-id="d13d3-356">Examples of hello information that you can pass as environment settings are:</span></span>

* <span data-ttu-id="d13d3-357">Chaves de conta e o nome de conta de armazenamento</span><span class="sxs-lookup"><span data-stu-id="d13d3-357">Storage account name and account keys</span></span>
* <span data-ttu-id="d13d3-358">URL da conta de batch</span><span class="sxs-lookup"><span data-stu-id="d13d3-358">Batch account URL</span></span>
* <span data-ttu-id="d13d3-359">Chave de conta do batch</span><span class="sxs-lookup"><span data-stu-id="d13d3-359">Batch account key</span></span>

<span data-ttu-id="d13d3-360">Olá serviço Batch tem um mecanismo simples toopass ambiente definições tooa tarefa do Gestor de tarefas utilizando Olá `EnvironmentSettings` propriedade no [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span><span class="sxs-lookup"><span data-stu-id="d13d3-360">hello Batch service has a simple mechanism toopass environment settings tooa job manager task by using hello `EnvironmentSettings` property in [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span></span>

<span data-ttu-id="d13d3-361">Por exemplo, tooget Olá `BatchClient` instância para uma conta do Batch, pode passar como variáveis de ambiente de cliente de Olá Olá URL de código e partilhados as credenciais da chave Olá conta de Batch.</span><span class="sxs-lookup"><span data-stu-id="d13d3-361">For example, tooget hello `BatchClient` instance for a Batch account, you can pass as environment variables from hello client code hello URL and shared key credentials for hello Batch account.</span></span> <span data-ttu-id="d13d3-362">Da mesma forma, a conta de armazenamento de Olá tooaccess que está ligado a conta do Batch toohello, pode passar o nome de conta do storage Olá e chave de conta do storage Olá como variáveis de ambiente.</span><span class="sxs-lookup"><span data-stu-id="d13d3-362">Likewise, tooaccess hello storage account that is linked toohello Batch account, you can pass hello storage account name and hello storage account key as environment variables.</span></span>

### <a name="pass-parameters-toohello-job-manager-template"></a><span data-ttu-id="d13d3-363">Passar o modelo de tarefa do Gestor de toohello parâmetros</span><span class="sxs-lookup"><span data-stu-id="d13d3-363">Pass parameters toohello Job Manager template</span></span>
<span data-ttu-id="d13d3-364">Em muitos casos, é útil toopass por tarefa parâmetros toohello tarefa de gestão, a tarefa de Olá toocontrol dividir o processo ou tarefas de Olá tooconfigure para Olá tarefa.</span><span class="sxs-lookup"><span data-stu-id="d13d3-364">In many cases, it's useful toopass per-job parameters toohello job manager task, either toocontrol hello job splitting process or tooconfigure hello tasks for hello job.</span></span> <span data-ttu-id="d13d3-365">Pode fazê-lo através do carregamento de um ficheiro JSON com o nome Parameters. JSON como um ficheiro de recursos para Olá tarefa do Gestor de tarefas.</span><span class="sxs-lookup"><span data-stu-id="d13d3-365">You can do this by uploading a JSON file named parameters.json as a resource file for hello job manager task.</span></span> <span data-ttu-id="d13d3-366">parâmetros de Olá, em seguida, podem ficar disponíveis na Olá `JobSplitter._parameters` campo no modelo de tarefa do Gestor de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-366">hello parameters can then become available in hello `JobSplitter._parameters` field in hello Job Manager template.</span></span>

> [!NOTE]
> <span data-ttu-id="d13d3-367">processador de parâmetro incorporada Olá suporta apenas dicionários de cadeia-cadeia.</span><span class="sxs-lookup"><span data-stu-id="d13d3-367">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="d13d3-368">Se quiser toopass valores JSON complexos, como os valores de parâmetros, será necessário toopass como cadeias e analisá-los no divisor da tarefa de Olá ou modificar do framework Olá `Configuration.GetJobParameters` método.</span><span class="sxs-lookup"><span data-stu-id="d13d3-368">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello job splitter, or modify hello framework's `Configuration.GetJobParameters` method.</span></span>
> 
> 

### <a name="pass-parameters-toohello-task-processor-template"></a><span data-ttu-id="d13d3-369">Passar o modelo de processador de tarefa toohello de parâmetros</span><span class="sxs-lookup"><span data-stu-id="d13d3-369">Pass parameters toohello Task Processor template</span></span>
<span data-ttu-id="d13d3-370">Pode também passar os parâmetros tooindividual tarefas implementadas utilizando o modelo de processador de tarefa Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-370">You can also pass parameters tooindividual tasks implemented using hello Task Processor template.</span></span> <span data-ttu-id="d13d3-371">Tal como com modelos do Gestor de tarefas de Olá, modelo de processador de tarefa Olá procura um ficheiro de recursos com o nome</span><span class="sxs-lookup"><span data-stu-id="d13d3-371">Just as with hello job manager template, hello task processor template looks for a resource file named</span></span>

<span data-ttu-id="d13d3-372">Parameters. JSON e se encontrar esta carrega-o como o dicionário de parâmetros de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-372">parameters.json, and if found it loads it as hello parameters dictionary.</span></span> <span data-ttu-id="d13d3-373">Existem duas opções para como toopass parâmetros toohello tarefas tarefas de processador:</span><span class="sxs-lookup"><span data-stu-id="d13d3-373">There are a couple of options for how toopass parameters toohello task processor tasks:</span></span>

* <span data-ttu-id="d13d3-374">Reutilize os parâmetros da tarefa Olá JSON.</span><span class="sxs-lookup"><span data-stu-id="d13d3-374">Reuse hello job parameters JSON.</span></span> <span data-ttu-id="d13d3-375">Isto funciona bem se parâmetros apenas Olá são ao nível da tarefa (por exemplo, uma composição altura e largura).</span><span class="sxs-lookup"><span data-stu-id="d13d3-375">This works well if hello only parameters are job-wide ones (for example, a render height and width).</span></span> <span data-ttu-id="d13d3-376">toodo, quando criar um CloudTask no divisor da tarefa de Olá, adicionar um objeto de ficheiro de recursos do referência toohello Parameters. JSON de ResourceFiles do Olá tarefa do Gestor (`JobSplitter._jobManagerTask.ResourceFiles`) coleção ResourceFiles do toohello CloudTask.</span><span class="sxs-lookup"><span data-stu-id="d13d3-376">toodo this, when creating a CloudTask in hello job splitter, add a reference toohello parameters.json resource file object from hello job manager task's ResourceFiles (`JobSplitter._jobManagerTask.ResourceFiles`) toohello CloudTask's ResourceFiles collection.</span></span>
* <span data-ttu-id="d13d3-377">Gerar e carregar um documento de Parameters. JSON de específicas de tarefas como parte da execução da tarefa divisor para fazer referência a esse blob na coleção de ficheiros de recursos da tarefa de Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-377">Generate and upload a task-specific parameters.json document as part of job splitter execution, and reference that blob in hello task's resource files collection.</span></span> <span data-ttu-id="d13d3-378">Isto é necessário se diferentes tarefas possuem parâmetros diferentes.</span><span class="sxs-lookup"><span data-stu-id="d13d3-378">This is necessary if different tasks have different parameters.</span></span> <span data-ttu-id="d13d3-379">Um exemplo pode ser um cenário de composição 3D onde o índice de moldura Olá é transmitido toohello tarefas como um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="d13d3-379">An example might be a 3D rendering scenario where hello frame index is passed toohello task as a parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="d13d3-380">processador de parâmetro incorporada Olá suporta apenas dicionários de cadeia-cadeia.</span><span class="sxs-lookup"><span data-stu-id="d13d3-380">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="d13d3-381">Se quiser toopass valores JSON complexos, como os valores de parâmetros, será necessário toopass como cadeias e analisá-los no processador de tarefa Olá ou modificar do framework Olá `Configuration.GetTaskParameters` método.</span><span class="sxs-lookup"><span data-stu-id="d13d3-381">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello task processor, or modify hello framework's `Configuration.GetTaskParameters` method.</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="d13d3-382">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="d13d3-382">Next steps</span></span>
### <a name="persist-job-and-task-output-tooazure-storage"></a><span data-ttu-id="d13d3-383">Manter a tarefa e tarefas da saída tooAzure armazenamento</span><span class="sxs-lookup"><span data-stu-id="d13d3-383">Persist job and task output tooAzure Storage</span></span>
<span data-ttu-id="d13d3-384">Outra ferramenta útil no desenvolvimento de solução do Batch é [convenções de ficheiro do Azure Batch][nuget_package].</span><span class="sxs-lookup"><span data-stu-id="d13d3-384">Another helpful tool in Batch solution development is [Azure Batch File Conventions][nuget_package].</span></span> <span data-ttu-id="d13d3-385">Utilizar esta biblioteca de classe do .NET (atualmente em pré-visualização) no arquivo de tooeasily de aplicações de .NET do Batch e obter tooand saídas de tarefa do armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="d13d3-385">Use this .NET class library (currently in preview) in your Batch .NET applications tooeasily store and retrieve task outputs tooand from Azure Storage.</span></span> <span data-ttu-id="d13d3-386">[Manter a saída de tarefas e do Azure Batch](batch-task-output.md) contém um debate completo da biblioteca de Olá e a sua utilização.</span><span class="sxs-lookup"><span data-stu-id="d13d3-386">[Persist Azure Batch job and task output](batch-task-output.md) contains a full discussion of hello library and its usage.</span></span>

### <a name="batch-forum"></a><span data-ttu-id="d13d3-387">Fórum do batch</span><span class="sxs-lookup"><span data-stu-id="d13d3-387">Batch Forum</span></span>
<span data-ttu-id="d13d3-388">Olá [fórum do Azure Batch] [ forum] no MSDN é ótimo colocar toodiscuss Batch e colocar questões sobre serviço Olá.</span><span class="sxs-lookup"><span data-stu-id="d13d3-388">hello [Azure Batch Forum][forum] on MSDN is a great place toodiscuss Batch and ask questions about hello service.</span></span> <span data-ttu-id="d13d3-389">HEAD na ativação pós-falha para mensagens "temporária" úteis e publique as suas perguntas que possam surgir ao criar as soluções do Batch.</span><span class="sxs-lookup"><span data-stu-id="d13d3-389">Head on over for helpful "sticky" posts, and post your questions as they arise while you build your Batch solutions.</span></span>

[forum]: https://social.msdn.microsoft.com/forums/azure/en-US/home?forum=azurebatch
[net_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.jobmanagertask.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[nuget_package]: https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files
[process_exitcode]: https://msdn.microsoft.com/library/system.diagnostics.process.exitcode.aspx
[vs_gallery]: https://visualstudiogallery.msdn.microsoft.com/
[vs_gallery_templates]: https://go.microsoft.com/fwlink/?linkid=820714
[vs_find_use_ext]: https://msdn.microsoft.com/library/dd293638.aspx

[diagram01]: ./media/batch-visual-studio-templates/diagram01.png
[solution_explorer01]: ./media/batch-visual-studio-templates/solution_explorer01.png
[solution_explorer02]: ./media/batch-visual-studio-templates/solution_explorer02.png
