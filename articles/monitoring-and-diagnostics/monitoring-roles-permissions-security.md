---
title: "aaaGet começar a utilizar segurança com a monitorização do Azure, funções e permissões | Microsoft Docs"
description: "Saiba como funções incorporadas e permissões toorestrict do Monitor de Azure toouse aceder aos recursos toomonitoring."
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 2686e53b-72f0-4312-bcd3-3dc1b4a9b912
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/26/2016
ms.author: johnkem
ms.openlocfilehash: 44fdf2a697050309480dfc164ebab51445b19bc8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="get-started-with-roles-permissions-and-security-with-azure-monitor"></a><span data-ttu-id="db42f-103">Introdução à segurança com a monitorização do Azure, funções e permissões</span><span class="sxs-lookup"><span data-stu-id="db42f-103">Get started with roles, permissions, and security with Azure Monitor</span></span>
<span data-ttu-id="db42f-104">Tem de várias equipas toostrictly limitá toomonitoring aceder a dados e definições.</span><span class="sxs-lookup"><span data-stu-id="db42f-104">Many teams need toostrictly regulate access toomonitoring data and settings.</span></span> <span data-ttu-id="db42f-105">Por exemplo, se tiver os membros da equipa que trabalham exclusivamente no monitorização (engenheiros de suporte, os engenheiros de devops) ou se utilizar um fornecedor de serviço geridas, poderá ser útil toogrant-lhes aceder tooonly dados de monitorização ao restringir os respetivos toocreate de capacidade, modificar, ou Elimine recursos.</span><span class="sxs-lookup"><span data-stu-id="db42f-105">For example, if you have team members who work exclusively on monitoring (support engineers, devops engineers) or if you use a managed service provider, you may want toogrant them access tooonly monitoring data while restricting their ability toocreate, modify, or delete resources.</span></span> <span data-ttu-id="db42f-106">Este artigo mostra como tooquickly aplicar um incorporada monitorização RBAC função tooa utilizador no Azure ou criar a sua própria função personalizada para um utilizador que tem permissões de monitorização limitadas.</span><span class="sxs-lookup"><span data-stu-id="db42f-106">This article shows how tooquickly apply a built-in monitoring RBAC role tooa user in Azure or build your own custom role for a user who needs limited monitoring permissions.</span></span> <span data-ttu-id="db42f-107">-Descreve considerações de segurança para os seus recursos relacionados com o Monitor do Azure, em seguida, e como pode limitar o acesso toohello dados contêm.</span><span class="sxs-lookup"><span data-stu-id="db42f-107">It then discusses security considerations for your Azure Monitor-related resources and how you can limit access toohello data they contain.</span></span>

## <a name="built-in-monitoring-roles"></a><span data-ttu-id="db42f-108">Monitorização de funções incorporadas</span><span class="sxs-lookup"><span data-stu-id="db42f-108">Built-in monitoring roles</span></span>
<span data-ttu-id="db42f-109">Funções incorporadas do Monitor do Azure são toohelp concebida limite acesso tooresources numa subscrição permitindo os responsáveis pela monitorização de infraestrutura tooobtain e configurar dados de Olá que precisam.</span><span class="sxs-lookup"><span data-stu-id="db42f-109">Azure Monitor’s built-in roles are designed toohelp limit access tooresources in a subscription while still enabling those responsible for monitoring infrastructure tooobtain and configure hello data they need.</span></span> <span data-ttu-id="db42f-110">Monitor do Azure fornece duas funções out of box: A monitorização leitor e contribuinte de monitorização.</span><span class="sxs-lookup"><span data-stu-id="db42f-110">Azure Monitor provides two out-of-the-box roles: A Monitoring Reader and a Monitoring Contributor.</span></span>

### <a name="monitoring-reader"></a><span data-ttu-id="db42f-111">Leitor de monitorização</span><span class="sxs-lookup"><span data-stu-id="db42f-111">Monitoring Reader</span></span>
<span data-ttu-id="db42f-112">Pessoas atribuídas a função de leitor de monitorização de Olá podem ver todos os dados de monitorização de uma subscrição, mas não é possível modificar qualquer recurso ou editar quaisquer recursos relacionados toomonitoring de definições.</span><span class="sxs-lookup"><span data-stu-id="db42f-112">People assigned hello Monitoring Reader role can view all monitoring data in a subscription but cannot modify any resource or edit any settings related toomonitoring resources.</span></span> <span data-ttu-id="db42f-113">Esta função é adequada para os utilizadores numa organização, tais como engenheiros de suporte ou operações que necessitam de toobe capaz de:</span><span class="sxs-lookup"><span data-stu-id="db42f-113">This role is appropriate for users in an organization, such as support or operations engineers, who need toobe able to:</span></span>

* <span data-ttu-id="db42f-114">Ver os dashboards de monitorização no portal de Olá e criar os seus próprios dashboards de monitorização privadas.</span><span class="sxs-lookup"><span data-stu-id="db42f-114">View monitoring dashboards in hello portal and create their own private monitoring dashboards.</span></span>
* <span data-ttu-id="db42f-115">A consulta utilizando Olá com base nas métricas [API REST da Azure Monitor](https://msdn.microsoft.com/library/azure/dn931930.aspx), [cmdlets do PowerShell](insights-powershell-samples.md), ou [CLI de várias plataformas](insights-cli-samples.md).</span><span class="sxs-lookup"><span data-stu-id="db42f-115">Query for metrics using hello [Azure Monitor REST API](https://msdn.microsoft.com/library/azure/dn931930.aspx), [PowerShell cmdlets](insights-powershell-samples.md), or [cross-platform CLI](insights-cli-samples.md).</span></span>
* <span data-ttu-id="db42f-116">Consulta Olá utilizando o portal de Olá, API de REST de Monitor do Azure, os cmdlets do PowerShell ou CLI de várias plataformas de registo de atividade.</span><span class="sxs-lookup"><span data-stu-id="db42f-116">Query hello Activity Log using hello portal, Azure Monitor REST API, PowerShell cmdlets, or cross-platform CLI.</span></span>
* <span data-ttu-id="db42f-117">Olá vista [definições de diagnóstico](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) para um recurso.</span><span class="sxs-lookup"><span data-stu-id="db42f-117">View hello [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.</span></span>
* <span data-ttu-id="db42f-118">Olá vista [registo perfil](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) para uma subscrição.</span><span class="sxs-lookup"><span data-stu-id="db42f-118">View hello [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.</span></span>
* <span data-ttu-id="db42f-119">Ver definições de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="db42f-119">View autoscale settings.</span></span>
* <span data-ttu-id="db42f-120">Atividade de alerta de vista e as definições.</span><span class="sxs-lookup"><span data-stu-id="db42f-120">View alert activity and settings.</span></span>
* <span data-ttu-id="db42f-121">Aceder a dados do Application Insights e ver dados AI análise.</span><span class="sxs-lookup"><span data-stu-id="db42f-121">Access Application Insights data and view data in AI Analytics.</span></span>
* <span data-ttu-id="db42f-122">Procurar dados de área de trabalho de análise de registos (OMS), incluindo dados de utilização para a área de trabalho Olá.</span><span class="sxs-lookup"><span data-stu-id="db42f-122">Search Log Analytics (OMS) workspace data including usage data for hello workspace.</span></span>
* <span data-ttu-id="db42f-123">Ver grupos de gestão de análise de registos (OMS).</span><span class="sxs-lookup"><span data-stu-id="db42f-123">View Log Analytics (OMS) management groups.</span></span>
* <span data-ttu-id="db42f-124">Obter o esquema de pesquisa do Olá análise de registos (OMS).</span><span class="sxs-lookup"><span data-stu-id="db42f-124">Retrieve hello Log Analytics (OMS) search schema.</span></span>
* <span data-ttu-id="db42f-125">Lista de pacotes de intelligence de análise de registos (OMS).</span><span class="sxs-lookup"><span data-stu-id="db42f-125">List Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="db42f-126">Obter e executar a análise de registos (OMS) pesquisas guardadas.</span><span class="sxs-lookup"><span data-stu-id="db42f-126">Retrieve and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="db42f-127">Obter a configuração de armazenamento da análise de registos (OMS) Olá.</span><span class="sxs-lookup"><span data-stu-id="db42f-127">Retrieve hello Log Analytics (OMS) storage configuration.</span></span>

> [!NOTE]
> <span data-ttu-id="db42f-128">Esta função não conceda acesso de leitura toolog dados que foi hub de eventos de transmissão em fluxo tooan ou armazenados numa conta do storage.</span><span class="sxs-lookup"><span data-stu-id="db42f-128">This role does not give read access toolog data that has been streamed tooan event hub or stored in a storage account.</span></span> <span data-ttu-id="db42f-129">[Consulte abaixo](#security-considerations-for-monitoring-data) para obter informações sobre como configurar o acesso a recursos toothese.</span><span class="sxs-lookup"><span data-stu-id="db42f-129">[See below](#security-considerations-for-monitoring-data) for information on configuring access toothese resources.</span></span>
> 
> 

### <a name="monitoring-contributor"></a><span data-ttu-id="db42f-130">Monitorização contribuinte</span><span class="sxs-lookup"><span data-stu-id="db42f-130">Monitoring Contributor</span></span>
<span data-ttu-id="db42f-131">As pessoas atribuídas Olá contribuinte de monitorização de função pode visualizar todos os dados de monitorização de uma subscrição e criar ou modificar as definições de monitorização, mas não é possível modificar quaisquer outros recursos.</span><span class="sxs-lookup"><span data-stu-id="db42f-131">People assigned hello Monitoring Contributor role can view all monitoring data in a subscription and create or modify monitoring settings, but cannot modify any other resources.</span></span> <span data-ttu-id="db42f-132">Esta função é um superconjunto da função de leitor de monitorização de Olá e é adequada para os membros da equipa de monitorização ou fornecedores de serviço gerida que, além disso toohello permissões acima, também necessitam de toobe conseguir da organização:</span><span class="sxs-lookup"><span data-stu-id="db42f-132">This role is a superset of hello Monitoring Reader role, and is appropriate for members of an organization’s monitoring team or managed service providers who, in addition toohello permissions above, also need toobe able to:</span></span>

* <span data-ttu-id="db42f-133">Publica os dashboards de monitorização como um dashboard partilhado.</span><span class="sxs-lookup"><span data-stu-id="db42f-133">Publish monitoring dashboards as a shared dashboard.</span></span>
* <span data-ttu-id="db42f-134">Definir [definições de diagnóstico](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) para um resource.*</span><span class="sxs-lookup"><span data-stu-id="db42f-134">Set [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.*</span></span>
* <span data-ttu-id="db42f-135">Conjunto Olá [registo perfil](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) para um subscription.*</span><span class="sxs-lookup"><span data-stu-id="db42f-135">Set hello [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.*</span></span>
* <span data-ttu-id="db42f-136">Defina a atividade de alerta e as definições.</span><span class="sxs-lookup"><span data-stu-id="db42f-136">Set alert activity and settings.</span></span>
* <span data-ttu-id="db42f-137">Crie testes web do Application Insights e componentes.</span><span class="sxs-lookup"><span data-stu-id="db42f-137">Create Application Insights web tests and components.</span></span>
* <span data-ttu-id="db42f-138">Área de trabalho de análise de registos (OMS) de lista de chaves partilhadas.</span><span class="sxs-lookup"><span data-stu-id="db42f-138">List Log Analytics (OMS) workspace shared keys.</span></span>
* <span data-ttu-id="db42f-139">Ativar ou desativar a análise de registos (OMS) intelligence pacotes.</span><span class="sxs-lookup"><span data-stu-id="db42f-139">Enable or disable Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="db42f-140">Criar e eliminar e executar a análise de registos (OMS) pesquisas guardadas.</span><span class="sxs-lookup"><span data-stu-id="db42f-140">Create and delete and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="db42f-141">Criar e eliminar configuração de armazenamento da análise de registos (OMS) Olá.</span><span class="sxs-lookup"><span data-stu-id="db42f-141">Create and delete hello Log Analytics (OMS) storage configuration.</span></span>

<span data-ttu-id="db42f-142">* tem também separadamente ser concedido ao utilizador permissão ListKeys Olá destino recursos (armazenamento conta ou event hub espaço de nomes) tooset um perfil de registo ou a definição de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="db42f-142">*user must also separately be granted ListKeys permission on hello target resource (storage account or event hub namespace) tooset a log profile or diagnostic setting.</span></span>

> [!NOTE]
> <span data-ttu-id="db42f-143">Esta função não conceda acesso de leitura toolog dados que foi hub de eventos de transmissão em fluxo tooan ou armazenados numa conta do storage.</span><span class="sxs-lookup"><span data-stu-id="db42f-143">This role does not give read access toolog data that has been streamed tooan event hub or stored in a storage account.</span></span> <span data-ttu-id="db42f-144">[Consulte abaixo](#security-considerations-for-monitoring-data) para obter informações sobre como configurar o acesso a recursos toothese.</span><span class="sxs-lookup"><span data-stu-id="db42f-144">[See below](#security-considerations-for-monitoring-data) for information on configuring access toothese resources.</span></span>
> 
> 

## <a name="monitoring-permissions-and-custom-rbac-roles"></a><span data-ttu-id="db42f-145">As permissões e funções do RBAC personalizadas de monitorização</span><span class="sxs-lookup"><span data-stu-id="db42f-145">Monitoring permissions and custom RBAC roles</span></span>
<span data-ttu-id="db42f-146">Se Olá acima funções incorporadas não satisfazer as necessidades de exato de Olá da sua equipa, pode [criar uma função personalizada do RBAC](../active-directory/role-based-access-control-custom-roles.md) com permissões mais granulares.</span><span class="sxs-lookup"><span data-stu-id="db42f-146">If hello above built-in roles don’t meet hello exact needs of your team, you can [create a custom RBAC role](../active-directory/role-based-access-control-custom-roles.md) with more granular permissions.</span></span> <span data-ttu-id="db42f-147">Seguem-se Olá operações comuns do RBAC de Monitor do Azure com as respetivas descrições.</span><span class="sxs-lookup"><span data-stu-id="db42f-147">Below are hello common Azure Monitor RBAC operations with their descriptions.</span></span>

| <span data-ttu-id="db42f-148">Operação</span><span class="sxs-lookup"><span data-stu-id="db42f-148">Operation</span></span> | <span data-ttu-id="db42f-149">Descrição</span><span class="sxs-lookup"><span data-stu-id="db42f-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="db42f-150">Microsoft.Insights/AlertRules/[Read, escrita, eliminar]</span><span class="sxs-lookup"><span data-stu-id="db42f-150">Microsoft.Insights/AlertRules/[Read, Write, Delete]</span></span> |<span data-ttu-id="db42f-151">Regras de alertas de leitura/escrita/eliminar.</span><span class="sxs-lookup"><span data-stu-id="db42f-151">Read/write/delete alert rules.</span></span> |
| <span data-ttu-id="db42f-152">Microsoft.Insights/AlertRules/Incidents/Read</span><span class="sxs-lookup"><span data-stu-id="db42f-152">Microsoft.Insights/AlertRules/Incidents/Read</span></span> |<span data-ttu-id="db42f-153">Lista de incidentes (histórico Olá de regra de alerta que está a ser acionado) para regras de alertas.</span><span class="sxs-lookup"><span data-stu-id="db42f-153">List incidents (history of hello alert rule being triggered) for alert rules.</span></span> <span data-ttu-id="db42f-154">Isto aplica-se apenas toohello portal.</span><span class="sxs-lookup"><span data-stu-id="db42f-154">This only applies toohello portal.</span></span> |
| <span data-ttu-id="db42f-155">Microsoft.Insights/AutoscaleSettings/[Read, escrita, eliminar]</span><span class="sxs-lookup"><span data-stu-id="db42f-155">Microsoft.Insights/AutoscaleSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="db42f-156">Definições de dimensionamento automático de leitura/escrita/eliminar.</span><span class="sxs-lookup"><span data-stu-id="db42f-156">Read/write/delete autoscale settings.</span></span> |
| <span data-ttu-id="db42f-157">Microsoft.Insights/DiagnosticSettings/[Read, escrita, eliminar]</span><span class="sxs-lookup"><span data-stu-id="db42f-157">Microsoft.Insights/DiagnosticSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="db42f-158">Definições de diagnóstico de leitura/escrita/eliminar.</span><span class="sxs-lookup"><span data-stu-id="db42f-158">Read/write/delete diagnostic settings.</span></span> |
| <span data-ttu-id="db42f-159">Microsoft.Insights/eventtypes/digestevents/Read</span><span class="sxs-lookup"><span data-stu-id="db42f-159">Microsoft.Insights/eventtypes/digestevents/Read</span></span> |<span data-ttu-id="db42f-160">Esta permissão é necessária para os utilizadores que precisam de aceder a registos de tooActivity através do portal Olá.</span><span class="sxs-lookup"><span data-stu-id="db42f-160">This permission is necessary for users who need access tooActivity Logs via hello portal.</span></span> |
| <span data-ttu-id="db42f-161">Microsoft.Insights/eventtypes/values/Read</span><span class="sxs-lookup"><span data-stu-id="db42f-161">Microsoft.Insights/eventtypes/values/Read</span></span> |<span data-ttu-id="db42f-162">Lista de eventos de registo de atividade (eventos de gestão) numa subscrição.</span><span class="sxs-lookup"><span data-stu-id="db42f-162">List Activity Log events (management events) in a subscription.</span></span> <span data-ttu-id="db42f-163">Esta permissão é aplicável tooboth acesso programático e portal toohello registo de atividade.</span><span class="sxs-lookup"><span data-stu-id="db42f-163">This permission is applicable tooboth programmatic and portal access toohello Activity Log.</span></span> |
| <span data-ttu-id="db42f-164">Microsoft.Insights/LogDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="db42f-164">Microsoft.Insights/LogDefinitions/Read</span></span> |<span data-ttu-id="db42f-165">Esta permissão é necessária para os utilizadores que precisam de aceder a registos de tooActivity através do portal Olá.</span><span class="sxs-lookup"><span data-stu-id="db42f-165">This permission is necessary for users who need access tooActivity Logs via hello portal.</span></span> |
| <span data-ttu-id="db42f-166">Microsoft.Insights/MetricDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="db42f-166">Microsoft.Insights/MetricDefinitions/Read</span></span> |<span data-ttu-id="db42f-167">Ler as definições de métrica (lista de tipos de métricas disponíveis para um recurso).</span><span class="sxs-lookup"><span data-stu-id="db42f-167">Read metric definitions (list of available metric types for a resource).</span></span> |
| <span data-ttu-id="db42f-168">Microsoft.Insights/Metrics/Read</span><span class="sxs-lookup"><span data-stu-id="db42f-168">Microsoft.Insights/Metrics/Read</span></span> |<span data-ttu-id="db42f-169">Ler métricas para um recurso.</span><span class="sxs-lookup"><span data-stu-id="db42f-169">Read metrics for a resource.</span></span> |

> [!NOTE]
> <span data-ttu-id="db42f-170">Acesso tooalerts, definições de diagnóstico e métricas para um recurso requer que o utilizador Olá tem o tipo de recurso de toohello de acesso de leitura e âmbito desse recurso.</span><span class="sxs-lookup"><span data-stu-id="db42f-170">Access tooalerts, diagnostic settings, and metrics for a resource requires that hello user has Read access toohello resource type and scope of that resource.</span></span> <span data-ttu-id="db42f-171">Criar ("escrita") um perfil de definição ou o registo de diagnóstico que arquivos tooa armazenamento conta ou fluxos tooevent hubs requer Olá utilizador tooalso permissão ListKeys no recurso de destino Olá.</span><span class="sxs-lookup"><span data-stu-id="db42f-171">Creating (“write”) a diagnostic setting or log profile that archives tooa storage account or streams tooevent hubs requires hello user tooalso have ListKeys permission on hello target resource.</span></span>
> 
> 

<span data-ttu-id="db42f-172">Por exemplo, utilizando Olá acima tabela pode criar uma função RBAC personalizada para um "leitor do registo de atividade" como esta:</span><span class="sxs-lookup"><span data-stu-id="db42f-172">For example, using hello above table you could create a custom RBAC role for an “Activity Log Reader” like this:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Activity Log Reader"
$role.Description = "Can view activity logs."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Insights/eventtypes/*")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription")
New-AzureRmRoleDefinition -Role $role 
```

## <a name="security-considerations-for-monitoring-data"></a><span data-ttu-id="db42f-173">Considerações de segurança para dados de monitorização</span><span class="sxs-lookup"><span data-stu-id="db42f-173">Security considerations for monitoring data</span></span>
<span data-ttu-id="db42f-174">Dados de monitorização — particularmente ficheiros de registo — pode conter informações confidenciais, tais como endereços IP ou nomes de utilizador.</span><span class="sxs-lookup"><span data-stu-id="db42f-174">Monitoring data—particularly log files—can contain sensitive information, such as IP addresses or user names.</span></span> <span data-ttu-id="db42f-175">Dados de monitorização do Azure é fornecido em três formulários básicos:</span><span class="sxs-lookup"><span data-stu-id="db42f-175">Monitoring data from Azure comes in three basic forms:</span></span>

1. <span data-ttu-id="db42f-176">Olá registo de atividade, que descreve a todas as ações de controlo plane na sua subscrição do Azure.</span><span class="sxs-lookup"><span data-stu-id="db42f-176">hello Activity Log, which describes all control-plane actions on your Azure subscription.</span></span>
2. <span data-ttu-id="db42f-177">Registos de diagnóstico, que são emitidos por um recurso de registos.</span><span class="sxs-lookup"><span data-stu-id="db42f-177">Diagnostic Logs, which are logs emitted by a resource.</span></span>
3. <span data-ttu-id="db42f-178">Métricas que são emitidas pelo recursos.</span><span class="sxs-lookup"><span data-stu-id="db42f-178">Metrics, which are emitted by resources.</span></span>

<span data-ttu-id="db42f-179">Todas as três dos seguintes tipos de dados podem ser armazenadas numa conta de armazenamento ou transmissão em fluxo tooEvent Hub, que são recursos do Azure para fins gerais.</span><span class="sxs-lookup"><span data-stu-id="db42f-179">All three of these data types can be stored in a storage account or streamed tooEvent Hub, both of which are general-purpose Azure resources.</span></span> <span data-ttu-id="db42f-180">Uma vez que estes são os recursos para fins gerais, criar, eliminar e aceder às mesmas são uma operação com privilégios normalmente reservada para um administrador.</span><span class="sxs-lookup"><span data-stu-id="db42f-180">Because these are general-purpose resources, creating, deleting, and accessing them is a privileged operation usually reserved for an administrator.</span></span> <span data-ttu-id="db42f-181">Sugerimos que utilize Olá seguintes práticas para utilização indevida de tooprevent relacionadas com a monitorização de recursos:</span><span class="sxs-lookup"><span data-stu-id="db42f-181">We suggest that you use hello following practices for monitoring-related resources tooprevent misuse:</span></span>

* <span data-ttu-id="db42f-182">Utilize uma conta de armazenamento dedicada único para os dados de monitorização.</span><span class="sxs-lookup"><span data-stu-id="db42f-182">Use a single, dedicated storage account for monitoring data.</span></span> <span data-ttu-id="db42f-183">Se precisar de tooseparate dados de monitorização em várias contas do storage, nunca partilhar a utilização de uma conta de armazenamento entre monitorização e não-monitorização de dados, como esta inadvertidamente podem dar a quem só precisa de aceder aos dados de toomonitoring (ex.</span><span class="sxs-lookup"><span data-stu-id="db42f-183">If you need tooseparate monitoring data into multiple storage accounts, never share usage of a storage account between monitoring and non-monitoring data, as this may inadvertently give those who only need access toomonitoring data (eg.</span></span> <span data-ttu-id="db42f-184">um SIEM de terceiros) aceder aos dados de monitorização de toonon.</span><span class="sxs-lookup"><span data-stu-id="db42f-184">a third-party SIEM) access toonon-monitoring data.</span></span>
* <span data-ttu-id="db42f-185">Utilize um único, dedicado barramento de serviço ou o Hub de eventos espaço de nomes em todas as definições de diagnóstico para Olá pelo mesmo motivo conforme apresentado acima.</span><span class="sxs-lookup"><span data-stu-id="db42f-185">Use a single, dedicated Service Bus or Event Hub namespace across all diagnostic settings for hello same reason as above.</span></span>
* <span data-ttu-id="db42f-186">Limitar as contas de acesso a armazenamento relacionadas com toomonitoring ou event hubs ao mantê-los num grupo de recursos separado, e [utilizar âmbito](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) nas funções de monitorização toolimit acesso tooonly nesse grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="db42f-186">Limit access toomonitoring-related storage accounts or event hubs by keeping them in a separate resource group, and [use scope](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) on your monitoring roles toolimit access tooonly that resource group.</span></span>
* <span data-ttu-id="db42f-187">Nunca Olá ListKeys permissão concedida para contas de armazenamento ou os hubs de eventos no âmbito da subscrição quando um utilizador necessita apenas de aceder a dados toomonitoring.</span><span class="sxs-lookup"><span data-stu-id="db42f-187">Never grant hello ListKeys permission for either storage accounts or event hubs at subscription scope when a user only needs access toomonitoring data.</span></span> <span data-ttu-id="db42f-188">Em vez disso, atribuir estas permissões toohello utilizador um recurso ou grupo de recursos (se tiver um grupo de recursos dedicado monitorização) âmbito.</span><span class="sxs-lookup"><span data-stu-id="db42f-188">Instead, give these permissions toohello user at a resource or resource group (if you have a dedicated monitoring resource group) scope.</span></span>

### <a name="limiting-access-toomonitoring-related-storage-accounts"></a><span data-ttu-id="db42f-189">Limitar as contas de armazenamento relacionadas com toomonitoring de acesso</span><span class="sxs-lookup"><span data-stu-id="db42f-189">Limiting access toomonitoring-related storage accounts</span></span>
<span data-ttu-id="db42f-190">Quando um utilizador ou aplicação precisa de aceder aos dados de toomonitoring numa conta do storage, deve [gerar um SAS de conta](https://msdn.microsoft.com/library/azure/mt584140.aspx) na conta de armazenamento de Olá que contém dados de monitorização com o armazenamento de tooblob acesso só de leitura de nível de serviço.</span><span class="sxs-lookup"><span data-stu-id="db42f-190">When a user or application needs access toomonitoring data in a storage account, you should [generate an Account SAS](https://msdn.microsoft.com/library/azure/mt584140.aspx) on hello storage account that contains monitoring data with service-level read-only access tooblob storage.</span></span> <span data-ttu-id="db42f-191">No PowerShell, este poderá ter o seguinte aspeto:</span><span class="sxs-lookup"><span data-stu-id="db42f-191">In PowerShell, this might look like:</span></span>

```powershell
$context = New-AzureStorageContext -ConnectionString "[connection string for your monitoring Storage Account]"
$token = New-AzureStorageAccountSASToken -ResourceType Service -Service Blob -Permission "rl" -Context $context
```

<span data-ttu-id="db42f-192">Em seguida, pode conceder entidade de token toohello Olá que necessita de tooread partir dessa conta de armazenamento e pode listar e ler a partir de todos os blobs nessa conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="db42f-192">You can then give hello token toohello entity that needs tooread from that storage account, and it can list and read from all blobs in that storage account.</span></span>

<span data-ttu-id="db42f-193">Em alternativa, se precisar de toocontrol esta permissão com RBAC, pode conceder Olá essa entidade permissão Microsoft.Storage/storageAccounts/listkeys/action essa conta de armazenamento específico.</span><span class="sxs-lookup"><span data-stu-id="db42f-193">Alternatively, if you need toocontrol this permission with RBAC, you can grant that entity hello Microsoft.Storage/storageAccounts/listkeys/action permission on that particular storage account.</span></span> <span data-ttu-id="db42f-194">Isto é necessário para os utilizadores que necessitam de toobe capaz de tooset uma diagnóstico definição ou de registo perfil tooarchive tooa conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="db42f-194">This is necessary for users who need toobe able tooset a diagnostic setting or log profile tooarchive tooa storage account.</span></span> <span data-ttu-id="db42f-195">Por exemplo, pode criar Olá seguinte função RBAC personalizada para um utilizador ou aplicação que necessita apenas de tooread de uma conta de armazenamento:</span><span class="sxs-lookup"><span data-stu-id="db42f-195">For example, you could create hello following custom RBAC role for a user or application that only needs tooread from one storage account:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Monitoring Storage Account Reader"
$role.Description = "Can get hello storage account keys for a monitoring storage account."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Storage/storageAccounts/listkeys/action")
$role.Actions.Add("Microsoft.Storage/storageAccounts/Read")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.Storage/storageAccounts/myMonitoringStorageAccount")
New-AzureRmRoleDefinition -Role $role 
```

> [!WARNING]
> <span data-ttu-id="db42f-196">Olá ListKeys permissão permite que as chaves de conta de armazenamento primário e secundário toolist Olá Olá utilizador.</span><span class="sxs-lookup"><span data-stu-id="db42f-196">hello ListKeys permission enables hello user toolist hello primary and secondary storage account keys.</span></span> <span data-ttu-id="db42f-197">Estas chaves conceder utilizador Olá todas assinadas permissões (ler, escrever, blobs de criar, eliminar blobs, etc.) em todas assinadas serviços (blob, fila, tabela, o ficheiro) nessa conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="db42f-197">These keys grant hello user all signed permissions (read, write, create blobs, delete blobs, etc.) across all signed services (blob, queue, table, file) in that storage account.</span></span> <span data-ttu-id="db42f-198">Recomendamos que utilize um SAS de conta descrito acima, sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="db42f-198">We recommend using an Account SAS described above when possible.</span></span>
> 
> 

### <a name="limiting-access-toomonitoring-related-event-hubs"></a><span data-ttu-id="db42f-199">Limitar os hubs de eventos relacionados com toomonitoring de acesso</span><span class="sxs-lookup"><span data-stu-id="db42f-199">Limiting access toomonitoring-related event hubs</span></span>
<span data-ttu-id="db42f-200">Um padrão semelhante pode ser seguido com os event hubs, mas tem primeiro toocreate uma regra de autorização de escutar dedicada.</span><span class="sxs-lookup"><span data-stu-id="db42f-200">A similar pattern can be followed with event hubs, but first you need toocreate a dedicated Listen authorization rule.</span></span> <span data-ttu-id="db42f-201">Se quiser toogrant acesso tooan aplicação que necessita apenas de hubs de eventos relacionados com toomonitoring toolisten, Olá a seguir:</span><span class="sxs-lookup"><span data-stu-id="db42f-201">If you want toogrant access tooan application that only needs toolisten toomonitoring-related event hubs, do hello following:</span></span>

1. <span data-ttu-id="db42f-202">Crie uma política de acesso partilhado no Olá eventos hub(s) que foram criadas para dados de monitorização com apenas afirmações de escuta de transmissão em fluxo.</span><span class="sxs-lookup"><span data-stu-id="db42f-202">Create a shared access policy on hello event hub(s) that were created for streaming monitoring data with only Listen claims.</span></span> <span data-ttu-id="db42f-203">Pode fazê-lo no portal de Olá.</span><span class="sxs-lookup"><span data-stu-id="db42f-203">This can be done in hello portal.</span></span> <span data-ttu-id="db42f-204">Por exemplo, pode chamar-"monitoringReadOnly."</span><span class="sxs-lookup"><span data-stu-id="db42f-204">For example, you might call it “monitoringReadOnly.”</span></span> <span data-ttu-id="db42f-205">Se for possível, deverá toogive que chave diretamente toohello consumidor e ignorar o passo seguinte Olá.</span><span class="sxs-lookup"><span data-stu-id="db42f-205">If possible, you will want toogive that key directly toohello consumer and skip hello next step.</span></span>
2. <span data-ttu-id="db42f-206">Se precisar de consumidor Olá toobe tooget capaz de Olá chave ad-hoc, conceda a ação do Olá utilizador Olá ListKeys para esse hub de eventos.</span><span class="sxs-lookup"><span data-stu-id="db42f-206">If hello consumer needs toobe able tooget hello key ad-hoc, grant hello user hello ListKeys action for that event hub.</span></span> <span data-ttu-id="db42f-207">Isto também é necessário para os utilizadores que precisam de toobe capaz de tooset uma definição de diagnóstico ou inicie os hubs de tooevent do perfil toostream.</span><span class="sxs-lookup"><span data-stu-id="db42f-207">This is also necessary for users who need toobe able tooset a diagnostic setting or log profile toostream tooevent hubs.</span></span> <span data-ttu-id="db42f-208">Por exemplo, poderá criar uma regra RBAC:</span><span class="sxs-lookup"><span data-stu-id="db42f-208">For example, you might create an RBAC rule:</span></span>
   
   ```powershell
   $role = Get-AzureRmRoleDefinition "Reader"
   $role.Id = $null
   $role.Name = "Monitoring Event Hub Listener"
   $role.Description = "Can get hello key toolisten tooan event hub streaming monitoring data."
   $role.Actions.Clear()
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/authorizationrules/listkeys/action")
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/Read")
   $role.AssignableScopes.Clear()
   $role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.ServiceBus/namespaces/mySBNameSpace")
   New-AzureRmRoleDefinition -Role $role 
   ```

## <a name="next-steps"></a><span data-ttu-id="db42f-209">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="db42f-209">Next steps</span></span>
* [<span data-ttu-id="db42f-210">Leia sobre RBAC e permissões no Gestor de recursos</span><span class="sxs-lookup"><span data-stu-id="db42f-210">Read about RBAC and permissions in Resource Manager</span></span>](../active-directory/role-based-access-control-what-is.md)
* [<span data-ttu-id="db42f-211">Descrição geral de Olá de leitura de monitorização no Azure</span><span class="sxs-lookup"><span data-stu-id="db42f-211">Read hello overview of monitoring in Azure</span></span>](monitoring-overview.md)

