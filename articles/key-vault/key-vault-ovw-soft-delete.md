---
ms.assetid: 
title: "eliminação de forma recuperável do Cofre de chaves de aaaAzure | Microsoft Docs"
ms.service: key-vault
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.date: 07/10/2017
ms.openlocfilehash: 1b402c58db6f25ae4ae5e2720786fa81eb0e839a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="azure-key-vault-soft-delete-overview"></a><span data-ttu-id="2a7f7-102">Descrição geral da eliminação de forma recuperável Cofre de chaves do Azure</span><span class="sxs-lookup"><span data-stu-id="2a7f7-102">Azure Key Vault soft-delete overview</span></span>

<span data-ttu-id="2a7f7-103">A funcionalidade de eliminação de forma recuperável do Cofre de chave permite a recuperação de cofres de Olá eliminado e objetos do cofre, conhecidos como eliminar de forma recuperável.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-103">Key Vault's soft delete feature allows recovery of hello deleted vaults and vault objects, known as soft-delete.</span></span> <span data-ttu-id="2a7f7-104">Especificamente, vamos abordar Olá os seguintes cenários:</span><span class="sxs-lookup"><span data-stu-id="2a7f7-104">Specifically, we address hello following scenarios:</span></span>

- <span data-ttu-id="2a7f7-105">Suporte para eliminação recuperável de um cofre de chaves</span><span class="sxs-lookup"><span data-stu-id="2a7f7-105">Support for recoverable deletion of a key vault</span></span>
- <span data-ttu-id="2a7f7-106">Suporte para eliminação recuperável de objetos do Cofre de chaves (ex.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-106">Support for recoverable deletion of key vault objects (ex.</span></span> <span data-ttu-id="2a7f7-107">as chaves, segredos, certificados)</span><span class="sxs-lookup"><span data-stu-id="2a7f7-107">keys, secrets, certificates)</span></span>

## <a name="supporting-interfaces"></a><span data-ttu-id="2a7f7-108">Interfaces de suporte</span><span class="sxs-lookup"><span data-stu-id="2a7f7-108">Supporting interfaces</span></span>

<span data-ttu-id="2a7f7-109">Olá funcionalidade de eliminação de forma recuperável está inicialmente disponível através do Olá REST, .NET / interfaces de c# e PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-109">hello soft-delete feature is initially available through hello REST, .NET/C# and PowerShell interfaces.</span></span> <span data-ttu-id="2a7f7-110">Consulte toohello referências para obter mais detalhes, [referência do Cofre de chave](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="2a7f7-110">Refer toohello references for these for more details, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

## <a name="scenarios"></a><span data-ttu-id="2a7f7-111">Cenários</span><span class="sxs-lookup"><span data-stu-id="2a7f7-111">Scenarios</span></span>

<span data-ttu-id="2a7f7-112">Cofres de chaves do Azure são recursos controlados, geridos pelo Gestor de recursos do Azure.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-112">Azure Key Vaults are tracked resources, managed by Azure Resource Manager.</span></span> <span data-ttu-id="2a7f7-113">O Azure Resource Manager também especifica um comportamento definido especificamente para eliminação, o que necessita que uma operação de eliminação com êxito têm de resultar nesse recurso não estão a ser acessível já.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-113">Azure Resource Manager also specifies a well-defined behavior for deletion, which requires that a successful DELETE operation must result in that resource not being accessible anymore.</span></span> <span data-ttu-id="2a7f7-114">endereços de funcionalidade de eliminação de forma recuperável Olá Olá recuperação de objeto de Olá eliminado, se a eliminação de Olá foi acidental ou intencional.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-114">hello soft-delete feature addresses hello recovery of hello deleted object, whether hello deletion was accidental or intentional.</span></span>

1. <span data-ttu-id="2a7f7-115">Cenário de típico Olá, um utilizador pode ter inadvertidamente eliminado um cofre de chaves ou um objeto do Cofre de chaves; Se esse cofre de chaves ou chave de cofre objeto foram toobe recuperável durante um período predeterminado, utilizador de Olá pode anular eliminação Olá e recuperar os seus dados.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-115">In hello typical scenario, a user may have inadvertently deleted a key vault or a key vault object; if that key vault or key vault object were toobe recoverable for a predetermined period, hello user may undo hello deletion and recover their data.</span></span>

2. <span data-ttu-id="2a7f7-116">Num cenário de diferentes, um utilizador não autorizado pode tentar toodelete um cofre de chaves ou um objeto de Cofre de chaves, tal como uma chave no interior de um cofre, toocause uma interrupção de negócios.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-116">In a different scenario, a rogue user may attempt toodelete a key vault or a key vault object, such as a key inside a vault, toocause a business disruption.</span></span> <span data-ttu-id="2a7f7-117">Separação de eliminação de Olá do Cofre de chaves Olá ou o objeto do Cofre de chaves contra eliminação real de Olá de Olá subjacente dados pode ser utilizada como uma medida de segurança ao, por exemplo, restringir permissões num tooa de eliminação de dados diferente, fidedigna função.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-117">Separating hello deletion of hello key vault or key vault object from hello actual deletion of hello underlying data can be used as a safety measure by, for instance, restricting permissions on data deletion tooa different, trusted role.</span></span> <span data-ttu-id="2a7f7-118">Esta abordagem requer efetivamente quórum para uma operação que caso contrário, poderá resultar em perda de dados de imediato.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-118">This approach effectively requires quorum for an operation which might otherwise result in an immediate data loss.</span></span>

### <a name="soft-delete-behavior"></a><span data-ttu-id="2a7f7-119">Comportamento de eliminação de forma recuperável</span><span class="sxs-lookup"><span data-stu-id="2a7f7-119">Soft-delete behavior</span></span>

<span data-ttu-id="2a7f7-120">Com esta funcionalidade, Olá operação eliminar um cofre de chaves ou o objeto do Cofre de chaves é soft eliminar eficazmente que está a reter recursos Olá durante um período de retenção especificado, enquanto a dar aspeto Olá esse objeto Olá é eliminada.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-120">With this feature, hello DELETE operation on a key vault or key vault object is a soft-delete, effectively holding hello resources for a given retention period, while giving hello appearance that hello object is deleted.</span></span> <span data-ttu-id="2a7f7-121">serviço de Olá mais fornece um mecanismo para recuperar o objeto de Olá eliminado, essencialmente undoing eliminação Olá.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-121">hello service further provides a mechanism for recovering hello deleted object, essentially undoing hello deletion.</span></span> 

<span data-ttu-id="2a7f7-122">Eliminar de forma recuperável é um comportamento opcional do Cofre de chaves e é **não ativada por predefinição** nesta versão.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-122">Soft-delete is an optional Key Vault behavior and is **not enabled by default** in this release.</span></span> <span data-ttu-id="2a7f7-123">Para obter detalhes sobre como ativar a eliminação de forma recuperável para o seu Cofre de chaves, consulte orientações específicas do Olá numa referência de Olá para a interface de Olá à sua escolha, [referência do Cofre de chave](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="2a7f7-123">For details on enabling soft-delete for your key vault, see hello specific guidance in hello reference for hello interface of your choice, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

### <a name="key-vault-recovery"></a><span data-ttu-id="2a7f7-124">Recuperação do Cofre de chaves</span><span class="sxs-lookup"><span data-stu-id="2a7f7-124">Key vault recovery</span></span>

<span data-ttu-id="2a7f7-125">Após eliminar um cofre de chaves, o serviço de Olá cria um recurso de proxy na subscrição Olá, adicionar metadados suficientes para recuperação.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-125">Upon deleting a key vault, hello service creates a proxy resource under hello subscription, adding sufficient metadata for recovery.</span></span> <span data-ttu-id="2a7f7-126">recurso de proxy de Olá é um objeto armazenado, disponível no Olá mesma localização do Cofre de chaves Olá eliminado.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-126">hello proxy resource is a stored object, available in hello same location as hello deleted key vault.</span></span> 

### <a name="key-vault-object-recovery"></a><span data-ttu-id="2a7f7-127">Recuperação de objeto do Cofre de chaves</span><span class="sxs-lookup"><span data-stu-id="2a7f7-127">Key vault object recovery</span></span>

<span data-ttu-id="2a7f7-128">Após eliminar um objeto de Cofre de chaves, tal como uma chave de serviço Olá colocará objeto Olá num Estado eliminado, deste modo, tornando-operações de obtenção de tooany inacessível.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-128">Upon deleting a key vault object, such as a key, hello service will place hello object in a deleted state, thus making it inaccessible tooany retrieval operations.</span></span> <span data-ttu-id="2a7f7-129">Enquanto estiver neste estado, objeto do Cofre de chaves de Olá pode apenas ser apresentado, recuperado ou forçadamente/permanentemente eliminado.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-129">While in this state, hello key vault object can only be listed, recovered, or forcefully/permanently deleted.</span></span> 

<span data-ttu-id="2a7f7-130">Em Olá mesmo Cofre de chave, tempo irá agendar a eliminação de Olá de Olá subjacente toohello correspondente de dados eliminada Cofre de chaves ou objeto de Cofre de chaves para execução após um intervalo de retenção predeterminada.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-130">At hello same time, Key Vault will schedule hello deletion of hello underlying data corresponding toohello deleted key vault or key vault object for execution after a predetermined retention interval.</span></span> <span data-ttu-id="2a7f7-131">Olá DNS registo toohello cofre correspondente também é mantida durante Olá do intervalo de retenção de Olá.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-131">hello DNS record corresponding toohello vault is also retained for hello duration of hello retention interval.</span></span>

### <a name="soft-delete-retention-period"></a><span data-ttu-id="2a7f7-132">Período de retenção de eliminação de forma recuperável</span><span class="sxs-lookup"><span data-stu-id="2a7f7-132">Soft-delete retention period</span></span>

<span data-ttu-id="2a7f7-133">Recursos eliminados de forma recuperável são retidos durante um período de tempo, 90 dias definido.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-133">Soft deleted resources are retained for a set period of time, 90 days.</span></span> <span data-ttu-id="2a7f7-134">Durante o intervalo de retenção de eliminação de forma recuperável Olá, Olá aplicar os seguintes:</span><span class="sxs-lookup"><span data-stu-id="2a7f7-134">During hello soft-delete retention interval, hello following apply:</span></span>

- <span data-ttu-id="2a7f7-135">Pode listar todos os cofres de chaves Olá e objetos do Cofre de chaves num Estado de eliminação de forma recuperável Olá para a sua subscrição, bem como informações de recuperação e eliminação de acesso sobre os mesmos.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-135">You may list all of hello key vaults and key vault objects in hello soft-delete state for your subscription as well as access deletion and recovery information about them.</span></span>
    - <span data-ttu-id="2a7f7-136">Apenas os utilizadores com permissões especiais podem listar os cofres eliminados.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-136">Only users with special permissions can list deleted vaults.</span></span> <span data-ttu-id="2a7f7-137">Recomendamos que os nossos utilizadores criar uma função personalizada com estas permissões especiais para processamento eliminado cofres.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-137">We recommend that our users create a custom role with these special permissions for handling deleted vaults.</span></span>
- <span data-ttu-id="2a7f7-138">Um cofre de chaves com Olá não é possível criar o mesmo nome no Olá mesma localização; proporcionalmente, um objeto do Cofre de chaves não é possível criar um cofre fornecido se esse cofre de chaves contém um objeto com Olá mesmo nome e a que se encontra no Estado eliminado</span><span class="sxs-lookup"><span data-stu-id="2a7f7-138">A key vault with hello same name cannot be created in hello same location; correspondingly, a key vault object cannot be created in a given vault if that key vault contains an object with hello same name and which is in a deleted state</span></span> 
- <span data-ttu-id="2a7f7-139">Apenas um utilizador especificamente com privilégios poderá restaurar um cofre de chaves ou o objeto de Cofre de chaves ao emitir um comando de recuperar no recurso de proxy Olá correspondente.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-139">Only a specifically privileged user may restore a key vault or key vault object by issuing a recover command on hello corresponding proxy resource.</span></span>
    - <span data-ttu-id="2a7f7-140">utilizador Olá, membro de função personalizada Olá, que tem o privilégio de Olá toocreate um cofre de chaves de grupo de recursos de Olá pode restaurar cofre Olá.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-140">hello user, member of hello custom role, who has hello privilege toocreate a key vault under hello resource group can restore hello vault.</span></span>
- <span data-ttu-id="2a7f7-141">Apenas um utilizador especificamente com privilégios a forçar a pode eliminar um cofre de chaves ou o objeto de Cofre de chaves ao emitir um comando de eliminação no recurso de proxy Olá correspondente.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-141">Only a specifically privileged user may forcibly delete a key vault or key vault object by issuing a delete command on hello corresponding proxy resource.</span></span>

<span data-ttu-id="2a7f7-142">A menos que um cofre de chaves ou o objeto de Cofre de chaves é recuperado, em Olá final do serviço de Olá de intervalo de retenção de Olá efetua uma remoção do Cofre de chaves Olá eliminados de forma recuperável ou o objeto do Cofre de chaves e o respetivo conteúdo.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-142">Unless a key vault or key vault object is recovered, at hello end of hello retention interval hello service performs a purge of hello soft-deleted key vault or key vault object and its content.</span></span> <span data-ttu-id="2a7f7-143">Eliminação de recurso não pode ser reagendada.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-143">Resource deletion may not be rescheduled.</span></span>

### <a name="permitted-purge"></a><span data-ttu-id="2a7f7-144">Remoção permitida</span><span class="sxs-lookup"><span data-stu-id="2a7f7-144">Permitted purge</span></span>

<span data-ttu-id="2a7f7-145">Permanentemente a eliminar, remover, um cofre de chaves é possível através de uma operação POST no recurso de proxy de Olá e necessita de privilégios especiais.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-145">Permanently deleting, purging, a key vault is possible via a POST operation on hello proxy resource and requires special privileges.</span></span> <span data-ttu-id="2a7f7-146">Geralmente, apenas o proprietário de subscrição Olá será capaz de toopurge um cofre de chaves.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-146">Generally, only hello subscription owner will be able toopurge a key vault.</span></span> <span data-ttu-id="2a7f7-147">acionadores de operação de POST Olá Olá eliminação imediata e irrecuperável de que o cofre.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-147">hello POST operation triggers hello immediate and irrecoverable deletion of that vault.</span></span> 

<span data-ttu-id="2a7f7-148">Uma exceção toothis for o caso de Olá quando Olá subscrição do Azure tiver sido marcada como *undeletable*.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-148">An exception toothis is hello case when hello Azure subscription has been marked as *undeletable*.</span></span> <span data-ttu-id="2a7f7-149">Neste caso, apenas os serviço Olá, em seguida, podem efetuar a eliminação real Olá e é feito como um processo agendado.</span><span class="sxs-lookup"><span data-stu-id="2a7f7-149">In this case, only hello service may then perform hello actual deletion, and does so as a scheduled process.</span></span> 



