---
title: aaaMultiple VIP de Balanceador de carga do Azure | Microsoft Docs
description: "Descrição geral de vários VIPs no balanceador de carga do Azure"
services: load-balancer
documentationcenter: na
author: chkuhtz
manager: narayan
editor: 
ms.assetid: 748e50cd-3087-4c2e-a9e1-ac0ecce4f869
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/11/2016
ms.author: chkuhtz
ms.openlocfilehash: e186e1248e7d187e7efd0668dc3244465ce3e156
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="multiple-vips-for-azure-load-balancer"></a><span data-ttu-id="30e12-103">Múltiplos VIPs para o Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="30e12-103">Multiple VIPs for Azure Load Balancer</span></span>

<span data-ttu-id="30e12-104">Balanceador de carga do Azure permite-lhe equilibrar os serviços tooload em várias portas, vários endereços IP ou ambos.</span><span class="sxs-lookup"><span data-stu-id="30e12-104">Azure Load Balancer allows you tooload balance services on multiple ports, multiple IP addresses, or both.</span></span> <span data-ttu-id="30e12-105">Pode utilizar os fluxos de balanceamento de carga interno e público balanceador definições tooload através de um conjunto de VMs.</span><span class="sxs-lookup"><span data-stu-id="30e12-105">You can use public and internal load balancer definitions tooload balance flows across a set of VMs.</span></span>

<span data-ttu-id="30e12-106">Este artigo descreve Olá Noções básicas sobre esta capacidade, conceitos importantes e as restrições.</span><span class="sxs-lookup"><span data-stu-id="30e12-106">This article describes hello fundamentals of this ability, important concepts, and constraints.</span></span> <span data-ttu-id="30e12-107">Se a que apenas pretende tooexpose serviços um endereço IP, pode encontrar instruções simplificadas para [pública](load-balancer-get-started-internet-portal.md) ou [interno](load-balancer-get-started-ilb-arm-portal.md) configurações de Balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="30e12-107">If you only intend tooexpose services on one IP address, you can find simplified instructions for [public](load-balancer-get-started-internet-portal.md) or [internal](load-balancer-get-started-ilb-arm-portal.md) load balancer configurations.</span></span> <span data-ttu-id="30e12-108">A adição de vários VIPs é a configuração de VIP único incremental tooa.</span><span class="sxs-lookup"><span data-stu-id="30e12-108">Adding Multiple VIPs is incremental tooa single VIP configuration.</span></span> <span data-ttu-id="30e12-109">Utilizar conceitos Olá neste artigo, pode expandir uma configuração simplificada em qualquer altura.</span><span class="sxs-lookup"><span data-stu-id="30e12-109">Using hello concepts in this article, you can expand a simplified configuration at any time.</span></span>

<span data-ttu-id="30e12-110">Quando definir um balanceador de carga do Azure, estão ligados com regras de front-end e uma configuração de back-end.</span><span class="sxs-lookup"><span data-stu-id="30e12-110">When you define an Azure Load Balancer, a frontend and a backend configuration are connected with rules.</span></span> <span data-ttu-id="30e12-111">Olá referenciada pela regra Olá de sonda de estado de funcionamento é utilizada toodetermine como novo fluxos são enviados tooa nó no conjunto de back-end Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-111">hello health probe referenced by hello rule is used toodetermine how new flows are sent tooa node in hello backend pool.</span></span> <span data-ttu-id="30e12-112">front-end de Olá é definido por um IP Virtual (VIP), que é uma 3 cadeias de identificação composta por um endereço IP (interno ou público), um protocolo de transporte (UDP ou TCP) e um número de porta.</span><span class="sxs-lookup"><span data-stu-id="30e12-112">hello frontend is defined by a Virtual IP (VIP), which is a 3-tuple comprised of an IP address (public or internal), a transport protocol (UDP or TCP), and a port number.</span></span> <span data-ttu-id="30e12-113">Um DIP é que um endereço IP numa NIC virtual do Azure anexados tooa VM no conjunto de back-end Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-113">A DIP is an IP address on an Azure virtual NIC attached tooa VM in hello backend pool.</span></span>

<span data-ttu-id="30e12-114">Olá, a tabela seguinte contém algumas configurações de front-end de exemplo:</span><span class="sxs-lookup"><span data-stu-id="30e12-114">hello following table contains some example frontend configurations:</span></span>

| <span data-ttu-id="30e12-115">VIP</span><span class="sxs-lookup"><span data-stu-id="30e12-115">VIP</span></span> | <span data-ttu-id="30e12-116">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="30e12-116">IP address</span></span> | <span data-ttu-id="30e12-117">Protocolo</span><span class="sxs-lookup"><span data-stu-id="30e12-117">protocol</span></span> | <span data-ttu-id="30e12-118">porta</span><span class="sxs-lookup"><span data-stu-id="30e12-118">port</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="30e12-119">1</span><span class="sxs-lookup"><span data-stu-id="30e12-119">1</span></span> |<span data-ttu-id="30e12-120">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="30e12-120">65.52.0.1</span></span> |<span data-ttu-id="30e12-121">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-121">TCP</span></span> |<span data-ttu-id="30e12-122">80</span><span class="sxs-lookup"><span data-stu-id="30e12-122">80</span></span> |
| <span data-ttu-id="30e12-123">2</span><span class="sxs-lookup"><span data-stu-id="30e12-123">2</span></span> |<span data-ttu-id="30e12-124">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="30e12-124">65.52.0.1</span></span> |<span data-ttu-id="30e12-125">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-125">TCP</span></span> |<span data-ttu-id="30e12-126">*8080*</span><span class="sxs-lookup"><span data-stu-id="30e12-126">*8080*</span></span> |
| <span data-ttu-id="30e12-127">3</span><span class="sxs-lookup"><span data-stu-id="30e12-127">3</span></span> |<span data-ttu-id="30e12-128">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="30e12-128">65.52.0.1</span></span> |<span data-ttu-id="30e12-129">*UDP*</span><span class="sxs-lookup"><span data-stu-id="30e12-129">*UDP*</span></span> |<span data-ttu-id="30e12-130">80</span><span class="sxs-lookup"><span data-stu-id="30e12-130">80</span></span> |
| <span data-ttu-id="30e12-131">4</span><span class="sxs-lookup"><span data-stu-id="30e12-131">4</span></span> |<span data-ttu-id="30e12-132">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="30e12-132">*65.52.0.2*</span></span> |<span data-ttu-id="30e12-133">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-133">TCP</span></span> |<span data-ttu-id="30e12-134">80</span><span class="sxs-lookup"><span data-stu-id="30e12-134">80</span></span> |

<span data-ttu-id="30e12-135">tabela de Olá mostra quatro frontends diferentes.</span><span class="sxs-lookup"><span data-stu-id="30e12-135">hello table shows four different frontends.</span></span> <span data-ttu-id="30e12-136">Frontends n. º 1, #2 e #3 são um VIP único com várias regras.</span><span class="sxs-lookup"><span data-stu-id="30e12-136">Frontends #1, #2 and #3 are a single VIP with multiple rules.</span></span> <span data-ttu-id="30e12-137">Olá mesmo endereço IP é utilizado, mas porta Olá ou protocolo é diferente para cada front-end.</span><span class="sxs-lookup"><span data-stu-id="30e12-137">hello same IP address is used but hello port or protocol is different for each frontend.</span></span> <span data-ttu-id="30e12-138">Frontends n. º 1 e #4 são um exemplo de vários VIPs, onde hello mesmo protocolo de front-end e porta são reutilizadas em vários VIPs.</span><span class="sxs-lookup"><span data-stu-id="30e12-138">Frontends #1 and #4 are an example of Multiple VIPs, where hello same frontend protocol and port are reused across multiple VIPs.</span></span>

<span data-ttu-id="30e12-139">Balanceador de carga do Azure fornece flexibilidade na definição de regras de balanceamento de carga Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-139">Azure Load Balancer provides flexibility in defining hello load balancing rules.</span></span> <span data-ttu-id="30e12-140">Uma regra declara como um endereço e porta de front-end de Olá está mapeada toohello endereço de destino e a porta no back-end de Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-140">A rule declares how an address and port on hello frontend is mapped toohello destination address and port on hello backend.</span></span> <span data-ttu-id="30e12-141">Se pretende ou não as portas de back-end são reutilizadas em regras dependem de tipo de Olá da regra de Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-141">Whether or not backend ports are reused across rules depends on hello type of hello rule.</span></span> <span data-ttu-id="30e12-142">Cada tipo de regra tem requisitos específicos que podem afetar a estrutura de configuração e a sonda do anfitrião.</span><span class="sxs-lookup"><span data-stu-id="30e12-142">Each type of rule has specific requirements that can affect host configuration and probe design.</span></span> <span data-ttu-id="30e12-143">Existem dois tipos de regras:</span><span class="sxs-lookup"><span data-stu-id="30e12-143">There are two types of rules:</span></span>

1. <span data-ttu-id="30e12-144">reutilizar a regra predefinida de Olá com nenhuma porta de back-end</span><span class="sxs-lookup"><span data-stu-id="30e12-144">hello default rule with no backend port reuse</span></span>
2. <span data-ttu-id="30e12-145">regra de IP flutuante olá onde são reutilizadas portas de back-end</span><span class="sxs-lookup"><span data-stu-id="30e12-145">hello Floating IP rule where backend ports are reused</span></span>

<span data-ttu-id="30e12-146">Balanceador de carga do Azure permite-lhe toomix ambos os tipos de regra no Olá a mesma configuração de Balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="30e12-146">Azure Load Balancer allows you toomix both rule types on hello same load balancer configuration.</span></span> <span data-ttu-id="30e12-147">Balanceador de carga Olá pode utilizá-los em simultâneo para uma determinada VM ou qualquer combinação, desde que cumprir por restrições de Olá da regra de Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-147">hello load balancer can use them simultaneously for a given VM, or any combination, as long as you abide by hello constraints of hello rule.</span></span> <span data-ttu-id="30e12-148">O tipo de regra que escolher depende de requisitos de Olá da sua aplicação e Olá complexidade de oferecer suporte a que a configuração.</span><span class="sxs-lookup"><span data-stu-id="30e12-148">Which rule type you choose depends on hello requirements of your application and hello complexity of supporting that configuration.</span></span> <span data-ttu-id="30e12-149">Deve avaliar que tipos de regra são melhores para o seu cenário.</span><span class="sxs-lookup"><span data-stu-id="30e12-149">You should evaluate which rule types are best for your scenario.</span></span>

<span data-ttu-id="30e12-150">Vamos explorar estes cenários mais iniciando com o comportamento predefinido de Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-150">We explore these scenarios further by starting with hello default behavior.</span></span>

## <a name="rule-type-1-no-backend-port-reuse"></a><span data-ttu-id="30e12-151">#1 do tipo de regra: nenhum reutilização de porta de back-end</span><span class="sxs-lookup"><span data-stu-id="30e12-151">Rule type #1: No backend port reuse</span></span>

![Ilustração de MultiVIP](./media/load-balancer-multivip-overview/load-balancer-multivip.png)

<span data-ttu-id="30e12-153">Neste cenário, front-end de Olá VIPs estão configuradas da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="30e12-153">In this scenario, hello frontend VIPs are configured as follows:</span></span>

| <span data-ttu-id="30e12-154">VIP</span><span class="sxs-lookup"><span data-stu-id="30e12-154">VIP</span></span> | <span data-ttu-id="30e12-155">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="30e12-155">IP address</span></span> | <span data-ttu-id="30e12-156">Protocolo</span><span class="sxs-lookup"><span data-stu-id="30e12-156">protocol</span></span> | <span data-ttu-id="30e12-157">porta</span><span class="sxs-lookup"><span data-stu-id="30e12-157">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="30e12-159">1</span><span class="sxs-lookup"><span data-stu-id="30e12-159">1</span></span> |<span data-ttu-id="30e12-160">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="30e12-160">65.52.0.1</span></span> |<span data-ttu-id="30e12-161">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-161">TCP</span></span> |<span data-ttu-id="30e12-162">80</span><span class="sxs-lookup"><span data-stu-id="30e12-162">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="30e12-164">2</span><span class="sxs-lookup"><span data-stu-id="30e12-164">2</span></span> |<span data-ttu-id="30e12-165">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="30e12-165">*65.52.0.2*</span></span> |<span data-ttu-id="30e12-166">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-166">TCP</span></span> |<span data-ttu-id="30e12-167">80</span><span class="sxs-lookup"><span data-stu-id="30e12-167">80</span></span> |

<span data-ttu-id="30e12-168">Olá DIP é destino Olá Olá fluxo de entrada.</span><span class="sxs-lookup"><span data-stu-id="30e12-168">hello DIP is hello destination of hello inbound flow.</span></span> <span data-ttu-id="30e12-169">No conjunto de back-end Olá, cada VM expõe serviço Olá pretendido numa porta exclusivo num DIP.</span><span class="sxs-lookup"><span data-stu-id="30e12-169">In hello backend pool, each VM exposes hello desired service on a unique port on a DIP.</span></span> <span data-ttu-id="30e12-170">Este serviço está associado a front-end de Olá através da definição de uma regra.</span><span class="sxs-lookup"><span data-stu-id="30e12-170">This service is associated with hello frontend through a rule definition.</span></span>

<span data-ttu-id="30e12-171">Iremos definir duas regras:</span><span class="sxs-lookup"><span data-stu-id="30e12-171">We define two rules:</span></span>

| <span data-ttu-id="30e12-172">Regra</span><span class="sxs-lookup"><span data-stu-id="30e12-172">Rule</span></span> | <span data-ttu-id="30e12-173">Mapear front-end</span><span class="sxs-lookup"><span data-stu-id="30e12-173">Map frontend</span></span> | <span data-ttu-id="30e12-174">conjunto de toobackend</span><span class="sxs-lookup"><span data-stu-id="30e12-174">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="30e12-175">1</span><span class="sxs-lookup"><span data-stu-id="30e12-175">1</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="30e12-177">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="30e12-177">VIP1:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="30e12-179">DIP1:80,</span><span class="sxs-lookup"><span data-stu-id="30e12-179">DIP1:80,</span></span> ![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="30e12-181">DIP2:80</span><span class="sxs-lookup"><span data-stu-id="30e12-181">DIP2:80</span></span> |
| <span data-ttu-id="30e12-182">2</span><span class="sxs-lookup"><span data-stu-id="30e12-182">2</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="30e12-184">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="30e12-184">VIP2:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="30e12-186">DIP1:81,</span><span class="sxs-lookup"><span data-stu-id="30e12-186">DIP1:81,</span></span> ![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="30e12-188">DIP2:81</span><span class="sxs-lookup"><span data-stu-id="30e12-188">DIP2:81</span></span> |

<span data-ttu-id="30e12-189">mapeamento de conclusão de Olá no balanceador de carga do Azure está agora da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="30e12-189">hello complete mapping in Azure Load Balancer is now as follows:</span></span>

| <span data-ttu-id="30e12-190">Regra</span><span class="sxs-lookup"><span data-stu-id="30e12-190">Rule</span></span> | <span data-ttu-id="30e12-191">Endereço IP de VIP</span><span class="sxs-lookup"><span data-stu-id="30e12-191">VIP IP address</span></span> | <span data-ttu-id="30e12-192">Protocolo</span><span class="sxs-lookup"><span data-stu-id="30e12-192">protocol</span></span> | <span data-ttu-id="30e12-193">porta</span><span class="sxs-lookup"><span data-stu-id="30e12-193">port</span></span> | <span data-ttu-id="30e12-194">Destino</span><span class="sxs-lookup"><span data-stu-id="30e12-194">Destination</span></span> | <span data-ttu-id="30e12-195">porta</span><span class="sxs-lookup"><span data-stu-id="30e12-195">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![Regra](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="30e12-197">1</span><span class="sxs-lookup"><span data-stu-id="30e12-197">1</span></span> |<span data-ttu-id="30e12-198">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="30e12-198">65.52.0.1</span></span> |<span data-ttu-id="30e12-199">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-199">TCP</span></span> |<span data-ttu-id="30e12-200">80</span><span class="sxs-lookup"><span data-stu-id="30e12-200">80</span></span> |<span data-ttu-id="30e12-201">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="30e12-201">DIP IP Address</span></span> |<span data-ttu-id="30e12-202">80</span><span class="sxs-lookup"><span data-stu-id="30e12-202">80</span></span> |
| ![Regra](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="30e12-204">2</span><span class="sxs-lookup"><span data-stu-id="30e12-204">2</span></span> |<span data-ttu-id="30e12-205">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="30e12-205">65.52.0.2</span></span> |<span data-ttu-id="30e12-206">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-206">TCP</span></span> |<span data-ttu-id="30e12-207">80</span><span class="sxs-lookup"><span data-stu-id="30e12-207">80</span></span> |<span data-ttu-id="30e12-208">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="30e12-208">DIP IP Address</span></span> |<span data-ttu-id="30e12-209">81</span><span class="sxs-lookup"><span data-stu-id="30e12-209">81</span></span> |

<span data-ttu-id="30e12-210">Cada regra deve produzir um fluxo com uma combinação única de endereço IP de destino e porta de destino.</span><span class="sxs-lookup"><span data-stu-id="30e12-210">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="30e12-211">Por variando Olá da porta de destino do fluxo de Olá, várias regras podem proporcionar fluxos toohello DIP mesmo nas portas diferentes.</span><span class="sxs-lookup"><span data-stu-id="30e12-211">By varying hello destination port of hello flow, multiple rules can deliver flows toohello same DIP on different ports.</span></span>

<span data-ttu-id="30e12-212">Sondas de estado de funcionamento são sempre toohello direcionado DIP de uma VM.</span><span class="sxs-lookup"><span data-stu-id="30e12-212">Health probes are always directed toohello DIP of a VM.</span></span> <span data-ttu-id="30e12-213">Tem de se certificar de se sua pesquisa reflete o estado de funcionamento de Olá de Olá VM.</span><span class="sxs-lookup"><span data-stu-id="30e12-213">You must ensure you that your probe reflects hello health of hello VM.</span></span>

## <a name="rule-type-2-backend-port-reuse-by-using-floating-ip"></a><span data-ttu-id="30e12-214">Regra de tipo #2: reutilização de porta de back-end utilizando o IP flutuante</span><span class="sxs-lookup"><span data-stu-id="30e12-214">Rule type #2: backend port reuse by using Floating IP</span></span>

<span data-ttu-id="30e12-215">Balanceador de carga do Azure fornece flexibilidade de Olá porta de front-end de Olá tooreuse vários VIPs independentemente do tipo de regra de Olá utilizado.</span><span class="sxs-lookup"><span data-stu-id="30e12-215">Azure Load Balancer provides hello flexibility tooreuse hello frontend port across multiple VIPs regardless of hello rule type used.</span></span> <span data-ttu-id="30e12-216">Além disso, alguns cenários de aplicação preferem ou exigem Olá mesmo toobe utilizado por várias instâncias de aplicações numa única VM no conjunto de back-end Olá de porta.</span><span class="sxs-lookup"><span data-stu-id="30e12-216">Additionally, some application scenarios prefer or require hello same port toobe used by multiple application instances on a single VM in hello backend pool.</span></span> <span data-ttu-id="30e12-217">Exemplos comuns de uma reutilização de porta incluem o clustering de elevada disponibilidade, aplicações virtuais e expor vários pontos finais TLS sem a encriptação de rede.</span><span class="sxs-lookup"><span data-stu-id="30e12-217">Common examples of port reuse include clustering for high availability, network virtual appliances, and exposing multiple TLS endpoints without re-encryption.</span></span>

<span data-ttu-id="30e12-218">Se pretender que a porta de back-end de Olá tooreuse através de várias regras, tem de ativar o IP flutuante na definição da regra de Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-218">If you want tooreuse hello backend port across multiple rules, you must enable Floating IP in hello rule definition.</span></span>

<span data-ttu-id="30e12-219">IP flutuante é uma parte do que é conhecida como direta servidor devolver (DSR).</span><span class="sxs-lookup"><span data-stu-id="30e12-219">Floating IP is a portion of what is known as Direct Server Return (DSR).</span></span> <span data-ttu-id="30e12-220">DSR consiste em duas partes: uma topologia de fluxo e um endereço IP esquema de mapeamento.</span><span class="sxs-lookup"><span data-stu-id="30e12-220">DSR consists of two parts: a flow topology and an IP address mapping scheme.</span></span> <span data-ttu-id="30e12-221">Um nível de plataforma, o Balanceador de carga do Azure sempre funciona numa topologia de fluxo DSR independentemente se o IP flutuante está ativada ou não.</span><span class="sxs-lookup"><span data-stu-id="30e12-221">At a platform level, Azure Load Balancer always operates in a DSR flow topology regardless of whether Floating IP is enabled or not.</span></span> <span data-ttu-id="30e12-222">Isto significa que Olá saída parte um fluxo sempre origem de anterior diretamente toohello tooflow corretamente conversão.</span><span class="sxs-lookup"><span data-stu-id="30e12-222">This means that hello outbound part of a flow is always correctly rewritten tooflow directly back toohello origin.</span></span>

<span data-ttu-id="30e12-223">Com o tipo de regra predefinida de Olá, Azure expõe uma esquema de mapeamento de endereço IP para facilitar a utilização de balanceamento de carga tradicional.</span><span class="sxs-lookup"><span data-stu-id="30e12-223">With hello default rule type, Azure exposes a traditional load balancing IP address mapping scheme for ease of use.</span></span> <span data-ttu-id="30e12-224">Ativar IP flutuante alterações Olá tooallow de esquema de mapeamento de endereço IP de flexibilidade adicional, como explicado abaixo.</span><span class="sxs-lookup"><span data-stu-id="30e12-224">Enabling Floating IP changes hello IP address mapping scheme tooallow for additional flexibility as explained below.</span></span>

<span data-ttu-id="30e12-225">Olá seguinte diagrama ilustra esta configuração:</span><span class="sxs-lookup"><span data-stu-id="30e12-225">hello following diagram illustrates this configuration:</span></span>

![Ilustração de MultiVIP](./media/load-balancer-multivip-overview/load-balancer-multivip-dsr.png)

<span data-ttu-id="30e12-227">Para este cenário, a cada VM no conjunto de back-end Olá tem três interfaces de rede:</span><span class="sxs-lookup"><span data-stu-id="30e12-227">For this scenario, every VM in hello backend pool has three network interfaces:</span></span>

* <span data-ttu-id="30e12-228">DIP: uma NIC Virtual associado Olá VM (configuração de IP do recurso NIC do Azure)</span><span class="sxs-lookup"><span data-stu-id="30e12-228">DIP: a Virtual NIC associated with hello VM (IP configuration of Azure's NIC resource)</span></span>
* <span data-ttu-id="30e12-229">O VIP1: uma interface de loopback dentro do SO que está configurado com o endereço IP do VIP1 convidado</span><span class="sxs-lookup"><span data-stu-id="30e12-229">VIP1: a loopback interface within guest OS that is configured with IP address of VIP1</span></span>
* <span data-ttu-id="30e12-230">VIP2: uma interface de loopback dentro do SO que está configurado com endereço IP de VIP2 convidado</span><span class="sxs-lookup"><span data-stu-id="30e12-230">VIP2: a loopback interface within guest OS that is configured with IP address of VIP2</span></span>

> [!IMPORTANT]
> <span data-ttu-id="30e12-231">configuração de Olá das interfaces lógica Olá é efetuada convidado Olá SO.</span><span class="sxs-lookup"><span data-stu-id="30e12-231">hello configuration of hello logical interfaces is performed within hello guest OS.</span></span> <span data-ttu-id="30e12-232">Esta configuração não é efetuada ou é gerida pelo Azure.</span><span class="sxs-lookup"><span data-stu-id="30e12-232">This configuration is not performed or managed by Azure.</span></span> <span data-ttu-id="30e12-233">Sem esta configuração, as regras de Olá não irão funcionar.</span><span class="sxs-lookup"><span data-stu-id="30e12-233">Without this configuration, hello rules will not function.</span></span> <span data-ttu-id="30e12-234">Definições de pesquisa de estado de funcionamento utilizam Olá DIP de Olá VM em vez de Olá VIP lógico.</span><span class="sxs-lookup"><span data-stu-id="30e12-234">Health probe definitions use hello DIP of hello VM rather than hello logical VIP.</span></span> <span data-ttu-id="30e12-235">Por conseguinte, o serviço tem de fornecer respostas de pesquisa numa porta DIP que refletir o estado de Olá do serviço de Olá disponibilizado no VIP lógica Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-235">Therefore, your service must provide probe responses on a DIP port that reflect hello status of hello service offered on hello logical VIP.</span></span>

<span data-ttu-id="30e12-236">Vamos supor que Olá mesma configuração de front-end como no cenário anterior Olá:</span><span class="sxs-lookup"><span data-stu-id="30e12-236">Let's assume hello same frontend configuration as in hello previous scenario:</span></span>

| <span data-ttu-id="30e12-237">VIP</span><span class="sxs-lookup"><span data-stu-id="30e12-237">VIP</span></span> | <span data-ttu-id="30e12-238">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="30e12-238">IP address</span></span> | <span data-ttu-id="30e12-239">Protocolo</span><span class="sxs-lookup"><span data-stu-id="30e12-239">protocol</span></span> | <span data-ttu-id="30e12-240">porta</span><span class="sxs-lookup"><span data-stu-id="30e12-240">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="30e12-242">1</span><span class="sxs-lookup"><span data-stu-id="30e12-242">1</span></span> |<span data-ttu-id="30e12-243">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="30e12-243">65.52.0.1</span></span> |<span data-ttu-id="30e12-244">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-244">TCP</span></span> |<span data-ttu-id="30e12-245">80</span><span class="sxs-lookup"><span data-stu-id="30e12-245">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="30e12-247">2</span><span class="sxs-lookup"><span data-stu-id="30e12-247">2</span></span> |<span data-ttu-id="30e12-248">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="30e12-248">*65.52.0.2*</span></span> |<span data-ttu-id="30e12-249">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-249">TCP</span></span> |<span data-ttu-id="30e12-250">80</span><span class="sxs-lookup"><span data-stu-id="30e12-250">80</span></span> |

<span data-ttu-id="30e12-251">Iremos definir duas regras:</span><span class="sxs-lookup"><span data-stu-id="30e12-251">We define two rules:</span></span>

| <span data-ttu-id="30e12-252">Regra</span><span class="sxs-lookup"><span data-stu-id="30e12-252">Rule</span></span> | <span data-ttu-id="30e12-253">Mapear front-end</span><span class="sxs-lookup"><span data-stu-id="30e12-253">Map frontend</span></span> | <span data-ttu-id="30e12-254">conjunto de toobackend</span><span class="sxs-lookup"><span data-stu-id="30e12-254">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="30e12-255">1</span><span class="sxs-lookup"><span data-stu-id="30e12-255">1</span></span> |![Regra](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="30e12-257">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="30e12-257">VIP1:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="30e12-259">VIP1:80 (na VM1 e VM2)</span><span class="sxs-lookup"><span data-stu-id="30e12-259">VIP1:80 (in VM1 and VM2)</span></span> |
| <span data-ttu-id="30e12-260">2</span><span class="sxs-lookup"><span data-stu-id="30e12-260">2</span></span> |![Regra](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="30e12-262">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="30e12-262">VIP2:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="30e12-264">VIP2:80 (na VM1 e VM2)</span><span class="sxs-lookup"><span data-stu-id="30e12-264">VIP2:80 (in VM1 and VM2)</span></span> |

<span data-ttu-id="30e12-265">Olá a tabela seguinte mostra o mapeamento de conclusão de Olá no balanceador de carga Olá:</span><span class="sxs-lookup"><span data-stu-id="30e12-265">hello following table shows hello complete mapping in hello load balancer:</span></span>

| <span data-ttu-id="30e12-266">Regra</span><span class="sxs-lookup"><span data-stu-id="30e12-266">Rule</span></span> | <span data-ttu-id="30e12-267">Endereço IP de VIP</span><span class="sxs-lookup"><span data-stu-id="30e12-267">VIP IP address</span></span> | <span data-ttu-id="30e12-268">Protocolo</span><span class="sxs-lookup"><span data-stu-id="30e12-268">protocol</span></span> | <span data-ttu-id="30e12-269">porta</span><span class="sxs-lookup"><span data-stu-id="30e12-269">port</span></span> | <span data-ttu-id="30e12-270">Destino</span><span class="sxs-lookup"><span data-stu-id="30e12-270">Destination</span></span> | <span data-ttu-id="30e12-271">porta</span><span class="sxs-lookup"><span data-stu-id="30e12-271">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="30e12-273">1</span><span class="sxs-lookup"><span data-stu-id="30e12-273">1</span></span> |<span data-ttu-id="30e12-274">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="30e12-274">65.52.0.1</span></span> |<span data-ttu-id="30e12-275">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-275">TCP</span></span> |<span data-ttu-id="30e12-276">80</span><span class="sxs-lookup"><span data-stu-id="30e12-276">80</span></span> |<span data-ttu-id="30e12-277">igual ao VIP (65.52.0.1)</span><span class="sxs-lookup"><span data-stu-id="30e12-277">same as VIP (65.52.0.1)</span></span> |<span data-ttu-id="30e12-278">igual ao VIP (80)</span><span class="sxs-lookup"><span data-stu-id="30e12-278">same as VIP (80)</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="30e12-280">2</span><span class="sxs-lookup"><span data-stu-id="30e12-280">2</span></span> |<span data-ttu-id="30e12-281">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="30e12-281">65.52.0.2</span></span> |<span data-ttu-id="30e12-282">TCP</span><span class="sxs-lookup"><span data-stu-id="30e12-282">TCP</span></span> |<span data-ttu-id="30e12-283">80</span><span class="sxs-lookup"><span data-stu-id="30e12-283">80</span></span> |<span data-ttu-id="30e12-284">igual ao VIP (65.52.0.2)</span><span class="sxs-lookup"><span data-stu-id="30e12-284">same as VIP (65.52.0.2)</span></span> |<span data-ttu-id="30e12-285">igual ao VIP (80)</span><span class="sxs-lookup"><span data-stu-id="30e12-285">same as VIP (80)</span></span> |

<span data-ttu-id="30e12-286">destino de Olá de Olá fluxo de entrada é o endereço de Olá VIP na interface de loopback de Olá no Olá VM.</span><span class="sxs-lookup"><span data-stu-id="30e12-286">hello destination of hello inbound flow is hello VIP address on hello loopback interface in hello VM.</span></span> <span data-ttu-id="30e12-287">Cada regra deve produzir um fluxo com uma combinação única de endereço IP de destino e porta de destino.</span><span class="sxs-lookup"><span data-stu-id="30e12-287">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="30e12-288">Por variando Olá endereço IP de destino do fluxo de Olá, é possível no reutilização de porta Olá mesma VM.</span><span class="sxs-lookup"><span data-stu-id="30e12-288">By varying hello destination IP address of hello flow, port reuse is possible on hello same VM.</span></span> <span data-ttu-id="30e12-289">O serviço é Balanceador de carga toohello expostos pelo enlace de endereço IP e porta de interface de loopback respetivos Olá toohello do VIP.</span><span class="sxs-lookup"><span data-stu-id="30e12-289">Your service is exposed toohello load balancer by binding it toohello VIP’s IP address and port of hello respective loopback interface.</span></span>

<span data-ttu-id="30e12-290">Tenha em atenção que este exemplo não altera a porta de destino Olá.</span><span class="sxs-lookup"><span data-stu-id="30e12-290">Notice that this example does not change hello destination port.</span></span> <span data-ttu-id="30e12-291">Apesar de este ser um cenário de IP flutuante, o Balanceador de carga do Azure suporta também definir uma regra toorewrite Olá back-end da porta de destino e toomake-diferente da porta de destino Olá front-end.</span><span class="sxs-lookup"><span data-stu-id="30e12-291">Even though this is a Floating IP scenario, Azure Load Balancer also supports defining a rule toorewrite hello backend destination port and toomake it different from hello frontend destination port.</span></span>

<span data-ttu-id="30e12-292">Olá, tipo de regra de IP flutuante é foundation Olá de vários padrões de configuração de Balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="30e12-292">hello Floating IP rule type is hello foundation of several load balancer configuration patterns.</span></span> <span data-ttu-id="30e12-293">Um exemplo que está atualmente disponível é Olá [AlwaysOn de SQL com vários serviços de escuta](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configuração.</span><span class="sxs-lookup"><span data-stu-id="30e12-293">One example that is currently available is hello [SQL AlwaysOn with Multiple Listeners](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configuration.</span></span> <span data-ttu-id="30e12-294">Ao longo do tempo, iremos irá documentos mais um destes cenários.</span><span class="sxs-lookup"><span data-stu-id="30e12-294">Over time, we will document more of these scenarios.</span></span>

## <a name="limitations"></a><span data-ttu-id="30e12-295">Limitações</span><span class="sxs-lookup"><span data-stu-id="30e12-295">Limitations</span></span>

* <span data-ttu-id="30e12-296">Múltiplas configurações de VIP só são suportadas com VMs de IaaS.</span><span class="sxs-lookup"><span data-stu-id="30e12-296">Multiple VIP configurations are only supported with IaaS VMs.</span></span>
* <span data-ttu-id="30e12-297">Com a regra de IP flutuante Olá, a aplicação tem de utilizar Olá DIP para fluxos de saída.</span><span class="sxs-lookup"><span data-stu-id="30e12-297">With hello Floating IP rule, your application must use hello DIP for outbound flows.</span></span> <span data-ttu-id="30e12-298">Se a sua aplicação vincula o endereço de VIP toohello configurado na interface de loopback de Olá no SO de convidado de Olá, em seguida, realizar o SNAT não é o fluxo de saída do toorewrite disponíveis Olá e fluxo Olá falha.</span><span class="sxs-lookup"><span data-stu-id="30e12-298">If your application binds toohello VIP address configured on hello loopback interface in hello guest OS, then SNAT is not available toorewrite hello outbound flow and hello flow fails.</span></span>
* <span data-ttu-id="30e12-299">Endereços IP públicos têm um efeito em faturação.</span><span class="sxs-lookup"><span data-stu-id="30e12-299">Public IP addresses have an effect on billing.</span></span> <span data-ttu-id="30e12-300">Para obter mais informações, consulte [preços do endereço IP](https://azure.microsoft.com/pricing/details/ip-addresses/)</span><span class="sxs-lookup"><span data-stu-id="30e12-300">For more information, see [IP Address pricing](https://azure.microsoft.com/pricing/details/ip-addresses/)</span></span>
* <span data-ttu-id="30e12-301">São aplicáveis a limites de subscrição.</span><span class="sxs-lookup"><span data-stu-id="30e12-301">Subscription limits apply.</span></span> <span data-ttu-id="30e12-302">Para obter mais informações, consulte [os limites de serviço](../azure-subscription-service-limits.md#networking-limits) para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="30e12-302">For more information, see [Service limits](../azure-subscription-service-limits.md#networking-limits) for details.</span></span>
