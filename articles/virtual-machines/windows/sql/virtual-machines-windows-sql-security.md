---
title: "aaaSecurity considerações para o SQL Server no Azure | Microsoft Docs"
description: "Este tópico fornece orientações gerais para proteger o SQL Server em execução de uma Máquina Virtual no Azure."
services: virtual-machines-windows
documentationcenter: na
author: rothja
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: d710c296-e490-43e7-8ca9-8932586b71da
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 06/02/2017
ms.author: jroth
ms.openlocfilehash: 14c3d828fa87446da67beea6d28886de254afe15
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="security-considerations-for-sql-server-in-azure-virtual-machines"></a><span data-ttu-id="7217e-103">Considerações de Segurança para SQL Server em Máquinas Virtuais do Azure</span><span class="sxs-lookup"><span data-stu-id="7217e-103">Security Considerations for SQL Server in Azure Virtual Machines</span></span>

<span data-ttu-id="7217e-104">Este tópico inclui geral diretrizes de segurança que ajudam a estabelecer instâncias de servidor do acesso seguro tooSQL numa máquina virtual do Azure (VM).</span><span class="sxs-lookup"><span data-stu-id="7217e-104">This topic includes overall security guidelines that help establish secure access tooSQL Server instances in an Azure virtual machine (VM).</span></span>

<span data-ttu-id="7217e-105">Azure está em conformidade com várias normas que podem permitir-toobuild uma solução em conformidade com o SQL Server em execução numa máquina virtual e regulamentos da indústria.</span><span class="sxs-lookup"><span data-stu-id="7217e-105">Azure complies with several industry regulations and standards that can enable you toobuild a compliant solution with SQL Server running in a virtual machine.</span></span> <span data-ttu-id="7217e-106">Para obter informações sobre a conformidade regulamentar com o Azure, consulte [Centro de fidedignidade do Azure](https://azure.microsoft.com/support/trust-center/).</span><span class="sxs-lookup"><span data-stu-id="7217e-106">For information about regulatory compliance with Azure, see [Azure Trust Center](https://azure.microsoft.com/support/trust-center/).</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="control-access-toohello-sql-vm"></a><span data-ttu-id="7217e-107">Controlar o acesso toohello VM do SQL Server</span><span class="sxs-lookup"><span data-stu-id="7217e-107">Control access toohello SQL VM</span></span>

<span data-ttu-id="7217e-108">Ao criar a máquina virtual do SQL Server, considere como toocarefully controlar quem tem máquina toohello de acesso e tooSQL servidor.</span><span class="sxs-lookup"><span data-stu-id="7217e-108">When you create your SQL Server virtual machine, consider how toocarefully control who has access toohello machine and tooSQL Server.</span></span> <span data-ttu-id="7217e-109">Em geral, deve fazer seguinte Olá:</span><span class="sxs-lookup"><span data-stu-id="7217e-109">In general, you should do hello following:</span></span>

- <span data-ttu-id="7217e-110">Restringir o acesso tooSQL tooonly Olá as aplicações de servidor e clientes que precisem dele.</span><span class="sxs-lookup"><span data-stu-id="7217e-110">Restrict access tooSQL Server tooonly hello applications and clients that need it.</span></span>
- <span data-ttu-id="7217e-111">Siga as melhores práticas para gerir contas de utilizador e palavras-passe.</span><span class="sxs-lookup"><span data-stu-id="7217e-111">Follow best practices for managing user accounts and passwords.</span></span>

<span data-ttu-id="7217e-112">Olá secções a seguir fornece sugestões sobre pensar através destes pontos.</span><span class="sxs-lookup"><span data-stu-id="7217e-112">hello following sections provide suggestions on thinking through these points.</span></span>

## <a name="secure-connections"></a><span data-ttu-id="7217e-113">Ligações seguras</span><span class="sxs-lookup"><span data-stu-id="7217e-113">Secure connections</span></span>

<span data-ttu-id="7217e-114">Quando cria uma máquina virtual do SQL Server com uma imagem de galeria, Olá **conectividade do SQL Server** opção fornecem Olá escolha de **Local (no interior da VM)**, **privada (na Virtual Network)** , ou **público (Internet)**.</span><span class="sxs-lookup"><span data-stu-id="7217e-114">When you create a SQL Server virtual machine with a gallery image, hello **SQL Server Connectivity** option gives you hello choice of **Local (inside VM)**, **Private (within Virtual Network)**, or **Public (Internet)**.</span></span>

![Conectividade do SQL Server](./media/virtual-machines-windows-sql-security/sql-vm-connectivity-option.png)

<span data-ttu-id="7217e-116">Para segurança de melhor Olá, escolha a opção mais restritiva do Olá para o seu cenário.</span><span class="sxs-lookup"><span data-stu-id="7217e-116">For hello best security, choose hello most restrictive option for your scenario.</span></span> <span data-ttu-id="7217e-117">Por exemplo, se estiver a executar uma aplicação que acede ao SQL Server no Olá mesma VM, em seguida, **Local** é Olá de opção mais segura.</span><span class="sxs-lookup"><span data-stu-id="7217e-117">For example, if you are running an application that accesses SQL Server on hello same VM, then **Local** is hello most secure choice.</span></span> <span data-ttu-id="7217e-118">Se estiver a executar uma aplicação do Azure que requer acesso toohello SQL Server, em seguida, **privada** protege comunicação tooSQL Server apenas dentro do Olá especificado [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7217e-118">If you are running an Azure application that requires access toohello SQL Server, then **Private** secures communication tooSQL Server only within hello specified [Azure Virtual Network](../../../virtual-network/virtual-networks-overview.md).</span></span> <span data-ttu-id="7217e-119">Se necessitar de **pública** (internest) de acesso de toohello VM do SQL Server, em seguida, marca se toofollow outros de melhores práticas no tooreduce tópico sua área de superfície de ataque.</span><span class="sxs-lookup"><span data-stu-id="7217e-119">If you require **Public** (internest) access toohello SQL Server VM, then make sure toofollow other best practices in this topic tooreduce your attack surface area.</span></span>

<span data-ttu-id="7217e-120">Olá as opções selecionadas no portal de Olá utilizam regras de segurança de entrada no Olá VMs [grupo de segurança de rede](../../../virtual-network/virtual-networks-nsg.md) tooallow (NSG) ou negar o tráfego de rede tooyour máquina de virtual.</span><span class="sxs-lookup"><span data-stu-id="7217e-120">hello selected options in hello portal use inbound security rules on hello VMs [Network Security Group](../../../virtual-network/virtual-networks-nsg.md) (NSG) tooallow or deny network traffic tooyour virtual machine.</span></span> <span data-ttu-id="7217e-121">Pode modificar ou criar novas regras NSG entradas porta do SQL Server do tooallow tráfego toohello (a predefinição é 1433).</span><span class="sxs-lookup"><span data-stu-id="7217e-121">You can modify or create new inbound NSG rules tooallow traffic toohello SQL Server port (default 1433).</span></span> <span data-ttu-id="7217e-122">Também pode especificar endereços IP específicos que são permitidos toocommunicate através desta porta.</span><span class="sxs-lookup"><span data-stu-id="7217e-122">You can also specify specific IP addresses that are allowed toocommunicate over this port.</span></span>

![Regras do grupo de segurança de rede](./media/virtual-machines-windows-sql-security/sql-vm-network-security-group-rules.png)

<span data-ttu-id="7217e-124">Além disso tooNSG regras de tráfego de rede toorestrict, também pode utilizar Olá Firewall do Windows na máquina virtual de Olá.</span><span class="sxs-lookup"><span data-stu-id="7217e-124">In addition tooNSG rules toorestrict network traffic, you can also use hello Windows Firewall on hello virtual machine.</span></span>

<span data-ttu-id="7217e-125">Se estiver a utilizar os pontos finais com o modelo de implementação clássica Olá, remova quaisquer pontos finais na máquina virtual de Olá se não utilizá-los.</span><span class="sxs-lookup"><span data-stu-id="7217e-125">If you are using endpoints with hello classic deployment model, remove any endpoints on hello virtual machine if you do not use them.</span></span> <span data-ttu-id="7217e-126">Para obter instruções sobre a utilização de ACLs com pontos finais, consulte [gerir Olá ACL num ponto final](../classic/setup-endpoints.md#manage-the-acl-on-an-endpoint).</span><span class="sxs-lookup"><span data-stu-id="7217e-126">For instructions on using ACLs with endpoints, see [Manage hello ACL on an endpoint](../classic/setup-endpoints.md#manage-the-acl-on-an-endpoint).</span></span> <span data-ttu-id="7217e-127">Não é necessário para as VMs que utilizam Olá Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="7217e-127">This is not necessary for VMs that use hello Resource Manager.</span></span>

<span data-ttu-id="7217e-128">Por fim, considere ativar ligações encriptadas para a instância de Olá de Olá motor de base de dados do SQL Server na sua máquina virtual do Azure.</span><span class="sxs-lookup"><span data-stu-id="7217e-128">Finally, consider enabling encrypted connections for hello instance of hello SQL Server Database Engine in your Azure virtual machine.</span></span> <span data-ttu-id="7217e-129">Configure a instância do SQL Server com um certificado assinado.</span><span class="sxs-lookup"><span data-stu-id="7217e-129">Configure SQL server instance with a signed certificate.</span></span> <span data-ttu-id="7217e-130">Para obter mais informações, consulte [ativar ligações encriptadas toohello motor de base de dados](https://docs.microsoft.com/sql/database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine) e [sintaxe da cadeia de ligação](https://msdn.microsoft.com/library/ms254500.aspx).</span><span class="sxs-lookup"><span data-stu-id="7217e-130">For more information, see [Enable Encrypted Connections toohello Database Engine](https://docs.microsoft.com/sql/database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine) and [Connection String Syntax](https://msdn.microsoft.com/library/ms254500.aspx).</span></span>

## <a name="use-a-non-default-port"></a><span data-ttu-id="7217e-131">Utilizar uma porta não predefinido</span><span class="sxs-lookup"><span data-stu-id="7217e-131">Use a non-default port</span></span>

<span data-ttu-id="7217e-132">Por predefinição, o SQL Server escuta numa porta bem conhecida, 1433.</span><span class="sxs-lookup"><span data-stu-id="7217e-132">By default, SQL Server listens on a well-known port, 1433.</span></span> <span data-ttu-id="7217e-133">Para maior segurança, configure o SQL Server toolisten numa porta não predefinidos, tais como 1401.</span><span class="sxs-lookup"><span data-stu-id="7217e-133">For increased security, configure SQL Server toolisten on a non-default port, such as 1401.</span></span> <span data-ttu-id="7217e-134">Se aprovisionar uma imagem de galeria do SQL Server no Olá portal do Azure, pode especificar esta porta no Olá **definições do SQL Server** painel.</span><span class="sxs-lookup"><span data-stu-id="7217e-134">If you provision a SQL Server gallery image in hello Azure portal, you can specify this port in hello **SQL Server settings** blade.</span></span>

<span data-ttu-id="7217e-135">tooconfigure este após o aprovisionamento, tem duas opções:</span><span class="sxs-lookup"><span data-stu-id="7217e-135">tooconfigure this after provisioning, you have two options:</span></span>

- <span data-ttu-id="7217e-136">Para VMs do Gestor de recursos, pode selecionar **configuração do SQL Server** do painel de descrição geral do Olá VM.</span><span class="sxs-lookup"><span data-stu-id="7217e-136">For Resource Manager VMs, you can select **SQL Server configuration** from hello VM overview blade.</span></span> <span data-ttu-id="7217e-137">Isto oferece uma opção de porta de Olá toochange.</span><span class="sxs-lookup"><span data-stu-id="7217e-137">This provides an option toochange hello port.</span></span>

  ![Alterar a porta TCP no portal](./media/virtual-machines-windows-sql-security/sql-vm-change-tcp-port.png)

- <span data-ttu-id="7217e-139">Para VMs clássicas ou para VMs de SQL Server que não tenham sido aprovisionados com o portal de Olá, pode configurar manualmente a porta de Olá ligando-se remotamente toohello VM.</span><span class="sxs-lookup"><span data-stu-id="7217e-139">For Classic VMs or for SQL Server VMs that were not provisioned with hello portal, you can manually configure hello port by connecting remotely toohello VM.</span></span> <span data-ttu-id="7217e-140">Para obter passos de configuração de Olá, consulte [configurar um servidor tooListen numa porta TCP específica](https://docs.microsoft.com/sql/database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port).</span><span class="sxs-lookup"><span data-stu-id="7217e-140">For hello configuration steps, see [Configure a Server tooListen on a Specific TCP Port](https://docs.microsoft.com/sql/database-engine/configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port).</span></span> <span data-ttu-id="7217e-141">Se utilizar esta técnica manual, terá também tooadd um Firewall do Windows regra tooallow tráfego de entrada nessa porta de TCP.</span><span class="sxs-lookup"><span data-stu-id="7217e-141">If you use this manual technique, you also need tooadd a Windows Firewall rule tooallow incoming traffic on that TCP port.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7217e-142">Especificar uma porta não predefinida é uma boa ideia se a porta do SQL Server é aberta toopublic ligações de internet.</span><span class="sxs-lookup"><span data-stu-id="7217e-142">Specifying a non-default port is a good idea if your SQL Server port is open toopublic internet connections.</span></span>

<span data-ttu-id="7217e-143">Quando o SQL Server está à escuta numa porta não predefinido, tem de especificar a porta de Olá quando se liga.</span><span class="sxs-lookup"><span data-stu-id="7217e-143">When SQL Server is listening on a non-default port, you must specify hello port when you connect.</span></span> <span data-ttu-id="7217e-144">Por exemplo, considere um cenário em que o endereço IP do servidor Olá é 13.55.255.255 e SQL Server está a escutar na porta 1401.</span><span class="sxs-lookup"><span data-stu-id="7217e-144">For example, consider a scenario where hello server IP address is 13.55.255.255 and SQL Server is listening on port 1401.</span></span> <span data-ttu-id="7217e-145">tooconnect tooSQL servidor, tem de especificar `13.55.255.255,1401` na cadeia de ligação de Olá.</span><span class="sxs-lookup"><span data-stu-id="7217e-145">tooconnect tooSQL Server, you would specify `13.55.255.255,1401` in hello connection string.</span></span>

## <a name="manage-accounts"></a><span data-ttu-id="7217e-146">Gerir contas</span><span class="sxs-lookup"><span data-stu-id="7217e-146">Manage accounts</span></span>

<span data-ttu-id="7217e-147">Não pretende que os nomes de atacantes tooeasily estimado contas ou palavras-passe.</span><span class="sxs-lookup"><span data-stu-id="7217e-147">You don't want attackers tooeasily guess account names or passwords.</span></span> <span data-ttu-id="7217e-148">Utilize Olá toohelp sugestões a seguir:</span><span class="sxs-lookup"><span data-stu-id="7217e-148">Use hello following tips toohelp:</span></span>

- <span data-ttu-id="7217e-149">Criar uma conta de administrador local exclusivo que não tem um nome **administrador**.</span><span class="sxs-lookup"><span data-stu-id="7217e-149">Create a unique local administrator account that is not named **Administrator**.</span></span>

- <span data-ttu-id="7217e-150">Utilize palavras-passe fortes complexas para todas as suas contas.</span><span class="sxs-lookup"><span data-stu-id="7217e-150">Use complex strong passwords for all your accounts.</span></span> <span data-ttu-id="7217e-151">Para obter mais informações sobre como toocreate uma palavra-passe segura, consulte [criar uma palavra-passe segura](https://support.microsoft.com/instantanswers/9bd5223b-efbe-aa95-b15a-2fb37bef637d/create-a-strong-password) artigo.</span><span class="sxs-lookup"><span data-stu-id="7217e-151">For more information about how toocreate a strong password, see [Create a strong password](https://support.microsoft.com/instantanswers/9bd5223b-efbe-aa95-b15a-2fb37bef637d/create-a-strong-password) article.</span></span>

- <span data-ttu-id="7217e-152">Por predefinição, o Azure seleciona a autenticação do Windows durante a configuração de Máquina Virtual do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="7217e-152">By default, Azure selects Windows Authentication during SQL Server Virtual Machine setup.</span></span> <span data-ttu-id="7217e-153">Por conseguinte, Olá **SA** início de sessão está desativado e uma palavra-passe é atribuída pelo programa de configuração.</span><span class="sxs-lookup"><span data-stu-id="7217e-153">Therefore, hello **SA** login is disabled and a password is assigned by setup.</span></span> <span data-ttu-id="7217e-154">Recomendamos que Olá **SA** início de sessão não deve ser utilizado ou ativado.</span><span class="sxs-lookup"><span data-stu-id="7217e-154">We recommend that hello **SA** login should not be used or enabled.</span></span> <span data-ttu-id="7217e-155">Se tem de ter um início de sessão do SQL Server, utilize uma das seguintes estratégias de Olá:</span><span class="sxs-lookup"><span data-stu-id="7217e-155">If you must have a SQL login, use one of hello following strategies:</span></span>

  - <span data-ttu-id="7217e-156">Criar uma conta SQL com um nome exclusivo que tenha **sysadmin** associação.</span><span class="sxs-lookup"><span data-stu-id="7217e-156">Create a SQL account with a unique name that has **sysadmin** membership.</span></span> <span data-ttu-id="7217e-157">Para fazer isto no portal de Olá Ativando **autenticação SQL** durante o aprovisionamento.</span><span class="sxs-lookup"><span data-stu-id="7217e-157">You can do this from hello portal by enabling **SQL Authentication** during provisioning.</span></span>

    > [!TIP] 
    > <span data-ttu-id="7217e-158">Se não ativar a autenticação de SQL durante o aprovisionamento, tem de alterar manualmente o modo de autenticação de Olá demasiado**do SQL Server e o modo de autenticação do Windows**.</span><span class="sxs-lookup"><span data-stu-id="7217e-158">If you do not enable SQL Authentication during provisioning, you must manually change hello authentication mode too**SQL Server and Windows Authentication Mode**.</span></span> <span data-ttu-id="7217e-159">Para obter mais informações, consulte [Alterar modo de autenticação de servidor](https://docs.microsoft.com/sql/database-engine/configure-windows/change-server-authentication-mode).</span><span class="sxs-lookup"><span data-stu-id="7217e-159">For more information, see [Change Server Authentication Mode](https://docs.microsoft.com/sql/database-engine/configure-windows/change-server-authentication-mode).</span></span>

  - <span data-ttu-id="7217e-160">Se tiver de utilizar Olá **SA** início de sessão, ativar início de sessão de Olá após o aprovisionamento e atribuir uma nova palavra-passe segura.</span><span class="sxs-lookup"><span data-stu-id="7217e-160">If you must use hello **SA** login, enable hello login after provisioning and assign a new strong password.</span></span>

## <a name="follow-on-premises-best-practices"></a><span data-ttu-id="7217e-161">Siga as melhores práticas de no local</span><span class="sxs-lookup"><span data-stu-id="7217e-161">Follow on-premises best practices</span></span>

<span data-ttu-id="7217e-162">Além disso toohello práticas descritas neste tópico, recomendamos que analise e se implementar práticas de segurança Olá tradicional no local onde for aplicável.</span><span class="sxs-lookup"><span data-stu-id="7217e-162">In addition toohello practices described in this topic, we recommend that you review and implement hello traditional on-premises security practices where applicable.</span></span> <span data-ttu-id="7217e-163">Para obter mais informações, consulte [considerações de segurança para uma instalação do SQL Server](https://docs.microsoft.com/sql/sql-server/install/security-considerations-for-a-sql-server-installation)</span><span class="sxs-lookup"><span data-stu-id="7217e-163">For more information, see [Security Considerations for a SQL Server Installation](https://docs.microsoft.com/sql/sql-server/install/security-considerations-for-a-sql-server-installation)</span></span>

## <a name="next-steps"></a><span data-ttu-id="7217e-164">Passos Seguintes</span><span class="sxs-lookup"><span data-stu-id="7217e-164">Next Steps</span></span>

<span data-ttu-id="7217e-165">Se também estiver interessado em melhores práticas em torno de desempenho, consulte o artigo [práticas recomendadas do SQL Server em Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="7217e-165">If you are also interested in best practices around performance, see [Performance Best Practices for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span></span>

<span data-ttu-id="7217e-166">Para outros tópicos relacionados com toorunning do SQL Server em VMs do Azure, consulte [SQL Server em Virtual Machines do Azure descrição-geral](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7217e-166">For other topics related toorunning SQL Server in Azure VMs, see [SQL Server on Azure Virtual Machines overview](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

