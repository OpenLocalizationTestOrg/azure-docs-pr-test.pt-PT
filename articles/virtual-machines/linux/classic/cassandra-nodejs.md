---
title: aaaRun Cassandra com Linux no Azure | Microsoft Docs
description: "Como toorun um Cassandra cluster no Linux em máquinas virtuais do Azure a partir de uma aplicação Node.js"
services: virtual-machines-linux
documentationcenter: nodejs
author: tomarcher
manager: routlaw
editor: 
tags: azure-service-management
ms.assetid: 30de1f29-e97d-492f-ae34-41ec83488de0
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: tarcher
ms.openlocfilehash: 381ca301bbe88d3740cf182f9c44fada5b9ba7cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="running-cassandra-with-linux-on-azure-and-accessing-it-from-nodejs"></a><span data-ttu-id="e59c8-103">Executar o Cassandra com o Linux no Azure e Aceder a partir de Node.js</span><span class="sxs-lookup"><span data-stu-id="e59c8-103">Running Cassandra with Linux on Azure and Accessing it from Node.js</span></span>
> [!IMPORTANT] 
> <span data-ttu-id="e59c8-104">O Azure tem dois modelos de implementação diferentes para criar e trabalhar com recursos: [Resource Manager e clássico](../../../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="e59c8-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="e59c8-105">Este artigo abrange utilizando o modelo de implementação clássica Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-105">This article covers using hello Classic deployment model.</span></span> <span data-ttu-id="e59c8-106">A Microsoft recomenda que as implementações mais novas utilizem o modelo de Gestor de recursos de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-106">Microsoft recommends that most new deployments use hello Resource Manager model.</span></span> <span data-ttu-id="e59c8-107">Ver modelos do Resource Manager para [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) e [Spark cluster e Cassandra em CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span><span class="sxs-lookup"><span data-stu-id="e59c8-107">See Resource Manager templates for [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) and [Spark cluster and Cassandra on CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span></span>

## <a name="overview"></a><span data-ttu-id="e59c8-108">Descrição geral</span><span class="sxs-lookup"><span data-stu-id="e59c8-108">Overview</span></span>
<span data-ttu-id="e59c8-109">Microsoft Azure é uma plataforma de nuvem aberto que executa ambos os Microsoft como bem como software não Microsoft que inclui os sistemas operativos, servidores de aplicações, mensagens middleware, bem como bases de dados NoSQL e SQL de ambos os modelos de comerciais e abrir a origem.</span><span class="sxs-lookup"><span data-stu-id="e59c8-109">Microsoft Azure is an open cloud platform that runs both Microsoft as well as non-Microsoft software which  includes operating systems, application servers, messaging middleware as well as SQL and NoSQL databases from both commercial and open source models.</span></span> <span data-ttu-id="e59c8-110">Criação de resilientes serviços em nuvens públicas, incluindo o Azure requer um planeamento cuidadoso e arquitetura deliberate para ambos os servidores de aplicações como camadas de armazenamento bem.</span><span class="sxs-lookup"><span data-stu-id="e59c8-110">Building resilient services on public clouds including Azure requires careful planning and deliberate architecture for both applications servers as well storage layers.</span></span> <span data-ttu-id="e59c8-111">Arquitetura de armazenamento distribuído do Cassandra naturalmente ajuda na criação de sistemas elevados tolerante a falhas de cluster de falhas.</span><span class="sxs-lookup"><span data-stu-id="e59c8-111">Cassandra’s distributed storage architecture naturally helps in building highly available systems that are fault tolerant for cluster failures.</span></span> <span data-ttu-id="e59c8-112">Cassandra é uma base de dados NoSQL mantido pelo Apache Software Foundation a cassandra.apache.org; escala da nuvem Cassandra é escrito em Java e, por conseguinte, é executado no Windows, bem como em Linux plataformas.</span><span class="sxs-lookup"><span data-stu-id="e59c8-112">Cassandra is a cloud scale NoSQL database maintained by Apache Software Foundation at cassandra.apache.org; Cassandra is written in Java and hence runs on both on Windows as well as Linux platforms.</span></span>

<span data-ttu-id="e59c8-113">Este artigo aborda Olá é tooshow Cassandra implementação Ubuntu como um cluster único e vários dados center tirar partido das máquinas virtuais do Microsoft Azure e redes virtuais.</span><span class="sxs-lookup"><span data-stu-id="e59c8-113">hello focus of this article is tooshow Cassandra deployment on Ubuntu as a single and multi-data center cluster leveraging Microsoft Azure Virtual Machines and Virtual Networks.</span></span> <span data-ttu-id="e59c8-114">Olá implementação de cluster para cargas de trabalho de produção otimizada está fora do âmbito deste artigo porque requer configuração do nó de disco multi, design de topologia do anel adequado e os dados de modelação toosupport Olá necessário replicação, consistência dos dados, débito e requisitos de elevada disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e59c8-114">hello cluster deployment for production optimized workloads is out of scope of this article as it requires multi-disk node configuration, appropriate ring topology design and data modeling toosupport hello needed replication, data consistency, throughput and high availability requirements.</span></span>

<span data-ttu-id="e59c8-115">Este guia de artigo tooshow uma abordagem fundamental que esteja envolvido na criação Olá Cassandra cluster em comparação com Docker, Chef ou Puppet, que pode efetuar Olá muito mais fácil de implementação da infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="e59c8-115">This article takes a fundamental approach tooshow what is involved in building hello Cassandra cluster compared Docker, Chef or Puppet which can make hello infrastructure deployment a lot easier.</span></span>  

## <a name="hello-deployment-models"></a><span data-ttu-id="e59c8-116">Olá modelos de implementação</span><span class="sxs-lookup"><span data-stu-id="e59c8-116">hello Deployment Models</span></span>
<span data-ttu-id="e59c8-117">Funcionamento em rede do Microsoft Azure permite a implementação Olá dos clusters privadas isolados, acesso Olá que pode ser segurança de rede detalhada bem tooattain restrito.</span><span class="sxs-lookup"><span data-stu-id="e59c8-117">Microsoft Azure networking allows hello deployment of isolated private clusters, hello access of which can be restricted tooattain fine grained network security.</span></span>  <span data-ttu-id="e59c8-118">Uma vez que este artigo sobre implementação de Cassandra Olá um nível de fundamentais a mostrar, incidirá não no nível de consistência Olá e conceção do armazenamento ideal de Olá de débito.</span><span class="sxs-lookup"><span data-stu-id="e59c8-118">Since this article is about showing hello Cassandra deployment at a fundamental level, we will not focus on hello consistency level and hello optimal storage design for throughput.</span></span> <span data-ttu-id="e59c8-119">Eis Olá lista dos requisitos de rede para o nosso hipotético cluster:</span><span class="sxs-lookup"><span data-stu-id="e59c8-119">Here is hello list of networking requirements for our hypothetical cluster:</span></span>

* <span data-ttu-id="e59c8-120">Sistemas externos que não é possível aceder Cassandra base de dados da dentro ou fora do Azure</span><span class="sxs-lookup"><span data-stu-id="e59c8-120">External systems can’t access Cassandra database from within or outside Azure</span></span>
* <span data-ttu-id="e59c8-121">Cluster de Cassandra tem toobe atrás de um balanceador de carga para tráfego de thrift</span><span class="sxs-lookup"><span data-stu-id="e59c8-121">Cassandra cluster has toobe behind a load balancer for thrift traffic</span></span>
* <span data-ttu-id="e59c8-122">Implementar Cassandra nós em dois grupos em cada centro de dados para um disponibilidade do cluster avançada</span><span class="sxs-lookup"><span data-stu-id="e59c8-122">Deploy Cassandra nodes in two groups in each data center for an enhanced cluster availability</span></span>
* <span data-ttu-id="e59c8-123">Bloquear cluster Olá, por isso, que só o farm de servidores de aplicação possui base de dados do access toohello diretamente</span><span class="sxs-lookup"><span data-stu-id="e59c8-123">Lock down hello cluster so that only application server farm has access toohello database directly</span></span>
* <span data-ttu-id="e59c8-124">Não existem públicas pontos finais de rede diferente de SSH</span><span class="sxs-lookup"><span data-stu-id="e59c8-124">No public networking endpoints other than SSH</span></span>
* <span data-ttu-id="e59c8-125">Cada nó de Cassandra tem um endereço IP interno fixo</span><span class="sxs-lookup"><span data-stu-id="e59c8-125">Each Cassandra node needs a fixed internal IP address</span></span>

<span data-ttu-id="e59c8-126">Cassandra pode ser implementado tooa única região do Azure ou regiões toomultiple com base na carga de trabalho Olá natureza Olá distribuído.</span><span class="sxs-lookup"><span data-stu-id="e59c8-126">Cassandra can be deployed tooa single Azure region or toomultiple regions based on hello distributed nature of hello workload.</span></span> <span data-ttu-id="e59c8-127">Modelo de implementação de multirregião pode ser aproveitadas tooserve os utilizadores finais próximo tooa específico geografia através de Olá mesma infraestrutura de Cassandra.</span><span class="sxs-lookup"><span data-stu-id="e59c8-127">Multi-region deployment model can be leveraged tooserve end users closer tooa particular geography through hello same Cassandra infrastructure.</span></span> <span data-ttu-id="e59c8-128">Resolvida replicação do nó incorporada do Cassandra de sincronização de Olá do mestre multi escreve provenientes de múltiplos centros de dados e apresenta uma vista de Olá dados tooapplications consistente.</span><span class="sxs-lookup"><span data-stu-id="e59c8-128">Cassandra’s built-in node replication takes care of hello synchronization of multi-master writes originating from multiple data centers and presents a consistent view of hello data tooapplications.</span></span> <span data-ttu-id="e59c8-129">Também pode ajudar a implementação de multirregião mitigação de riscos Olá de falhas no serviço Azure Olá mais ampla.</span><span class="sxs-lookup"><span data-stu-id="e59c8-129">Multi-region deployment can also help with hello risk mitigation of hello broader Azure service outages.</span></span> <span data-ttu-id="e59c8-130">Topologia de replicação e consistência ajustáveis do Cassandra irão ajudar a satisfazer as necessidades de RPO diversificadas das aplicações.</span><span class="sxs-lookup"><span data-stu-id="e59c8-130">Cassandra’s tunable consistency and replication topology will help in meeting diverse RPO needs of applications.</span></span>

### <a name="single-region-deployment"></a><span data-ttu-id="e59c8-131">Implementação única região</span><span class="sxs-lookup"><span data-stu-id="e59c8-131">Single Region Deployment</span></span>
<span data-ttu-id="e59c8-132">Iremos irá começar com uma implementação única região e recolher Olá learnings na criação de um modelo de multirregião.</span><span class="sxs-lookup"><span data-stu-id="e59c8-132">We will start with a single region deployment and harvest hello learnings in creating a multi-region model.</span></span> <span data-ttu-id="e59c8-133">Redes virtuais do Azure será utilizado toocreate isolada sub-redes, para que possam ser satisfeitos requisitos de segurança de rede de Olá mencionados acima.</span><span class="sxs-lookup"><span data-stu-id="e59c8-133">Azure virtual networking will be used toocreate isolated subnets so that hello network security requirements mentioned above can be met.</span></span>  <span data-ttu-id="e59c8-134">processo de Olá descrito na criação de implementação de única região Olá utiliza Ubuntu 14.04 LTS e Cassandra 2.08; No entanto, o processo de Olá pode facilmente ser adotado toohello outros variantes do Linux.</span><span class="sxs-lookup"><span data-stu-id="e59c8-134">hello process described in creating hello single region deployment uses Ubuntu 14.04 LTS and Cassandra 2.08; however, hello process can easily be adopted toohello other Linux variants.</span></span> <span data-ttu-id="e59c8-135">Olá seguem-se algumas das características de systemic Olá da implementação do Olá única região.</span><span class="sxs-lookup"><span data-stu-id="e59c8-135">hello following are some of hello systemic characteristics of hello single region deployment.</span></span>  

<span data-ttu-id="e59c8-136">**Elevada disponibilidade:** Olá nós Cassandra mostrados na Olá figura 1 são implementadas conjuntos de disponibilidade de tootwo para que nós de Olá são distribuídas entre vários domínios de falhas de elevada disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e59c8-136">**High Availability:** hello Cassandra nodes shown in hello Figure 1 are deployed tootwo availability sets so that hello nodes are spread between multiple fault domains for high availability.</span></span> <span data-ttu-id="e59c8-137">VMs anotadas com cada conjunto de disponibilidade está mapeada too2 domínios de falhas.</span><span class="sxs-lookup"><span data-stu-id="e59c8-137">VMs annotated with each availability set is mapped too2 fault domains.</span></span>  <span data-ttu-id="e59c8-138">Microsoft Azure utiliza Olá conceito de toomanage de domínio de falha não planeada do tempo (por exemplo, falhas de hardware ou software) ao conceito de Olá de domínio de atualização (por exemplo, o convidado ou anfitrião SO aplicação de patches/atualizações, as atualizações de aplicações) é utilizado para gerir agendada tempo.</span><span class="sxs-lookup"><span data-stu-id="e59c8-138">Microsoft Azure uses hello concept of fault domain toomanage unplanned down time (e.g. hardware or software failures) while hello concept of upgrade domain (e.g. host or guest OS patching/upgrades, application upgrades) is used for managing scheduled down time.</span></span> <span data-ttu-id="e59c8-139">Consulte [recuperação após desastre e elevada disponibilidade para aplicações do Azure](http://msdn.microsoft.com/library/dn251004.aspx) para a função de Olá de domínios de falhas e a atualização na attaining elevada disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e59c8-139">Please see [Disaster Recovery and High Availability for Azure Applications](http://msdn.microsoft.com/library/dn251004.aspx) for hello role of fault and upgrade domains in attaining high availability.</span></span>

![Implementação única região](./media/cassandra-nodejs/cassandra-linux1.png)

<span data-ttu-id="e59c8-141">Figura 1: Implementação de única região</span><span class="sxs-lookup"><span data-stu-id="e59c8-141">Figure 1: Single region deployment</span></span>

<span data-ttu-id="e59c8-142">Tenha em atenção que no momento desta redação da Olá, Azure não permite o mapeamento de explícita Olá de um grupo de domínio de falhas específicas do VMs tooa; Por conseguinte, mesmo com o modelo de implementação de Olá mostrado na figura 1, é estatisticamente provável que todas as máquinas de virtuais Olá podem ser mapeadas tootwo domínios de falhas em vez de quatro.</span><span class="sxs-lookup"><span data-stu-id="e59c8-142">Note that at hello time of this writing, Azure doesn’t allow hello explicit mapping of a group of VMs tooa specific fault domain; consequently, even with hello deployment model shown in Figure 1, it is statistically probable that all hello virtual machines may be mapped tootwo fault domains instead of four.</span></span>

<span data-ttu-id="e59c8-143">**Tráfego de Thrift de balanceamento de carga:** bibliotecas de cliente de Thrift no interior do servidor de web de Olá ligam toohello cluster através de um balanceador de carga interno.</span><span class="sxs-lookup"><span data-stu-id="e59c8-143">**Load Balancing Thrift Traffic:** Thrift client libraries inside hello web server connect toohello cluster through an internal load balancer.</span></span> <span data-ttu-id="e59c8-144">Isto requer que o processo de Olá de adicionar a sub-rede de Olá carga interno balanceador toohello "dados" (consulte a figura 1) no contexto de Olá do cluster de Cassandra Olá de alojamento do serviço de nuvem Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-144">This requires hello process of adding hello internal load balancer toohello “data” subnet (refer Figure 1) in hello context of hello cloud service hosting hello Cassandra cluster.</span></span> <span data-ttu-id="e59c8-145">Assim que o Balanceador de carga interno Olá estiver definida, a cada nó requer toobe de ponto final com balanceamento de carga de Olá adicionada com anotações Olá de um conjunto com balanceamento de carga anteriormente com o nome do Balanceador de carga definido.</span><span class="sxs-lookup"><span data-stu-id="e59c8-145">Once hello internal load balancer is defined, each node requires hello load balanced endpoint toobe added with hello annotations of a load balanced set with previously defined load balancer name.</span></span> <span data-ttu-id="e59c8-146">Consulte [Azure interno balanceamento de carga ](../../../load-balancer/load-balancer-internal-overview.md)para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="e59c8-146">See [Azure Internal Load Balancing ](../../../load-balancer/load-balancer-internal-overview.md)for more details.</span></span>

<span data-ttu-id="e59c8-147">**Cluster Seeds:** é importante tooselect Olá maioria de nós de elevada disponibilidade para seeds como Olá novos nós irão comunicar com o seed nós toodiscover Olá topologia cluster Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-147">**Cluster Seeds:** It is important tooselect hello most highly available nodes for seeds as hello new nodes will communicate with seed nodes toodiscover hello topology of hello cluster.</span></span> <span data-ttu-id="e59c8-148">Um nó de cada conjunto de disponibilidade está designado como o seed nós tooavoid único ponto da falha.</span><span class="sxs-lookup"><span data-stu-id="e59c8-148">One node from each availability set is designated as seed nodes tooavoid single point of failure.</span></span>

<span data-ttu-id="e59c8-149">**Fator de replicação e o nível de consistência:** compilação na elevada disponibilidade e dados durabilidade do Cassandra é caracterizada por Olá fator de replicação (RF - número de cópias de cada linha armazenadas num cluster de Olá) e o nível de consistência (número de réplicas toobe leitura/escrita antes de o devolver Olá resultado toohello do chamador).</span><span class="sxs-lookup"><span data-stu-id="e59c8-149">**Replication Factor and Consistency Level:** Cassandra’s build-in high-availability and data durability is characterized by hello Replication Factor (RF - number of copies of each row stored on hello cluster) and Consistency Level (number of replicas toobe read/written before returning hello result toohello caller).</span></span> <span data-ttu-id="e59c8-150">Fator de replicação é especificada durante a Olá criação KEYSPACE (semelhante tooa base de dados relacional), enquanto que o nível de consistência Olá é especificado ao emitir consultas CRUD Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-150">Replication factor is specified during hello KEYSPACE (similar tooa relational database) creation whereas hello consistency level is specified while issuing hello CRUD query.</span></span> <span data-ttu-id="e59c8-151">Consulte a documentação de Cassandra em [configurar para consistência](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) para detalhes de consistência e fórmula Olá para o cálculo de quórum.</span><span class="sxs-lookup"><span data-stu-id="e59c8-151">See Cassandra documentation at [Configuring for Consistency](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) for consistency details and hello formula for quorum computation.</span></span>

<span data-ttu-id="e59c8-152">Cassandra suporta dois tipos de modelos de integridade de dados – consistência e a consistência Eventual; Olá fator de replicação e nível de consistência serão em conjunto determinam se os dados de Olá serão consistentes, assim que uma operação de escrita foi concluída ou que será eventualmente consistente.</span><span class="sxs-lookup"><span data-stu-id="e59c8-152">Cassandra supports two types of data integrity models – Consistency and Eventual Consistency; hello Replication Factor and Consistency Level will together determine if hello data will be consistent as soon as a write operation is complete or it will be eventually consistent.</span></span> <span data-ttu-id="e59c8-153">Por exemplo, o QUÓRUM (por exemplo, um) especificar QUÓRUM como Olá que nível de consistência será sempre garante a consistência de dados ao qualquer nível de consistência, abaixo o número de Olá de toobe réplicas escrito como tooattain necessário resulta em dados que está a ser eventualmente consistente.</span><span class="sxs-lookup"><span data-stu-id="e59c8-153">For example, specifying QUORUM as hello Consistency Level will always ensures data Consistency while any consistency level, below hello number of replicas toobe written as needed tooattain QUORUM (e.g. ONE) results in data being eventually consistent.</span></span>

<span data-ttu-id="e59c8-154">cluster de nó de 8 Olá mostrado acima, com um fator de replicação de 3 e QUÓRUM (2 nós são lidas ou escritas para consistência) ao nível de consistência de leitura/escrita, pode sobreviver perda teórico Olá de em Olá a maioria das 1 nó por replicação grupo antes do início da aplicação de Olá Falha de Olá dar por isso.</span><span class="sxs-lookup"><span data-stu-id="e59c8-154">hello 8-node cluster shown above, with a replication factor of 3 and QUORUM (2 nodes are read or written for consistency) read/write consistency level, can survive hello theoretical loss of at hello most 1 node per replication group before hello application start noticing hello failure.</span></span> <span data-ttu-id="e59c8-155">Esta parte do princípio de que todos os espaços de chave de Olá tem bem com balanceamento de pedidos de leitura/escrita.</span><span class="sxs-lookup"><span data-stu-id="e59c8-155">This assumes that all hello key spaces have well balanced read/write requests.</span></span>  <span data-ttu-id="e59c8-156">Olá, são parâmetros Olá, que iremos utilizar para o cluster de Olá implementado:</span><span class="sxs-lookup"><span data-stu-id="e59c8-156">hello following are hello parameters we will use for hello deployed cluster:</span></span>

<span data-ttu-id="e59c8-157">Configuração de cluster de Cassandra única região:</span><span class="sxs-lookup"><span data-stu-id="e59c8-157">Single region Cassandra cluster configuration:</span></span>

| <span data-ttu-id="e59c8-158">Parâmetro de cluster</span><span class="sxs-lookup"><span data-stu-id="e59c8-158">Cluster Parameter</span></span> | <span data-ttu-id="e59c8-159">Valor</span><span class="sxs-lookup"><span data-stu-id="e59c8-159">Value</span></span> | <span data-ttu-id="e59c8-160">Observações</span><span class="sxs-lookup"><span data-stu-id="e59c8-160">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e59c8-161">Número de nós (N)</span><span class="sxs-lookup"><span data-stu-id="e59c8-161">Number of Nodes (N)</span></span> |<span data-ttu-id="e59c8-162">8</span><span class="sxs-lookup"><span data-stu-id="e59c8-162">8</span></span> |<span data-ttu-id="e59c8-163">Número total de nós no cluster de Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-163">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="e59c8-164">Fator de replicação (RF)</span><span class="sxs-lookup"><span data-stu-id="e59c8-164">Replication Factor (RF)</span></span> |<span data-ttu-id="e59c8-165">3</span><span class="sxs-lookup"><span data-stu-id="e59c8-165">3</span></span> |<span data-ttu-id="e59c8-166">Número de réplicas de uma linha especificada</span><span class="sxs-lookup"><span data-stu-id="e59c8-166">Number of replicas of a given row</span></span> |
| <span data-ttu-id="e59c8-167">Nível de consistência (escrita)</span><span class="sxs-lookup"><span data-stu-id="e59c8-167">Consistency Level (Write)</span></span> |<span data-ttu-id="e59c8-168">QUORUM[(RF/2) +1) = resultado 2] Olá de Olá fórmula é arredondada para baixo</span><span class="sxs-lookup"><span data-stu-id="e59c8-168">QUORUM[(RF/2) +1) = 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="e59c8-169">Escreve no Olá a maioria das 2 réplicas antes do envio do chamador toohello resposta Olá réplica 3rd é escrita de forma eventualmente consistente.</span><span class="sxs-lookup"><span data-stu-id="e59c8-169">Writes at hello most 2 replicas before hello response is sent toohello caller; 3rd replica is written in an eventually consistent manner.</span></span> |
| <span data-ttu-id="e59c8-170">Nível de consistência (leitura)</span><span class="sxs-lookup"><span data-stu-id="e59c8-170">Consistency Level (Read)</span></span> |<span data-ttu-id="e59c8-171">QUÓRUM [(RF/2) + 1 = 2] resultado Olá de fórmula Olá é arredondado para baixo</span><span class="sxs-lookup"><span data-stu-id="e59c8-171">QUORUM [(RF/2) +1= 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="e59c8-172">Lê 2 réplicas antes de enviar o chamador de toohello de resposta.</span><span class="sxs-lookup"><span data-stu-id="e59c8-172">Reads 2 replicas before sending response toohello caller.</span></span> |
| <span data-ttu-id="e59c8-173">Estratégia de replicação</span><span class="sxs-lookup"><span data-stu-id="e59c8-173">Replication Strategy</span></span> |<span data-ttu-id="e59c8-174">Consulte NetworkTopologyStrategy [replicação de dados](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) na documentação de Cassandra para obter mais informações</span><span class="sxs-lookup"><span data-stu-id="e59c8-174">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="e59c8-175">Compreende a topologia de implementação de Olá e coloca réplicas em nós, para que todas as réplicas de Olá não acabar em Olá mesmo bastidor</span><span class="sxs-lookup"><span data-stu-id="e59c8-175">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="e59c8-176">Snitch</span><span class="sxs-lookup"><span data-stu-id="e59c8-176">Snitch</span></span> |<span data-ttu-id="e59c8-177">Consulte GossipingPropertyFileSnitch [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) na documentação de Cassandra para obter mais informações</span><span class="sxs-lookup"><span data-stu-id="e59c8-177">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="e59c8-178">NetworkTopologyStrategy utiliza um conceito de topologia do snitch toounderstand Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-178">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="e59c8-179">GossipingPropertyFileSnitch proporciona um melhor controlo em cada nó toodata Centro e em Bastidor de mapeamento.</span><span class="sxs-lookup"><span data-stu-id="e59c8-179">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="e59c8-180">Olá cluster utiliza, em seguida, gossip toopropagate, estas informações.</span><span class="sxs-lookup"><span data-stu-id="e59c8-180">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="e59c8-181">Isto é muito mais simples no dinâmica tooPropertyFileSnitch relativo para o IP definição</span><span class="sxs-lookup"><span data-stu-id="e59c8-181">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

<span data-ttu-id="e59c8-182">**Considerações do Azure para o Cassandra Cluster:** capacidade de máquinas virtuais do Microsoft Azure utiliza o Blob storage do Azure para a persistência de disco; Armazenamento do Azure guarda 3 réplicas de cada disco para uma durabilidade elevada.</span><span class="sxs-lookup"><span data-stu-id="e59c8-182">**Azure Considerations for Cassandra Cluster:** Microsoft Azure Virtual Machines capability uses Azure Blob storage for disk persistence; Azure Storage saves 3 replicas of each disk for high durability.</span></span> <span data-ttu-id="e59c8-183">Isto significa que cada linha da dados inseridos na tabela Cassandra já está armazenada na 3 réplicas e, por conseguinte, consistência de dados está já tratada, mesmo que esteja Olá fator de replicação (RF) 1.</span><span class="sxs-lookup"><span data-stu-id="e59c8-183">That means each row of data inserted into a Cassandra table is already stored in 3 replicas and hence data consistency is already taken care of even if hello Replication Factor (RF) is 1.</span></span> <span data-ttu-id="e59c8-184">problema de principal de Olá com fator de replicação que está a ser 1 é que aplicação Olá será tempo de inatividade, mesmo se a um único nó Cassandra falha.</span><span class="sxs-lookup"><span data-stu-id="e59c8-184">hello main problem with Replication Factor being 1 is that hello application will experience downtime even if a single Cassandra node fails.</span></span> <span data-ttu-id="e59c8-185">No entanto, se um nó para baixo para problemas de Olá (por exemplo, hardware, falhas de software do sistema) reconhecidos pelo controlador de recursos do Azure, irá aprovisionar um novo nó no seu lugar utilizando Olá mesmo unidades de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="e59c8-185">However, if a node is down for hello problems (e.g. hardware, system software failures) recognized by Azure Fabric Controller, it will provision a new node in its place using hello same storage drives.</span></span> <span data-ttu-id="e59c8-186">Aprovisionamento de um novo nó tooreplace Olá antigo um processo poderá demorar alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="e59c8-186">Provisioning a new node tooreplace hello old one may take a few minutes.</span></span>  <span data-ttu-id="e59c8-187">Da mesma forma para atividades de manutenção planeada, como as alterações de SO convidado, Cassandra atualiza e as alterações de aplicação o controlador de recursos do Azure efetua a implementar atualizações de nós de Olá num cluster de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-187">Similarly for planned maintenance activities like guest OS changes, Cassandra upgrades and application changes Azure Fabric Controller performs rolling upgrades of hello nodes in hello cluster.</span></span>  <span data-ttu-id="e59c8-188">Implementar atualizações também poderá demorar baixo alguns nós numa altura e, por conseguinte, o cluster Olá pode ter breve tempo de inatividade para partições alguns.</span><span class="sxs-lookup"><span data-stu-id="e59c8-188">Rolling upgrades also may take down a few nodes at a time and hence hello cluster may experience brief downtime for a few partitions.</span></span> <span data-ttu-id="e59c8-189">No entanto, não poderá ser perdidos devido a redundância de armazenamento do Azure incorporada toohello dados Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-189">However, hello data will not be lost due toohello built-in Azure Storage redundancy.</span></span>  

<span data-ttu-id="e59c8-190">Para sistemas implementado tooAzure não necessita de elevada disponibilidade (por exemplo, cerca de 99,9 que é equivalente too8.76 hrs/ano; consulte [elevada disponibilidade](http://en.wikipedia.org/wiki/High_availability) para obter detalhes) poderá ser capaz de toorun com RF = 1 e o nível de consistência = ONE.</span><span class="sxs-lookup"><span data-stu-id="e59c8-190">For systems deployed tooAzure that doesn’t require high availability (e.g. around 99.9 which is equivalent too8.76 hrs/year; see [High Availability](http://en.wikipedia.org/wiki/High_availability) for details) you may be able toorun with RF=1 and Consistency Level=ONE.</span></span>  <span data-ttu-id="e59c8-191">Para aplicações com requisitos de elevada disponibilidade, RF = 3 e o nível de consistência = QUÓRUM serão tolerar Olá tempo de um de nós de Olá uma das réplicas Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-191">For applications with high availability requirements, RF=3 and Consistency Level=QUORUM will tolerate hello down time of one of hello nodes one of hello replicas.</span></span> <span data-ttu-id="e59c8-192">RF = 1 em implementações tradicionais (por exemplo, no local) não pode ser utilizado devido toohello possíveis perdas de dados resultantes de problemas como falhas de disco.</span><span class="sxs-lookup"><span data-stu-id="e59c8-192">RF=1 in traditional deployments (e.g. on-premises) can’t be used due toohello possible data loss resulting from problems like disk failures.</span></span>   

## <a name="multi-region-deployment"></a><span data-ttu-id="e59c8-193">Implementação de multirregião</span><span class="sxs-lookup"><span data-stu-id="e59c8-193">Multi-region Deployment</span></span>
<span data-ttu-id="e59c8-194">Data center-com suporte para replicação e o modelo de consistência descrito acima ajuda-o com a implementação de multirregião Olá Box Olá sem Olá da Cassandra necessidade de quaisquer ferramentas externas.</span><span class="sxs-lookup"><span data-stu-id="e59c8-194">Cassandra’s data-center-aware replication and consistency model described above helps with hello multi-region deployment out of hello box without hello need for any external tooling.</span></span> <span data-ttu-id="e59c8-195">Isto é bastante diferente do Olá tradicionais bases de dados relacionais em que o programa de configuração de Olá para espelhamento da base de dados para escritas multi-mestre pode ser bastante complexo.</span><span class="sxs-lookup"><span data-stu-id="e59c8-195">This is quite different from hello traditional relational databases where hello setup for database mirroring for multi-master writes can be quite complex.</span></span> <span data-ttu-id="e59c8-196">Cenários de utilização de Olá incluindo Olá seguinte pode ajudar a Cassandra numa região multi configurar:</span><span class="sxs-lookup"><span data-stu-id="e59c8-196">Cassandra in a multi-region set up can help with hello usage scenarios including hello following:</span></span>

<span data-ttu-id="e59c8-197">**Implementação baseada em proximidade:** aplicações multi-inquilino, com Limpar mapeamento de utilizadores de inquilino-para-região, pode ser benefited por baixas latências do cluster de multirregião Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-197">**Proximity based deployment:** Multi-tenant applications, with clear mapping of tenant users -to-region, can be benefited by hello multi-region cluster’s low latencies.</span></span> <span data-ttu-id="e59c8-198">Por exemplo, um gestão de aprendizagem sistemas operativos instituições educational podem implementar um cluster distribuído nos EUA leste e EUA oeste regiões tooserve Olá respetivos campuses para transacional, bem como a análise.</span><span class="sxs-lookup"><span data-stu-id="e59c8-198">For example a learning management systems for educational institutions can deploy a distributed cluster in East US and West US regions tooserve hello respective campuses for transactional as well as analytics.</span></span> <span data-ttu-id="e59c8-199">dados de Olá podem ser localmente consistentes em Olá tempo leituras e escritas e podem ser eventualmente consistentes em ambas as regiões de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-199">hello data can be locally consistent at hello time reads and writes and can be eventually consistent across both hello regions.</span></span> <span data-ttu-id="e59c8-200">Existem outros exemplos de como a distribuição de suporte de dados, comércio e nada e tudo o que funciona georreplicação concentrated utilizador base é um caso de utilização boa para este modelo de implementação.</span><span class="sxs-lookup"><span data-stu-id="e59c8-200">There are other examples like media distribution, e-commerce and anything and everything that serves geo concentrated user base is a good use case for this deployment model.</span></span>

<span data-ttu-id="e59c8-201">**Elevada disponibilidade:** redundância é um fator chave attaining elevada disponibilidade de hardware e software; Consulte edifício fiável sistemas de nuvem no Microsoft Azure para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="e59c8-201">**High Availability:** Redundancy is a key factor in attaining high availability of software and hardware; see Building Reliable Cloud Systems on Microsoft Azure for details.</span></span> <span data-ttu-id="e59c8-202">No Microsoft Azure, Olá forma fiável apenas de atingirem a total redundância verdadeira é implementar um cluster de multirregião.</span><span class="sxs-lookup"><span data-stu-id="e59c8-202">On Microsoft Azure, hello only reliable way of achieving true redundancy is by deploying a multi-region cluster.</span></span> <span data-ttu-id="e59c8-203">É possível implementar aplicações num modo ativo-ativo ou ativo-passivo e se uma das regiões Olá estiver desativado, o Gestor de tráfego do Azure pode redirecionar região ativa do tráfego toohello.</span><span class="sxs-lookup"><span data-stu-id="e59c8-203">Applications can be deployed in an active-active or active-passive mode and if one of hello regions is down, Azure Traffic Manager can redirect traffic toohello active region.</span></span>  <span data-ttu-id="e59c8-204">Com a implementação de única região Olá, se for de disponibilidade de Olá 99,9, uma implementação de dois região pode obter um disponibilidade dos 99.9999 calculado pela fórmula Olá: (1-(1-0.999) * (1-0.999)) * 100); Consulte Olá acima documento para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="e59c8-204">With hello single region deployment, if hello availability is 99.9, a two-region deployment can attain an availability of 99.9999 computed by hello formula: (1-(1-0.999) * (1-0.999))*100); see hello above paper for details.</span></span>

<span data-ttu-id="e59c8-205">**Recuperação após desastre:** cluster multirregião Cassandra, se concebido corretamente, pode conseguir falhas de center catastrófica de dados.</span><span class="sxs-lookup"><span data-stu-id="e59c8-205">**Disaster Recovery:** Multi-region Cassandra cluster, if properly designed, can withstand catastrophic data center outages.</span></span> <span data-ttu-id="e59c8-206">Se uma região estiver em baixo, Olá aplicação implementada tooother regiões podem começar a servir os utilizadores finais de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-206">If one region is down, hello application deployed tooother regions can start serving hello end users.</span></span> <span data-ttu-id="e59c8-207">Como quaisquer outras empresas continuidade implementações, a aplicação de Olá tem tolerância a falhas para algumas perda de dados resultantes de dados de Olá no pipeline assíncrona Olá toobe.</span><span class="sxs-lookup"><span data-stu-id="e59c8-207">Like any other business continuity implementations, hello application has toobe tolerant for some data loss resulting from hello data in hello asynchronous pipeline.</span></span> <span data-ttu-id="e59c8-208">No entanto, Cassandra torna recuperação Olá muito swifter à hora de Olá executada por processos de recuperação de bases de dados tradicionais.</span><span class="sxs-lookup"><span data-stu-id="e59c8-208">However, Cassandra makes hello recovery much swifter than hello time taken by traditional database recovery processes.</span></span> <span data-ttu-id="e59c8-209">Figura 2 mostra o modelo de implementação de multirregião típica Olá com oito nós em cada região.</span><span class="sxs-lookup"><span data-stu-id="e59c8-209">Figure 2 shows hello typical multi-region deployment model with eight nodes in each region.</span></span> <span data-ttu-id="e59c8-210">Ambas as regiões são imagens de espelho de si para Olá mesmo de symmetry; estruturas de mundo real dependem do tipo de carga de trabalho de Olá (por exemplo, analítico ou transacional), RPO, RTO, consistência dos dados e requisitos de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e59c8-210">Both regions are mirror images of each other for hello same of symmetry; real world designs depend on hello workload type (e.g. transactional or analytical), RPO, RTO, data consistency and availability requirements.</span></span>

![Implementação de região de múltipla](./media/cassandra-nodejs/cassandra-linux2.png)

<span data-ttu-id="e59c8-212">Figura 2: Implementação de multirregião Cassandra</span><span class="sxs-lookup"><span data-stu-id="e59c8-212">Figure 2: Multi-region Cassandra deployment</span></span>

### <a name="network-integration"></a><span data-ttu-id="e59c8-213">Integração de rede</span><span class="sxs-lookup"><span data-stu-id="e59c8-213">Network Integration</span></span>
<span data-ttu-id="e59c8-214">Conjuntos de máquinas virtuais, redes tooprivate implementado localizados em duas regiões comunica com entre si utilizando um túnel VPN.</span><span class="sxs-lookup"><span data-stu-id="e59c8-214">Sets of virtual machines deployed tooprivate networks located on two regions communicates with each other using a VPN tunnel.</span></span> <span data-ttu-id="e59c8-215">túnel VPN de Olá liga-se dois gateways de software aprovisionados durante o processo de implementação de rede Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-215">hello VPN tunnel connects two software gateways provisioned during hello network deployment process.</span></span> <span data-ttu-id="e59c8-216">Ambas as regiões têm a arquitetura de rede semelhante em termos de sub-redes "web" e "dados"; Redes do Azure permite a criação de Olá de sub-redes tantos conforme necessário e aplicar ACLs conforme necessário para a segurança de rede.</span><span class="sxs-lookup"><span data-stu-id="e59c8-216">Both regions have similar network architecture in terms of “web” and “data” subnets; Azure networking allows hello creation of as many subnets as needed and apply ACLs as needed by network security.</span></span> <span data-ttu-id="e59c8-217">Ao conceber a topologia de cluster Olá inter-data center comunicação latência e Olá económico impacto de Olá rede tráfego necessidade toobe considerado.</span><span class="sxs-lookup"><span data-stu-id="e59c8-217">While designing hello cluster topology inter data center communication latency and hello economic impact of hello network traffic need toobe considered.</span></span>

### <a name="data-consistency-for-multi-data-center-deployment"></a><span data-ttu-id="e59c8-218">Consistência dos dados para a implementação de centro de dados de vários</span><span class="sxs-lookup"><span data-stu-id="e59c8-218">Data Consistency for Multi-Data Center Deployment</span></span>
<span data-ttu-id="e59c8-219">Distribuída toobe necessidade de implementações em consideração impacto de topologia de cluster Olá no débito e elevada disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e59c8-219">Distributed deployments need toobe aware of hello cluster topology impact on throughput and high availability.</span></span> <span data-ttu-id="e59c8-220">Olá RF e o nível de consistência toobe necessidade selecionado forma que Olá quórum não depende disponibilidade Olá de todos os centros de dados de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-220">hello RF and Consistency Level need toobe selected in such way that hello quorum doesn’t depend on hello availability of all hello data centers.</span></span>
<span data-ttu-id="e59c8-221">Para um sistema que tem de consistência elevada, um LOCAL_QUORUM para o nível de consistência (para leituras e escritas) irá garantir que esse Olá local lê e escreve forem satisfeitas do Olá local nós enquanto os dados são replicadas de forma assíncrona toohello centros de dados remota.</span><span class="sxs-lookup"><span data-stu-id="e59c8-221">For a system that needs high consistency, a LOCAL_QUORUM for consistency level (for reads and writes) will make sure that hello local reads and writes are satisfied from hello local nodes while data is replicated asynchronously toohello remote data centers.</span></span>  <span data-ttu-id="e59c8-222">Tabela 2 resume configuração Olá escrever os detalhes para o cluster de multirregião Olá descrito mais à frente no Olá cópias de segurança.</span><span class="sxs-lookup"><span data-stu-id="e59c8-222">Table 2 summarizes hello configuration details for hello multi-region cluster outlined later in hello write up.</span></span>

<span data-ttu-id="e59c8-223">**Configuração de cluster Cassandra dois-região**</span><span class="sxs-lookup"><span data-stu-id="e59c8-223">**Two-region Cassandra cluster configuration**</span></span>

| <span data-ttu-id="e59c8-224">Parâmetro de cluster</span><span class="sxs-lookup"><span data-stu-id="e59c8-224">Cluster Parameter</span></span> | <span data-ttu-id="e59c8-225">Valor</span><span class="sxs-lookup"><span data-stu-id="e59c8-225">Value</span></span> | <span data-ttu-id="e59c8-226">Observações</span><span class="sxs-lookup"><span data-stu-id="e59c8-226">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e59c8-227">Número de nós (N)</span><span class="sxs-lookup"><span data-stu-id="e59c8-227">Number of Nodes (N)</span></span> |<span data-ttu-id="e59c8-228">8 + 8</span><span class="sxs-lookup"><span data-stu-id="e59c8-228">8 + 8</span></span> |<span data-ttu-id="e59c8-229">Número total de nós no cluster de Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-229">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="e59c8-230">Fator de replicação (RF)</span><span class="sxs-lookup"><span data-stu-id="e59c8-230">Replication Factor (RF)</span></span> |<span data-ttu-id="e59c8-231">3</span><span class="sxs-lookup"><span data-stu-id="e59c8-231">3</span></span> |<span data-ttu-id="e59c8-232">Número de réplicas de uma linha especificada</span><span class="sxs-lookup"><span data-stu-id="e59c8-232">Number of replicas of a given row</span></span> |
| <span data-ttu-id="e59c8-233">Nível de consistência (escrita)</span><span class="sxs-lookup"><span data-stu-id="e59c8-233">Consistency Level (Write)</span></span> |<span data-ttu-id="e59c8-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] resultado Olá de fórmula Olá é arredondado para baixo</span><span class="sxs-lookup"><span data-stu-id="e59c8-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="e59c8-235">2 nós serão escritos toohello primeiro centro de dados de forma síncrona; Olá outros 2 nós necessários para quórum serão escritos no modo assíncrono toohello 2nd Centro de dados.</span><span class="sxs-lookup"><span data-stu-id="e59c8-235">2 nodes will be written toohello first data center synchronously; hello additional 2 nodes needed for quorum will be written asynchronously toohello 2nd data center.</span></span> |
| <span data-ttu-id="e59c8-236">Nível de consistência (leitura)</span><span class="sxs-lookup"><span data-stu-id="e59c8-236">Consistency Level (Read)</span></span> |<span data-ttu-id="e59c8-237">LOCAL_QUORUM ((RF/2) + 1) = 2 resultado Olá de fórmula Olá é arredondado para baixo</span><span class="sxs-lookup"><span data-stu-id="e59c8-237">LOCAL_QUORUM ((RF/2) +1) = 2 hello result of hello formula is rounded down</span></span> |<span data-ttu-id="e59c8-238">Pedidos de leitura são satisfeitos de apenas uma região; são lidos a 2 nós antes do envio de resposta Olá toohello back-cliente.</span><span class="sxs-lookup"><span data-stu-id="e59c8-238">Read requests are satisfied from only one region; 2 nodes are read before hello response is sent back toohello client.</span></span> |
| <span data-ttu-id="e59c8-239">Estratégia de replicação</span><span class="sxs-lookup"><span data-stu-id="e59c8-239">Replication Strategy</span></span> |<span data-ttu-id="e59c8-240">Consulte NetworkTopologyStrategy [replicação de dados](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) na documentação de Cassandra para obter mais informações</span><span class="sxs-lookup"><span data-stu-id="e59c8-240">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="e59c8-241">Compreende a topologia de implementação de Olá e coloca réplicas em nós, para que todas as réplicas de Olá não acabar em Olá mesmo bastidor</span><span class="sxs-lookup"><span data-stu-id="e59c8-241">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="e59c8-242">Snitch</span><span class="sxs-lookup"><span data-stu-id="e59c8-242">Snitch</span></span> |<span data-ttu-id="e59c8-243">Consulte GossipingPropertyFileSnitch [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) na documentação de Cassandra para obter mais informações</span><span class="sxs-lookup"><span data-stu-id="e59c8-243">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="e59c8-244">NetworkTopologyStrategy utiliza um conceito de topologia do snitch toounderstand Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-244">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="e59c8-245">GossipingPropertyFileSnitch proporciona um melhor controlo em cada nó toodata Centro e em Bastidor de mapeamento.</span><span class="sxs-lookup"><span data-stu-id="e59c8-245">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="e59c8-246">Olá cluster utiliza, em seguida, gossip toopropagate, estas informações.</span><span class="sxs-lookup"><span data-stu-id="e59c8-246">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="e59c8-247">Isto é muito mais simples no dinâmica tooPropertyFileSnitch relativo para o IP definição</span><span class="sxs-lookup"><span data-stu-id="e59c8-247">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

## <a name="hello-software-configuration"></a><span data-ttu-id="e59c8-248">Olá configuração de SOFTWARE</span><span class="sxs-lookup"><span data-stu-id="e59c8-248">hello SOFTWARE CONFIGURATION</span></span>
<span data-ttu-id="e59c8-249">Olá seguintes versões de software é utilizado durante a implementação de Olá:</span><span class="sxs-lookup"><span data-stu-id="e59c8-249">hello following software versions are used during hello deployment:</span></span>

<table>
<tr><th><span data-ttu-id="e59c8-250">Software</span><span class="sxs-lookup"><span data-stu-id="e59c8-250">Software</span></span></th><th><span data-ttu-id="e59c8-251">Origem</span><span class="sxs-lookup"><span data-stu-id="e59c8-251">Source</span></span></th><th><span data-ttu-id="e59c8-252">Versão</span><span class="sxs-lookup"><span data-stu-id="e59c8-252">Version</span></span></th></tr>
<tr><td><span data-ttu-id="e59c8-253">JRE</span><span class="sxs-lookup"><span data-stu-id="e59c8-253">JRE</span></span>    </td><td><span data-ttu-id="e59c8-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span><span class="sxs-lookup"><span data-stu-id="e59c8-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span></span></td><td><span data-ttu-id="e59c8-255">8U5</span><span class="sxs-lookup"><span data-stu-id="e59c8-255">8U5</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-256">JNA</span><span class="sxs-lookup"><span data-stu-id="e59c8-256">JNA</span></span>    </td><td><span data-ttu-id="e59c8-257">[JNA](https://github.com/twall/jna) </span><span class="sxs-lookup"><span data-stu-id="e59c8-257">[JNA](https://github.com/twall/jna) </span></span></td><td> <span data-ttu-id="e59c8-258">3.2.7</span><span class="sxs-lookup"><span data-stu-id="e59c8-258">3.2.7</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-259">Cassandra</span><span class="sxs-lookup"><span data-stu-id="e59c8-259">Cassandra</span></span></td><td>[<span data-ttu-id="e59c8-260">Apache Cassandra 2.0.8</span><span class="sxs-lookup"><span data-stu-id="e59c8-260">Apache Cassandra 2.0.8</span></span>](http://www.apache.org/dist/cassandra/2.0.8/apache-cassandra-2.0.8-bin.tar.gz)</td><td> <span data-ttu-id="e59c8-261">2.0.8</span><span class="sxs-lookup"><span data-stu-id="e59c8-261">2.0.8</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-262">Ubuntu</span><span class="sxs-lookup"><span data-stu-id="e59c8-262">Ubuntu</span></span>    </td><td><span data-ttu-id="e59c8-263">[Microsoft Azure](https://azure.microsoft.com/) </span><span class="sxs-lookup"><span data-stu-id="e59c8-263">[Microsoft Azure](https://azure.microsoft.com/) </span></span></td><td><span data-ttu-id="e59c8-264">14.04 LTS</span><span class="sxs-lookup"><span data-stu-id="e59c8-264">14.04 LTS</span></span></td></tr>
</table>

<span data-ttu-id="e59c8-265">Uma vez que transferir da JRE requer manual aceitação de licença do Oracle, implementação de Olá toosimplify, transferência que todas Olá ambiente de trabalho do software necessárias toohello para carregar mais tarde para a imagem de modelo do Ubuntu Olá que iremos criar como um cluster de toohello precursor implementação.</span><span class="sxs-lookup"><span data-stu-id="e59c8-265">Since downloading of JRE requires manual acceptance of Oracle license, toosimplify hello deployment, download all hello required software toohello desktop for later uploading into hello Ubuntu template image we will be creating as a precursor toohello cluster deployment.</span></span>

<span data-ttu-id="e59c8-266">Transferir Olá acima software para um diretório de transferências bem conhecido (por exemplo, %TEMP%/downloads no Windows ou ~/Downloads na maioria das distribuições de Linux ou Mac) no computador local Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-266">Download hello above software into a well-known download directory (e.g. %TEMP%/downloads on Windows or ~/Downloads on most Linux distributions or Mac) on hello local computer.</span></span>

### <a name="create-ubuntu-vm"></a><span data-ttu-id="e59c8-267">CRIAR A VM COM UBUNTU</span><span class="sxs-lookup"><span data-stu-id="e59c8-267">CREATE UBUNTU VM</span></span>
<span data-ttu-id="e59c8-268">Neste passo do processo de Olá iremos criar Ubuntu imagem com o software de pré-requisito Olá para que hello imagem pode ser reutilizada para o aprovisionamento de vários nós Cassandra.</span><span class="sxs-lookup"><span data-stu-id="e59c8-268">In this step of hello process we will create Ubuntu image with hello pre-requisite software so that hello image can be reused for provisioning several Cassandra nodes.</span></span>  

#### <a name="step-1-generate-ssh-key-pair"></a><span data-ttu-id="e59c8-269">PASSO 1: Gerar par de chaves de SSH</span><span class="sxs-lookup"><span data-stu-id="e59c8-269">STEP 1: Generate SSH key pair</span></span>
<span data-ttu-id="e59c8-270">Azure tem uma chave pública que é PEM ou DER codificado em Olá tempo de aprovisionamento de X509.</span><span class="sxs-lookup"><span data-stu-id="e59c8-270">Azure needs an X509 public key that is either PEM or DER encoded at hello provisioning time.</span></span> <span data-ttu-id="e59c8-271">Gerar um par de chaves públicas/privadas, utilizando instruções Olá localizadas como tooUse SSH com o Linux no Azure.</span><span class="sxs-lookup"><span data-stu-id="e59c8-271">Generate a public/private key pair using hello instructions located at How tooUse SSH with Linux on Azure.</span></span> <span data-ttu-id="e59c8-272">Se planear toouse putty.exe como um cliente SSH no Windows ou Linux, tem de tooconvert Olá PEM codificado em formato de tooPPK chaves privadas RSA utilizando puttygen.exe; Olá as instruções para isto podem ser encontradas na Olá acima página web.</span><span class="sxs-lookup"><span data-stu-id="e59c8-272">If you plan toouse putty.exe as an SSH client either on Windows or Linux, you have tooconvert hello PEM encoded RSA private key tooPPK format using puttygen.exe; hello instructions for this can be found in hello above web page.</span></span>

#### <a name="step-2-create-ubuntu-template-vm"></a><span data-ttu-id="e59c8-273">PASSO 2: Criar o modelo de Ubuntu VM</span><span class="sxs-lookup"><span data-stu-id="e59c8-273">STEP 2: Create Ubuntu template VM</span></span>
<span data-ttu-id="e59c8-274">VM, do modelo de Olá toocreate sessão Olá Azure clássico Olá de portal e utilize a seguinte sequência: clique em novo, COMPUTAÇÃO, máquina VIRTUAL, FROM GALERIA, UBUNTU, Ubuntu Server 14.04 LTS e, em seguida, clique em seta para a direita Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-274">toocreate hello template VM, log into hello Azure classic portal and use hello following sequence: Click NEW, COMPUTE, VIRTUAL MACHINE, FROM GALLERY, UBUNTU, Ubuntu Server 14.04 LTS, and then click hello right arrow.</span></span> <span data-ttu-id="e59c8-275">Para um tutorial que descreve como toocreate uma VM com Linux, consulte Criar uma Linux em execução de Máquina Virtual.</span><span class="sxs-lookup"><span data-stu-id="e59c8-275">For a tutorial that describes how toocreate a Linux VM, see Create a Virtual Machine Running Linux.</span></span>

<span data-ttu-id="e59c8-276">Introduza Olá seguindo as informações do ecrã de Olá "configuração da Máquina Virtual" #1:</span><span class="sxs-lookup"><span data-stu-id="e59c8-276">Enter hello following information on hello “Virtual machine configuration” screen #1:</span></span>

<table>
<tr><th><span data-ttu-id="e59c8-277">NOME DO CAMPO</span><span class="sxs-lookup"><span data-stu-id="e59c8-277">FIELD NAME</span></span>              </td><td>       <span data-ttu-id="e59c8-278">VALOR DO CAMPO</span><span class="sxs-lookup"><span data-stu-id="e59c8-278">FIELD VALUE</span></span>               </td><td>         <span data-ttu-id="e59c8-279">OBSERVAÇÕES</span><span class="sxs-lookup"><span data-stu-id="e59c8-279">REMARKS</span></span>                </td><tr>
<tr><td><span data-ttu-id="e59c8-280">DATA DE LANÇAMENTO DA VERSÃO</span><span class="sxs-lookup"><span data-stu-id="e59c8-280">VERSION RELEASE DATE</span></span>    </td><td> <span data-ttu-id="e59c8-281">Selecione uma data no Olá pendente</span><span class="sxs-lookup"><span data-stu-id="e59c8-281">Select a date from hello drop down</span></span></td><td></td><tr>
<tr><td><span data-ttu-id="e59c8-282">NOME DA MÁQUINA VIRTUAL</span><span class="sxs-lookup"><span data-stu-id="e59c8-282">VIRTUAL MACHINE NAME</span></span>    </td><td> <span data-ttu-id="e59c8-283">modelo de CASS</span><span class="sxs-lookup"><span data-stu-id="e59c8-283">cass-template</span></span>                   </td><td> <span data-ttu-id="e59c8-284">Este é o nome de anfitrião de Olá do Olá VM</span><span class="sxs-lookup"><span data-stu-id="e59c8-284">This is hello hostname of hello VM</span></span> </td><tr>
<tr><td><span data-ttu-id="e59c8-285">CAMADA</span><span class="sxs-lookup"><span data-stu-id="e59c8-285">TIER</span></span>                     </td><td> <span data-ttu-id="e59c8-286">STANDARD</span><span class="sxs-lookup"><span data-stu-id="e59c8-286">STANDARD</span></span>                           </td><td> <span data-ttu-id="e59c8-287">Deixe a predefinição de Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-287">Leave hello default</span></span>              </td><tr>
<tr><td><span data-ttu-id="e59c8-288">TAMANHO</span><span class="sxs-lookup"><span data-stu-id="e59c8-288">SIZE</span></span>                     </td><td> <span data-ttu-id="e59c8-289">A1</span><span class="sxs-lookup"><span data-stu-id="e59c8-289">A1</span></span>                              </td><td><span data-ttu-id="e59c8-290">Tem de selecionar Olá que VM com base no Olá e/s; para este fim, deixe a predefinição de Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-290">Select hello VM based on hello IO needs; for this purpose leave hello default</span></span> </td><tr>
<tr><td> <span data-ttu-id="e59c8-291">NOVO NOME DE UTILIZADOR</span><span class="sxs-lookup"><span data-stu-id="e59c8-291">NEW USER NAME</span></span>             </td><td> <span data-ttu-id="e59c8-292">localadmin</span><span class="sxs-lookup"><span data-stu-id="e59c8-292">localadmin</span></span>                       </td><td> <span data-ttu-id="e59c8-293">"admin" é um nome de utilizador reservado no Ubuntu 12. xx e depois</span><span class="sxs-lookup"><span data-stu-id="e59c8-293">"admin" is a reserved user name in Ubuntu 12.xx and after</span></span></td><tr>
<tr><td> <span data-ttu-id="e59c8-294">AUTENTICAÇÃO</span><span class="sxs-lookup"><span data-stu-id="e59c8-294">AUTHENTICATION</span></span>         </td><td> <span data-ttu-id="e59c8-295">Clique em caixa de verificação</span><span class="sxs-lookup"><span data-stu-id="e59c8-295">Click check box</span></span>                 </td><td><span data-ttu-id="e59c8-296">Verifique se quiser toosecure com uma chave SSH</span><span class="sxs-lookup"><span data-stu-id="e59c8-296">Check if you want toosecure with an SSH key</span></span> </td><tr>
<tr><td> <span data-ttu-id="e59c8-297">CERTIFICADO</span><span class="sxs-lookup"><span data-stu-id="e59c8-297">CERTIFICATE</span></span>             </td><td> <span data-ttu-id="e59c8-298">nome de ficheiro do certificado de chave pública Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-298">file name of hello public key certificate</span></span> </td><td> <span data-ttu-id="e59c8-299">Utilize a chave pública Olá gerado anteriormente</span><span class="sxs-lookup"><span data-stu-id="e59c8-299">Use hello public key generated previously</span></span></td><tr>
<tr><td> <span data-ttu-id="e59c8-300">Nova palavra-passe</span><span class="sxs-lookup"><span data-stu-id="e59c8-300">New Password</span></span>    </td><td> <span data-ttu-id="e59c8-301">palavra-passe segura</span><span class="sxs-lookup"><span data-stu-id="e59c8-301">strong password</span></span> </td><td> </td><tr>
<tr><td> <span data-ttu-id="e59c8-302">Confirmar palavra-passe</span><span class="sxs-lookup"><span data-stu-id="e59c8-302">Confirm Password</span></span>    </td><td> <span data-ttu-id="e59c8-303">palavra-passe segura</span><span class="sxs-lookup"><span data-stu-id="e59c8-303">strong password</span></span> </td><td></td><tr>
</table>

<span data-ttu-id="e59c8-304">Introduza Olá seguindo as informações do ecrã de Olá "configuração da Máquina Virtual" #2:</span><span class="sxs-lookup"><span data-stu-id="e59c8-304">Enter hello following information on hello “Virtual machine configuration” screen #2:</span></span>

<table>
<tr><th><span data-ttu-id="e59c8-305">NOME DO CAMPO</span><span class="sxs-lookup"><span data-stu-id="e59c8-305">FIELD NAME</span></span>             </th><th> <span data-ttu-id="e59c8-306">VALOR DO CAMPO</span><span class="sxs-lookup"><span data-stu-id="e59c8-306">FIELD VALUE</span></span>                       </th><th> <span data-ttu-id="e59c8-307">OBSERVAÇÕES</span><span class="sxs-lookup"><span data-stu-id="e59c8-307">REMARKS</span></span>                                 </th></tr>
<tr><td> <span data-ttu-id="e59c8-308">SERVIÇO EM NUVEM</span><span class="sxs-lookup"><span data-stu-id="e59c8-308">CLOUD SERVICE</span></span>    </td><td> <span data-ttu-id="e59c8-309">Criar um novo serviço de nuvem</span><span class="sxs-lookup"><span data-stu-id="e59c8-309">Create a new cloud service</span></span>    </td><td><span data-ttu-id="e59c8-310">Serviço em nuvem é um recursos de computação do contentor como máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="e59c8-310">Cloud service is a container compute resources like virtual machines</span></span></td></tr>
<tr><td> <span data-ttu-id="e59c8-311">NOME DE DNS DO SERVIÇO DE NUVEM</span><span class="sxs-lookup"><span data-stu-id="e59c8-311">CLOUD SERVICE DNS NAME</span></span>    </td><td><span data-ttu-id="e59c8-312">ubuntu template.cloudapp.net</span><span class="sxs-lookup"><span data-stu-id="e59c8-312">ubuntu-template.cloudapp.net</span></span>    </td><td><span data-ttu-id="e59c8-313">Dê um nome de Balanceador de carga com máquina</span><span class="sxs-lookup"><span data-stu-id="e59c8-313">Give a machine agnostic load balancer name</span></span></td></tr>
<tr><td> <span data-ttu-id="e59c8-314">REGIÃO/GRUPO DE AFINIDADE/REDE VIRTUAL</span><span class="sxs-lookup"><span data-stu-id="e59c8-314">REGION/AFFINITY GROUP/VIRTUAL NETWORK</span></span> </td><td>    <span data-ttu-id="e59c8-315">EUA Oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-315">West US</span></span>    </td><td> <span data-ttu-id="e59c8-316">Selecione uma região a partir da qual as suas aplicações web aceder ao cluster de Cassandra Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-316">Select a region from which your web applications access hello Cassandra cluster</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-317">CONTA DE ARMAZENAMENTO</span><span class="sxs-lookup"><span data-stu-id="e59c8-317">STORAGE ACCOUNT</span></span> </td><td>    <span data-ttu-id="e59c8-318">Utilizar predefinição</span><span class="sxs-lookup"><span data-stu-id="e59c8-318">Use default</span></span>    </td><td><span data-ttu-id="e59c8-319">Utilizar a conta do storage predefinida Olá ou uma conta de armazenamento previamente criada numa região específica</span><span class="sxs-lookup"><span data-stu-id="e59c8-319">Use hello default storage account  or a pre-created storage account in a particular region</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-320">CONJUNTO DE DISPONIBILIDADE</span><span class="sxs-lookup"><span data-stu-id="e59c8-320">AVAILABILITY SET</span></span> </td><td>    <span data-ttu-id="e59c8-321">Nenhuma</span><span class="sxs-lookup"><span data-stu-id="e59c8-321">None</span></span> </td><td>    <span data-ttu-id="e59c8-322">Pode deixar em branco</span><span class="sxs-lookup"><span data-stu-id="e59c8-322">Leave it blank</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-323">PONTOS FINAIS</span><span class="sxs-lookup"><span data-stu-id="e59c8-323">ENDPOINTS</span></span>    </td><td><span data-ttu-id="e59c8-324">Utilizar predefinição</span><span class="sxs-lookup"><span data-stu-id="e59c8-324">Use default</span></span> </td><td>    <span data-ttu-id="e59c8-325">Utilize a configuração de SSH Olá predefinida</span><span class="sxs-lookup"><span data-stu-id="e59c8-325">Use hello default SSH configuration</span></span> </td></tr>
</table>

<span data-ttu-id="e59c8-326">Clique em seta para a direita, deixe as predefinições de Olá no ecrã de Olá #3 e clique em Olá "verificar" botão toocomplete Olá VM processo de aprovisionamento.</span><span class="sxs-lookup"><span data-stu-id="e59c8-326">Click right arrow, leave hello defaults on hello screen #3 and click hello “check” button toocomplete hello VM provisioning process.</span></span> <span data-ttu-id="e59c8-327">Após alguns minutos, Olá VM com o nome "ubuntu-modelo de Olá" deve estar no estado "em execução".</span><span class="sxs-lookup"><span data-stu-id="e59c8-327">After a few minutes, hello VM with hello name “ubuntu-template” should be in a “running” status.</span></span>

### <a name="install-hello-necessary-software"></a><span data-ttu-id="e59c8-328">INSTALAR Olá SOFTWARE necessário</span><span class="sxs-lookup"><span data-stu-id="e59c8-328">INSTALL hello NECESSARY SOFTWARE</span></span>
#### <a name="step-1-upload-tarballs"></a><span data-ttu-id="e59c8-329">PASSO 1: Carregamento tarballs</span><span class="sxs-lookup"><span data-stu-id="e59c8-329">STEP 1: Upload tarballs</span></span>
<span data-ttu-id="e59c8-330">Utilizar o scp ou pscp, Olá cópia anteriormente transferidos software demasiado ~ / diretório de transferências utilizando Olá segue o formato de comando:</span><span class="sxs-lookup"><span data-stu-id="e59c8-330">Using scp or pscp, copy hello previously downloaded software too~/downloads directory using hello following command format:</span></span>

##### <a name="pscp-server-jre-8u5-linux-x64targz-localadminhk-cas-templatecloudappnethomelocaladmindownloadsserver-jre-8u5-linux-x64targz"></a><span data-ttu-id="e59c8-331">pscp servidor-jre-8u5-linux-x64.tar.gzlocaladmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span><span class="sxs-lookup"><span data-stu-id="e59c8-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span></span>
<span data-ttu-id="e59c8-332">Repita Olá acima comando para JRE, bem como para bits de Cassandra Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-332">Repeat hello above command for JRE as well as for hello Cassandra bits.</span></span>

#### <a name="step-2-prepare-hello-directory-structure-and-extract-hello-archives"></a><span data-ttu-id="e59c8-333">PASSO 2: Preparar a estrutura de diretórios Olá e extrair os arquivos de Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-333">STEP 2: Prepare hello directory structure and extract hello archives</span></span>
<span data-ttu-id="e59c8-334">Inicie sessão no Olá VM e criar a estrutura de diretórios Olá e extrair software como um Superutilizador utilizando scripts de bash Olá abaixo:</span><span class="sxs-lookup"><span data-stu-id="e59c8-334">Log into hello VM and create hello directory structure and extract software as a super user using hello bash script below:</span></span>

    #!/bin/bash
    CASS_INSTALL_DIR="/opt/cassandra"
    JRE_INSTALL_DIR="/opt/java"
    CASS_DATA_DIR="/var/lib/cassandra"
    CASS_LOG_DIR="/var/log/cassandra"
    DOWNLOADS_DIR="~/downloads"
    JRE_TARBALL="server-jre-8u5-linux-x64.tar.gz"
    CASS_TARBALL="apache-cassandra-2.0.8-bin.tar.gz"
    SVC_USER="localadmin"

    RESET_ERROR=1
    MKDIR_ERROR=2

    reset_installation ()
    {
       rm -rf $CASS_INSTALL_DIR 2> /dev/null
       rm -rf $JRE_INSTALL_DIR 2> /dev/null
       rm -rf $CASS_DATA_DIR 2> /dev/null
       rm -rf $CASS_LOG_DIR 2> /dev/null
    }
    make_dir ()
    {
       if [ -z "$1" ]
       then
          echo "make_dir: invalid directory name"
          exit $MKDIR_ERROR
       fi

       if [ -d "$1" ]
       then
          echo "make_dir: directory already exists"
          exit $MKDIR_ERROR
       fi

       mkdir $1 2>/dev/null
       if [ $? != 0 ]
       then
          echo "directory creation failed"
          exit $MKDIR_ERROR
       fi
    }

    unzip()
    {
       if [ $# == 2 ]
       then
          tar xzf $1 -C $2
       else
          echo "archive error"
       fi

    }

    if [ -n "$1" ]
    then
       SVC_USER=$1
    fi

    reset_installation
    make_dir $CASS_INSTALL_DIR
    make_dir $JRE_INSTALL_DIR
    make_dir $CASS_DATA_DIR
    make_dir $CASS_LOG_DIR

    #unzip JRE and Cassandra
    unzip $HOME/downloads/$JRE_TARBALL $JRE_INSTALL_DIR
    unzip $HOME/downloads/$CASS_TARBALL $CASS_INSTALL_DIR

    #Change hello ownership toohello service credentials

    chown -R $SVC_USER:$GROUP $CASS_DATA_DIR
    chown -R $SVC_USER:$GROUP $CASS_LOG_DIR
    echo "edit /etc/profile tooadd JRE toohello PATH"
    echo "installation is complete"


<span data-ttu-id="e59c8-335">Se cole este script janela vim, certifique-se tooremove avanço de Olá retorno ('\r ") com Olá os seguintes comandos:</span><span class="sxs-lookup"><span data-stu-id="e59c8-335">If you paste this script into vim window, make sure tooremove hello carriage return (‘\r”) using hello following command:</span></span>

    tr -d '\r' <infile.sh >outfile.sh

#### <a name="step-3-edit-etcprofile"></a><span data-ttu-id="e59c8-336">Passo 3: Editar perfil/etc.</span><span class="sxs-lookup"><span data-stu-id="e59c8-336">Step 3: Edit etc/profile</span></span>
<span data-ttu-id="e59c8-337">Acrescente seguinte Olá no fim de Olá:</span><span class="sxs-lookup"><span data-stu-id="e59c8-337">Append hello following at hello end:</span></span>

    JAVA_HOME=/opt/java/jdk1.8.0_05
    CASS_HOME= /opt/cassandra/apache-cassandra-2.0.8
    PATH=$PATH:$HOME/bin:$JAVA_HOME/bin:$CASS_HOME/bin
    export JAVA_HOME
    export CASS_HOME
    export PATH

#### <a name="step-4-install-jna-for-production-systems"></a><span data-ttu-id="e59c8-338">Passo 4: Instalar JNA para sistemas de produção</span><span class="sxs-lookup"><span data-stu-id="e59c8-338">Step 4: Install JNA for production systems</span></span>
<span data-ttu-id="e59c8-339">Sequência de comandos seguinte Olá de utilização: seguinte Olá comando instalação jna-3.2.7.jar e jna-plataforma-3.2.7.jar too/usr/share.java diretório sudo apt-get instalará libjna java</span><span class="sxs-lookup"><span data-stu-id="e59c8-339">Use hello following command sequence: hello following command will install jna-3.2.7.jar and jna-platform-3.2.7.jar too/usr/share.java directory sudo apt-get install libjna-java</span></span>

<span data-ttu-id="e59c8-340">Crie ligações simbólicas no diretório CASS_HOME/lib $ para que o script de arranque Cassandra pode encontrar estas v7:</span><span class="sxs-lookup"><span data-stu-id="e59c8-340">Create symbolic links in $CASS_HOME/lib directory so that Cassandra startup script can find these jars:</span></span>

    ln -s /usr/share/java/jna-3.2.7.jar $CASS_HOME/lib/jna.jar

    ln -s /usr/share/java/jna-platform-3.2.7.jar $CASS_HOME/lib/jna-platform.jar

#### <a name="step-5-configure-cassandrayaml"></a><span data-ttu-id="e59c8-341">Passo 5: Configurar cassandra.yaml</span><span class="sxs-lookup"><span data-stu-id="e59c8-341">Step 5: Configure cassandra.yaml</span></span>
<span data-ttu-id="e59c8-342">Edite cassandra.yaml na configuração de tooreflect cada VM necessária para todas as máquinas de virtuais Olá [podemos irá otimizar este durante o aprovisionamento de Olá real]:</span><span class="sxs-lookup"><span data-stu-id="e59c8-342">Edit cassandra.yaml on each VM tooreflect configuration needed by all hello virtual machines [we will tweak this during hello actual provisioning]:</span></span>

<table>
<tr><th><span data-ttu-id="e59c8-343">Nome do campo</span><span class="sxs-lookup"><span data-stu-id="e59c8-343">Field Name</span></span>   </th><th> <span data-ttu-id="e59c8-344">Valor</span><span class="sxs-lookup"><span data-stu-id="e59c8-344">Value</span></span>  </th><th>    <span data-ttu-id="e59c8-345">Observações</span><span class="sxs-lookup"><span data-stu-id="e59c8-345">Remarks</span></span> </th></tr>
<tr><td><span data-ttu-id="e59c8-346">cluster_name</span><span class="sxs-lookup"><span data-stu-id="e59c8-346">cluster_name</span></span> </td><td>    <span data-ttu-id="e59c8-347">"CustomerService"</span><span class="sxs-lookup"><span data-stu-id="e59c8-347">“CustomerService”</span></span>    </td><td> <span data-ttu-id="e59c8-348">Utilize o nome Olá que reflete a implementação</span><span class="sxs-lookup"><span data-stu-id="e59c8-348">Use hello name that reflects your deployment</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-349">listen_address</span><span class="sxs-lookup"><span data-stu-id="e59c8-349">listen_address</span></span>    </td><td><span data-ttu-id="e59c8-350">[pode deixar em branco]</span><span class="sxs-lookup"><span data-stu-id="e59c8-350">[leave it blank]</span></span>    </td><td> <span data-ttu-id="e59c8-351">Eliminar "localhost"</span><span class="sxs-lookup"><span data-stu-id="e59c8-351">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="e59c8-352">rpc_addres</span><span class="sxs-lookup"><span data-stu-id="e59c8-352">rpc_addres</span></span>   </td><td><span data-ttu-id="e59c8-353">[pode deixar em branco]</span><span class="sxs-lookup"><span data-stu-id="e59c8-353">[leave it blank]</span></span>    </td><td> <span data-ttu-id="e59c8-354">Eliminar "localhost"</span><span class="sxs-lookup"><span data-stu-id="e59c8-354">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="e59c8-355">Seeds</span><span class="sxs-lookup"><span data-stu-id="e59c8-355">seeds</span></span>    </td><td><span data-ttu-id="e59c8-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span><span class="sxs-lookup"><span data-stu-id="e59c8-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span></span>    </td><td><span data-ttu-id="e59c8-357">Lista de todos os endereços IP Olá que são designados como seeds.</span><span class="sxs-lookup"><span data-stu-id="e59c8-357">List of  all hello IP addresses which are designated as seeds.</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-358">endpoint_snitch</span><span class="sxs-lookup"><span data-stu-id="e59c8-358">endpoint_snitch</span></span> </td><td> <span data-ttu-id="e59c8-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="e59c8-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span></span> </td><td> <span data-ttu-id="e59c8-360">Isto é utilizado por Olá NetworkTopologyStrateg para o Centro de dados de Olá ao inferir e bastidor de Olá de Olá VM</span><span class="sxs-lookup"><span data-stu-id="e59c8-360">This is used by hello NetworkTopologyStrateg for inferring hello data center and hello rack of hello VM</span></span></td></tr>
</table>

#### <a name="step-6-capture-hello-vm-image"></a><span data-ttu-id="e59c8-361">Passo 6: Capturar a imagem de VM Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-361">Step 6: Capture hello VM image</span></span>
<span data-ttu-id="e59c8-362">Iniciar sessão na máquina virtual de Olá utilizando Olá hostname (hk-ACs-template.cloudapp.net) e a chave do SSH de Olá privada que criou anteriormente.</span><span class="sxs-lookup"><span data-stu-id="e59c8-362">Log into hello virtual machine using hello hostname (hk-cas-template.cloudapp.net) and hello SSH private key previously created.</span></span> <span data-ttu-id="e59c8-363">Veja como tooUse a SSH com o Linux no Azure para obter detalhes sobre como toolog utilizando Olá comando ssh ou putty.exe.</span><span class="sxs-lookup"><span data-stu-id="e59c8-363">See How tooUse SSH with Linux on Azure for details on how toolog in using hello command ssh or putty.exe.</span></span>

<span data-ttu-id="e59c8-364">Execute Olá sequência da imagem de Olá toocapture de ações a seguir:</span><span class="sxs-lookup"><span data-stu-id="e59c8-364">Execute hello following sequence of actions toocapture hello image:</span></span>

##### <a name="1-deprovision"></a><span data-ttu-id="e59c8-365">1. Desaprovisionamento</span><span class="sxs-lookup"><span data-stu-id="e59c8-365">1. Deprovision</span></span>
<span data-ttu-id="e59c8-366">Utilize o comando de Olá "sudo waagent – deprovision + utilizador" tooremove informações específicas de instância de Máquina Virtual.</span><span class="sxs-lookup"><span data-stu-id="e59c8-366">Use hello command “sudo waagent –deprovision+user” tooremove Virtual Machine instance specific information.</span></span> <span data-ttu-id="e59c8-367">Consulte para [como tooCapture uma Máquina Virtual Linux](capture-image.md) tooUse como um modelo em mais detalhe no processo de captura de imagem de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-367">See for [How tooCapture a Linux Virtual Machine](capture-image.md) tooUse as a Template more details on hello image capture process.</span></span>

##### <a name="2-shutdown-hello-vm"></a><span data-ttu-id="e59c8-368">2: Olá encerramento VM</span><span class="sxs-lookup"><span data-stu-id="e59c8-368">2: Shutdown hello VM</span></span>
<span data-ttu-id="e59c8-369">Certifique-se de que a máquina virtual Olá é realçada e clique em ligação de encerramento Olá da barra de comando Olá inferior.</span><span class="sxs-lookup"><span data-stu-id="e59c8-369">Make sure that hello virtual machine is highlighted and click hello SHUTDOWN link from hello bottom command bar.</span></span>

##### <a name="3-capture-hello-image"></a><span data-ttu-id="e59c8-370">3: imagem de Olá de captura</span><span class="sxs-lookup"><span data-stu-id="e59c8-370">3: Capture hello image</span></span>
<span data-ttu-id="e59c8-371">Certifique-se de que a máquina virtual Olá é realçada e clique em ligação de captura Olá da barra de comando Olá inferior.</span><span class="sxs-lookup"><span data-stu-id="e59c8-371">Make sure that hello virtual machine is highlighted and click hello CAPTURE link from hello bottom command bar.</span></span> <span data-ttu-id="e59c8-372">No seguinte ecrã de Olá, atribua um nome de imagem (por exemplo, hk-cas-2-08-ub-14-04-2014071), adequado a descrição da imagem e clique em processo de captura de Olá marca toofinish Olá "verificar".</span><span class="sxs-lookup"><span data-stu-id="e59c8-372">In hello next screen, give an IMAGE NAME (e.g. hk-cas-2-08-ub-14-04-2014071), appropriate IMAGE DESCRIPTION, and click hello “check” mark toofinish hello CAPTURE process.</span></span>

<span data-ttu-id="e59c8-373">Esta ação irá demorar alguns segundos e imagem Olá deve estar disponível na secção das minhas imagens da Galeria de imagem de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-373">This will take a few seconds and hello image should be available in MY IMAGES section of hello image gallery.</span></span> <span data-ttu-id="e59c8-374">Olá de VM de origem será eliminado automaticamente após a imagem de Olá é capturada com êxito.</span><span class="sxs-lookup"><span data-stu-id="e59c8-374">hello source VM will be automatically deleted after hello image is successfully captured.</span></span> 

## <a name="single-region-deployment-process"></a><span data-ttu-id="e59c8-375">Processo de implementação única região</span><span class="sxs-lookup"><span data-stu-id="e59c8-375">Single Region Deployment Process</span></span>
<span data-ttu-id="e59c8-376">**Passo 1: Criar rede Virtual de Olá** sessão Olá portal do Azure e criar uma rede virtual (clássica) com atributos de Olá mostrada na Olá a tabela seguinte.</span><span class="sxs-lookup"><span data-stu-id="e59c8-376">**Step 1: Create hello Virtual Network** Log into hello Azure portal and create a virtual network (classic) with hello attributes shown in hello following table.</span></span> <span data-ttu-id="e59c8-377">Consulte [criar uma rede virtual (clássica) com o portal do Azure de Olá](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) para obter passos detalhados do processo de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-377">See [Create a virtual network (classic) using hello Azure portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="e59c8-378">Nome de atributo VM</span><span class="sxs-lookup"><span data-stu-id="e59c8-378">VM Attribute Name</span></span></th><th><span data-ttu-id="e59c8-379">Valor</span><span class="sxs-lookup"><span data-stu-id="e59c8-379">Value</span></span></th><th><span data-ttu-id="e59c8-380">Observações</span><span class="sxs-lookup"><span data-stu-id="e59c8-380">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="e59c8-381">Nome</span><span class="sxs-lookup"><span data-stu-id="e59c8-381">Name</span></span></td><td><span data-ttu-id="e59c8-382">vnet-cass--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-382">vnet-cass-west-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="e59c8-383">Região</span><span class="sxs-lookup"><span data-stu-id="e59c8-383">Region</span></span></td><td><span data-ttu-id="e59c8-384">EUA Oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-384">West US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="e59c8-385">Servidores DNS</span><span class="sxs-lookup"><span data-stu-id="e59c8-385">DNS Servers</span></span></td><td><span data-ttu-id="e59c8-386">Nenhuma</span><span class="sxs-lookup"><span data-stu-id="e59c8-386">None</span></span></td><td><span data-ttu-id="e59c8-387">Ignore esta indicação como podemos não estiver a utilizar um servidor DNS</span><span class="sxs-lookup"><span data-stu-id="e59c8-387">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-388">Espaço de endereços</span><span class="sxs-lookup"><span data-stu-id="e59c8-388">Address Space</span></span></td><td><span data-ttu-id="e59c8-389">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="e59c8-389">10.1.0.0/16</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="e59c8-390">IP inicial</span><span class="sxs-lookup"><span data-stu-id="e59c8-390">Starting IP</span></span></td><td><span data-ttu-id="e59c8-391">10.1.0.0</span><span class="sxs-lookup"><span data-stu-id="e59c8-391">10.1.0.0</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="e59c8-392">CIDR</span><span class="sxs-lookup"><span data-stu-id="e59c8-392">CIDR</span></span> </td><td><span data-ttu-id="e59c8-393">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="e59c8-393">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="e59c8-394">Adicione Olá seguintes sub-redes:</span><span class="sxs-lookup"><span data-stu-id="e59c8-394">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="e59c8-395">Nome</span><span class="sxs-lookup"><span data-stu-id="e59c8-395">Name</span></span></th><th><span data-ttu-id="e59c8-396">IP inicial</span><span class="sxs-lookup"><span data-stu-id="e59c8-396">Starting IP</span></span></th><th><span data-ttu-id="e59c8-397">CIDR</span><span class="sxs-lookup"><span data-stu-id="e59c8-397">CIDR</span></span></th><th><span data-ttu-id="e59c8-398">Observações</span><span class="sxs-lookup"><span data-stu-id="e59c8-398">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="e59c8-399">Web</span><span class="sxs-lookup"><span data-stu-id="e59c8-399">web</span></span></td><td><span data-ttu-id="e59c8-400">10.1.1.0</span><span class="sxs-lookup"><span data-stu-id="e59c8-400">10.1.1.0</span></span></td><td><span data-ttu-id="e59c8-401">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="e59c8-401">/24 (251)</span></span></td><td><span data-ttu-id="e59c8-402">Sub-rede para a web farm do Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-402">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-403">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-403">data</span></span></td><td><span data-ttu-id="e59c8-404">10.1.2.0</span><span class="sxs-lookup"><span data-stu-id="e59c8-404">10.1.2.0</span></span></td><td><span data-ttu-id="e59c8-405">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="e59c8-405">/24 (251)</span></span></td><td><span data-ttu-id="e59c8-406">Sub-rede para nós de base de dados de Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-406">Subnet for hello database nodes</span></span></td></tr>
</table>

<span data-ttu-id="e59c8-407">Dados e sub-redes Web podem ser protegidas através de grupos de segurança de rede cobertura de Olá que está fora do âmbito deste artigo.</span><span class="sxs-lookup"><span data-stu-id="e59c8-407">Data and Web subnets can be protected through network security groups hello coverage of which is out of scope for this article.</span></span>  

<span data-ttu-id="e59c8-408">**Passo 2: Aprovisionar máquinas** utilizando a imagem de Olá criada anteriormente, iremos criar Olá seguintes máquinas virtuais na nuvem de Olá server "hk-c-svc-Oeste" e vinculá-los toohello respetivas sub-redes conforme mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="e59c8-408">**Step 2: Provision Virtual Machines** Using hello image created previously, we will create hello following virtual machines in hello cloud server “hk-c-svc-west” and bind them toohello respective subnets as shown below:</span></span>

<table>
<tr><th><span data-ttu-id="e59c8-409">Nome do computador</span><span class="sxs-lookup"><span data-stu-id="e59c8-409">Machine Name</span></span>    </th><th><span data-ttu-id="e59c8-410">Subrede</span><span class="sxs-lookup"><span data-stu-id="e59c8-410">Subnet</span></span>    </th><th><span data-ttu-id="e59c8-411">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="e59c8-411">IP Address</span></span>    </th><th><span data-ttu-id="e59c8-412">Conjunto de disponibilidade</span><span class="sxs-lookup"><span data-stu-id="e59c8-412">Availability set</span></span></th><th><span data-ttu-id="e59c8-413">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="e59c8-413">DC/Rack</span></span></th><th><span data-ttu-id="e59c8-414">Seed?</span><span class="sxs-lookup"><span data-stu-id="e59c8-414">Seed?</span></span></th></tr>
<tr><td><span data-ttu-id="e59c8-415">HK-c1--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-415">hk-c1-west-us</span></span>    </td><td><span data-ttu-id="e59c8-416">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-416">data</span></span>    </td><td><span data-ttu-id="e59c8-417">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="e59c8-417">10.1.2.4</span></span>    </td><td><span data-ttu-id="e59c8-418">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-418">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="e59c8-419">DC = WESTUS bastidor = rack1</span><span class="sxs-lookup"><span data-stu-id="e59c8-419">dc =WESTUS rack =rack1</span></span> </td><td><span data-ttu-id="e59c8-420">Sim</span><span class="sxs-lookup"><span data-stu-id="e59c8-420">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-421">HK-c2--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-421">hk-c2-west-us</span></span>    </td><td><span data-ttu-id="e59c8-422">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-422">data</span></span>    </td><td><span data-ttu-id="e59c8-423">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="e59c8-423">10.1.2.5</span></span>    </td><td><span data-ttu-id="e59c8-424">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-424">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="e59c8-425">DC = WESTUS bastidor = rack1</span><span class="sxs-lookup"><span data-stu-id="e59c8-425">dc =WESTUS rack =rack1</span></span>    </td><td><span data-ttu-id="e59c8-426">Não</span><span class="sxs-lookup"><span data-stu-id="e59c8-426">No</span></span> </td></tr>
<tr><td><span data-ttu-id="e59c8-427">HK-c3--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-427">hk-c3-west-us</span></span>    </td><td><span data-ttu-id="e59c8-428">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-428">data</span></span>    </td><td><span data-ttu-id="e59c8-429">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="e59c8-429">10.1.2.6</span></span>    </td><td><span data-ttu-id="e59c8-430">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-430">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="e59c8-431">DC = WESTUS bastidor = rack2</span><span class="sxs-lookup"><span data-stu-id="e59c8-431">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="e59c8-432">Sim</span><span class="sxs-lookup"><span data-stu-id="e59c8-432">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-433">HK-c4--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-433">hk-c4-west-us</span></span>    </td><td><span data-ttu-id="e59c8-434">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-434">data</span></span>    </td><td><span data-ttu-id="e59c8-435">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="e59c8-435">10.1.2.7</span></span>    </td><td><span data-ttu-id="e59c8-436">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-436">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="e59c8-437">DC = WESTUS bastidor = rack2</span><span class="sxs-lookup"><span data-stu-id="e59c8-437">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="e59c8-438">Não</span><span class="sxs-lookup"><span data-stu-id="e59c8-438">No</span></span> </td></tr>
<tr><td><span data-ttu-id="e59c8-439">HK-c5--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-439">hk-c5-west-us</span></span>    </td><td><span data-ttu-id="e59c8-440">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-440">data</span></span>    </td><td><span data-ttu-id="e59c8-441">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="e59c8-441">10.1.2.8</span></span>    </td><td><span data-ttu-id="e59c8-442">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="e59c8-442">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="e59c8-443">DC = WESTUS bastidor = rack3</span><span class="sxs-lookup"><span data-stu-id="e59c8-443">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="e59c8-444">Sim</span><span class="sxs-lookup"><span data-stu-id="e59c8-444">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-445">HK-c6--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-445">hk-c6-west-us</span></span>    </td><td><span data-ttu-id="e59c8-446">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-446">data</span></span>    </td><td><span data-ttu-id="e59c8-447">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="e59c8-447">10.1.2.9</span></span>    </td><td><span data-ttu-id="e59c8-448">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="e59c8-448">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="e59c8-449">DC = WESTUS bastidor = rack3</span><span class="sxs-lookup"><span data-stu-id="e59c8-449">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="e59c8-450">Não</span><span class="sxs-lookup"><span data-stu-id="e59c8-450">No</span></span> </td></tr>
<tr><td><span data-ttu-id="e59c8-451">HK-c7--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-451">hk-c7-west-us</span></span>    </td><td><span data-ttu-id="e59c8-452">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-452">data</span></span>    </td><td><span data-ttu-id="e59c8-453">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="e59c8-453">10.1.2.10</span></span>    </td><td><span data-ttu-id="e59c8-454">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="e59c8-454">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="e59c8-455">DC = WESTUS bastidor = rack4</span><span class="sxs-lookup"><span data-stu-id="e59c8-455">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="e59c8-456">Sim</span><span class="sxs-lookup"><span data-stu-id="e59c8-456">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-457">HK-c8--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-457">hk-c8-west-us</span></span>    </td><td><span data-ttu-id="e59c8-458">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-458">data</span></span>    </td><td><span data-ttu-id="e59c8-459">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="e59c8-459">10.1.2.11</span></span>    </td><td><span data-ttu-id="e59c8-460">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="e59c8-460">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="e59c8-461">DC = WESTUS bastidor = rack4</span><span class="sxs-lookup"><span data-stu-id="e59c8-461">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="e59c8-462">Não</span><span class="sxs-lookup"><span data-stu-id="e59c8-462">No</span></span> </td></tr>
<tr><td><span data-ttu-id="e59c8-463">HK-w1--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-463">hk-w1-west-us</span></span>    </td><td><span data-ttu-id="e59c8-464">Web</span><span class="sxs-lookup"><span data-stu-id="e59c8-464">web</span></span>    </td><td><span data-ttu-id="e59c8-465">10.1.1.4</span><span class="sxs-lookup"><span data-stu-id="e59c8-465">10.1.1.4</span></span>    </td><td><span data-ttu-id="e59c8-466">HK-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-466">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="e59c8-467">N/D</span><span class="sxs-lookup"><span data-stu-id="e59c8-467">N/A</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-468">HK-w2--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-468">hk-w2-west-us</span></span>    </td><td><span data-ttu-id="e59c8-469">Web</span><span class="sxs-lookup"><span data-stu-id="e59c8-469">web</span></span>    </td><td><span data-ttu-id="e59c8-470">10.1.1.5</span><span class="sxs-lookup"><span data-stu-id="e59c8-470">10.1.1.5</span></span>    </td><td><span data-ttu-id="e59c8-471">HK-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-471">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="e59c8-472">N/D</span><span class="sxs-lookup"><span data-stu-id="e59c8-472">N/A</span></span></td></tr>
</table>

<span data-ttu-id="e59c8-473">A criação de Olá acima lista de VMs requer Olá seguinte processo:</span><span class="sxs-lookup"><span data-stu-id="e59c8-473">Creation of hello above list of VMs requires hello following process:</span></span>

1. <span data-ttu-id="e59c8-474">Criar um serviço em nuvem vazio numa região específica</span><span class="sxs-lookup"><span data-stu-id="e59c8-474">Create an empty cloud service in a particular region</span></span>
2. <span data-ttu-id="e59c8-475">Criar uma VM a partir da imagem capturada anteriormente Olá e anexe-toohello de rede virtual criada anteriormente; Repita esta para todas as VMs de Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-475">Create a VM from hello previously captured image and attach it toohello virtual network created previously; repeat this for all hello VMs</span></span>
3. <span data-ttu-id="e59c8-476">Adicionar um serviço de nuvem de toohello de Balanceador de carga interno e anexe-sub-rede toohello "dados"</span><span class="sxs-lookup"><span data-stu-id="e59c8-476">Add an internal load balancer toohello cloud service and attach it toohello “data” subnet</span></span>
4. <span data-ttu-id="e59c8-477">Para cada VM criada anteriormente, adicione um ponto de final com balanceamento de carga para tráfego de thrift através de um balanceador de carga interno com balanceamento de carga conjunto ligado toohello criado anteriormente</span><span class="sxs-lookup"><span data-stu-id="e59c8-477">For each VM created previously, add a load balanced endpoint for thrift traffic through a load balanced set connected toohello previously created internal load balancer</span></span>

<span data-ttu-id="e59c8-478">Olá acima processo pode ser executado através do portal clássico do Azure; utilizar uma máquina de Windows (utilize uma VM no Azure se não tiver máquina de Windows acesso tooa), utilize Olá seguir tooprovision de script do PowerShell todos os 8 VMs automaticamente.</span><span class="sxs-lookup"><span data-stu-id="e59c8-478">hello above process can be executed using Azure classic portal; use a Windows machine (use a VM on Azure if you don't have access tooa Windows machine), use hello following PowerShell script tooprovision all 8 VMs automatically.</span></span>

<span data-ttu-id="e59c8-479">**Lista 1: Script do PowerShell para o aprovisionamento de máquinas virtuais**</span><span class="sxs-lookup"><span data-stu-id="e59c8-479">**List 1: PowerShell script for provisioning virtual machines**</span></span>

        #Tested with Azure Powershell - November 2014
        #This powershell script deployes a number of VMs from an existing image inside an Azure region
        #Import your Azure subscription into hello current Powershell session before proceeding
        #hello process: 1. create Azure Storage account, 2. create virtual network, 3.create hello VM template, 2. crate a list of VMs from hello template

        #fundamental variables - change these tooreflect your subscription
        $country="us"; $region="west"; $vnetName = "your_vnet_name";$storageAccount="your_storage_account"
        $numVMs=8;$prefix = "hk-cass";$ilbIP="your_ilb_ip"
        $subscriptionName = "Azure_subscription_name";
        $vmSize="ExtraSmall"; $imageName="your_linux_image_name"
        $ilbName="ThriftInternalLB"; $thriftEndPoint="ThriftEndPoint"

        #generated variables
        $serviceName = "$prefix-svc-$region-$country"; $azureRegion = "$region $country"

        $vmNames = @()
        for ($i=0; $i -lt $numVMs; $i++)
        {
           $vmNames+=("$prefix-vm"+($i+1) + "-$region-$country" );
        }

        #select an Azure subscription already imported into Powershell session
        Select-AzureSubscription -SubscriptionName $subscriptionName -Current
        Set-AzureSubscription -SubscriptionName $subscriptionName -CurrentStorageAccountName $storageAccount

        #create an empty cloud service
        New-AzureService -ServiceName $serviceName -Label "hkcass$region" -Location $azureRegion
        Write-Host "Created $serviceName"

        $VMList= @()   # stores hello list of azure vm configuration objects
        #create hello list of VMs
        foreach($vmName in $vmNames)
        {
           $VMList += New-AzureVMConfig -Name $vmName -InstanceSize ExtraSmall -ImageName $imageName |
           Add-AzureProvisioningConfig -Linux -LinuxUser "localadmin" -Password "Local123" |
           Set-AzureSubnet "data"
        }

        New-AzureVM -ServiceName $serviceName -VNetName $vnetName -VMs $VMList

        #Create internal load balancer
        Add-AzureInternalLoadBalancer -ServiceName $serviceName -InternalLoadBalancerName $ilbName -SubnetName "data" -StaticVNetIPAddress "$ilbIP"
        Write-Host "Created $ilbName"
        #Add add hello thrift endpoint toohello internal load balancer for all hello VMs
        foreach($vmName in $vmNames)
        {
            Get-AzureVM -ServiceName $serviceName -Name $vmName |
                Add-AzureEndpoint -Name $thriftEndPoint -LBSetName "ThriftLBSet" -Protocol tcp -LocalPort 9160 -PublicPort 9160 -ProbePort 9160 -ProbeProtocol tcp -ProbeIntervalInSeconds 10 -InternalLoadBalancerName $ilbName |
                Update-AzureVM

            Write-Host "created $vmName"     
        }

<span data-ttu-id="e59c8-480">**Passo 3: Configurar Cassandra em cada VM**</span><span class="sxs-lookup"><span data-stu-id="e59c8-480">**Step 3: Configure Cassandra on each VM**</span></span>

<span data-ttu-id="e59c8-481">Inicie sessão no Olá VM e efetuar Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="e59c8-481">Log into hello VM and perform hello following:</span></span>

* <span data-ttu-id="e59c8-482">Edite $CASS_HOME/conf/cassandra-rackdc.properties toospecify Olá Centro e bastidor propriedades de dados:</span><span class="sxs-lookup"><span data-stu-id="e59c8-482">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties:</span></span>
  
       dc =EASTUS, rack =rack1
* <span data-ttu-id="e59c8-483">Edite nós de seed tooconfigure cassandra.yaml como abaixo:</span><span class="sxs-lookup"><span data-stu-id="e59c8-483">Edit cassandra.yaml tooconfigure seed nodes as below:</span></span>
  
       Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10"

<span data-ttu-id="e59c8-484">**Passo 4: Iniciar Olá VMs e testar cluster Olá**</span><span class="sxs-lookup"><span data-stu-id="e59c8-484">**Step 4: Start hello VMs and test hello cluster**</span></span>

<span data-ttu-id="e59c8-485">Registo num de nós de Olá (por exemplo, hk-c1--EUA oeste) e estado do comando toosee Olá do cluster de Olá Olá executar os seguintes:</span><span class="sxs-lookup"><span data-stu-id="e59c8-485">Log into one of hello nodes (e.g. hk-c1-west-us) and run hello following command toosee hello status of hello cluster:</span></span>

       nodetool –h 10.1.2.4 –p 7199 status

<span data-ttu-id="e59c8-486">Deverá ver Olá apresentar semelhante toohello um abaixo para um cluster do nó de 8:</span><span class="sxs-lookup"><span data-stu-id="e59c8-486">You should see hello display similar toohello one below for an 8-node cluster:</span></span>

<table>
<tr><th><span data-ttu-id="e59c8-487">Estado</span><span class="sxs-lookup"><span data-stu-id="e59c8-487">Status</span></span></th><th><span data-ttu-id="e59c8-488">Endereço</span><span class="sxs-lookup"><span data-stu-id="e59c8-488">Address</span></span>    </th><th><span data-ttu-id="e59c8-489">Carregar</span><span class="sxs-lookup"><span data-stu-id="e59c8-489">Load</span></span>    </th><th><span data-ttu-id="e59c8-490">Tokens</span><span class="sxs-lookup"><span data-stu-id="e59c8-490">Tokens</span></span>    </th><th><span data-ttu-id="e59c8-491">É proprietário</span><span class="sxs-lookup"><span data-stu-id="e59c8-491">Owns</span></span> </th><th><span data-ttu-id="e59c8-492">ID de anfitrião</span><span class="sxs-lookup"><span data-stu-id="e59c8-492">Host ID</span></span>    </th><th><span data-ttu-id="e59c8-493">Bastidor</span><span class="sxs-lookup"><span data-stu-id="e59c8-493">Rack</span></span></th></tr>
<tr><th><span data-ttu-id="e59c8-494">ANULAR</span><span class="sxs-lookup"><span data-stu-id="e59c8-494">UN</span></span>    </td><td><span data-ttu-id="e59c8-495">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="e59c8-495">10.1.2.4</span></span>     </td><td><span data-ttu-id="e59c8-496">87.81 KB</span><span class="sxs-lookup"><span data-stu-id="e59c8-496">87.81 KB</span></span>    </td><td><span data-ttu-id="e59c8-497">256</span><span class="sxs-lookup"><span data-stu-id="e59c8-497">256</span></span>    </td><td><span data-ttu-id="e59c8-498">38.0%</span><span class="sxs-lookup"><span data-stu-id="e59c8-498">38.0%</span></span>    </td><td><span data-ttu-id="e59c8-499">GUID (removido)</span><span class="sxs-lookup"><span data-stu-id="e59c8-499">Guid (removed)</span></span></td><td><span data-ttu-id="e59c8-500">rack1</span><span class="sxs-lookup"><span data-stu-id="e59c8-500">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="e59c8-501">ANULAR</span><span class="sxs-lookup"><span data-stu-id="e59c8-501">UN</span></span>    </td><td><span data-ttu-id="e59c8-502">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="e59c8-502">10.1.2.5</span></span>     </td><td><span data-ttu-id="e59c8-503">41.08 KB</span><span class="sxs-lookup"><span data-stu-id="e59c8-503">41.08 KB</span></span>    </td><td><span data-ttu-id="e59c8-504">256</span><span class="sxs-lookup"><span data-stu-id="e59c8-504">256</span></span>    </td><td><span data-ttu-id="e59c8-505">68.9%</span><span class="sxs-lookup"><span data-stu-id="e59c8-505">68.9%</span></span>    </td><td><span data-ttu-id="e59c8-506">GUID (removido)</span><span class="sxs-lookup"><span data-stu-id="e59c8-506">Guid (removed)</span></span></td><td><span data-ttu-id="e59c8-507">rack1</span><span class="sxs-lookup"><span data-stu-id="e59c8-507">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="e59c8-508">ANULAR</span><span class="sxs-lookup"><span data-stu-id="e59c8-508">UN</span></span>    </td><td><span data-ttu-id="e59c8-509">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="e59c8-509">10.1.2.6</span></span>     </td><td><span data-ttu-id="e59c8-510">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="e59c8-510">55.29 KB</span></span>    </td><td><span data-ttu-id="e59c8-511">256</span><span class="sxs-lookup"><span data-stu-id="e59c8-511">256</span></span>    </td><td><span data-ttu-id="e59c8-512">68.8%</span><span class="sxs-lookup"><span data-stu-id="e59c8-512">68.8%</span></span>    </td><td><span data-ttu-id="e59c8-513">GUID (removido)</span><span class="sxs-lookup"><span data-stu-id="e59c8-513">Guid (removed)</span></span></td><td><span data-ttu-id="e59c8-514">rack2</span><span class="sxs-lookup"><span data-stu-id="e59c8-514">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="e59c8-515">ANULAR</span><span class="sxs-lookup"><span data-stu-id="e59c8-515">UN</span></span>    </td><td><span data-ttu-id="e59c8-516">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="e59c8-516">10.1.2.7</span></span>     </td><td><span data-ttu-id="e59c8-517">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="e59c8-517">55.29 KB</span></span>    </td><td><span data-ttu-id="e59c8-518">256</span><span class="sxs-lookup"><span data-stu-id="e59c8-518">256</span></span>    </td><td><span data-ttu-id="e59c8-519">68.8%</span><span class="sxs-lookup"><span data-stu-id="e59c8-519">68.8%</span></span>    </td><td><span data-ttu-id="e59c8-520">GUID (removido)</span><span class="sxs-lookup"><span data-stu-id="e59c8-520">Guid (removed)</span></span></td><td><span data-ttu-id="e59c8-521">rack2</span><span class="sxs-lookup"><span data-stu-id="e59c8-521">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="e59c8-522">ANULAR</span><span class="sxs-lookup"><span data-stu-id="e59c8-522">UN</span></span>    </td><td><span data-ttu-id="e59c8-523">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="e59c8-523">10.1.2.8</span></span>     </td><td><span data-ttu-id="e59c8-524">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="e59c8-524">55.29 KB</span></span>    </td><td><span data-ttu-id="e59c8-525">256</span><span class="sxs-lookup"><span data-stu-id="e59c8-525">256</span></span>    </td><td><span data-ttu-id="e59c8-526">68.8%</span><span class="sxs-lookup"><span data-stu-id="e59c8-526">68.8%</span></span>    </td><td><span data-ttu-id="e59c8-527">GUID (removido)</span><span class="sxs-lookup"><span data-stu-id="e59c8-527">Guid (removed)</span></span></td><td><span data-ttu-id="e59c8-528">rack3</span><span class="sxs-lookup"><span data-stu-id="e59c8-528">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="e59c8-529">ANULAR</span><span class="sxs-lookup"><span data-stu-id="e59c8-529">UN</span></span>    </td><td><span data-ttu-id="e59c8-530">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="e59c8-530">10.1.2.9</span></span>     </td><td><span data-ttu-id="e59c8-531">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="e59c8-531">55.29 KB</span></span>    </td><td><span data-ttu-id="e59c8-532">256</span><span class="sxs-lookup"><span data-stu-id="e59c8-532">256</span></span>    </td><td><span data-ttu-id="e59c8-533">68.8%</span><span class="sxs-lookup"><span data-stu-id="e59c8-533">68.8%</span></span>    </td><td><span data-ttu-id="e59c8-534">GUID (removido)</span><span class="sxs-lookup"><span data-stu-id="e59c8-534">Guid (removed)</span></span></td><td><span data-ttu-id="e59c8-535">rack3</span><span class="sxs-lookup"><span data-stu-id="e59c8-535">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="e59c8-536">ANULAR</span><span class="sxs-lookup"><span data-stu-id="e59c8-536">UN</span></span>    </td><td><span data-ttu-id="e59c8-537">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="e59c8-537">10.1.2.10</span></span>     </td><td><span data-ttu-id="e59c8-538">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="e59c8-538">55.29 KB</span></span>    </td><td><span data-ttu-id="e59c8-539">256</span><span class="sxs-lookup"><span data-stu-id="e59c8-539">256</span></span>    </td><td><span data-ttu-id="e59c8-540">68.8%</span><span class="sxs-lookup"><span data-stu-id="e59c8-540">68.8%</span></span>    </td><td><span data-ttu-id="e59c8-541">GUID (removido)</span><span class="sxs-lookup"><span data-stu-id="e59c8-541">Guid (removed)</span></span></td><td><span data-ttu-id="e59c8-542">rack4</span><span class="sxs-lookup"><span data-stu-id="e59c8-542">rack4</span></span></td></tr>
<tr><th><span data-ttu-id="e59c8-543">ANULAR</span><span class="sxs-lookup"><span data-stu-id="e59c8-543">UN</span></span>    </td><td><span data-ttu-id="e59c8-544">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="e59c8-544">10.1.2.11</span></span>     </td><td><span data-ttu-id="e59c8-545">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="e59c8-545">55.29 KB</span></span>    </td><td><span data-ttu-id="e59c8-546">256</span><span class="sxs-lookup"><span data-stu-id="e59c8-546">256</span></span>    </td><td><span data-ttu-id="e59c8-547">68.8%</span><span class="sxs-lookup"><span data-stu-id="e59c8-547">68.8%</span></span>    </td><td><span data-ttu-id="e59c8-548">GUID (removido)</span><span class="sxs-lookup"><span data-stu-id="e59c8-548">Guid (removed)</span></span></td><td><span data-ttu-id="e59c8-549">rack4</span><span class="sxs-lookup"><span data-stu-id="e59c8-549">rack4</span></span></td></tr>
</table>

## <a name="test-hello-single-region-cluster"></a><span data-ttu-id="e59c8-550">Olá de teste único Cluster de região</span><span class="sxs-lookup"><span data-stu-id="e59c8-550">Test hello Single Region Cluster</span></span>
<span data-ttu-id="e59c8-551">Utilize Olá cluster de Olá tootest de passos a seguir:</span><span class="sxs-lookup"><span data-stu-id="e59c8-551">Use hello following steps tootest hello cluster:</span></span>

1. <span data-ttu-id="e59c8-552">Utilizar Olá Powershell comando Get-AzureInternalLoadbalancer commandlet, obter o endereço IP de Olá Olá interno de Balanceador de carga (por exemplo  10.1.2.101).</span><span class="sxs-lookup"><span data-stu-id="e59c8-552">Using hello Powershell command Get-AzureInternalLoadbalancer commandlet, obtain hello IP address of hello internal load balancer (e.g.  10.1.2.101).</span></span> <span data-ttu-id="e59c8-553">sintaxe de Olá do comando de Olá é mostrado abaixo: Get-AzureLoadbalancer – ServiceName "hk-c-svc--EUA Oeste" [apresenta detalhes de Olá de Balanceador de carga interno Olá, juntamente com o respetivo endereço IP]</span><span class="sxs-lookup"><span data-stu-id="e59c8-553">hello syntax of hello command is shown below: Get-AzureLoadbalancer –ServiceName "hk-c-svc-west-us” [displays hello details of hello internal load balancer along with its IP address]</span></span>
2. <span data-ttu-id="e59c8-554">Iniciar sessão no farm de web de Olá VM (por exemplo, hk-w1--EUA oeste) a utilizar o Putty ou ssh</span><span class="sxs-lookup"><span data-stu-id="e59c8-554">Log into hello web farm VM (e.g. hk-w1-west-us) using Putty or ssh</span></span>
3. <span data-ttu-id="e59c8-555">Executar $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="e59c8-555">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
4. <span data-ttu-id="e59c8-556">Utilize Olá seguir CQL comandos tooverify se cluster Olá está a funcionar:</span><span class="sxs-lookup"><span data-stu-id="e59c8-556">Use hello following CQL commands tooverify if hello cluster is working:</span></span>
   
     <span data-ttu-id="e59c8-557">Criar KEYSPACE customers_ks com replicação = {'class': 'SimpleStrategy', 'replication_factor': 3};   UTILIZAR customers_ks;   Criar tabela Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Inserir em Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   Inserir em Customers(customer_id, firstname, lastname) os valores (2, 'Joana', 'Silva');</span><span class="sxs-lookup"><span data-stu-id="e59c8-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span></span>
   
     <span data-ttu-id="e59c8-558">SELECIONAR * de clientes;</span><span class="sxs-lookup"><span data-stu-id="e59c8-558">SELECT * FROM Customers;</span></span>

<span data-ttu-id="e59c8-559">Deverá ver uma apresentação como Olá um abaixo:</span><span class="sxs-lookup"><span data-stu-id="e59c8-559">You should see a display like hello one below:</span></span>

<table>
  <tr><th> <span data-ttu-id="e59c8-560">customer_id</span><span class="sxs-lookup"><span data-stu-id="e59c8-560">customer_id</span></span> </th><th> <span data-ttu-id="e59c8-561">nome próprio</span><span class="sxs-lookup"><span data-stu-id="e59c8-561">firstname</span></span> </th><th> <span data-ttu-id="e59c8-562">Apelido</span><span class="sxs-lookup"><span data-stu-id="e59c8-562">lastname</span></span> </th></tr>
  <tr><td> <span data-ttu-id="e59c8-563">1</span><span class="sxs-lookup"><span data-stu-id="e59c8-563">1</span></span> </td><td> <span data-ttu-id="e59c8-564">João</span><span class="sxs-lookup"><span data-stu-id="e59c8-564">John</span></span> </td><td> <span data-ttu-id="e59c8-565">Silva</span><span class="sxs-lookup"><span data-stu-id="e59c8-565">Doe</span></span> </td></tr>
  <tr><td> <span data-ttu-id="e59c8-566">2</span><span class="sxs-lookup"><span data-stu-id="e59c8-566">2</span></span> </td><td> <span data-ttu-id="e59c8-567">Joana</span><span class="sxs-lookup"><span data-stu-id="e59c8-567">Jane</span></span> </td><td> <span data-ttu-id="e59c8-568">Silva</span><span class="sxs-lookup"><span data-stu-id="e59c8-568">Doe</span></span> </td></tr>
</table>

<span data-ttu-id="e59c8-569">Tenha em atenção que keyspace Olá criado no passo 4 utiliza SimpleStrategy com um replication_factor de 3.</span><span class="sxs-lookup"><span data-stu-id="e59c8-569">Please note that hello keyspace created in step 4 uses SimpleStrategy with a  replication_factor of 3.</span></span> <span data-ttu-id="e59c8-570">SimpleStrategy é recomendada para os dados únicos center implementações enquanto NetworkTopologyStrategy para dados multi center implementações.</span><span class="sxs-lookup"><span data-stu-id="e59c8-570">SimpleStrategy is recommended for single data center deployments whereas NetworkTopologyStrategy for multi-data center deployments.</span></span> <span data-ttu-id="e59c8-571">Um replication_factor de 3 proporcionará tolerância a falhas de nó.</span><span class="sxs-lookup"><span data-stu-id="e59c8-571">A replication_factor of 3 will give tolerance for node failures.</span></span>

## <span data-ttu-id="e59c8-572"><a id="tworegion"></a>Processo de implementação de Multirregião</span><span class="sxs-lookup"><span data-stu-id="e59c8-572"><a id="tworegion"> </a>Multi-Region Deployment Process</span></span>
<span data-ttu-id="e59c8-573">Irá tirar partido das foi concluída a implementação única região Olá e repita Olá mesmo processo para instalar a região segundo Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-573">Will leverage hello single region deployment completed and repeat hello same process for installing hello second region.</span></span> <span data-ttu-id="e59c8-574">diferença de chave de Olá entre Olá único e implementação de vários região é a configuração de túnel VPN Olá para comunicação entre região; Iremos começar com a instalação de rede Olá, aprovisionar Olá VMs e configurar Cassandra.</span><span class="sxs-lookup"><span data-stu-id="e59c8-574">hello key difference between hello single and multiple region deployment is hello VPN tunnel setup for inter-region communication; we will start with hello network installation, provision hello VMs and configure Cassandra.</span></span>

### <a name="step-1-create-hello-virtual-network-at-hello-2nd-region"></a><span data-ttu-id="e59c8-575">Passo 1: Criar rede Virtual de Olá Olá 2nd região</span><span class="sxs-lookup"><span data-stu-id="e59c8-575">Step 1: Create hello Virtual Network at hello 2nd Region</span></span>
<span data-ttu-id="e59c8-576">Inicie sessão no portal clássico do Azure de Olá e crie uma rede Virtual com Olá atributos Mostrar na tabela de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-576">Log into hello Azure classic portal and create a Virtual Network with hello attributes show in hello table.</span></span> <span data-ttu-id="e59c8-577">Consulte [configurar uma rede Virtual Cloud-Only no portal clássico do Azure de Olá](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) para obter passos detalhados do processo de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-577">See [Configure a Cloud-Only Virtual Network in hello Azure classic portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="e59c8-578">Nome do atributo</span><span class="sxs-lookup"><span data-stu-id="e59c8-578">Attribute Name</span></span>    </th><th><span data-ttu-id="e59c8-579">Valor</span><span class="sxs-lookup"><span data-stu-id="e59c8-579">Value</span></span>    </th><th><span data-ttu-id="e59c8-580">Observações</span><span class="sxs-lookup"><span data-stu-id="e59c8-580">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="e59c8-581">Nome</span><span class="sxs-lookup"><span data-stu-id="e59c8-581">Name</span></span>    </td><td><span data-ttu-id="e59c8-582">vnet-cass-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-582">vnet-cass-east-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="e59c8-583">Região</span><span class="sxs-lookup"><span data-stu-id="e59c8-583">Region</span></span>    </td><td><span data-ttu-id="e59c8-584">EUA Leste</span><span class="sxs-lookup"><span data-stu-id="e59c8-584">East US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="e59c8-585">Servidores DNS</span><span class="sxs-lookup"><span data-stu-id="e59c8-585">DNS Servers</span></span>        </td><td></td><td><span data-ttu-id="e59c8-586">Ignore esta indicação como podemos não estiver a utilizar um servidor DNS</span><span class="sxs-lookup"><span data-stu-id="e59c8-586">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-587">Configurar uma VPN ponto a site</span><span class="sxs-lookup"><span data-stu-id="e59c8-587">Configure a point-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="e59c8-588">Ignore esta indicação</span><span class="sxs-lookup"><span data-stu-id="e59c8-588">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-589">Configurar uma rede de VPN</span><span class="sxs-lookup"><span data-stu-id="e59c8-589">Configure a site-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="e59c8-590">Ignore esta indicação</span><span class="sxs-lookup"><span data-stu-id="e59c8-590">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-591">Espaço de endereços</span><span class="sxs-lookup"><span data-stu-id="e59c8-591">Address Space</span></span>    </td><td><span data-ttu-id="e59c8-592">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="e59c8-592">10.2.0.0/16</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="e59c8-593">IP inicial</span><span class="sxs-lookup"><span data-stu-id="e59c8-593">Starting IP</span></span>    </td><td><span data-ttu-id="e59c8-594">10.2.0.0</span><span class="sxs-lookup"><span data-stu-id="e59c8-594">10.2.0.0</span></span>    </td><td></td></tr>
<tr><td><span data-ttu-id="e59c8-595">CIDR</span><span class="sxs-lookup"><span data-stu-id="e59c8-595">CIDR</span></span>    </td><td><span data-ttu-id="e59c8-596">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="e59c8-596">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="e59c8-597">Adicione Olá seguintes sub-redes:</span><span class="sxs-lookup"><span data-stu-id="e59c8-597">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="e59c8-598">Nome</span><span class="sxs-lookup"><span data-stu-id="e59c8-598">Name</span></span>    </th><th><span data-ttu-id="e59c8-599">IP inicial</span><span class="sxs-lookup"><span data-stu-id="e59c8-599">Starting IP</span></span>    </th><th><span data-ttu-id="e59c8-600">CIDR</span><span class="sxs-lookup"><span data-stu-id="e59c8-600">CIDR</span></span>    </th><th><span data-ttu-id="e59c8-601">Observações</span><span class="sxs-lookup"><span data-stu-id="e59c8-601">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="e59c8-602">Web</span><span class="sxs-lookup"><span data-stu-id="e59c8-602">web</span></span>    </td><td><span data-ttu-id="e59c8-603">10.2.1.0</span><span class="sxs-lookup"><span data-stu-id="e59c8-603">10.2.1.0</span></span>    </td><td><span data-ttu-id="e59c8-604">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="e59c8-604">/24 (251)</span></span>    </td><td><span data-ttu-id="e59c8-605">Sub-rede para a web farm do Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-605">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-606">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-606">data</span></span>    </td><td><span data-ttu-id="e59c8-607">10.2.2.0</span><span class="sxs-lookup"><span data-stu-id="e59c8-607">10.2.2.0</span></span>    </td><td><span data-ttu-id="e59c8-608">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="e59c8-608">/24 (251)</span></span>    </td><td><span data-ttu-id="e59c8-609">Sub-rede para nós de base de dados de Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-609">Subnet for hello database nodes</span></span></td></tr>
</table>


### <a name="step-2-create-local-networks"></a><span data-ttu-id="e59c8-610">Passo 2: Criar redes locais</span><span class="sxs-lookup"><span data-stu-id="e59c8-610">Step 2: Create Local Networks</span></span>
<span data-ttu-id="e59c8-611">Uma rede Local na rede virtual do Azure é um espaço de endereços de proxy que mapeie tooa site remoto, incluindo uma nuvem privada ou outra região do Azure.</span><span class="sxs-lookup"><span data-stu-id="e59c8-611">A Local Network in Azure virtual networking is a proxy address space that maps tooa remote site including a private cloud or another Azure region.</span></span> <span data-ttu-id="e59c8-612">Este espaço de endereços de proxy é vinculado tooa gateway remoto para o encaminhamento de rede de toohello destinos de rede à direita.</span><span class="sxs-lookup"><span data-stu-id="e59c8-612">This proxy address space is bound tooa remote gateway for routing network toohello right networking destinations.</span></span> <span data-ttu-id="e59c8-613">Consulte [configurar uma ligação de tooVNet VNet](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) para Olá obter instruções sobre como estabelecer a ligação VNET a VNET.</span><span class="sxs-lookup"><span data-stu-id="e59c8-613">See [Configure a VNet tooVNet Connection](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) for hello instructions on establishing VNET-to-VNET connection.</span></span>

<span data-ttu-id="e59c8-614">Crie duas redes locais por Olá os detalhes:</span><span class="sxs-lookup"><span data-stu-id="e59c8-614">Create two local networks per hello following details:</span></span>

| <span data-ttu-id="e59c8-615">Nome da rede</span><span class="sxs-lookup"><span data-stu-id="e59c8-615">Network Name</span></span> | <span data-ttu-id="e59c8-616">Endereço de Gateway VPN</span><span class="sxs-lookup"><span data-stu-id="e59c8-616">VPN Gateway Address</span></span> | <span data-ttu-id="e59c8-617">Espaço de endereços</span><span class="sxs-lookup"><span data-stu-id="e59c8-617">Address Space</span></span> | <span data-ttu-id="e59c8-618">Observações</span><span class="sxs-lookup"><span data-stu-id="e59c8-618">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="e59c8-619">HK-lnet-Map-to-East-US</span><span class="sxs-lookup"><span data-stu-id="e59c8-619">hk-lnet-map-to-east-us</span></span> |<span data-ttu-id="e59c8-620">23.1.1.1</span><span class="sxs-lookup"><span data-stu-id="e59c8-620">23.1.1.1</span></span> |<span data-ttu-id="e59c8-621">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="e59c8-621">10.2.0.0/16</span></span> |<span data-ttu-id="e59c8-622">Ao criar Olá rede Local dar um marcador de posição endereço de gateway.</span><span class="sxs-lookup"><span data-stu-id="e59c8-622">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="e59c8-623">endereço de real gateway Olá é preenchido quando for criado o gateway de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-623">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="e59c8-624">Certifique-se de espaço de endereços de Olá corresponde exatamente ao hello respetiva VNET remota; Neste caso, hello VNET criada no Olá região EUA Leste.</span><span class="sxs-lookup"><span data-stu-id="e59c8-624">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello East US region.</span></span> |
| <span data-ttu-id="e59c8-625">HK-lnet-Map-to-West-US</span><span class="sxs-lookup"><span data-stu-id="e59c8-625">hk-lnet-map-to-west-us</span></span> |<span data-ttu-id="e59c8-626">23.2.2.2</span><span class="sxs-lookup"><span data-stu-id="e59c8-626">23.2.2.2</span></span> |<span data-ttu-id="e59c8-627">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="e59c8-627">10.1.0.0/16</span></span> |<span data-ttu-id="e59c8-628">Ao criar Olá rede Local dar um marcador de posição endereço de gateway.</span><span class="sxs-lookup"><span data-stu-id="e59c8-628">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="e59c8-629">endereço de real gateway Olá é preenchido quando for criado o gateway de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-629">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="e59c8-630">Certifique-se de espaço de endereços de Olá corresponde exatamente ao hello respetiva VNET remota; Neste caso, hello VNET criada no Olá região EUA oeste.</span><span class="sxs-lookup"><span data-stu-id="e59c8-630">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello West US region.</span></span> |

### <a name="step-3-map-local-network-toohello-respective-vnets"></a><span data-ttu-id="e59c8-631">Passo 3: Mapa "Local" rede toohello respetivas VNETs</span><span class="sxs-lookup"><span data-stu-id="e59c8-631">Step 3: Map “Local” network toohello respective VNETs</span></span>
<span data-ttu-id="e59c8-632">De Olá portal clássico do Azure, selecione cada vnet, clique em "Configurar", consulte "Ligar toohello rede local" e selecione Olá redes locais por Olá os detalhes:</span><span class="sxs-lookup"><span data-stu-id="e59c8-632">From hello Azure classic portal, select each vnet, click “Configure”, check “Connect toohello local network”, and select hello Local Networks per hello following details:</span></span>

| <span data-ttu-id="e59c8-633">Rede Virtual</span><span class="sxs-lookup"><span data-stu-id="e59c8-633">Virtual Network</span></span> | <span data-ttu-id="e59c8-634">Rede local</span><span class="sxs-lookup"><span data-stu-id="e59c8-634">Local Network</span></span> |
| --- | --- |
| <span data-ttu-id="e59c8-635">HK-vnet--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-635">hk-vnet-west-us</span></span> |<span data-ttu-id="e59c8-636">HK-lnet-Map-to-East-US</span><span class="sxs-lookup"><span data-stu-id="e59c8-636">hk-lnet-map-to-east-us</span></span> |
| <span data-ttu-id="e59c8-637">HK-vnet-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-637">hk-vnet-east-us</span></span> |<span data-ttu-id="e59c8-638">HK-lnet-Map-to-West-US</span><span class="sxs-lookup"><span data-stu-id="e59c8-638">hk-lnet-map-to-west-us</span></span> |

### <a name="step-4-create-gateways-on-vnet1-and-vnet2"></a><span data-ttu-id="e59c8-639">Passo 4: Criar Gateways no VNET1 e VNET2</span><span class="sxs-lookup"><span data-stu-id="e59c8-639">Step 4: Create Gateways on VNET1 and VNET2</span></span>
<span data-ttu-id="e59c8-640">A partir do dashboard de Olá de ambas as redes virtuais Olá, clique em criar GATEWAY que activarão o gateway de VPN de Olá processo de aprovisionamento.</span><span class="sxs-lookup"><span data-stu-id="e59c8-640">From hello dashboard of both hello virtual networks, click CREATE GATEWAY which will trigger hello VPN gateway provisioning process.</span></span> <span data-ttu-id="e59c8-641">Após alguns minutos Olá dashboard de cada rede virtual deve apresentar o endereço de gateway real Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-641">After a few minutes hello dashboard of each virtual network should display hello actual gateway address.</span></span>

### <a name="step-5-update-local-networks-with-hello-respective-gateway-addresses"></a><span data-ttu-id="e59c8-642">Passo 5: Redes de "Local" de atualização com endereços de respetivos "Gateway" Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-642">Step 5: Update “Local” networks with hello respective “Gateway” addresses</span></span>
<span data-ttu-id="e59c8-643">Edite os dois Olá redes locais tooreplace Olá marcador de posição gateway IP endereço com o endereço IP real Olá de Olá apenas aprovisionado gateways.</span><span class="sxs-lookup"><span data-stu-id="e59c8-643">Edit both hello local networks tooreplace hello placeholder gateway IP address with hello real IP address of hello just provisioned gateways.</span></span> <span data-ttu-id="e59c8-644">Utilize Olá mapeamento os seguintes:</span><span class="sxs-lookup"><span data-stu-id="e59c8-644">Use hello following mapping:</span></span>

<table>
<tr><th><span data-ttu-id="e59c8-645">Rede local</span><span class="sxs-lookup"><span data-stu-id="e59c8-645">Local Network</span></span>    </th><th><span data-ttu-id="e59c8-646">Gateway de Rede Virtual</span><span class="sxs-lookup"><span data-stu-id="e59c8-646">Virtual Network Gateway</span></span></th></tr>
<tr><td><span data-ttu-id="e59c8-647">HK-lnet-Map-to-East-US</span><span class="sxs-lookup"><span data-stu-id="e59c8-647">hk-lnet-map-to-east-us</span></span> </td><td><span data-ttu-id="e59c8-648">Gateway de hk-vnet--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-648">Gateway of hk-vnet-west-us</span></span></td></tr>
<tr><td><span data-ttu-id="e59c8-649">HK-lnet-Map-to-West-US</span><span class="sxs-lookup"><span data-stu-id="e59c8-649">hk-lnet-map-to-west-us</span></span> </td><td><span data-ttu-id="e59c8-650">Gateway de hk-vnet-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-650">Gateway of hk-vnet-east-us</span></span></td></tr>
</table>

### <a name="step-6-update-hello-shared-key"></a><span data-ttu-id="e59c8-651">Passo 6: Atualizar a chave partilhada Olá</span><span class="sxs-lookup"><span data-stu-id="e59c8-651">Step 6: Update hello shared key</span></span>
<span data-ttu-id="e59c8-652">Olá utilize a seguinte chave de IPSec do Powershell script tooupdate Olá de cada gateway VPN [Utilize Olá sake chave para ambas as gateways Olá]: hk-lnet-map-to-west-us de - LocalNetworkSiteName do conjunto AzureVNetGatewayKey - VNetName hk-vnet-Leste-nos - SharedKey D9E76BKK Conjunto AzureVNetGatewayKey - VNetName hk-vnet--EUA oeste - LocalNetworkSiteName hk-lnet-map-to-east-us - SharedKey D9E76BKK</span><span class="sxs-lookup"><span data-stu-id="e59c8-652">Use hello following Powershell script tooupdate hello IPSec key of each VPN gateway [use hello sake key for both hello gateways]: Set-AzureVNetGatewayKey -VNetName hk-vnet-east-us -LocalNetworkSiteName hk-lnet-map-to-west-us -SharedKey D9E76BKK Set-AzureVNetGatewayKey -VNetName hk-vnet-west-us -LocalNetworkSiteName hk-lnet-map-to-east-us -SharedKey D9E76BKK</span></span>

### <a name="step-7-establish-hello-vnet-to-vnet-connection"></a><span data-ttu-id="e59c8-653">Passo 7: Estabelecer a ligação de Olá VNET a VNET</span><span class="sxs-lookup"><span data-stu-id="e59c8-653">Step 7: Establish hello VNET-to-VNET connection</span></span>
<span data-ttu-id="e59c8-654">A partir de Olá portal clássico do Azure, utilize o menu de "DASHBOARD" Olá da ligação de gateway a gateway ambas Olá redes virtuais tooestablish.</span><span class="sxs-lookup"><span data-stu-id="e59c8-654">From hello Azure classic portal, use hello “DASHBOARD” menu of both hello virtual networks tooestablish gateway-to-gateway connection.</span></span> <span data-ttu-id="e59c8-655">Utilize itens de menu "Ligar" Olá na barra de ferramentas do Olá inferior.</span><span class="sxs-lookup"><span data-stu-id="e59c8-655">Use hello “CONNECT” menu items in hello bottom toolbar.</span></span> <span data-ttu-id="e59c8-656">Após alguns minutos dashboard Olá deve apresentar detalhes de ligação de Olá graficamente.</span><span class="sxs-lookup"><span data-stu-id="e59c8-656">After a few minutes hello dashboard should display hello connection details graphically.</span></span>

### <a name="step-8-create-hello-virtual-machines-in-region-2"></a><span data-ttu-id="e59c8-657">Passo 8: Criar máquinas virtuais Olá na região #2</span><span class="sxs-lookup"><span data-stu-id="e59c8-657">Step 8: Create hello virtual machines in region #2</span></span>
<span data-ttu-id="e59c8-658">Criar imagem de Ubuntu Olá, conforme descrito na implementação de região #1 pelo seguinte Olá mesmos passos ou copie Olá imagem VHD ficheiro toohello conta de armazenamento Azure localizada numa região #2 e criar Olá imagem.</span><span class="sxs-lookup"><span data-stu-id="e59c8-658">Create hello Ubuntu image as described in region #1 deployment by following hello same steps or copy hello image VHD file toohello Azure storage account located in region #2 and create hello image.</span></span> <span data-ttu-id="e59c8-659">Utilizar esta imagem e crie Olá seguinte lista de máquinas virtuais para um novo serviço em nuvem hk-c-svc-leste--na:</span><span class="sxs-lookup"><span data-stu-id="e59c8-659">Use this image and create hello following list of virtual machines into a new cloud service hk-c-svc-east-us:</span></span>

| <span data-ttu-id="e59c8-660">Nome do computador</span><span class="sxs-lookup"><span data-stu-id="e59c8-660">Machine Name</span></span> | <span data-ttu-id="e59c8-661">Subrede</span><span class="sxs-lookup"><span data-stu-id="e59c8-661">Subnet</span></span> | <span data-ttu-id="e59c8-662">Endereço IP</span><span class="sxs-lookup"><span data-stu-id="e59c8-662">IP Address</span></span> | <span data-ttu-id="e59c8-663">Conjunto de disponibilidade</span><span class="sxs-lookup"><span data-stu-id="e59c8-663">Availability set</span></span> | <span data-ttu-id="e59c8-664">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="e59c8-664">DC/Rack</span></span> | <span data-ttu-id="e59c8-665">Seed?</span><span class="sxs-lookup"><span data-stu-id="e59c8-665">Seed?</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="e59c8-666">HK-c1-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-666">hk-c1-east-us</span></span> |<span data-ttu-id="e59c8-667">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-667">data</span></span> |<span data-ttu-id="e59c8-668">10.2.2.4</span><span class="sxs-lookup"><span data-stu-id="e59c8-668">10.2.2.4</span></span> |<span data-ttu-id="e59c8-669">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-669">hk-c-aset-1</span></span> |<span data-ttu-id="e59c8-670">DC = EASTUS bastidor = rack1</span><span class="sxs-lookup"><span data-stu-id="e59c8-670">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="e59c8-671">Sim</span><span class="sxs-lookup"><span data-stu-id="e59c8-671">Yes</span></span> |
| <span data-ttu-id="e59c8-672">HK-c2-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-672">hk-c2-east-us</span></span> |<span data-ttu-id="e59c8-673">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-673">data</span></span> |<span data-ttu-id="e59c8-674">10.2.2.5</span><span class="sxs-lookup"><span data-stu-id="e59c8-674">10.2.2.5</span></span> |<span data-ttu-id="e59c8-675">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-675">hk-c-aset-1</span></span> |<span data-ttu-id="e59c8-676">DC = EASTUS bastidor = rack1</span><span class="sxs-lookup"><span data-stu-id="e59c8-676">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="e59c8-677">Não</span><span class="sxs-lookup"><span data-stu-id="e59c8-677">No</span></span> |
| <span data-ttu-id="e59c8-678">HK-c3-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-678">hk-c3-east-us</span></span> |<span data-ttu-id="e59c8-679">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-679">data</span></span> |<span data-ttu-id="e59c8-680">10.2.2.6</span><span class="sxs-lookup"><span data-stu-id="e59c8-680">10.2.2.6</span></span> |<span data-ttu-id="e59c8-681">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-681">hk-c-aset-1</span></span> |<span data-ttu-id="e59c8-682">DC = EASTUS bastidor = rack2</span><span class="sxs-lookup"><span data-stu-id="e59c8-682">dc =EASTUS rack =rack2</span></span> |<span data-ttu-id="e59c8-683">Sim</span><span class="sxs-lookup"><span data-stu-id="e59c8-683">Yes</span></span> |
| <span data-ttu-id="e59c8-684">HK-c5-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-684">hk-c5-east-us</span></span> |<span data-ttu-id="e59c8-685">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-685">data</span></span> |<span data-ttu-id="e59c8-686">10.2.2.8</span><span class="sxs-lookup"><span data-stu-id="e59c8-686">10.2.2.8</span></span> |<span data-ttu-id="e59c8-687">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="e59c8-687">hk-c-aset-2</span></span> |<span data-ttu-id="e59c8-688">DC = EASTUS bastidor = rack3</span><span class="sxs-lookup"><span data-stu-id="e59c8-688">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="e59c8-689">Sim</span><span class="sxs-lookup"><span data-stu-id="e59c8-689">Yes</span></span> |
| <span data-ttu-id="e59c8-690">HK-c6-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-690">hk-c6-east-us</span></span> |<span data-ttu-id="e59c8-691">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-691">data</span></span> |<span data-ttu-id="e59c8-692">10.2.2.9</span><span class="sxs-lookup"><span data-stu-id="e59c8-692">10.2.2.9</span></span> |<span data-ttu-id="e59c8-693">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="e59c8-693">hk-c-aset-2</span></span> |<span data-ttu-id="e59c8-694">DC = EASTUS bastidor = rack3</span><span class="sxs-lookup"><span data-stu-id="e59c8-694">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="e59c8-695">Não</span><span class="sxs-lookup"><span data-stu-id="e59c8-695">No</span></span> |
| <span data-ttu-id="e59c8-696">HK-c7-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-696">hk-c7-east-us</span></span> |<span data-ttu-id="e59c8-697">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-697">data</span></span> |<span data-ttu-id="e59c8-698">10.2.2.10</span><span class="sxs-lookup"><span data-stu-id="e59c8-698">10.2.2.10</span></span> |<span data-ttu-id="e59c8-699">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="e59c8-699">hk-c-aset-2</span></span> |<span data-ttu-id="e59c8-700">DC = EASTUS bastidor = rack4</span><span class="sxs-lookup"><span data-stu-id="e59c8-700">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="e59c8-701">Sim</span><span class="sxs-lookup"><span data-stu-id="e59c8-701">Yes</span></span> |
| <span data-ttu-id="e59c8-702">HK-c8-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-702">hk-c8-east-us</span></span> |<span data-ttu-id="e59c8-703">dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-703">data</span></span> |<span data-ttu-id="e59c8-704">10.2.2.11</span><span class="sxs-lookup"><span data-stu-id="e59c8-704">10.2.2.11</span></span> |<span data-ttu-id="e59c8-705">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="e59c8-705">hk-c-aset-2</span></span> |<span data-ttu-id="e59c8-706">DC = EASTUS bastidor = rack4</span><span class="sxs-lookup"><span data-stu-id="e59c8-706">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="e59c8-707">Não</span><span class="sxs-lookup"><span data-stu-id="e59c8-707">No</span></span> |
| <span data-ttu-id="e59c8-708">HK-w1-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-708">hk-w1-east-us</span></span> |<span data-ttu-id="e59c8-709">Web</span><span class="sxs-lookup"><span data-stu-id="e59c8-709">web</span></span> |<span data-ttu-id="e59c8-710">10.2.1.4</span><span class="sxs-lookup"><span data-stu-id="e59c8-710">10.2.1.4</span></span> |<span data-ttu-id="e59c8-711">HK-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-711">hk-w-aset-1</span></span> |<span data-ttu-id="e59c8-712">N/D</span><span class="sxs-lookup"><span data-stu-id="e59c8-712">N/A</span></span> |<span data-ttu-id="e59c8-713">N/D</span><span class="sxs-lookup"><span data-stu-id="e59c8-713">N/A</span></span> |
| <span data-ttu-id="e59c8-714">HK-w2-Leste-nos</span><span class="sxs-lookup"><span data-stu-id="e59c8-714">hk-w2-east-us</span></span> |<span data-ttu-id="e59c8-715">Web</span><span class="sxs-lookup"><span data-stu-id="e59c8-715">web</span></span> |<span data-ttu-id="e59c8-716">10.2.1.5</span><span class="sxs-lookup"><span data-stu-id="e59c8-716">10.2.1.5</span></span> |<span data-ttu-id="e59c8-717">HK-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="e59c8-717">hk-w-aset-1</span></span> |<span data-ttu-id="e59c8-718">N/D</span><span class="sxs-lookup"><span data-stu-id="e59c8-718">N/A</span></span> |<span data-ttu-id="e59c8-719">N/D</span><span class="sxs-lookup"><span data-stu-id="e59c8-719">N/A</span></span> |

<span data-ttu-id="e59c8-720">Siga Olá mesmo instruções como região #1, mas utilizam o espaço de endereços 10.2.xxx.xxx.</span><span class="sxs-lookup"><span data-stu-id="e59c8-720">Follow hello same instructions as region #1 but use 10.2.xxx.xxx address space.</span></span>

### <a name="step-9-configure-cassandra-on-each-vm"></a><span data-ttu-id="e59c8-721">Passo 9: Configurar Cassandra em cada VM</span><span class="sxs-lookup"><span data-stu-id="e59c8-721">Step 9: Configure Cassandra on each VM</span></span>
<span data-ttu-id="e59c8-722">Inicie sessão no Olá VM e efetuar Olá seguinte:</span><span class="sxs-lookup"><span data-stu-id="e59c8-722">Log into hello VM and perform hello following:</span></span>

1. <span data-ttu-id="e59c8-723">Editar $CASS_HOME/conf/cassandra-rackdc.properties toospecify Olá dados Centro e bastidor propriedades no formato de Olá: dc = EASTUS bastidor = rack1</span><span class="sxs-lookup"><span data-stu-id="e59c8-723">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties in hello format:  dc =EASTUS  rack =rack1</span></span>
2. <span data-ttu-id="e59c8-724">Editar cassandra.yaml tooconfigure seed nós: Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span><span class="sxs-lookup"><span data-stu-id="e59c8-724">Edit cassandra.yaml tooconfigure seed nodes:  Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span></span>

### <a name="step-10-start-cassandra"></a><span data-ttu-id="e59c8-725">Passo 10: Iniciar Cassandra</span><span class="sxs-lookup"><span data-stu-id="e59c8-725">Step 10: Start Cassandra</span></span>
<span data-ttu-id="e59c8-726">Inicie sessão em cada VM e inicie Cassandra em segundo plano de Olá executando Olá os seguintes comandos: $CASS_HOME/bin/cassandra</span><span class="sxs-lookup"><span data-stu-id="e59c8-726">Log into each VM and start Cassandra in hello background by running hello following command: $CASS_HOME/bin/cassandra</span></span>

## <a name="test-hello-multi-region-cluster"></a><span data-ttu-id="e59c8-727">Olá teste Multirregião Cluster</span><span class="sxs-lookup"><span data-stu-id="e59c8-727">Test hello Multi-Region Cluster</span></span>
<span data-ttu-id="e59c8-728">Por agora Cassandra foi implementado too16 nós com 8 nós em cada região do Azure.</span><span class="sxs-lookup"><span data-stu-id="e59c8-728">By now Cassandra has been deployed too16 nodes with 8 nodes in each Azure region.</span></span> <span data-ttu-id="e59c8-729">Estes nós estão no mesmo cluster em virtude de nome de cluster comum Olá e a configuração de nó de seed Olá de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-729">These nodes are in hello same cluster by virtue of hello common cluster name and hello seed node configuration.</span></span> <span data-ttu-id="e59c8-730">Utilize Olá cluster do processo tootest Olá os seguintes:</span><span class="sxs-lookup"><span data-stu-id="e59c8-730">Use hello following process tootest hello cluster:</span></span>

### <a name="step-1-get-hello-internal-load-balancer-ip-for-both-hello-regions-using-powershell"></a><span data-ttu-id="e59c8-731">Passo 1: Obter o IP de Balanceador de carga interno Olá para ambas as regiões de Olá através do PowerShell</span><span class="sxs-lookup"><span data-stu-id="e59c8-731">Step 1: Get hello internal load balancer IP for both hello regions using PowerShell</span></span>
* <span data-ttu-id="e59c8-732">Get-AzureInternalLoadbalancer - ServiceName "hk-c-svc--EUA Oeste"</span><span class="sxs-lookup"><span data-stu-id="e59c8-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span></span>
* <span data-ttu-id="e59c8-733">Get-AzureInternalLoadbalancer - ServiceName "hk-c-svc-Leste-us"</span><span class="sxs-lookup"><span data-stu-id="e59c8-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span></span>  
  
    <span data-ttu-id="e59c8-734">Tenha em atenção endereços IP Olá (por exemplo, oeste - 10.1.2.101 Leste - 10.2.2.101) apresentado.</span><span class="sxs-lookup"><span data-stu-id="e59c8-734">Note hello IP addresses (e.g. west - 10.1.2.101, east - 10.2.2.101) displayed.</span></span>

### <a name="step-2-execute-hello-following-in-hello-west-region-after-logging-into-hk-w1-west-us"></a><span data-ttu-id="e59c8-735">Passo 2: Executar seguinte Olá na região de oeste Olá depois de iniciar sessão em hk-w1--EUA oeste</span><span class="sxs-lookup"><span data-stu-id="e59c8-735">Step 2: Execute hello following in hello west region after logging into hk-w1-west-us</span></span>
1. <span data-ttu-id="e59c8-736">Executar $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="e59c8-736">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
2. <span data-ttu-id="e59c8-737">Execute os seguintes comandos CQL de Olá:</span><span class="sxs-lookup"><span data-stu-id="e59c8-737">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="e59c8-738">Criar KEYSPACE customers_ks com replicação = {'class': 'NetworkToplogyStrategy', 'WESTUS': 3, 'EASTUS': 3};   UTILIZAR customers_ks;   Criar tabela Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Inserir em Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   Inserir em Customers(customer_id, firstname, lastname) os valores (2, 'Joana', 'Silva');   SELECIONAR * de clientes;</span><span class="sxs-lookup"><span data-stu-id="e59c8-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="e59c8-739">Deverá ver uma apresentação como Olá um abaixo:</span><span class="sxs-lookup"><span data-stu-id="e59c8-739">You should see a display like hello one below:</span></span>

| <span data-ttu-id="e59c8-740">customer_id</span><span class="sxs-lookup"><span data-stu-id="e59c8-740">customer_id</span></span> | <span data-ttu-id="e59c8-741">nome próprio</span><span class="sxs-lookup"><span data-stu-id="e59c8-741">firstname</span></span> | <span data-ttu-id="e59c8-742">Apelido</span><span class="sxs-lookup"><span data-stu-id="e59c8-742">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e59c8-743">1</span><span class="sxs-lookup"><span data-stu-id="e59c8-743">1</span></span> |<span data-ttu-id="e59c8-744">João</span><span class="sxs-lookup"><span data-stu-id="e59c8-744">John</span></span> |<span data-ttu-id="e59c8-745">Silva</span><span class="sxs-lookup"><span data-stu-id="e59c8-745">Doe</span></span> |
| <span data-ttu-id="e59c8-746">2</span><span class="sxs-lookup"><span data-stu-id="e59c8-746">2</span></span> |<span data-ttu-id="e59c8-747">Joana</span><span class="sxs-lookup"><span data-stu-id="e59c8-747">Jane</span></span> |<span data-ttu-id="e59c8-748">Silva</span><span class="sxs-lookup"><span data-stu-id="e59c8-748">Doe</span></span> |

### <a name="step-3-execute-hello-following-in-hello-east-region-after-logging-into-hk-w1-east-us"></a><span data-ttu-id="e59c8-749">Passo 3: Execute o seguinte Olá na região de Leste Olá depois de iniciar sessão em hk-w1-leste--na:</span><span class="sxs-lookup"><span data-stu-id="e59c8-749">Step 3: Execute hello following in hello east region after logging into hk-w1-east-us:</span></span>
1. <span data-ttu-id="e59c8-750">Executar $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="e59c8-750">Execute $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span></span>
2. <span data-ttu-id="e59c8-751">Execute os seguintes comandos CQL de Olá:</span><span class="sxs-lookup"><span data-stu-id="e59c8-751">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="e59c8-752">UTILIZAR customers_ks;   Criar tabela Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Inserir em Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   Inserir em Customers(customer_id, firstname, lastname) os valores (2, 'Joana', 'Silva');   SELECIONAR * de clientes;</span><span class="sxs-lookup"><span data-stu-id="e59c8-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="e59c8-753">Deverá ver Olá mesmo apresentar visto região de oeste Olá:</span><span class="sxs-lookup"><span data-stu-id="e59c8-753">You should see hello same display as seen for hello West region:</span></span>

| <span data-ttu-id="e59c8-754">customer_id</span><span class="sxs-lookup"><span data-stu-id="e59c8-754">customer_id</span></span> | <span data-ttu-id="e59c8-755">nome próprio</span><span class="sxs-lookup"><span data-stu-id="e59c8-755">firstname</span></span> | <span data-ttu-id="e59c8-756">Apelido</span><span class="sxs-lookup"><span data-stu-id="e59c8-756">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e59c8-757">1</span><span class="sxs-lookup"><span data-stu-id="e59c8-757">1</span></span> |<span data-ttu-id="e59c8-758">João</span><span class="sxs-lookup"><span data-stu-id="e59c8-758">John</span></span> |<span data-ttu-id="e59c8-759">Silva</span><span class="sxs-lookup"><span data-stu-id="e59c8-759">Doe</span></span> |
| <span data-ttu-id="e59c8-760">2</span><span class="sxs-lookup"><span data-stu-id="e59c8-760">2</span></span> |<span data-ttu-id="e59c8-761">Joana</span><span class="sxs-lookup"><span data-stu-id="e59c8-761">Jane</span></span> |<span data-ttu-id="e59c8-762">Silva</span><span class="sxs-lookup"><span data-stu-id="e59c8-762">Doe</span></span> |

<span data-ttu-id="e59c8-763">Executar alguns inserções mais e ver que os obter toowest replicada-na parte do cluster de Olá.</span><span class="sxs-lookup"><span data-stu-id="e59c8-763">Execute a few more inserts and see that those get replicated toowest-us part of hello cluster.</span></span>

## <a name="test-cassandra-cluster-from-nodejs"></a><span data-ttu-id="e59c8-764">Cluster de Cassandra de teste do Node.js</span><span class="sxs-lookup"><span data-stu-id="e59c8-764">Test Cassandra Cluster from Node.js</span></span>
<span data-ttu-id="e59c8-765">Utilizar uma das VMs do Linux Olá criado anteriormente na camada de "web" Olá, iremos irá executar um simples Node.js script tooread Olá anteriormente inserida de dados</span><span class="sxs-lookup"><span data-stu-id="e59c8-765">Using one of hello Linux VMs crated in hello "web" tier previously, we will execute a simple Node.js script tooread hello previously inserted data</span></span>

<span data-ttu-id="e59c8-766">**Passo 1: Instalar o Node.js e Cassandra cliente**</span><span class="sxs-lookup"><span data-stu-id="e59c8-766">**Step 1: Install Node.js and Cassandra Client**</span></span>

1. <span data-ttu-id="e59c8-767">Instalar Node.js e npm</span><span class="sxs-lookup"><span data-stu-id="e59c8-767">Install Node.js and npm</span></span>
2. <span data-ttu-id="e59c8-768">Instalar o pacote "cassandra-cliente de nó" utilizando npm</span><span class="sxs-lookup"><span data-stu-id="e59c8-768">Install node package "cassandra-client" using npm</span></span>
3. <span data-ttu-id="e59c8-769">Execute o seguinte script na linha de comandos do shell Olá que apresenta a cadeia de json Olá de Olá obtida dados de Olá:</span><span class="sxs-lookup"><span data-stu-id="e59c8-769">Execute hello following script at hello shell prompt which displays hello json string of hello retrieved data:</span></span>
   
        var pooledCon = require('cassandra-client').PooledConnection;
        var ksName = "custsupport_ks";
        var cfName = "customers_cf";
        var hostList = ['internal_loadbalancer_ip:9160'];
        var ksConOptions = { hosts: hostList,
                             keyspace: ksName, use_bigints: false };
   
        function createKeyspace(callback){
           var cql = 'CREATE KEYSPACE ' + ksName + ' WITH strategy_class=SimpleStrategy AND strategy_options:replication_factor=1';
           var sysConOptions = { hosts: hostList,  
                                 keyspace: 'system', use_bigints: false };
           var con = new pooledCon(sysConOptions);
           con.execute(cql,[],function(err) {
           if (err) {
             console.log("Failed toocreate Keyspace: " + ksName);
             console.log(err);
           }
           else {
             console.log("Created Keyspace: " + ksName);
             callback(ksConOptions, populateCustomerData);
           }
           });
           con.shutdown();
        }
   
        function createColumnFamily(ksConOptions, callback){
          var params = ['customers_cf','custid','varint','custname',
                        'text','custaddress','text'];
          var cql = 'CREATE COLUMNFAMILY ? (? ? PRIMARY KEY,? ?, ? ?)';
        var con =  new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) {
                 console.log("Failed toocreate column family: " + params[0]);
                 console.log(err);
              }
              else {
                 console.log("Created column family: " + params[0]);
                 callback();
              }
          });
          con.shutdown();
        }
   
        //populate Data
        function populateCustomerData() {
           var params = ['John','Infinity Dr, TX', 1];
           updateCustomer(ksConOptions,params);
   
           params = ['Tom','Fermat Ln, WA', 2];
           updateCustomer(ksConOptions,params);
        }
   
        //update will also insert hello record if none exists
        function updateCustomer(ksConOptions,params)
        {
          var cql = 'UPDATE customers_cf SET custname=?,custaddress=? where custid=?';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) console.log(err);
              else console.log("Inserted customer : " + params[0]);
          });
          con.shutdown();
        }
   
        //read hello two rows inserted above
        function readCustomer(ksConOptions)
        {
          var cql = 'SELECT * FROM customers_cf WHERE custid IN (1,2)';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,[],function(err,rows) {
              if (err)
                 console.log(err);
              else
                 for (var i=0; i<rows.length; i++)
                    console.log(JSON.stringify(rows[i]));
            });
           con.shutdown();
        }
   
        //exectue hello code
        createKeyspace(createColumnFamily);
        readCustomer(ksConOptions)

## <a name="conclusion"></a><span data-ttu-id="e59c8-770">Conclusão</span><span class="sxs-lookup"><span data-stu-id="e59c8-770">Conclusion</span></span>
<span data-ttu-id="e59c8-771">Microsoft Azure é uma plataforma flexível que permite a execução de Olá de ambos Microsoft, bem como o software open source para como é demonstrado neste exercício.</span><span class="sxs-lookup"><span data-stu-id="e59c8-771">Microsoft Azure is a flexible platform that allows hello running of both Microsoft as well as open source software as demonstrated by this exercise.</span></span> <span data-ttu-id="e59c8-772">Clusters de Cassandra elevadas podem ser implementados no Centro de dados único através de Olá propagando-se Olá nós de cluster em vários domínios de falhas.</span><span class="sxs-lookup"><span data-stu-id="e59c8-772">Highly available Cassandra clusters can be deployed on a single data center through hello spreading of hello cluster nodes across multiple fault domains.</span></span> <span data-ttu-id="e59c8-773">Cassandra clusters também podem ser implementados em várias regiões do Azure, geograficamente distantes para sistemas de prova de desastre.</span><span class="sxs-lookup"><span data-stu-id="e59c8-773">Cassandra clusters can also be deployed across multiple geographically distant Azure regions for disaster proof systems.</span></span> <span data-ttu-id="e59c8-774">Azure e permite em conjunto Cassandra Olá construção de altamente dimensionável e altamente disponíveis e serviços de cloud possível recuperar de desastres necessitam através da internet de hoje aumentar.</span><span class="sxs-lookup"><span data-stu-id="e59c8-774">Azure and Cassandra together enables hello construction of highly scalable, highly available and disaster recoverable cloud services needed by today's internet scale services.</span></span>  

## <a name="references"></a><span data-ttu-id="e59c8-775">Referências</span><span class="sxs-lookup"><span data-stu-id="e59c8-775">References</span></span>
* [<span data-ttu-id="e59c8-776">http://cassandra.apache.org</span><span class="sxs-lookup"><span data-stu-id="e59c8-776">http://cassandra.apache.org</span></span>](http://cassandra.apache.org)
* [<span data-ttu-id="e59c8-777">http://www.datastax.com</span><span class="sxs-lookup"><span data-stu-id="e59c8-777">http://www.datastax.com</span></span>](http://www.datastax.com)
* [<span data-ttu-id="e59c8-778">http://www.nodejs.org</span><span class="sxs-lookup"><span data-stu-id="e59c8-778">http://www.nodejs.org</span></span>](http://www.nodejs.org)

