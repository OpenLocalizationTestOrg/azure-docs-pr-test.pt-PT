---
title: aaaProfiling em direto de web apps do Azure com o Application Insights | Microsoft Docs
description: "Identifica o caminho de acesso frequente Olá no seu código de servidor web com um gerador de perfis de requisitos de espaço insuficiente."
services: application-insights
documentationcenter: 
author: CFreemanwa
manager: carmonm
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 05/04/2017
ms.author: bwren
ms.openlocfilehash: 3c7f21076f19335e0f006327932e13623ec9526b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="profiling-live-azure-web-apps-with-application-insights"></a><span data-ttu-id="dd176-103">Criação de perfis de aplicações web do Azure em direto com o Application Insights</span><span class="sxs-lookup"><span data-stu-id="dd176-103">Profiling live Azure web apps with Application Insights</span></span>

<span data-ttu-id="dd176-104">*Esta funcionalidade do Application Insights está GA para serviços de aplicações e na pré-visualização da computação.*</span><span class="sxs-lookup"><span data-stu-id="dd176-104">*This feature of Application Insights is GA for App Services and in preview for Compute.*</span></span>

<span data-ttu-id="dd176-105">Saber quanto tempo é gasto a cada método na sua aplicação web em direto utilizando a ferramenta de criação de perfis de Olá [Azure Application Insights](app-insights-overview.md).</span><span class="sxs-lookup"><span data-stu-id="dd176-105">Find out how much time is spent in each method in your live web application by using hello profiling tool of [Azure Application Insights](app-insights-overview.md).</span></span> <span data-ttu-id="dd176-106">Mostra-lhe perfis de detalhado de pedidos em direto que foram processados pela sua aplicação e realça Olá 'frequente path' que está a utilizar Olá mais tempo.</span><span class="sxs-lookup"><span data-stu-id="dd176-106">It shows you detailed profiles of live requests that were served by your app, and highlights hello 'hot path' that is using hello most time.</span></span> <span data-ttu-id="dd176-107">Seleciona automaticamente os exemplos que tenham tempos de resposta diferentes.</span><span class="sxs-lookup"><span data-stu-id="dd176-107">It automatically selects examples that have different response times.</span></span> <span data-ttu-id="dd176-108">gerador de perfis de Olá utiliza a sobrecarga de toominimize várias técnicas.</span><span class="sxs-lookup"><span data-stu-id="dd176-108">hello profiler uses various techniques toominimize overhead.</span></span>

<span data-ttu-id="dd176-109">Olá gerador de perfis atualmente funciona para o ASP.NET web aplicações em execução nos serviços de aplicações do Azure, no mínimo Olá Basic escalão de preço.</span><span class="sxs-lookup"><span data-stu-id="dd176-109">hello profiler currently works for ASP.NET web apps running on Azure App Services, in at least hello Basic pricing tier.</span></span> 

<a id="installation"></a>
## <a name="enable-hello-profiler"></a><span data-ttu-id="dd176-110">Ativar o gerador de perfis de Olá</span><span class="sxs-lookup"><span data-stu-id="dd176-110">Enable hello profiler</span></span>

<span data-ttu-id="dd176-111">[Instale o Application Insights](app-insights-asp-net.md) no seu código.</span><span class="sxs-lookup"><span data-stu-id="dd176-111">[Install Application Insights](app-insights-asp-net.md) in your code.</span></span> <span data-ttu-id="dd176-112">Se já estiver instalado, certifique-se de que tem a versão mais recente Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-112">If it's already installed, make sure you have hello latest version.</span></span> <span data-ttu-id="dd176-113">(toodo isto, clique no projeto no Explorador de soluções e escolha pacotes NuGet gerir.</span><span class="sxs-lookup"><span data-stu-id="dd176-113">(toodo this, right-click your project in Solution Explorer, and choose Manage NuGet packages.</span></span> <span data-ttu-id="dd176-114">Selecione as atualizações e todos os pacotes de atualização.) Implemente novamente a sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="dd176-114">Select Updates and update all packages.) Re-deploy your app.</span></span>

<span data-ttu-id="dd176-115">*Com o ASP.NET Core? [Verifique aqui](#aspnetcore).*</span><span class="sxs-lookup"><span data-stu-id="dd176-115">*Using ASP.NET Core? [Check here](#aspnetcore).*</span></span>

<span data-ttu-id="dd176-116">No [https://portal.azure.com](https://portal.azure.com), abra o recurso do Application Insights Olá para a sua aplicação web.</span><span class="sxs-lookup"><span data-stu-id="dd176-116">In [https://portal.azure.com](https://portal.azure.com), open hello Application Insights resource for your web app.</span></span> <span data-ttu-id="dd176-117">Abra **desempenho** e clique em **ativar o gerador de perfis do Application Insights...** .</span><span class="sxs-lookup"><span data-stu-id="dd176-117">Open **Performance** and click **Enable Application Insights Profiler...**.</span></span>

![Clique em Olá ativar faixa de gerador de perfis][enable-profiler-banner]

<span data-ttu-id="dd176-119">Em alternativa, pode sempre clicar **configurar** tooview Estado, ativar ou desativar Olá gerador de perfis.</span><span class="sxs-lookup"><span data-stu-id="dd176-119">Alternatively, you can always click **Configure** tooview status, enable, or disable hello Profiler.</span></span>

![No painel de desempenho de Olá, clique em configurar][performance-blade]

<span data-ttu-id="dd176-121">Aplicações Web que estão configuradas com o Application Insights estão listadas no painel de configurar.</span><span class="sxs-lookup"><span data-stu-id="dd176-121">Web apps that are configured with Application Insights are listed on Configure blade.</span></span> <span data-ttu-id="dd176-122">Siga o agente de gerador de perfis de Olá do instruções tooinstall se for necessário.</span><span class="sxs-lookup"><span data-stu-id="dd176-122">Follow instructions tooinstall hello Profiler agent if needed.</span></span> <span data-ttu-id="dd176-123">Se não existe nenhuma aplicação web ainda está configurada com o Application Insights, clique em *adicionar aplicações ligadas*.</span><span class="sxs-lookup"><span data-stu-id="dd176-123">If no web app is configured with Application Insights yet, click *Add Linked Apps*.</span></span>

<span data-ttu-id="dd176-124">Olá utilize *ativar o gerador de perfis* ou *desativar o gerador de perfis* botões no Olá configurar painel toocontrol Olá gerador de perfis em todas as suas aplicações web ligado.</span><span class="sxs-lookup"><span data-stu-id="dd176-124">Use hello *Enable Profiler* or *Disable Profiler* buttons in hello Configure blade toocontrol hello Profiler on all your linked web apps.</span></span>



![Configurar o painel][linked app services]

<span data-ttu-id="dd176-126">toostop ou a reinicialização Olá gerador de perfis para uma instância de serviço de aplicações individuais, pode encontrá-la **no Olá recurso do App Service**, na **trabalhos Web**.</span><span class="sxs-lookup"><span data-stu-id="dd176-126">toostop or restart hello profiler for an individual App Service instance, you'll find it **in hello App Service resource**, in **Web Jobs**.</span></span> <span data-ttu-id="dd176-127">toodelete-lo, procure em **extensões**.</span><span class="sxs-lookup"><span data-stu-id="dd176-127">toodelete it, look under **Extensions**.</span></span>

![Desativar o gerador de perfis para das tarefas da web][disable-profiler-webjob]

<span data-ttu-id="dd176-129">Recomendamos que tenha Olá gerador de perfis ativada em todos os seus web apps toodiscover qualquer desempenho emite logo que possível.</span><span class="sxs-lookup"><span data-stu-id="dd176-129">We recommend that you have hello Profiler enabled on all your web apps toodiscover any performance issues as soon as possible.</span></span>

<span data-ttu-id="dd176-130">Se utilizar a aplicação de web WebDeploy toodeploy alterações tooyour, certifique-se de que excluir Olá **App_Data** pasta seja eliminado durante a implementação.</span><span class="sxs-lookup"><span data-stu-id="dd176-130">If you use WebDeploy toodeploy changes tooyour web application, ensure that you exclude hello **App_Data** folder from being deleted during deployment.</span></span> <span data-ttu-id="dd176-131">Caso contrário, hello ficheiros da extensão do gerador de perfis será eliminado quando implementa tooAzure de aplicação web de Olá seguinte.</span><span class="sxs-lookup"><span data-stu-id="dd176-131">Otherwise, hello profiler extension's files will be deleted when you next deploy hello web application tooAzure.</span></span>

### <a name="using-profiler-with-azure-vms-and-compute-resources-preview"></a><span data-ttu-id="dd176-132">Utilizar o gerador de perfis com as VMs do Azure e recursos de computação (pré-visualização)</span><span class="sxs-lookup"><span data-stu-id="dd176-132">Using profiler with Azure VMs and Compute resources (preview)</span></span>

<span data-ttu-id="dd176-133">Quando lhe [ativar Application Insights para serviços de aplicações do Azure em tempo de execução](app-insights-azure-web-apps.md#run-time-instrumentation-with-application-insights), o gerador de perfis está automaticamente disponível.</span><span class="sxs-lookup"><span data-stu-id="dd176-133">When you [enable Application Insights for Azure app services at run time](app-insights-azure-web-apps.md#run-time-instrumentation-with-application-insights), Profiler is automatically available.</span></span> <span data-ttu-id="dd176-134">(Se ativou Application Insights para o recurso de Olá, poderá ser necessário tooupdate toohello lates versão através do Olá **configurar** assistente.)</span><span class="sxs-lookup"><span data-stu-id="dd176-134">(If you already enabled Application Insights for hello resource, you might need tooupdate toohello lates version through hello **Configure** wizard.)</span></span>

<span data-ttu-id="dd176-135">Não existe um [versão de pré-visualização do Olá gerador de perfis para os recursos de computação do Azure](https://go.microsoft.com/fwlink/?linkid=848155).</span><span class="sxs-lookup"><span data-stu-id="dd176-135">There is a [preview version of hello Profiler for Azure Compute resources](https://go.microsoft.com/fwlink/?linkid=848155).</span></span>


## <a name="limits"></a><span data-ttu-id="dd176-136">Limites</span><span class="sxs-lookup"><span data-stu-id="dd176-136">Limits</span></span>

<span data-ttu-id="dd176-137">retenção de dados do Olá predefinido é de 5 dias.</span><span class="sxs-lookup"><span data-stu-id="dd176-137">hello default data retention is 5 days.</span></span> <span data-ttu-id="dd176-138">Máximo de 10 GB ingerido por dia.</span><span class="sxs-lookup"><span data-stu-id="dd176-138">Maximum 10 GB ingested per day.</span></span>

<span data-ttu-id="dd176-139">Não há sem encargos durante o serviço do gerador de perfis de Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-139">There is no charge for hello profiler service.</span></span> <span data-ttu-id="dd176-140">A aplicação web tem de estar alojada no Olá, pelo menos, o escalão básico dos serviços de aplicações.</span><span class="sxs-lookup"><span data-stu-id="dd176-140">Your web app must be hosted in at least hello Basic tier of App Services.</span></span>

## <a name="viewing-profiler-data"></a><span data-ttu-id="dd176-141">Visualizar dados do gerador de perfis</span><span class="sxs-lookup"><span data-stu-id="dd176-141">Viewing profiler data</span></span>

<span data-ttu-id="dd176-142">Abra o painel de desempenho de Olá e desloque-se para baixo a lista de operações toohello.</span><span class="sxs-lookup"><span data-stu-id="dd176-142">Open hello Performance blade and scroll down toohello operation list.</span></span>




![Painel de informações de desempenho de aplicações coluna de exemplos][performance-blade-examples]

<span data-ttu-id="dd176-144">Olá as colunas na tabela de Olá são:</span><span class="sxs-lookup"><span data-stu-id="dd176-144">hello columns in hello table are:</span></span>

* <span data-ttu-id="dd176-145">**Contagem** -Olá diversas estes pedidos no intervalo de tempo de Olá do painel de Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-145">**Count** - hello number of these requests in hello time range of hello blade.</span></span>
* <span data-ttu-id="dd176-146">**Mediana** -tempo normal Olá a aplicação demora toorespond tooa pedido.</span><span class="sxs-lookup"><span data-stu-id="dd176-146">**Median** - hello typical time your app takes toorespond tooa request.</span></span> <span data-ttu-id="dd176-147">Metade de todas as respostas foram mais rápida do que isto.</span><span class="sxs-lookup"><span data-stu-id="dd176-147">Half of all responses were faster than this.</span></span>
* <span data-ttu-id="dd176-148">**percentil 95th** 95% das respostas foram mais rápida do que isto.</span><span class="sxs-lookup"><span data-stu-id="dd176-148">**95th percentile** 95% of responses were faster than this.</span></span> <span data-ttu-id="dd176-149">Se desta figura é muito diferente do valor mediano de Olá, poderá existir um problema intermitente faça com a sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="dd176-149">If this figure is very different from hello median, there might be an intermittent problem with your app.</span></span> <span data-ttu-id="dd176-150">(Ou pode ser explicado por uma funcionalidade de estrutura como colocação em cache)</span><span class="sxs-lookup"><span data-stu-id="dd176-150">(Or it might be explained by a design feature such as caching.)</span></span>
* <span data-ttu-id="dd176-151">**Exemplos** -um ícone indica que o gerador de perfis Olá tem capturar rastreios de pilha para esta operação.</span><span class="sxs-lookup"><span data-stu-id="dd176-151">**Examples** - an icon indicates that hello profiler has captured stack traces for this operation.</span></span>

<span data-ttu-id="dd176-152">Clique em Explorador de rastreio de Olá ícone tooopen Olá exemplos.</span><span class="sxs-lookup"><span data-stu-id="dd176-152">Click hello Examples icon tooopen hello trace explorer.</span></span> <span data-ttu-id="dd176-153">Olá explorer mostra alguns exemplos que Olá gerador de perfis foi capturado, classificados por tempo de resposta.</span><span class="sxs-lookup"><span data-stu-id="dd176-153">hello explorer shows several samples that hello profiler has captured, classified by response time.</span></span>

<span data-ttu-id="dd176-154">Selecione tooshow um exemplo de uma divisão de nível de código de tempo gasto em execução Olá pedido.</span><span class="sxs-lookup"><span data-stu-id="dd176-154">Select a sample tooshow a code-level breakdown of time spent executing hello request.</span></span>

![Explorador de rastreio do Application Insights][trace-explorer]

<span data-ttu-id="dd176-156">**Mostrar caminho frequente** abre Olá maior nó de folha ou, pelo menos, algo fechar.</span><span class="sxs-lookup"><span data-stu-id="dd176-156">**Show hot path** opens hello biggest leaf node, or at least something close.</span></span> <span data-ttu-id="dd176-157">Na maioria dos casos, este nó será estrangulamento do desempenho tooa adjacente.</span><span class="sxs-lookup"><span data-stu-id="dd176-157">In most cases this node will be adjacent tooa performance bottleneck.</span></span>



* <span data-ttu-id="dd176-158">**Etiqueta**: nome de Olá da função de Olá ou eventos.</span><span class="sxs-lookup"><span data-stu-id="dd176-158">**Label**: hello name of hello function or event.</span></span> <span data-ttu-id="dd176-159">árvore de Olá mostra uma combinação de código e os eventos que ocorreram (por exemplo, eventos SQL e http).</span><span class="sxs-lookup"><span data-stu-id="dd176-159">hello tree shows a mix of code and events that occurred (such as SQL and http events).</span></span> <span data-ttu-id="dd176-160">evento superior Olá representa Olá geral duração do pedido.</span><span class="sxs-lookup"><span data-stu-id="dd176-160">hello top event represents hello overall request duration.</span></span>
* <span data-ttu-id="dd176-161">**Decorrido**: intervalo de tempo de Olá entre o início de Olá da operação de Olá e de fim de Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-161">**Elapsed**: hello time interval between hello start of hello operation and hello end.</span></span>
* <span data-ttu-id="dd176-162">**Quando**: mostra quando Olá função/evento estava a ser executado nas funções de tooother de relação.</span><span class="sxs-lookup"><span data-stu-id="dd176-162">**When**: Shows when hello function/event was running in relation tooother functions.</span></span>

## <a name="how-tooread-performance-data"></a><span data-ttu-id="dd176-163">Como os dados de desempenho de tooread</span><span class="sxs-lookup"><span data-stu-id="dd176-163">How tooread performance data</span></span>

<span data-ttu-id="dd176-164">O gerador de perfis do Microsoft service utiliza uma combinação de amostragem método instrumentação tooanalyze Olá desempenho e da sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="dd176-164">Microsoft service profiler uses a combination of sampling method and instrumentation tooanalyze hello performance of your application.</span></span>
<span data-ttu-id="dd176-165">Quando a coleção de detalhado está em curso, exemplos de gerador de perfis de serviço Olá ponteiro de instrução de cada de CPU da máquina de Olá em cada milissegundo.</span><span class="sxs-lookup"><span data-stu-id="dd176-165">When detailed collection is in progress, service profiler samples hello instruction pointer of each of hello machine's CPU in every millisecond.</span></span>
<span data-ttu-id="dd176-166">Cada amostra captura pilha de chamadas de conclusão de Olá do thread de Olá atualmente em execução, fornecer informações úteis e detalhadas sobre o que se thread estava a fazer em ambos alta e baixa níveis de abstração.</span><span class="sxs-lookup"><span data-stu-id="dd176-166">Each sample captures hello complete call stack of hello thread currently executing, giving detailed and useful information about what that thread was doing at both high and low levels of abstraction.</span></span> <span data-ttu-id="dd176-167">Gerador de perfis de serviço também recolhe outros eventos, tais como eventos de mudança de contexto, eventos TPL e correlação de atividade do conjunto de threads eventos tootrack e causality.</span><span class="sxs-lookup"><span data-stu-id="dd176-167">Service profiler also collects other events such as context switching events, TPL events, and thread-pool events tootrack activity correlation and causality.</span></span>

<span data-ttu-id="dd176-168">a pilha de chamadas de Olá apresentada na vista de linha cronológica de Olá é resultado Olá Olá acima amostragem e instrumentação.</span><span class="sxs-lookup"><span data-stu-id="dd176-168">hello call stack shown in hello timeline view is hello result of hello above sampling and instrumentation.</span></span> <span data-ttu-id="dd176-169">Porque cada amostra captura pilha de chamadas de conclusão de Olá do thread de Olá, inclui código da estrutura de .NET Olá, bem como outras estruturas que referenciar.</span><span class="sxs-lookup"><span data-stu-id="dd176-169">Because each sample captures hello complete call stack of hello thread, it includes code from hello .NET framework, as well as other frameworks you reference.</span></span>

### <span data-ttu-id="dd176-170"><a id="jitnewobj"></a>Alocação de objeto (`clr!JIT\_New or clr!JIT\_Newarr1`)</span><span class="sxs-lookup"><span data-stu-id="dd176-170"><a id="jitnewobj"></a>Object Allocation (`clr!JIT\_New or clr!JIT\_Newarr1`)</span></span>
<span data-ttu-id="dd176-171">`clr!JIT\_New and clr!JIT\_Newarr1`são funções de programa auxiliar no interior do .NET framework que aloca a memória a partir da área dinâmica para dados geridos.</span><span class="sxs-lookup"><span data-stu-id="dd176-171">`clr!JIT\_New and clr!JIT\_Newarr1` are helper functions inside .NET framework that allocates memory from managed heap.</span></span> <span data-ttu-id="dd176-172">`clr!JIT\_New`é invocada quando existe um objeto é alocado.</span><span class="sxs-lookup"><span data-stu-id="dd176-172">`clr!JIT\_New` is invoked when an object is allocated.</span></span> <span data-ttu-id="dd176-173">`clr!JIT\_Newarr1`é invocada quando é atribuída uma matriz de objetos.</span><span class="sxs-lookup"><span data-stu-id="dd176-173">`clr!JIT\_Newarr1` is invoked when an object array is allocated.</span></span> <span data-ttu-id="dd176-174">Estas duas funções são, normalmente, muito rápidas em devem tomar relativamente pequeno período de tempo.</span><span class="sxs-lookup"><span data-stu-id="dd176-174">These two functions are typically very fast and should take relatively small amount of time.</span></span> <span data-ttu-id="dd176-175">Se vir `clr!JIT\_New` ou `clr!JIT\_Newarr1` demorar uma quantidade substancial de tempo na sua linha cronológica, é uma indicação de que o código de Olá pode ser alocar muitos objetos e consumir quantidade significativa de memória.</span><span class="sxs-lookup"><span data-stu-id="dd176-175">If you see `clr!JIT\_New` or `clr!JIT\_Newarr1` take a substantial amount of time in your timeline, it's an indication that hello code may be allocating many objects and consuming significant amount of memory.</span></span>

### <span data-ttu-id="dd176-176"><a id="theprestub"></a>Carregar código (`clr!ThePreStub`)</span><span class="sxs-lookup"><span data-stu-id="dd176-176"><a id="theprestub"></a>Loading Code (`clr!ThePreStub`)</span></span>
<span data-ttu-id="dd176-177">`clr!ThePreStub`é uma função de programa auxiliar no interior do .NET framework que prepara Olá código tooexecute Olá pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="dd176-177">`clr!ThePreStub` is a helper function inside .NET framework that prepares hello code tooexecute for hello first time.</span></span> <span data-ttu-id="dd176-178">Isto inclui normalmente, mas não limitado a, compilação JIT (apenas no tempo).</span><span class="sxs-lookup"><span data-stu-id="dd176-178">This typically includes, but not limited to, JIT (Just In Time) compilation.</span></span> <span data-ttu-id="dd176-179">Para cada método c#, `clr!ThePreStub` deve ser invocado no máximo uma vez durante a duração de Olá de um processo.</span><span class="sxs-lookup"><span data-stu-id="dd176-179">For each C# method, `clr!ThePreStub` should be invoked at most once during hello lifetime of a process.</span></span>

<span data-ttu-id="dd176-180">Se vir `clr!ThePreStub` demora quantidade significativa de tempo de um pedido, indica esse pedido é Olá primeiro um que executa a esse método e tempo Olá tooload de tempo de execução do .NET framework que o método é significativo.</span><span class="sxs-lookup"><span data-stu-id="dd176-180">If you see `clr!ThePreStub` takes significant amount of time for a request, it indicates that request is hello first one that executes that method, and hello time for .NET framework runtime tooload that method is significant.</span></span> <span data-ttu-id="dd176-181">Pode considerar um processo de warm-up que executa a que parte do código Olá antes dos utilizadores aceder ao mesmo ou considere executar NGen no seu assemblagens.</span><span class="sxs-lookup"><span data-stu-id="dd176-181">You can consider a warm-up process that executes that portion of hello code before your users access it, or consider running NGen on your assemblies.</span></span>

### <span data-ttu-id="dd176-182"><a id="lockcontention"></a>Bloquear contenção (`clr!JITutil\_MonContention` ou `clr!JITutil\_MonEnterWorker`)</span><span class="sxs-lookup"><span data-stu-id="dd176-182"><a id="lockcontention"></a>Lock Contention (`clr!JITutil\_MonContention` or `clr!JITutil\_MonEnterWorker`)</span></span>
<span data-ttu-id="dd176-183">`clr!JITutil\_MonContention`ou `clr!JITutil\_MonEnterWorker` indicar o thread actual Olá está a aguardar um toobe bloqueio lançada.</span><span class="sxs-lookup"><span data-stu-id="dd176-183">`clr!JITutil\_MonContention` or `clr!JITutil\_MonEnterWorker` indicate hello current thread is waiting for a lock toobe released.</span></span> <span data-ttu-id="dd176-184">Isto normalmente aparece quando executar uma c# bloqueio instrução, invocar o método Monitor.Enter ou invocar um método com o atributo Methodimploptions.</span><span class="sxs-lookup"><span data-stu-id="dd176-184">This typically shows up when executing a C# lock statement, invoking Monitor.Enter method, or invoking a method with MethodImplOptions.Synchronized attribute.</span></span> <span data-ttu-id="dd176-185">Contenção ocorre normalmente quando o thread A adquire um bloqueio e thread B tenta Olá tooacquire mesmo de bloqueio antes de thread A versões-lo.</span><span class="sxs-lookup"><span data-stu-id="dd176-185">Lock contention typically happens when thread A acquires a lock, and thread B tries tooacquire hello same lock before thread A releases it.</span></span>

### <span data-ttu-id="dd176-186"><a id="ngencold"></a>Carregar código (`[COLD]`)</span><span class="sxs-lookup"><span data-stu-id="dd176-186"><a id="ngencold"></a>Loading code (`[COLD]`)</span></span>
<span data-ttu-id="dd176-187">Se o nome do método Olá contém `[COLD]`, tais como `mscorlib.ni![COLD]System.Reflection.CustomAttribute.IsDefined`, significa que runtime do Olá .NET framework está a executar o código que não está otimizado por <a href="https://msdn.microsoft.com/library/e7k32f4k.aspx">orientado por perfil otimização</a> para Olá pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="dd176-187">If hello method name contains `[COLD]`, such as `mscorlib.ni![COLD]System.Reflection.CustomAttribute.IsDefined`, it means that hello .NET framework runtime is executing code that is not optimized by <a href="https://msdn.microsoft.com/library/e7k32f4k.aspx">profile-guided optimization</a> for hello first time.</span></span> <span data-ttu-id="dd176-188">Para cada método, deve agora mostrar cópias de segurança no máximo uma vez durante a duração de Olá do processo de Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-188">For each method, it should show up at most once during hello lifetime of hello process.</span></span>

<span data-ttu-id="dd176-189">Se carregar código demora bastante tempo para um pedido, ele indica esse pedido é Olá primeiro um tooexecute Olá servirem parte do método Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-189">If loading code takes significant amount of time for a request, it indicates that request is hello first one tooexecute hello unoptimized portion of hello method.</span></span> <span data-ttu-id="dd176-190">Pode considerar um transfira segurança processo que executa a que parte do código Olá antes dos utilizadores aceder ao mesmo.</span><span class="sxs-lookup"><span data-stu-id="dd176-190">You can consider a warm up process that executes that portion of hello code before your users access it.</span></span>

### <span data-ttu-id="dd176-191"><a id="httpclientsend"></a>Enviar o pedido HTTP</span><span class="sxs-lookup"><span data-stu-id="dd176-191"><a id="httpclientsend"></a>Send HTTP Request</span></span>
<span data-ttu-id="dd176-192">Métodos, tais como `HttpClient.Send` indicar o código de Olá está a aguardar um toocomplete de pedido HTTP.</span><span class="sxs-lookup"><span data-stu-id="dd176-192">Methods such as `HttpClient.Send` indicate hello code is waiting for a HTTP request toocomplete.</span></span>

### <span data-ttu-id="dd176-193"><a id="sqlcommand"></a>Operação de base de dados</span><span class="sxs-lookup"><span data-stu-id="dd176-193"><a id="sqlcommand"></a>Database Operation</span></span>
<span data-ttu-id="dd176-194">Método como SqlCommand.Execute indica o código de Olá está a aguardar um toocomplete de operação de base de dados.</span><span class="sxs-lookup"><span data-stu-id="dd176-194">Method such as SqlCommand.Execute indicates hello code is waiting for a database operation toocomplete.</span></span>

### <span data-ttu-id="dd176-195"><a id="await"></a>A aguardar (`AWAIT\_TIME`)</span><span class="sxs-lookup"><span data-stu-id="dd176-195"><a id="await"></a>Waiting (`AWAIT\_TIME`)</span></span>
<span data-ttu-id="dd176-196">`AWAIT\_TIME`indica o código de Olá está a aguardar outro toocomplete de tarefas.</span><span class="sxs-lookup"><span data-stu-id="dd176-196">`AWAIT\_TIME` indicates hello code is waiting for another task toocomplete.</span></span> <span data-ttu-id="dd176-197">Esta situação ocorre normalmente com c# 'await' da instrução.</span><span class="sxs-lookup"><span data-stu-id="dd176-197">This typically happens with C# 'await' statement.</span></span> <span data-ttu-id="dd176-198">Quando executa o código de Olá um c# 'await', hello thread unwinds e devolve o conjunto de threads do toohello controlo e não há nenhum thread que está bloqueado aguardar Olá 'await' toofinish.</span><span class="sxs-lookup"><span data-stu-id="dd176-198">When hello code does a C# 'await', hello thread unwinds and returns control toohello thread-pool, and there is no thread that is blocked waiting for hello 'await' toofinish.</span></span> <span data-ttu-id="dd176-199">No entanto, logicamente Olá thread que foi Olá await é 'Bloqueado' aguardar Olá operação toocomplete.</span><span class="sxs-lookup"><span data-stu-id="dd176-199">However, logically hello thread that did hello await is 'blocked' waiting for hello operation toocomplete.</span></span> <span data-ttu-id="dd176-200">O `AWAIT\_TIME` indica o tempo de Olá bloqueado aguardar Olá toocomplete de tarefas.</span><span class="sxs-lookup"><span data-stu-id="dd176-200">The `AWAIT\_TIME` indicates hello blocked time waiting for hello task toocomplete.</span></span>

### <span data-ttu-id="dd176-201"><a id="block"></a>Tempo bloqueado</span><span class="sxs-lookup"><span data-stu-id="dd176-201"><a id="block"></a>Blocked Time</span></span>
<span data-ttu-id="dd176-202">`BLOCKED_TIME`indica o código de Olá está a aguardar outro toobe recursos disponível, tais como a aguardar que um objeto de sincronização, aguardar um toobe thread disponível, ou aguardar toofinish um pedido.</span><span class="sxs-lookup"><span data-stu-id="dd176-202">`BLOCKED_TIME` indicates hello code is waiting for another resource toobe available, such as waiting for a synchronization object, waiting for a thread toobe available, or waiting for a request toofinish.</span></span>

### <span data-ttu-id="dd176-203"><a id="cpu"></a>Tempo de CPU</span><span class="sxs-lookup"><span data-stu-id="dd176-203"><a id="cpu"></a>CPU Time</span></span>
<span data-ttu-id="dd176-204">Olá CPU está ocupado executar instruções Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-204">hello CPU is busy executing hello instructions.</span></span>

### <span data-ttu-id="dd176-205"><a id="disk"></a>Tempo de disco</span><span class="sxs-lookup"><span data-stu-id="dd176-205"><a id="disk"></a>Disk Time</span></span>
<span data-ttu-id="dd176-206">aplicação Olá está a efetuar operações de disco.</span><span class="sxs-lookup"><span data-stu-id="dd176-206">hello application is performing disk operations.</span></span>

### <span data-ttu-id="dd176-207"><a id="network"></a>Tempo da rede</span><span class="sxs-lookup"><span data-stu-id="dd176-207"><a id="network"></a>Network Time</span></span>
<span data-ttu-id="dd176-208">aplicação Olá está a efetuar operações de rede.</span><span class="sxs-lookup"><span data-stu-id="dd176-208">hello application is performing network operations.</span></span>

### <span data-ttu-id="dd176-209"><a id="when"></a>Quando coluna</span><span class="sxs-lookup"><span data-stu-id="dd176-209"><a id="when"></a>When column</span></span>
<span data-ttu-id="dd176-210">Esta é uma visualização de como exemplos, INCLUSIVE Olá recolhidos para um nó variam ao longo do tempo.</span><span class="sxs-lookup"><span data-stu-id="dd176-210">This is a visualization of how hello INCLUSIVE samples collected for a node vary over time.</span></span> <span data-ttu-id="dd176-211">Olá total do intervalo do pedido de Olá está dividido em 32 registos de tempo e exemplos de inclusive Olá para esse nó são acumulados para esses registos 32.</span><span class="sxs-lookup"><span data-stu-id="dd176-211">hello total range of hello request is divided into 32 time buckets and hello inclusive samples for that node are accumulated into those 32 buckets.</span></span> <span data-ttu-id="dd176-212">Cada registo, em seguida, é representado como uma barra cuja altura representa um valor expandido.</span><span class="sxs-lookup"><span data-stu-id="dd176-212">Each bucket is then represented as a bar whose height represents a scaled value.</span></span> <span data-ttu-id="dd176-213">Para nós marcado `CPU_TIME` ou `BLOCKED_TIME`, ou onde existe uma relação óbvias de consumir um recurso (cpu, disco, thread), Olá barra representa consumir um destes recursos Olá durante período de tempo do que o registo.</span><span class="sxs-lookup"><span data-stu-id="dd176-213">For nodes marked `CPU_TIME` or `BLOCKED_TIME`, or where there is an obvious relationship of consuming a resource (cpu, disk, thread), hello bar represents consuming one of those resources for hello period of time of that bucket.</span></span> <span data-ttu-id="dd176-214">Para estas métricas, pode obter superior a 100% consumir recursos de vários.</span><span class="sxs-lookup"><span data-stu-id="dd176-214">For these metrics you can get greater than 100% by consuming multiple resources.</span></span> <span data-ttu-id="dd176-215">Por exemplo, se em média utilizar duas CPUs, ao longo de um intervalo, em seguida, pode obter 200%.</span><span class="sxs-lookup"><span data-stu-id="dd176-215">For example, if on average you use two CPUs over an interval then you get 200%.</span></span>


## <span data-ttu-id="dd176-216"><a id="troubleshooting"></a>Resolução de Problemas</span><span class="sxs-lookup"><span data-stu-id="dd176-216"><a id="troubleshooting"></a>Troubleshooting</span></span>

### <a name="how-can-i-know-whether-application-insights-profiler-is-running"></a><span data-ttu-id="dd176-217">Como saber se o gerador de perfis do Application Insights está em execução?</span><span class="sxs-lookup"><span data-stu-id="dd176-217">How can I know whether Application Insights profiler is running?</span></span>

<span data-ttu-id="dd176-218">gerador de perfis de Olá é executado como um trabalho web contínua na aplicação Web.</span><span class="sxs-lookup"><span data-stu-id="dd176-218">hello profiler runs as a continuous web job in Web App.</span></span> <span data-ttu-id="dd176-219">Pode abrir o recurso de aplicação Web de Olá no https://portal.azure.com e verificar o estado de "ApplicationInsightsProfiler" no painel de WebJobs Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-219">You can open hello Web App resource in https://portal.azure.com and check "ApplicationInsightsProfiler" status in hello WebJobs blade.</span></span> <span data-ttu-id="dd176-220">Se não está em execução, abra **registos** toofind mais informações.</span><span class="sxs-lookup"><span data-stu-id="dd176-220">If it isn't running, open **Logs** toofind out more.</span></span>

### <a name="why-cant-i-find-any-stack-examples-even-though-hello-profiler-is-running"></a><span data-ttu-id="dd176-221">Por que motivo não consigo encontrá qualquer exemplos de pilha apesar do gerador de perfis de Olá está em execução?</span><span class="sxs-lookup"><span data-stu-id="dd176-221">Why can't I find any stack examples even though hello profiler is running?</span></span>

<span data-ttu-id="dd176-222">Seguem-se algumas coisas, que pode verificar.</span><span class="sxs-lookup"><span data-stu-id="dd176-222">Here are a few things you can check.</span></span>

1. <span data-ttu-id="dd176-223">Certifique-se do plano do serviço Web App escalão básico e superior.</span><span class="sxs-lookup"><span data-stu-id="dd176-223">Make sure your Web App Service Plan is Basic tier and above.</span></span>
2. <span data-ttu-id="dd176-224">Certifique-se a aplicação Web com o Application Insights SDK 2.2 Beta e acima ativada.</span><span class="sxs-lookup"><span data-stu-id="dd176-224">Make sure your Web App has Application Insights SDK 2.2 Beta and above enabled.</span></span>
3. <span data-ttu-id="dd176-225">Certifique-se a que sua aplicação Web tem definição de APPINSIGHTS_INSTRUMENTATIONKEY Olá com Olá mesma chave de instrumentação utilizada pelo Application Insights SDK.</span><span class="sxs-lookup"><span data-stu-id="dd176-225">Make sure your Web App has hello APPINSIGHTS_INSTRUMENTATIONKEY setting with hello same instrumentation key used by Application Insights SDK.</span></span>
4. <span data-ttu-id="dd176-226">Certifique-se a sua aplicação Web está em execução no .net Framework 4.6.</span><span class="sxs-lookup"><span data-stu-id="dd176-226">Make sure your Web App is running on .Net Framework 4.6.</span></span>
5. <span data-ttu-id="dd176-227">Se se tratar de uma aplicação ASP.NET Core, também verifique [Olá necessário dependências](#aspnetcore).</span><span class="sxs-lookup"><span data-stu-id="dd176-227">If it's an ASP.NET Core application, please also check [hello required dependencies](#aspnetcore).</span></span>

<span data-ttu-id="dd176-228">Depois de iniciado o gerador de perfis de Olá, há um período curto warm-up quando o gerador de perfis de Olá recolhe ativamente várias rastreios de desempenho.</span><span class="sxs-lookup"><span data-stu-id="dd176-228">After hello profiler is started, there is a short warm-up period when hello profiler actively collects several performance traces.</span></span> <span data-ttu-id="dd176-229">Depois disso, o gerador de perfis de Olá recolhendo rastreios de desempenho de dois minutos em cada hora.</span><span class="sxs-lookup"><span data-stu-id="dd176-229">After that, hello profiler collects performance traces for two minutes in every hour.</span></span>  

### <a name="i-was-using-azure-service-profiler-what-happened-tooit"></a><span data-ttu-id="dd176-230">Estava a utilizar o gerador de perfis de serviço de Azure.</span><span class="sxs-lookup"><span data-stu-id="dd176-230">I was using Azure Service Profiler.</span></span> <span data-ttu-id="dd176-231">Que tooit happened?</span><span class="sxs-lookup"><span data-stu-id="dd176-231">What happened tooit?</span></span>  

<span data-ttu-id="dd176-232">Quando ativa o gerador de perfis do Application Insights, o agente do gerador de perfis de serviço de Azure está desativada.</span><span class="sxs-lookup"><span data-stu-id="dd176-232">When you enable Application Insights Profiler, Azure Service Profiler agent is disabled.</span></span>

### <span data-ttu-id="dd176-233"><a id="double-counting"></a>Valor de duplo contando em threads paralelas</span><span class="sxs-lookup"><span data-stu-id="dd176-233"><a id="double-counting"></a>Double counting in parallel threads</span></span>

<span data-ttu-id="dd176-234">Olá alguns casos métrica do tempo total no Visualizador de pilha Olá é superior a duração real da Olá de pedido de Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-234">In some cases hello total time metric in hello stack viewer is more than hello actual duration of hello request.</span></span>

<span data-ttu-id="dd176-235">Isto pode acontecer quando existem duas ou mais threads associadas a um pedido, a funcionar em paralelo.</span><span class="sxs-lookup"><span data-stu-id="dd176-235">This can happen when there are two or more threads associated with a request, operating in parallel.</span></span> <span data-ttu-id="dd176-236">tempo total de threads de Olá, em seguida, é maior do que o tempo decorrido de Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-236">hello total thread time is then more than hello elapsed time.</span></span> <span data-ttu-id="dd176-237">Em muitos casos, um thread pode aguardar a resposta de Olá outro toocomplete.</span><span class="sxs-lookup"><span data-stu-id="dd176-237">In many cases one thread may be waiting on hello other toocomplete.</span></span> <span data-ttu-id="dd176-238">Olá Visualizador tenta toodetect isto e omitir espera desinteressantes Olá, mas errs no lado de Olá de mostrar demasiada em vez de omitindo que podem ser informações críticas.</span><span class="sxs-lookup"><span data-stu-id="dd176-238">hello viewer tries toodetect this and omit hello uninteresting wait, but errs on hello side of showing too much rather than omitting what may be critical information.</span></span>  

<span data-ttu-id="dd176-239">Quando vir threads paralelas nos seus rastreios, terá de toodetermine que threads estão a aguardar para que possa determinar caminho crítico de Olá para pedido de Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-239">When you see parallel threads in your traces, you need toodetermine which threads are waiting so you can determine hello critical path for hello request.</span></span> <span data-ttu-id="dd176-240">Na maioria dos casos, o thread de Olá que rapidamente ficar num Estado de espera é simplesmente aguardar Olá outros threads.</span><span class="sxs-lookup"><span data-stu-id="dd176-240">In most cases, hello thread that quickly goes into a wait state is simply waiting on hello other threads.</span></span> <span data-ttu-id="dd176-241">Concentrar-se no Olá outras pessoas e ignorar o tempo de Olá em threads em espera Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-241">Concentrate on hello others and ignore hello time in hello waiting threads.</span></span>

### <span data-ttu-id="dd176-242"><a id="issue-loading-trace-in-viewer"></a>Não existem dados de criação de perfis</span><span class="sxs-lookup"><span data-stu-id="dd176-242"><a id="issue-loading-trace-in-viewer"></a>No profiling data</span></span>

1. <span data-ttu-id="dd176-243">Se os dados de Olá que está a tentar tooview com mais de duas semanas, tente limitar o filtro de tempo e tente novamente.</span><span class="sxs-lookup"><span data-stu-id="dd176-243">If hello data you are trying tooview is older than a couple of weeks, try limiting your time filter and try again.</span></span>

2. <span data-ttu-id="dd176-244">Verificação de proxies ou uma firewall não ter bloqueado toohttps://gateway.azureserviceprofiler.net acesso.</span><span class="sxs-lookup"><span data-stu-id="dd176-244">Check that proxies or a firewall have not blocked access toohttps://gateway.azureserviceprofiler.net.</span></span>

3. <span data-ttu-id="dd176-245">Verifique que Olá Application Insights é a chave de instrumentação que está a utilizar na sua aplicação Olá mesmo como Olá tiver ativado a criação de perfis com o recurso do Application Insights.</span><span class="sxs-lookup"><span data-stu-id="dd176-245">Check that hello Application Insights instrumentation key you are using in your app is hello same as hello Application Insights resource you've enabled profiling with.</span></span> <span data-ttu-id="dd176-246">chave de Olá está normalmente nas Applicationinsights, mas também pode ser encontrado na Web. config ou o App. config.</span><span class="sxs-lookup"><span data-stu-id="dd176-246">hello key is usually in ApplicationInsights.config but can also be found in web.config or app.config.</span></span>

### <a name="error-report-in-hello-profiling-viewer"></a><span data-ttu-id="dd176-247">Relatório de erros no Visualizador de criação de perfis de Olá</span><span class="sxs-lookup"><span data-stu-id="dd176-247">Error report in hello profiling viewer</span></span>

<span data-ttu-id="dd176-248">Um pedido de suporte do portal de Olá de ficheiros.</span><span class="sxs-lookup"><span data-stu-id="dd176-248">File a support ticket from hello portal.</span></span> <span data-ttu-id="dd176-249">Inclua Olá ID de correlação da mensagem de erro de saudação.</span><span class="sxs-lookup"><span data-stu-id="dd176-249">Please include hello correlation ID from hello error message.</span></span>

## <a name="manual-installation"></a><span data-ttu-id="dd176-250">Instalação manual</span><span class="sxs-lookup"><span data-stu-id="dd176-250">Manual installation</span></span>

<span data-ttu-id="dd176-251">Quando configura o gerador de perfis de Olá, hello seguintes atualizações que são efetuadas definições da aplicação Web toohello.</span><span class="sxs-lookup"><span data-stu-id="dd176-251">When you configure hello profiler, hello following updates are made toohello Web App's settings.</span></span> <span data-ttu-id="dd176-252">Pode fazê-las pessoalmente manualmente se o seu ambiente necessitar, por exemplo, se a aplicação for executada no ambiente de serviço de aplicações do Azure (ASE):</span><span class="sxs-lookup"><span data-stu-id="dd176-252">You can do them yourself manually if your environment requires, for example, if your application runs in Azure App Service Environment (ASE):</span></span>

1. <span data-ttu-id="dd176-253">No painel de controlo de aplicação web Olá, abra as definições.</span><span class="sxs-lookup"><span data-stu-id="dd176-253">In hello web app control blade, open Settings.</span></span>
2. <span data-ttu-id="dd176-254">Definir ".Net Framework versão" toov4.6.</span><span class="sxs-lookup"><span data-stu-id="dd176-254">Set ".Net Framework version" toov4.6.</span></span>
3. <span data-ttu-id="dd176-255">Definir tooOn "Always On".</span><span class="sxs-lookup"><span data-stu-id="dd176-255">Set "Always On" tooOn.</span></span>
4. <span data-ttu-id="dd176-256">Adicionar definição de aplicação "__APPINSIGHTS_INSTRUMENTATIONKEY__" e o conjunto Olá valor toohello a mesma chave de instrumentação utilizado pelo Olá SDK.</span><span class="sxs-lookup"><span data-stu-id="dd176-256">Add app setting "__APPINSIGHTS_INSTRUMENTATIONKEY__" and set hello value toohello same instrumentation key used by hello SDK.</span></span>
5. <span data-ttu-id="dd176-257">Abrir as ferramentas avançadas.</span><span class="sxs-lookup"><span data-stu-id="dd176-257">Open Advanced Tools.</span></span>
6. <span data-ttu-id="dd176-258">Clique em "Ir" tooopen Olá Kudu Web site.</span><span class="sxs-lookup"><span data-stu-id="dd176-258">Click "Go" tooopen hello Kudu website.</span></span>
7. <span data-ttu-id="dd176-259">No Web site do Kudu Olá, selecione "As extensões de Site".</span><span class="sxs-lookup"><span data-stu-id="dd176-259">In hello Kudu website, select "Site extensions".</span></span>
8. <span data-ttu-id="dd176-260">Instalar "__Application Insights__" da galeria.</span><span class="sxs-lookup"><span data-stu-id="dd176-260">Install "__Application Insights__" from Gallery.</span></span>
9. <span data-ttu-id="dd176-261">Reinicie a aplicação de web de Olá.</span><span class="sxs-lookup"><span data-stu-id="dd176-261">Restart hello web app.</span></span>

## <span data-ttu-id="dd176-262"><a id="aspnetcore"></a>Suporte de núcleo de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="dd176-262"><a id="aspnetcore"></a>ASP.NET Core Support</span></span>

<span data-ttu-id="dd176-263">Aplicação de ASP.NET Core tem tooinstall 2.1.0-beta6 de pacote Microsoft.ApplicationInsights.AspNetCore Nuget ou superior toowork com Olá gerador de perfis.</span><span class="sxs-lookup"><span data-stu-id="dd176-263">ASP.NET Core application needs tooinstall Microsoft.ApplicationInsights.AspNetCore Nuget package 2.1.0-beta6 or higher toowork with hello Profiler.</span></span> <span data-ttu-id="dd176-264">Já não suportamos versões inferiores Olá após 27/6/2017.</span><span class="sxs-lookup"><span data-stu-id="dd176-264">We no longer support hello lower versions after 6/27/2017.</span></span>

## <a name="next-steps"></a><span data-ttu-id="dd176-265">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="dd176-265">Next steps</span></span>

* [<span data-ttu-id="dd176-266">Trabalhar com o Application Insights no Visual Studio</span><span class="sxs-lookup"><span data-stu-id="dd176-266">Working with Application Insights in Visual Studio</span></span>](https://docs.microsoft.com/azure/application-insights/app-insights-visual-studio)

[performance-blade]: ./media/app-insights-profiler/performance-blade.png
[performance-blade-examples]: ./media/app-insights-profiler/performance-blade-examples.png
[trace-explorer]: ./media/app-insights-profiler/trace-explorer.png
[trace-explorer-toolbar]: ./media/app-insights-profiler/trace-explorer-toolbar.png
[trace-explorer-hint-tip]: ./media/app-insights-profiler/trace-explorer-hint-tip.png
[trace-explorer-hot-path]: ./media/app-insights-profiler/trace-explorer-hot-path.png
[enable-profiler-banner]: ./media/app-insights-profiler/enable-profiler-banner.png
[disable-profiler-webjob]: ./media/app-insights-profiler/disable-profiler-webjob.png
[linked app services]: ./media/app-insights-profiler/linked-app-services.png
