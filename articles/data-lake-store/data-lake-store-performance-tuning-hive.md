---
title: "aaaAzure Data Lake arquivo Hive desempenho otimização diretrizes | Microsoft Docs"
description: "Desempenho de ramo de registo do Azure Data Lake Store diretrizes de otimização"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: e44daeb6ad3b64e893c709df63b56444a330729f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-hive-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="0f69b-103">Orientações para do Hive no HDInsight e o Azure Data Lake Store de otimização do desempenho</span><span class="sxs-lookup"><span data-stu-id="0f69b-103">Performance tuning guidance for Hive on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="0f69b-104">foram definidas predefinições Olá tooprovide um bom desempenho em muitos casos de utilização diferentes.</span><span class="sxs-lookup"><span data-stu-id="0f69b-104">hello default settings have been set tooprovide good performance across many different use cases.</span></span>  <span data-ttu-id="0f69b-105">Para consultas de e/s intensivas, o ramo de registo pode estar atento tooget um melhor desempenho com ADLS.</span><span class="sxs-lookup"><span data-stu-id="0f69b-105">For I/O intensive queries, Hive can be tuned tooget better performance with ADLS.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="0f69b-106">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="0f69b-106">Prerequisites</span></span>

* <span data-ttu-id="0f69b-107">**Uma subscrição do Azure**.</span><span class="sxs-lookup"><span data-stu-id="0f69b-107">**An Azure subscription**.</span></span> <span data-ttu-id="0f69b-108">Consulte [Obter uma avaliação gratuita do Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="0f69b-108">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="0f69b-109">**Uma conta do Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="0f69b-109">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="0f69b-110">Para obter instruções sobre como um, ver toocreate [introdução ao Azure Data Lake Store](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="0f69b-110">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="0f69b-111">**Cluster do HDInsight Azure** com acesso tooa conta do Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="0f69b-111">**Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="0f69b-112">Consulte [criar um cluster do HDInsight com o Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="0f69b-112">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="0f69b-113">Certifique-se de que ativar o ambiente de trabalho remoto para o cluster de Olá.</span><span class="sxs-lookup"><span data-stu-id="0f69b-113">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="0f69b-114">**Em execução do Hive no HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="0f69b-114">**Running Hive on HDInsight**.</span></span>  <span data-ttu-id="0f69b-115">toolearn sobre como executar tarefas do Hive no HDInsight, consulte [utilizar o Hive no HDInsight] (https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-use-hive)</span><span class="sxs-lookup"><span data-stu-id="0f69b-115">toolearn about running Hive jobs on HDInsight, see [Use Hive on HDInsight] (https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-use-hive)</span></span>
* <span data-ttu-id="0f69b-116">**Diretrizes no ADLS de otimização do desempenho**.</span><span class="sxs-lookup"><span data-stu-id="0f69b-116">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="0f69b-117">Para os conceitos gerais de desempenho, consulte [guia de otimização de desempenho do Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="0f69b-117">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span>

## <a name="parameters"></a><span data-ttu-id="0f69b-118">Parâmetros</span><span class="sxs-lookup"><span data-stu-id="0f69b-118">Parameters</span></span>

<span data-ttu-id="0f69b-119">Seguem-se Olá tootune de definições mais importante para um melhor desempenho ADLS:</span><span class="sxs-lookup"><span data-stu-id="0f69b-119">Here are hello most important settings tootune for improved ADLS performance:</span></span>

* <span data-ttu-id="0f69b-120">**Hive.tez.Container.size** – quantidade de Olá de memória utilizada por cada tarefas</span><span class="sxs-lookup"><span data-stu-id="0f69b-120">**hive.tez.container.size** – hello amount of memory used by each tasks</span></span>

* <span data-ttu-id="0f69b-121">**tamanho tez.grouping.min** – mínimo tamanho de cada mapeador</span><span class="sxs-lookup"><span data-stu-id="0f69b-121">**tez.grouping.min-size** – minimum size of each mapper</span></span>

* <span data-ttu-id="0f69b-122">**tamanho tez.grouping.Max** – máximo tamanho de cada mapeador</span><span class="sxs-lookup"><span data-stu-id="0f69b-122">**tez.grouping.max-size** – maximum size of each mapper</span></span>

* <span data-ttu-id="0f69b-123">**Hive.exec.reducer.bytes.Per.reducer** – tamanho de cada reducer</span><span class="sxs-lookup"><span data-stu-id="0f69b-123">**hive.exec.reducer.bytes.per.reducer** – size of each reducer</span></span>

<span data-ttu-id="0f69b-124">**Hive.tez.Container.size** -tamanho do contentor de Olá determina a quantidade de memória está disponível para cada tarefa.</span><span class="sxs-lookup"><span data-stu-id="0f69b-124">**hive.tez.container.size** - hello container size determines how much memory is available for each task.</span></span>  <span data-ttu-id="0f69b-125">Esta é a entrada principal de Olá para controlar simultaneidade Olá no ramo de registo.</span><span class="sxs-lookup"><span data-stu-id="0f69b-125">This is hello main input for controlling hello concurrency in Hive.</span></span>  

<span data-ttu-id="0f69b-126">**tamanho tez.grouping.min** – este parâmetro permite-lhe tooset tamanho mínimo de Olá do mapeador de cada.</span><span class="sxs-lookup"><span data-stu-id="0f69b-126">**tez.grouping.min-size** – This parameter allows you tooset hello minimum size of each mapper.</span></span>  <span data-ttu-id="0f69b-127">Se o número de Olá de mappers Tez escolhe é inferior ao valor de Olá deste parâmetro, Tez irá utilizar valor Olá definido aqui.</span><span class="sxs-lookup"><span data-stu-id="0f69b-127">If hello number of mappers that Tez chooses is smaller than hello value of this parameter, then Tez will use hello value set here.</span></span>  

<span data-ttu-id="0f69b-128">**tamanho tez.grouping.Max** – parâmetro Olá permite-lhe tooset Olá máximo de cada mapeador.</span><span class="sxs-lookup"><span data-stu-id="0f69b-128">**tez.grouping.max-size** – hello parameter allows you tooset hello maximum size of each mapper.</span></span>  <span data-ttu-id="0f69b-129">Se o número de Olá de mappers Tez escolhe é superior ao valor Olá deste parâmetro, Tez irá utilizar valor Olá definido aqui.</span><span class="sxs-lookup"><span data-stu-id="0f69b-129">If hello number of mappers that Tez chooses is larger than hello value of this parameter, then Tez will use hello value set here.</span></span>  

<span data-ttu-id="0f69b-130">**Hive.exec.reducer.bytes.Per.reducer** – este parâmetro define o tamanho de cada reducer Olá.</span><span class="sxs-lookup"><span data-stu-id="0f69b-130">**hive.exec.reducer.bytes.per.reducer** – This parameter sets hello size of each reducer.</span></span>  <span data-ttu-id="0f69b-131">Por predefinição, cada reducer é de 256MB.</span><span class="sxs-lookup"><span data-stu-id="0f69b-131">By default, each reducer is 256MB.</span></span>  

## <a name="guidance"></a><span data-ttu-id="0f69b-132">Orientação</span><span class="sxs-lookup"><span data-stu-id="0f69b-132">Guidance</span></span>

<span data-ttu-id="0f69b-133">**Definir hive.exec.reducer.bytes.per.reducer** – valor predefinido de Olá funciona bem quando os dados de Olá são descomprimidos.</span><span class="sxs-lookup"><span data-stu-id="0f69b-133">**Set hive.exec.reducer.bytes.per.reducer** – hello default value works well when hello data is uncompressed.</span></span>  <span data-ttu-id="0f69b-134">Para os dados são comprimidos, deve de reduzir o tamanho de Olá dos reducer Olá.</span><span class="sxs-lookup"><span data-stu-id="0f69b-134">For data that is compressed, you should reduce hello size of hello reducer.</span></span>  

<span data-ttu-id="0f69b-135">**Definir hive.tez.container.size** – em cada nó, memória é especificada por yarn.nodemanager.resource.memory mb e deve ser definida corretamente no HDI cluster por predefinição.</span><span class="sxs-lookup"><span data-stu-id="0f69b-135">**Set hive.tez.container.size** – In each node, memory is specified by yarn.nodemanager.resource.memory-mb and should be correctly set on HDI cluster by default.</span></span>  <span data-ttu-id="0f69b-136">Para obter informações adicionais sobre a definição de memória adequada Olá no YARN, consulte este [publique](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-hive-out-of-memory-error-oom).</span><span class="sxs-lookup"><span data-stu-id="0f69b-136">For additional information on setting hello appropriate memory in YARN, see this [post](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-hive-out-of-memory-error-oom).</span></span>

<span data-ttu-id="0f69b-137">Cargas de trabalho de e/s intensivas podem beneficiar do paralelismo mais ao diminuir o tamanho de contentor do Olá Tez.</span><span class="sxs-lookup"><span data-stu-id="0f69b-137">I/O intensive workloads can benefit from more parallelism by decreasing hello Tez container size.</span></span> <span data-ttu-id="0f69b-138">Isto dá-utilizador Olá mais contentores que aumenta de concorrência.</span><span class="sxs-lookup"><span data-stu-id="0f69b-138">This gives hello user more containers which increases concurrency.</span></span>  <span data-ttu-id="0f69b-139">No entanto, algumas consultas do Hive requerem uma quantidade significativa de memória (por exemplo, MapJoin).</span><span class="sxs-lookup"><span data-stu-id="0f69b-139">However, some Hive queries require a significant amount of memory (e.g. MapJoin).</span></span>  <span data-ttu-id="0f69b-140">Se a tarefa de Olá não tem memória suficiente, receberá um fora de exceção de memória durante o tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="0f69b-140">If hello task does not have enough memory, you will get an out of memory exception during runtime.</span></span>  <span data-ttu-id="0f69b-141">Se receber fora de exceções de memória, em seguida, deve aumentar memória Olá.</span><span class="sxs-lookup"><span data-stu-id="0f69b-141">If you receive out of memory exceptions, then you should increase hello memory.</span></span>   

<span data-ttu-id="0f69b-142">Olá simultâneas diversas tarefas em execução ou o paralelismo tem um vínculo pelo total de memória YARN Olá.</span><span class="sxs-lookup"><span data-stu-id="0f69b-142">hello concurrent number of tasks running or parallelism will be bounded by hello total YARN memory.</span></span>  <span data-ttu-id="0f69b-143">número de Olá de contentores YARN determinarão como muitas tarefas simultâneas podem ser executado.</span><span class="sxs-lookup"><span data-stu-id="0f69b-143">hello number of YARN containers will dictate how many concurrent tasks can run.</span></span>  <span data-ttu-id="0f69b-144">toofind Olá YARN memória por nó podem aceder tooAmbari.</span><span class="sxs-lookup"><span data-stu-id="0f69b-144">toofind hello YARN memory per node, you can go tooAmbari.</span></span>  <span data-ttu-id="0f69b-145">Navegue tooYARN e ver o separador de folhas de Olá.  Olá memória YARN é apresentado nesta janela.</span><span class="sxs-lookup"><span data-stu-id="0f69b-145">Navigate tooYARN and view hello Configs tab.  hello YARN memory is displayed in this window.</span></span>  

        Total YARN memory = nodes * YARN memory per node
        # of YARN containers = Total YARN memory / Tez container size
<span data-ttu-id="0f69b-146">desempenho de chave tooimproving Olá utilizando ADLS é simultaneidade de Olá tooincrease quanto possível.</span><span class="sxs-lookup"><span data-stu-id="0f69b-146">hello key tooimproving performance using ADLS is tooincrease hello concurrency as much as possible.</span></span>  <span data-ttu-id="0f69b-147">Tez calcula automaticamente o número de Olá de tarefas que deverá ser criado, pelo que não necessita de tooset-lo.</span><span class="sxs-lookup"><span data-stu-id="0f69b-147">Tez automatically calculates hello number of tasks that should be created so you do not need tooset it.</span></span>   

## <a name="example-calculation"></a><span data-ttu-id="0f69b-148">Cálculo de exemplo</span><span class="sxs-lookup"><span data-stu-id="0f69b-148">Example Calculation</span></span>

<span data-ttu-id="0f69b-149">Imaginemos que tem um cluster do 8 nó D14.</span><span class="sxs-lookup"><span data-stu-id="0f69b-149">Let’s say you have an 8 node D14 cluster.</span></span>  

    Total YARN memory = nodes * YARN memory per node
    Total YARN memory = 8 nodes * 96GB = 768GB
    # of YARN containers = 768GB / 3072MB = 256

## <a name="limitations"></a><span data-ttu-id="0f69b-150">Limitações</span><span class="sxs-lookup"><span data-stu-id="0f69b-150">Limitations</span></span>
<span data-ttu-id="0f69b-151">**ADLS limitação**</span><span class="sxs-lookup"><span data-stu-id="0f69b-151">**ADLS throttling**</span></span> 

<span data-ttu-id="0f69b-152">UIf atingiu limites de Olá de largura de banda fornecida pelo ADLS, seria começar toosee falhas de tarefas.</span><span class="sxs-lookup"><span data-stu-id="0f69b-152">UIf you hit hello limits of bandwidth provided by ADLS, you would start toosee task failures.</span></span> <span data-ttu-id="0f69b-153">Isto pode ser identificado ao observar erros limitação nos registos de tarefas.</span><span class="sxs-lookup"><span data-stu-id="0f69b-153">This could be identified by observing throttling errors in task logs.</span></span>  <span data-ttu-id="0f69b-154">Pode diminuir o paralelismo Olá através do aumento do tamanho do contentor de Tez.</span><span class="sxs-lookup"><span data-stu-id="0f69b-154">You can decrease hello parallelism by increasing Tez container size.</span></span>  <span data-ttu-id="0f69b-155">Se precisar de concorrência mais a tarefa, contacte-nos.</span><span class="sxs-lookup"><span data-stu-id="0f69b-155">If you need more concurrency for your job, please contact us.</span></span>   

<span data-ttu-id="0f69b-156">toocheck se a introdução limitada, terá de depuração de Olá tooenable início de sessão do lado do cliente de Olá.</span><span class="sxs-lookup"><span data-stu-id="0f69b-156">toocheck if you are getting throttled, you need tooenable hello debug logging on hello client side.</span></span> <span data-ttu-id="0f69b-157">Eis como, pode fazê-lo:</span><span class="sxs-lookup"><span data-stu-id="0f69b-157">Here’s how you can do that:</span></span>

1. <span data-ttu-id="0f69b-158">Colocar Olá seguinte propriedade nas propriedades de log4j Olá na configuração do ramo de registo. Isto pode ser feito a partir da vista Ambari: log4j.logger.com.microsoft.azure.datalake.store=DEBUG reiniciar Olá todos os nós/serviço para o efeito de tootake Olá config.</span><span class="sxs-lookup"><span data-stu-id="0f69b-158">Put hello following property in hello log4j properties in Hive config. This can be done from Ambari view: log4j.logger.com.microsoft.azure.datalake.store=DEBUG Restart all hello nodes/service for hello config tootake effect.</span></span>

2. <span data-ttu-id="0f69b-159">Se a introdução limitada, verá o código de erro HTTP 429 Olá no ficheiro de registo do ramo de registo Olá.</span><span class="sxs-lookup"><span data-stu-id="0f69b-159">If you are getting throttled, you’ll see hello HTTP 429 error code in hello hive log file.</span></span> <span data-ttu-id="0f69b-160">ficheiro de registo do ramo de registo Olá consta /tmp/&lt;utilizador&gt;/hive.log</span><span class="sxs-lookup"><span data-stu-id="0f69b-160">hello hive log file is in /tmp/&lt;user&gt;/hive.log</span></span>

## <a name="further-information-on-hive-tuning"></a><span data-ttu-id="0f69b-161">Mais informações sobre a otimização de ramo de registo</span><span class="sxs-lookup"><span data-stu-id="0f69b-161">Further information on Hive tuning</span></span>

<span data-ttu-id="0f69b-162">Seguem-se alguns blogues que o irão ajudar a otimizar as consultas do Hive:</span><span class="sxs-lookup"><span data-stu-id="0f69b-162">Here are a few blogs that will help tune your Hive queries:</span></span>
* [<span data-ttu-id="0f69b-163">Otimizar as consultas do Hive do Hadoop no HDInsight</span><span class="sxs-lookup"><span data-stu-id="0f69b-163">Optimize Hive queries for Hadoop in HDInsight</span></span>](https://azure.microsoft.com/en-us/documentation/articles/hdinsight-hadoop-optimize-hive-query/)
* [<span data-ttu-id="0f69b-164">Resolução de problemas de desempenho das consultas do Hive</span><span class="sxs-lookup"><span data-stu-id="0f69b-164">Troubleshooting Hive query performance</span></span>](https://blogs.msdn.microsoft.com/bigdatasupport/2015/08/13/troubleshooting-hive-query-performance-in-hdinsight-hadoop-cluster/)
* [<span data-ttu-id="0f69b-165">Ignite peça no otimizar do Hive no HDInsight</span><span class="sxs-lookup"><span data-stu-id="0f69b-165">Ignite talk on optimize Hive on HDInsight</span></span>](https://channel9.msdn.com/events/Machine-Learning-and-Data-Sciences-Conference/Data-Science-Summit-2016/MSDSS25)
