---
title: "aaaReplicate uma aplicação do SharePoint de várias camadas utilizando o Azure Site Recovery | Microsoft Docs"
description: "Este artigo descreve como tooreplicate uma aplicação do SharePoint de várias camadas utilizando as capacidades do Azure Site Recovery."
services: site-recovery
documentationcenter: 
author: sujayt
manager: rochakm
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: sutalasi
ms.openlocfilehash: d856034ac2a3c95b0c1f0cf85e62c4e7a5a3210f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="replicate-a-multi-tier-sharepoint-application-for-disaster-recovery-using-azure-site-recovery"></a><span data-ttu-id="6a84b-103">Replicar uma aplicação do SharePoint de várias camadas para a recuperação de desastre utilizando o Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="6a84b-103">Replicate a multi-tier SharePoint application for disaster recovery using Azure Site Recovery</span></span>

<span data-ttu-id="6a84b-104">Este artigo descreve em detalhe como tooprotect um através da aplicação SharePoint [do Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6a84b-104">This article describes in detail how tooprotect a SharePoint application using  [Azure Site Recovery](site-recovery-overview.md).</span></span>


## <a name="overview"></a><span data-ttu-id="6a84b-105">Descrição geral</span><span class="sxs-lookup"><span data-stu-id="6a84b-105">Overview</span></span>

<span data-ttu-id="6a84b-106">Microsoft SharePoint é uma aplicação de elevado desempenho que pode ajudar a um grupo ou o departamento de organizar, colaborar e partilhar informações.</span><span class="sxs-lookup"><span data-stu-id="6a84b-106">Microsoft SharePoint is a powerful application that can help a group or department organize, collaborate, and share information.</span></span> <span data-ttu-id="6a84b-107">SharePoint pode fornecer portais de intranet, gestão de ficheiros e documentos, colaboração, redes sociais, extranets, Web sites, pesquisa de enterprise e business intelligence.</span><span class="sxs-lookup"><span data-stu-id="6a84b-107">SharePoint can provide intranet portals, document and file management, collaboration, social networks, extranets, websites, enterprise search, and business intelligence.</span></span> <span data-ttu-id="6a84b-108">Tem também a integração de sistema, integração de processo e capacidades de automatização do fluxo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="6a84b-108">It also has system integration, process integration, and workflow automation capabilities.</span></span> <span data-ttu-id="6a84b-109">Normalmente, as organizações consideram como uma nível 1 aplicações confidencial toodowntime perda de dados e.</span><span class="sxs-lookup"><span data-stu-id="6a84b-109">Typically, organizations consider it as a Tier-1 application sensitive toodowntime and data loss.</span></span>

<span data-ttu-id="6a84b-110">Hoje em dia, Microsoft SharePoint não fornece quaisquer funcionalidades de recuperação de desastre out of box.</span><span class="sxs-lookup"><span data-stu-id="6a84b-110">Today, Microsoft SharePoint  does not provide any out-of-the-box disaster recovery capabilities.</span></span> <span data-ttu-id="6a84b-111">Independentemente do tipo de Olá e dimensionamento de um desastre, recuperação envolve a utilização de Olá de um centro de dados espera que pode recuperar farm Olá para.</span><span class="sxs-lookup"><span data-stu-id="6a84b-111">Regardless of hello type and scale of a disaster, recovery involves hello use of a standby data center that you can recover hello farm to.</span></span> <span data-ttu-id="6a84b-112">Os centros de dados em modo de espera são necessários para cenários em que sistemas redundantes locais e as cópias de segurança não é possível recuperar da falha de Olá no Centro de dados principal Olá.</span><span class="sxs-lookup"><span data-stu-id="6a84b-112">Standby data centers are required for scenarios where local redundant systems and backups cannot recover from hello outage at hello primary data center.</span></span>

<span data-ttu-id="6a84b-113">Uma solução de recuperação após desastre boa deve permitir a modelação de planos de recuperação em torno de arquiteturas de aplicações complexas de Olá como o SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6a84b-113">A good disaster recovery solution should allow modeling of recovery plans around hello  complex application architectures such as SharePoint.</span></span> <span data-ttu-id="6a84b-114">Também deve ter Olá capacidade tooadd personalizado passos toohandle aplicação mapeamentos entre várias camadas e, por conseguinte, fornecendo uma ativação pós-falha de clique único com um RTO inferior no evento Olá de um desastre.</span><span class="sxs-lookup"><span data-stu-id="6a84b-114">It should also have hello ability tooadd customized steps toohandle application mappings between various tiers and hence providing a single-click failover with a lower RTO in hello event of a disaster.</span></span>

<span data-ttu-id="6a84b-115">Este artigo descreve em detalhe como tooprotect um através da aplicação SharePoint [do Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6a84b-115">This article describes in detail how tooprotect a SharePoint application using [Azure Site Recovery](site-recovery-overview.md).</span></span> <span data-ttu-id="6a84b-116">Este artigo abordará as melhores práticas para replicar uma tooAzure de aplicações do SharePoint de três camadas, como pode fazer um exercício de recuperação após desastre e como pode tooAzure de aplicação Olá de ativação pós-falha.</span><span class="sxs-lookup"><span data-stu-id="6a84b-116">This article will cover best practices for replicating a three tier SharePoint application tooAzure, how you can do a disaster recovery drill, and how you can failover hello application tooAzure.</span></span>

<span data-ttu-id="6a84b-117">Pode ver Olá vídeo sobre como recuperar uma tooAzure de aplicação de camada de várias abaixo.</span><span class="sxs-lookup"><span data-stu-id="6a84b-117">You can watch hello below video about recovering a multi tier application tooAzure.</span></span>

> [!VIDEO https://channel9.msdn.com/Series/Azure-Site-Recovery/Disaster-Recovery-of-load-balanced-multi-tier-applications-using-Azure-Site-Recovery/player]


## <a name="prerequisites"></a><span data-ttu-id="6a84b-118">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="6a84b-118">Prerequisites</span></span>

<span data-ttu-id="6a84b-119">Antes de começar, certifique-se de que compreende seguinte Olá:</span><span class="sxs-lookup"><span data-stu-id="6a84b-119">Before you start, make sure you understand hello following:</span></span>

1. [<span data-ttu-id="6a84b-120">Replicar tooAzure uma máquina virtual</span><span class="sxs-lookup"><span data-stu-id="6a84b-120">Replicating a virtual machine tooAzure</span></span>](site-recovery-vmware-to-azure.md)
2. <span data-ttu-id="6a84b-121">Como demasiado[estruturar uma rede de recuperação](site-recovery-network-design.md)</span><span class="sxs-lookup"><span data-stu-id="6a84b-121">How too[design a recovery network](site-recovery-network-design.md)</span></span>
3. [<span data-ttu-id="6a84b-122">Fazer uma tooAzure de ativação pós-falha de teste</span><span class="sxs-lookup"><span data-stu-id="6a84b-122">Doing a test failover tooAzure</span></span>](site-recovery-test-failover-to-azure.md)
4. [<span data-ttu-id="6a84b-123">Fazer uma tooAzure de ativação pós-falha</span><span class="sxs-lookup"><span data-stu-id="6a84b-123">Doing a failover tooAzure</span></span>](site-recovery-failover.md)
5. <span data-ttu-id="6a84b-124">Como demasiado[replicar um controlador de domínio](site-recovery-active-directory.md)</span><span class="sxs-lookup"><span data-stu-id="6a84b-124">How too[replicate a domain controller](site-recovery-active-directory.md)</span></span>
6. <span data-ttu-id="6a84b-125">Como demasiado[replicar do SQL Server](site-recovery-sql.md)</span><span class="sxs-lookup"><span data-stu-id="6a84b-125">How too[replicate SQL Server](site-recovery-sql.md)</span></span>

## <a name="sharepoint-architecture"></a><span data-ttu-id="6a84b-126">Arquitetura do SharePoint</span><span class="sxs-lookup"><span data-stu-id="6a84b-126">SharePoint architecture</span></span>

<span data-ttu-id="6a84b-127">SharePoint pode ser implementado num ou mais servidores utilizando topologias em camadas e funções de servidor tooimplement uma estrutura de farm que satisfaz os objetivos e objetivos específicos.</span><span class="sxs-lookup"><span data-stu-id="6a84b-127">SharePoint can be deployed on one or more servers using tiered topologies and server roles tooimplement a farm design that meets specific goals and objectives.</span></span> <span data-ttu-id="6a84b-128">Um típico grande, a pedido alta server farm do SharePoint que suporta um número elevado de utilizadores em simultâneo e um grande número de itens de conteúdo utilizar agrupamento do serviço como parte da sua estratégia de escalabilidade.</span><span class="sxs-lookup"><span data-stu-id="6a84b-128">A typical large, high-demand SharePoint server farm that supports a high number of concurrent users and a large number of content items use service grouping as part of their scalability strategy.</span></span> <span data-ttu-id="6a84b-129">Esta abordagem envolve a executar os serviços em servidores dedicados, agrupamento estes serviços em conjunto e, em seguida, aumentar horizontalmente servidores Olá como um grupo.</span><span class="sxs-lookup"><span data-stu-id="6a84b-129">This approach involves running services on dedicated servers, grouping these services together, and then scaling out hello servers as a group.</span></span> <span data-ttu-id="6a84b-130">Olá seguinte topologia ilustra serviço Olá e o servidor de agrupamento para uma camada de três farm de servidores do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6a84b-130">hello following topology illustrates hello service and server grouping for a three tier SharePoint server farm.</span></span> <span data-ttu-id="6a84b-131">. Consulte a documentação de tooSharePoint e arquiteturas de linha de produto para obter orientações detalhadas sobre diferentes topologias do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6a84b-131">Please refer tooSharePoint documentation and product line architectures for detailed guidance on different SharePoint topologies.</span></span> <span data-ttu-id="6a84b-132">Pode encontrar mais detalhes sobre a implementação do SharePoint 2013 no [neste documento](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span><span class="sxs-lookup"><span data-stu-id="6a84b-132">You can find more details about SharePoint 2013 deployment in [this document](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span></span>



![Implementação padrão 1](./media/site-recovery-sharepoint/sharepointarch.png)


## <a name="site-recovery-support"></a><span data-ttu-id="6a84b-134">Suporte de recuperação de site</span><span class="sxs-lookup"><span data-stu-id="6a84b-134">Site Recovery support</span></span>

<span data-ttu-id="6a84b-135">Para criar este artigo, máquinas virtuais VMware com o Windows Server 2012 R2 Enterprise foram utilizadas.</span><span class="sxs-lookup"><span data-stu-id="6a84b-135">For creating this article, VMware virtual machines with Windows Server 2012 R2 Enterprise were used.</span></span> <span data-ttu-id="6a84b-136">SharePoint 2013 Enterprise edition e a edição Enterprise do SQL server 2014 foram utilizados.</span><span class="sxs-lookup"><span data-stu-id="6a84b-136">SharePoint 2013 Enterprise edition and SQL server 2014 Enterprise edition were used.</span></span> <span data-ttu-id="6a84b-137">Como a replicação do Site Recovery desconhece de aplicação, recomendações Olá fornecidas aqui destinam-se toohold esperado nos seguintes cenários, bem como.</span><span class="sxs-lookup"><span data-stu-id="6a84b-137">As Site Recovery replication is application agnostic, hello recommendations provided here are expected toohold on for following scenarios as well.</span></span>

### <a name="source-and-target"></a><span data-ttu-id="6a84b-138">A origem e destino</span><span class="sxs-lookup"><span data-stu-id="6a84b-138">Source and target</span></span>

<span data-ttu-id="6a84b-139">**Cenário**</span><span class="sxs-lookup"><span data-stu-id="6a84b-139">**Scenario**</span></span> | <span data-ttu-id="6a84b-140">**site secundário tooa**</span><span class="sxs-lookup"><span data-stu-id="6a84b-140">**tooa secondary site**</span></span> | <span data-ttu-id="6a84b-141">**tooAzure**</span><span class="sxs-lookup"><span data-stu-id="6a84b-141">**tooAzure**</span></span>
--- | --- | ---
<span data-ttu-id="6a84b-142">**Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="6a84b-142">**Hyper-V**</span></span> | <span data-ttu-id="6a84b-143">Sim</span><span class="sxs-lookup"><span data-stu-id="6a84b-143">Yes</span></span> | <span data-ttu-id="6a84b-144">Sim</span><span class="sxs-lookup"><span data-stu-id="6a84b-144">Yes</span></span>
<span data-ttu-id="6a84b-145">**VMware**</span><span class="sxs-lookup"><span data-stu-id="6a84b-145">**VMware**</span></span> | <span data-ttu-id="6a84b-146">Sim</span><span class="sxs-lookup"><span data-stu-id="6a84b-146">Yes</span></span> | <span data-ttu-id="6a84b-147">Sim</span><span class="sxs-lookup"><span data-stu-id="6a84b-147">Yes</span></span>
<span data-ttu-id="6a84b-148">**Servidor físico**</span><span class="sxs-lookup"><span data-stu-id="6a84b-148">**Physical server**</span></span> | <span data-ttu-id="6a84b-149">Sim</span><span class="sxs-lookup"><span data-stu-id="6a84b-149">Yes</span></span> | <span data-ttu-id="6a84b-150">Sim</span><span class="sxs-lookup"><span data-stu-id="6a84b-150">Yes</span></span>

### <a name="sharepoint-versions"></a><span data-ttu-id="6a84b-151">Versões do SharePoint</span><span class="sxs-lookup"><span data-stu-id="6a84b-151">SharePoint Versions</span></span>
<span data-ttu-id="6a84b-152">Olá seguintes versões do SharePoint server é suportada.</span><span class="sxs-lookup"><span data-stu-id="6a84b-152">hello following SharePoint server versions are supported.</span></span>

* <span data-ttu-id="6a84b-153">Servidor do SharePoint 2013 padrão</span><span class="sxs-lookup"><span data-stu-id="6a84b-153">SharePoint server 2013 Standard</span></span>
* <span data-ttu-id="6a84b-154">SharePoint server 2013 Enterprise</span><span class="sxs-lookup"><span data-stu-id="6a84b-154">SharePoint server 2013 Enterprise</span></span>
* <span data-ttu-id="6a84b-155">Servidor do SharePoint 2016 padrão</span><span class="sxs-lookup"><span data-stu-id="6a84b-155">SharePoint server 2016 Standard</span></span>
* <span data-ttu-id="6a84b-156">SharePoint server 2016 Enterprise</span><span class="sxs-lookup"><span data-stu-id="6a84b-156">SharePoint server 2016 Enterprise</span></span>

### <a name="things-tookeep-in-mind"></a><span data-ttu-id="6a84b-157">Coisas tookeep em mente</span><span class="sxs-lookup"><span data-stu-id="6a84b-157">Things tookeep in mind</span></span>

<span data-ttu-id="6a84b-158">Se estiver a utilizar um cluster partilhado com base em disco como qualquer camada na sua aplicação, em seguida, não poderá ser toouse capaz de recuperação de Site replicação tooreplicate dessas máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="6a84b-158">If you are using a shared disk-based cluster as any tier in your application then you will not be able toouse Site Recovery replication tooreplicate those virtual machines.</span></span> <span data-ttu-id="6a84b-159">Pode utilizar replicação nativa fornecida pela aplicação Olá e, em seguida, utilizar um [plano de recuperação](site-recovery-create-recovery-plans.md) toofailover todas as camadas.</span><span class="sxs-lookup"><span data-stu-id="6a84b-159">You can use native replication provided by hello application and then use a [recovery plan](site-recovery-create-recovery-plans.md) toofailover all tiers.</span></span>

## <a name="replicating-virtual-machines"></a><span data-ttu-id="6a84b-160">Replicar máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="6a84b-160">Replicating virtual machines</span></span>

<span data-ttu-id="6a84b-161">Siga [esta orientação](site-recovery-vmware-to-azure.md) toostart Olá tooAzure de máquina virtual a replicar.</span><span class="sxs-lookup"><span data-stu-id="6a84b-161">Follow [this guidance](site-recovery-vmware-to-azure.md) toostart replicating hello virtual machine tooAzure.</span></span>

* <span data-ttu-id="6a84b-162">Após a conclusão da replicação de Olá, certifique-se de que aceda a máquina virtual de tooeach de cada camada e selecione o mesma conjunto de disponibilidade no ' item replicados > Definições > propriedades > computação e rede '.</span><span class="sxs-lookup"><span data-stu-id="6a84b-162">Once hello replication is complete, make sure you go tooeach virtual machine of each tier and select same availability set in 'Replicated item > Settings > Properties > Compute and Network'.</span></span> <span data-ttu-id="6a84b-163">Por exemplo, se a camada web tiver 3 VMs, certifique-se de Olá todos os 3 VMs são configuradas toobe parte do mesma conjunto de disponibilidade no Azure.</span><span class="sxs-lookup"><span data-stu-id="6a84b-163">For example, if your web tier has 3 VMs, ensure all hello 3 VMs are configured toobe part of same availability set in Azure.</span></span>

    ![Conjunto de disponibilidade de conjunto](./media/site-recovery-sharepoint/select-av-set.png)

* <span data-ttu-id="6a84b-165">Para obter orientações sobre a proteger o Active Directory e DNS, consulte demasiado[proteger o Active Directory e DNS](site-recovery-active-directory.md) documento.</span><span class="sxs-lookup"><span data-stu-id="6a84b-165">For guidance on protecting Active Directory and DNS, refer too[Protect Active Directory and DNS](site-recovery-active-directory.md) document.</span></span>

* <span data-ttu-id="6a84b-166">Para obter orientações sobre a proteção de camada de base de dados em execução no SQL server, consulte demasiado[proteger o SQL Server](site-recovery-active-directory.md) documento.</span><span class="sxs-lookup"><span data-stu-id="6a84b-166">For guidance on protecting database tier running on SQL server, refer too[Protect SQL Server](site-recovery-active-directory.md) document.</span></span>

## <a name="networking-configuration"></a><span data-ttu-id="6a84b-167">Configuração de redes</span><span class="sxs-lookup"><span data-stu-id="6a84b-167">Networking configuration</span></span>

### <a name="network-properties"></a><span data-ttu-id="6a84b-168">Propriedades da rede</span><span class="sxs-lookup"><span data-stu-id="6a84b-168">Network properties</span></span>

* <span data-ttu-id="6a84b-169">Para Olá aplicação e a camada Web VMs, configure definições de rede no portal do Azure para que as VMs de Olá toohello anexado à direita DR rede após a ativação pós-falha.</span><span class="sxs-lookup"><span data-stu-id="6a84b-169">For hello App and Web tier VMs, configure network settings in Azure portal so that hello VMs get attached toohello right DR network after failover.</span></span>

    ![Selecione a rede](./media/site-recovery-sharepoint/select-network.png)


* <span data-ttu-id="6a84b-171">Se estiver a utilizar um IP estático, em seguida, especifique Olá IP que pretende que sejam Olá tootake de máquina virtual no Olá **IP de destino** campo</span><span class="sxs-lookup"><span data-stu-id="6a84b-171">If you are using a static IP, then specify hello IP that you want hello virtual machine tootake in hello **Target IP** field</span></span>

    ![Definir o IP estático](./media/site-recovery-sharepoint/set-static-ip.png)

### <a name="dns-and-traffic-routing"></a><span data-ttu-id="6a84b-173">DNS e o encaminhamento de tráfego</span><span class="sxs-lookup"><span data-stu-id="6a84b-173">DNS and Traffic Routing</span></span>

<span data-ttu-id="6a84b-174">Para a internet com sites, [criar um perfil do Traffic Manager do tipo 'Priority'](../traffic-manager/traffic-manager-create-profile.md) no Olá subscrição do Azure.</span><span class="sxs-lookup"><span data-stu-id="6a84b-174">For internet facing sites, [create a Traffic Manager profile of 'Priority' type](../traffic-manager/traffic-manager-create-profile.md) in hello Azure subscription.</span></span> <span data-ttu-id="6a84b-175">E, em seguida, configure o seu perfil do Traffic Manager e o DNS no Olá seguinte forma.</span><span class="sxs-lookup"><span data-stu-id="6a84b-175">And then configure your DNS and Traffic Manager profile in hello following manner.</span></span>


| <span data-ttu-id="6a84b-176">**Onde**</span><span class="sxs-lookup"><span data-stu-id="6a84b-176">**Where**</span></span> | <span data-ttu-id="6a84b-177">**Origem**</span><span class="sxs-lookup"><span data-stu-id="6a84b-177">**Source**</span></span> | <span data-ttu-id="6a84b-178">**Destino**</span><span class="sxs-lookup"><span data-stu-id="6a84b-178">**Target**</span></span>|
| --- | --- | --- |
| <span data-ttu-id="6a84b-179">DNS público</span><span class="sxs-lookup"><span data-stu-id="6a84b-179">Public DNS</span></span> | <span data-ttu-id="6a84b-180">DNS público para sites do SharePoint</span><span class="sxs-lookup"><span data-stu-id="6a84b-180">Public DNS for SharePoint sites</span></span> <br/><br/> <span data-ttu-id="6a84b-181">Ex: sharepoint.contoso.com</span><span class="sxs-lookup"><span data-stu-id="6a84b-181">Ex: sharepoint.contoso.com</span></span> | <span data-ttu-id="6a84b-182">Gestor de Tráfego</span><span class="sxs-lookup"><span data-stu-id="6a84b-182">Traffic Manager</span></span> <br/><br/> <span data-ttu-id="6a84b-183">contososharepoint.trafficmanager.NET</span><span class="sxs-lookup"><span data-stu-id="6a84b-183">contososharepoint.trafficmanager.net</span></span> |
| <span data-ttu-id="6a84b-184">DNS no local</span><span class="sxs-lookup"><span data-stu-id="6a84b-184">On-premises DNS</span></span> | <span data-ttu-id="6a84b-185">sharepointonprem.contoso.com</span><span class="sxs-lookup"><span data-stu-id="6a84b-185">sharepointonprem.contoso.com</span></span> | <span data-ttu-id="6a84b-186">IP público no farm do Olá no local</span><span class="sxs-lookup"><span data-stu-id="6a84b-186">Public IP on hello on-premises farm</span></span> |


<span data-ttu-id="6a84b-187">No perfil do Gestor de tráfego, de Olá [criar Olá pontos finais primário e de recuperação](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="6a84b-187">In hello Traffic Manager profile, [create hello primary and recovery endpoints](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span></span> <span data-ttu-id="6a84b-188">Utilize o ponto final externo de Olá para o ponto final no local e o IP público para o ponto final do Azure.</span><span class="sxs-lookup"><span data-stu-id="6a84b-188">Use hello external endpoint for on-premises endpoint and public IP for Azure endpoint.</span></span> <span data-ttu-id="6a84b-189">Certifique-se de que Olá prioridade é definida de ponto final de tooon local superior.</span><span class="sxs-lookup"><span data-stu-id="6a84b-189">Ensure that hello priority is set higher tooon-premises endpoint.</span></span>

<span data-ttu-id="6a84b-190">Uma página de teste numa porta específica (por exemplo, 800) na camada de web SharePoint Olá por ordem para tooautomatically do Gestor de tráfego de anfitrião detetar a ativação pós-falha de post de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="6a84b-190">Host a test page on a specific port (for example, 800) in hello SharePoint web tier in order for Traffic Manager tooautomatically detect availability post failover.</span></span> <span data-ttu-id="6a84b-191">Esta é uma solução no caso de não é possível ativar a autenticação anónima em qualquer um dos seus sites do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6a84b-191">This is a workaround in case you cannot enable anonymous authentication on any of your SharePoint sites.</span></span>

<span data-ttu-id="6a84b-192">[Configurar o perfil do Traffic Manager Olá](../traffic-manager/traffic-manager-configure-priority-routing-method.md) com Olá abaixo as definições.</span><span class="sxs-lookup"><span data-stu-id="6a84b-192">[Configure hello Traffic Manager profile](../traffic-manager/traffic-manager-configure-priority-routing-method.md) with hello below settings.</span></span>

* <span data-ttu-id="6a84b-193">Método de encaminhamento - 'Priority'</span><span class="sxs-lookup"><span data-stu-id="6a84b-193">Routing method - 'Priority'</span></span>
* <span data-ttu-id="6a84b-194">DNS tempo toolive (TTL) - ' 30 segundos'</span><span class="sxs-lookup"><span data-stu-id="6a84b-194">DNS time toolive (TTL) - '30 seconds'</span></span>
* <span data-ttu-id="6a84b-195">Definições de monitorização do ponto final - se de que pode ativar a autenticação anónima, pode dar um ponto final do Web site específico.</span><span class="sxs-lookup"><span data-stu-id="6a84b-195">Endpoint monitor settings - If you can enable anonymous authentication, you can give a specific website endpoint.</span></span> <span data-ttu-id="6a84b-196">Em alternativa, pode utilizar uma página de teste numa porta específica (por exemplo, 800).</span><span class="sxs-lookup"><span data-stu-id="6a84b-196">Or, you can use a test page on a specific port (for example, 800).</span></span>

## <a name="creating-a-recovery-plan"></a><span data-ttu-id="6a84b-197">Criar um plano de recuperação</span><span class="sxs-lookup"><span data-stu-id="6a84b-197">Creating a recovery plan</span></span>

<span data-ttu-id="6a84b-198">Um plano de recuperação permite a ativação pós-falha de Olá de várias camadas numa aplicação de várias camada, por conseguinte, manter a consistência da aplicação da sequência.</span><span class="sxs-lookup"><span data-stu-id="6a84b-198">A recovery plan allows sequencing hello failover of various tiers in a multi-tier application, hence, maintaining application consistency.</span></span> <span data-ttu-id="6a84b-199">Siga Olá passos abaixo ao criar um plano de recuperação para uma aplicação web de várias camadas.</span><span class="sxs-lookup"><span data-stu-id="6a84b-199">Follow hello below steps while creating a recovery plan for a multi-tier web application.</span></span> <span data-ttu-id="6a84b-200">[Saiba mais sobre como criar um plano de recuperação](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span><span class="sxs-lookup"><span data-stu-id="6a84b-200">[Learn more about creating a recovery plan](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span></span>

### <a name="adding-virtual-machines-toofailover-groups"></a><span data-ttu-id="6a84b-201">Adicionar grupos de toofailover de máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="6a84b-201">Adding virtual machines toofailover groups</span></span>

1. <span data-ttu-id="6a84b-202">Crie um plano de recuperação por Olá Adicionar aplicação e a camada Web VMs.</span><span class="sxs-lookup"><span data-stu-id="6a84b-202">Create a recovery plan by adding hello App and Web tier VMs.</span></span>
2. <span data-ttu-id="6a84b-203">Clique em 'Personalizar' toogroup Olá VMs.</span><span class="sxs-lookup"><span data-stu-id="6a84b-203">Click on 'Customize' toogroup hello VMs.</span></span> <span data-ttu-id="6a84b-204">Por predefinição, todas as VMs fazem parte do 'Grupo 1'.</span><span class="sxs-lookup"><span data-stu-id="6a84b-204">By default, all VMs are part of 'Group 1'.</span></span>

    ![Personalizar RP](./media/site-recovery-sharepoint/rp-groups.png)

3. <span data-ttu-id="6a84b-206">Criar outro grupo (grupo 2) e mover camada Web de Olá VMs para o novo grupo de Olá.</span><span class="sxs-lookup"><span data-stu-id="6a84b-206">Create another Group (Group 2) and move hello Web tier VMs into hello new group.</span></span> <span data-ttu-id="6a84b-207">O escalão de aplicação VMs deve fazer parte do 'Grupo 1' e a camada Web VMs deve fazer parte do 'Grupo 2'.</span><span class="sxs-lookup"><span data-stu-id="6a84b-207">Your App tier VMs should be part of 'Group 1' and Web tier VMs should be part of 'Group 2'.</span></span> <span data-ttu-id="6a84b-208">Este é tooensure Olá camada VMs efetuar o arranque primeiro seguido de VMs de camada Web de aplicação.</span><span class="sxs-lookup"><span data-stu-id="6a84b-208">This is tooensure that hello App tier VMs boot up first followed by Web tier VMs.</span></span>


### <a name="adding-scripts-toohello-recovery-plan"></a><span data-ttu-id="6a84b-209">Adicionar scripts toohello plano de recuperação</span><span class="sxs-lookup"><span data-stu-id="6a84b-209">Adding scripts toohello recovery plan</span></span>

<span data-ttu-id="6a84b-210">Pode implementar scripts de Azure Site Recovery Olá normalmente utilizada na sua conta de automatização clicar Olá 'Implementar tooAzure' no botão abaixo.</span><span class="sxs-lookup"><span data-stu-id="6a84b-210">You can deploy hello most commonly used Azure Site Recovery scripts into your Automation account clicking hello 'Deploy tooAzure' button below.</span></span> <span data-ttu-id="6a84b-211">Quando estiver a utilizar qualquer script publicado, certifique-se de que segue orientações Olá no script de Olá.</span><span class="sxs-lookup"><span data-stu-id="6a84b-211">When you are using any published script, ensure you follow hello guidance in hello script.</span></span>

<span data-ttu-id="6a84b-212">[![Implementar tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span><span class="sxs-lookup"><span data-stu-id="6a84b-212">[![Deploy tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span></span>

1. <span data-ttu-id="6a84b-213">Adicione um script de pré-ação too'Group 1' toofailover grupo de disponibilidade SQL.</span><span class="sxs-lookup"><span data-stu-id="6a84b-213">Add a pre-action script too'Group 1' toofailover SQL Availability group.</span></span> <span data-ttu-id="6a84b-214">Utilize script de 'ASR-SQL-FailoverAG' Olá publicada nos scripts de exemplo de Olá.</span><span class="sxs-lookup"><span data-stu-id="6a84b-214">Use hello 'ASR-SQL-FailoverAG' script published in hello sample scripts.</span></span> <span data-ttu-id="6a84b-215">Certifique-se de que siga as orientações Olá no script de Olá e Olá necessárias alterações no script de Olá adequadamente.</span><span class="sxs-lookup"><span data-stu-id="6a84b-215">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Adicionar-AG-Script-passo-1](./media/site-recovery-sharepoint/add-ag-script-step1.png)

    ![Adicionar-AG-Script-passo-2](./media/site-recovery-sharepoint/add-ag-script-step2.png)

2. <span data-ttu-id="6a84b-218">Adicione um script de ação post tooattach um balanceador de carga no Olá efetuado a ativação pós-falha de máquinas virtuais da camada Web (grupo 2).</span><span class="sxs-lookup"><span data-stu-id="6a84b-218">Add a post action script tooattach a load balancer on hello failed over virtual machines of Web tier (Group 2).</span></span> <span data-ttu-id="6a84b-219">Utilize script de 'ASR AddSingleLoadBalancer' Olá publicada nos scripts de exemplo de Olá.</span><span class="sxs-lookup"><span data-stu-id="6a84b-219">Use hello 'ASR-AddSingleLoadBalancer' script published in hello sample scripts.</span></span> <span data-ttu-id="6a84b-220">Certifique-se de que siga as orientações Olá no script de Olá e Olá necessárias alterações no script de Olá adequadamente.</span><span class="sxs-lookup"><span data-stu-id="6a84b-220">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Adicionar-LB-Script-passo-1](./media/site-recovery-sharepoint/add-lb-script-step1.png)

    ![Adicionar-LB-Script-passo-2](./media/site-recovery-sharepoint/add-lb-script-step2.png)

3. <span data-ttu-id="6a84b-223">Adicione um passo manual tooupdate Olá DNS registos toopoint toohello novo farm no Azure.</span><span class="sxs-lookup"><span data-stu-id="6a84b-223">Add a manual step tooupdate hello DNS records toopoint toohello new farm in Azure.</span></span>

    * <span data-ttu-id="6a84b-224">Para a internet com sites, não existem atualizações DNS são ativação pós-falha de post necessária.</span><span class="sxs-lookup"><span data-stu-id="6a84b-224">For internet facing sites, no DNS updates are required post failover.</span></span> <span data-ttu-id="6a84b-225">Siga os passos de Olá descritos nos Olá 'Redes orientações' secção tooconfigure Gestor de tráfego.</span><span class="sxs-lookup"><span data-stu-id="6a84b-225">Follow hello steps described in hello 'Networking guidance' section tooconfigure Traffic Manager.</span></span> <span data-ttu-id="6a84b-226">Se tiver sido configurada Olá perfil do Traffic Manager, tal como descrito na secção anterior Olá, adicione uma porta de fictício de tooopen do script (800 no exemplo de Olá) no Olá VM do Azure.</span><span class="sxs-lookup"><span data-stu-id="6a84b-226">If hello Traffic Manager profile has been set up as described in hello previous section, add a script tooopen dummy port (800 in hello example) on hello Azure VM.</span></span>

    * <span data-ttu-id="6a84b-227">Para os sites com acesso internos, adicione um passo manual tooupdate Olá DNS toopoint registos toohello novo Web camada da carga balanceador IP da VM.</span><span class="sxs-lookup"><span data-stu-id="6a84b-227">For internal facing sites, add a manual step tooupdate hello DNS record toopoint toohello new Web tier VM’s load balancer IP.</span></span>

4. <span data-ttu-id="6a84b-228">Adicionar uma aplicação de pesquisa de toorestore passo manual de uma cópia de segurança ou iniciar um novo serviço de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="6a84b-228">Add a manual step toorestore search application from a backup or start a new search service.</span></span>

5. <span data-ttu-id="6a84b-229">Para restaurar a aplicação de serviço de pesquisa de uma cópia de segurança, siga os passos abaixo.</span><span class="sxs-lookup"><span data-stu-id="6a84b-229">For restoring Search service application from a backup, follow below steps.</span></span>

    * <span data-ttu-id="6a84b-230">Este método assume que foi efetuada uma cópia de segurança da aplicação de serviço de pesquisa de Olá antes de evento catastrófica Olá e essa cópia de segurança Olá está disponível no site de Olá DR.</span><span class="sxs-lookup"><span data-stu-id="6a84b-230">This method assumes that a backup of hello Search Service Application was performed before hello catastrophic event and that hello backup is available at hello DR site.</span></span>
    * <span data-ttu-id="6a84b-231">Isto pode facilmente alcançado Agendar cópia de segurança de Olá (por exemplo, uma vez diariamente) e utilizando uma cópia procedimento tooplace Olá de segurança em site Olá DR.</span><span class="sxs-lookup"><span data-stu-id="6a84b-231">This can easily be achieved by scheduling hello backup (for example, once daily) and using a copy procedure tooplace hello backup at hello DR site.</span></span> <span data-ttu-id="6a84b-232">Procedimentos de cópia pode incluir programas de script como AzCopy (cópia do Azure) ou como configurar o DFSR (Serviços de replicação de ficheiros distribuído).</span><span class="sxs-lookup"><span data-stu-id="6a84b-232">Copy procedures could include scripted programs such as AzCopy (Azure Copy) or setting up DFSR (Distributed File Services Replication).</span></span>
    * <span data-ttu-id="6a84b-233">Agora que Olá SharePoint de farm está em execução, navegue Olá Administração Central, 'Cópia de segurança e restaurar' e selecione o restauro.</span><span class="sxs-lookup"><span data-stu-id="6a84b-233">Now that hello SharePoint farm is running, navigate hello Central Administration, 'Backup and Restore' and select Restore.</span></span> <span data-ttu-id="6a84b-234">Olá restauro interrogates localização de cópia de segurança Olá especificada (poderá ter de valor de Olá tooupdate).</span><span class="sxs-lookup"><span data-stu-id="6a84b-234">hello restore interrogates hello backup location specified (you may need tooupdate hello value).</span></span> <span data-ttu-id="6a84b-235">Selecione as cópias de segurança de aplicação de serviço de pesquisa do Olá gostaria toorestore.</span><span class="sxs-lookup"><span data-stu-id="6a84b-235">Select hello Search Service Application backup you would like toorestore.</span></span>
    * <span data-ttu-id="6a84b-236">Pesquisa é restaurada.</span><span class="sxs-lookup"><span data-stu-id="6a84b-236">Search is restored.</span></span> <span data-ttu-id="6a84b-237">Tenha em atenção que Olá restauro espera toofind Olá mesmo topologia (mesmo número de servidores) e as mesmas rígido letras de unidade atribuídas toothose servidores.</span><span class="sxs-lookup"><span data-stu-id="6a84b-237">Keep in mind that hello restore expects toofind hello same topology (same number of servers) and same hard drive letters assigned toothose servers.</span></span> <span data-ttu-id="6a84b-238">Para obter mais informações, consulte ['Aplicação de serviço de pesquisa de restauro no SharePoint 2013'](https://technet.microsoft.com/library/ee748654.aspx) documento.</span><span class="sxs-lookup"><span data-stu-id="6a84b-238">For more information, see ['Restore Search service application in SharePoint 2013'](https://technet.microsoft.com/library/ee748654.aspx) document.</span></span>


6. <span data-ttu-id="6a84b-239">Para começar com uma nova aplicação de serviço de pesquisa, siga os passos abaixo.</span><span class="sxs-lookup"><span data-stu-id="6a84b-239">For starting with a new Search service application, follow below steps.</span></span>

    * <span data-ttu-id="6a84b-240">Este método parte do princípio de que está disponível uma cópia de segurança da base de dados do Olá "Administração de pesquisa" no site de Olá DR.</span><span class="sxs-lookup"><span data-stu-id="6a84b-240">This method assumes that a backup of hello “Search Administration” database is available at hello DR site.</span></span>
    * <span data-ttu-id="6a84b-241">Uma vez que hello outras bases de dados de aplicação de serviço de pesquisa não são replicadas, precisam de toobe recriado.</span><span class="sxs-lookup"><span data-stu-id="6a84b-241">Since hello other Search Service Application databases are not replicated, they need toobe re-created.</span></span> <span data-ttu-id="6a84b-242">por isso, toodo navegue tooCentral administração e eliminar Olá aplicação de serviço de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="6a84b-242">toodo so, navigate tooCentral Administration and delete hello Search Service Application.</span></span> <span data-ttu-id="6a84b-243">Em todos os servidores que Olá anfitrião índice de pesquisa, eliminar ficheiros de índice de Olá.</span><span class="sxs-lookup"><span data-stu-id="6a84b-243">On any servers which host hello Search Index, delete hello index files.</span></span>
    * <span data-ttu-id="6a84b-244">Voltar a criar Olá aplicação de serviço de pesquisa e este recria Olá as bases de dados.</span><span class="sxs-lookup"><span data-stu-id="6a84b-244">Re-create hello Search Service Application and this re-creates hello databases.</span></span> <span data-ttu-id="6a84b-245">Recomenda-se toohave um script preparado que recria esta aplicação de service, uma vez que não é possível tooperform todas as ações através de Olá GUI.</span><span class="sxs-lookup"><span data-stu-id="6a84b-245">It is recommended toohave a prepared script that re-creates this service application since it is not possible tooperform all actions via hello GUI.</span></span> <span data-ttu-id="6a84b-246">Por exemplo, definir localização de unidade de índice de Olá e configurar a topologia de pesquisa de Olá são possíveis apenas utilizando cmdlets do PowerShell do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6a84b-246">For example, setting hello index drive location and configuring hello search topology are only possible by using SharePoint PowerShell cmdlets.</span></span> <span data-ttu-id="6a84b-247">Utilizar o cmdlet do Windows PowerShell de Olá SPEnterpriseSearchServiceApplication de restauro e especifique Olá encontram enviadas para registo e base de dados de administração de pesquisa, Search_Service__DB foram replicadas.</span><span class="sxs-lookup"><span data-stu-id="6a84b-247">Use hello Windows PowerShell cmdlet Restore-SPEnterpriseSearchServiceApplication and specify hello log-shipped and replicated Search Administration database, Search_Service__DB.</span></span> <span data-ttu-id="6a84b-248">Este cmdlet fornece configuração de pesquisa de Olá, esquema, propriedades geridas, as regras e origens e cria um conjunto predefinido de Olá outros componentes.</span><span class="sxs-lookup"><span data-stu-id="6a84b-248">This cmdlet gives hello search configuration, schema, managed properties, rules, and sources and creates a default set of hello other components.</span></span>
    * <span data-ttu-id="6a84b-249">Depois de Olá que aplicação de serviço de pesquisa tem de ser recriadas, tem de iniciar uma pesquisa completa para cada Olá toorestore de origem de conteúdo o serviço de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="6a84b-249">Once hello Search Service Application has be re-created, you must start a full crawl for each content source toorestore hello Search Service.</span></span> <span data-ttu-id="6a84b-250">Perder algumas informações de análise do farm no local de Olá, tais como recomendações de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="6a84b-250">You lose some analytics information from hello on-premises farm, such as search recommendations.</span></span>

7. <span data-ttu-id="6a84b-251">Depois de concluídos todos os passos de Olá, guardar o plano de recuperação Olá e plano de recuperação final Olá terá um aspeto semelhante.</span><span class="sxs-lookup"><span data-stu-id="6a84b-251">Once all hello steps are completed, save hello recovery plan and hello final recovery plan will look like following.</span></span>

    ![RP guardado](./media/site-recovery-sharepoint/saved-rp.png)

## <a name="doing-a-test-failover"></a><span data-ttu-id="6a84b-253">Efetuar uma ativação pós-falha de teste</span><span class="sxs-lookup"><span data-stu-id="6a84b-253">Doing a test failover</span></span>
<span data-ttu-id="6a84b-254">Siga [esta orientação](site-recovery-test-failover-to-azure.md) toodo uma ativação pós-falha de teste.</span><span class="sxs-lookup"><span data-stu-id="6a84b-254">Follow [this guidance](site-recovery-test-failover-to-azure.md) toodo a test failover.</span></span>

1.  <span data-ttu-id="6a84b-255">Aceda tooAzure portal e selecione o Cofre de serviço de recuperação.</span><span class="sxs-lookup"><span data-stu-id="6a84b-255">Go tooAzure portal and select your Recovery Service vault.</span></span>
2.  <span data-ttu-id="6a84b-256">Clique no plano de recuperação de Olá criado da aplicação SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6a84b-256">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="6a84b-257">Clique em "Ativação pós-falha de teste".</span><span class="sxs-lookup"><span data-stu-id="6a84b-257">Click on 'Test Failover'.</span></span>
4.  <span data-ttu-id="6a84b-258">Selecione o ponto de recuperação e o processo de ativação pós-falha de teste de Olá toostart rede virtual do Azure.</span><span class="sxs-lookup"><span data-stu-id="6a84b-258">Select recovery point and Azure virtual network toostart hello test failover process.</span></span>
5.  <span data-ttu-id="6a84b-259">Assim que estiver ambiente secundário Olá cópias de segurança, pode realizar as validações.</span><span class="sxs-lookup"><span data-stu-id="6a84b-259">Once hello secondary environment is up, you can perform your validations.</span></span>
6.  <span data-ttu-id="6a84b-260">Depois de validações Olá estiverem concluídas, pode clicar em 'Limpeza ativação pós-falha de teste"no plano de recuperação Olá e ambiente de ativação pós-falha de teste de Olá limpos.</span><span class="sxs-lookup"><span data-stu-id="6a84b-260">Once hello validations are complete, you can click 'Cleanup test failover' on hello recovery plan and hello test failover environment is cleaned.</span></span>

<span data-ttu-id="6a84b-261">Para obter orientações sobre a fazer a ativação pós-falha de teste do AD e DNS, consulte demasiado[considerações de ativação pós-falha do AD e DNS](site-recovery-active-directory.md#test-failover-considerations) documento.</span><span class="sxs-lookup"><span data-stu-id="6a84b-261">For guidance on doing test failover for AD and DNS, refer too[Test failover considerations for AD and DNS](site-recovery-active-directory.md#test-failover-considerations) document.</span></span>

<span data-ttu-id="6a84b-262">Para obter orientações sobre a efetuar ativação pós-falha de teste para o SQL Server sempre em grupos de disponibilidade, consulte demasiado[fazer testar a ativação pós-falha para o SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) documento.</span><span class="sxs-lookup"><span data-stu-id="6a84b-262">For guidance on doing test failover for SQL Always ON availability groups, refer too[Doing Test failover for SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) document.</span></span>

## <a name="doing-a-failover"></a><span data-ttu-id="6a84b-263">Efetuar uma ativação pós-falha</span><span class="sxs-lookup"><span data-stu-id="6a84b-263">Doing a failover</span></span>
<span data-ttu-id="6a84b-264">Siga [esta orientação](site-recovery-failover.md) para efetuar uma ativação pós-falha.</span><span class="sxs-lookup"><span data-stu-id="6a84b-264">Follow [this guidance](site-recovery-failover.md) for doing a failover.</span></span>

1.  <span data-ttu-id="6a84b-265">Aceda tooAzure portal e selecione o Cofre dos serviços de recuperação.</span><span class="sxs-lookup"><span data-stu-id="6a84b-265">Go tooAzure portal and select your Recovery Services vault.</span></span>
2.  <span data-ttu-id="6a84b-266">Clique no plano de recuperação de Olá criado da aplicação SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6a84b-266">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="6a84b-267">Clique em 'Failover'.</span><span class="sxs-lookup"><span data-stu-id="6a84b-267">Click on 'Failover'.</span></span>
4.  <span data-ttu-id="6a84b-268">Selecione o processo de ativação pós-falha de Olá de toostart de ponto de recuperação.</span><span class="sxs-lookup"><span data-stu-id="6a84b-268">Select recovery point toostart hello failover process.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6a84b-269">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="6a84b-269">Next steps</span></span>
<span data-ttu-id="6a84b-270">Pode saber mais sobre [replicar outras aplicações](site-recovery-workload.md) utilizando a recuperação de sites.</span><span class="sxs-lookup"><span data-stu-id="6a84b-270">You can learn more about [replicating other applications](site-recovery-workload.md) using Site Recovery.</span></span>
