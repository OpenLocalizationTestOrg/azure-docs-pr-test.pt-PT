---
title: aaaCopy uma base de dados SQL do Azure | Microsoft Docs
description: "Criar uma cópia de uma base de dados SQL do Azure"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: 5aaf6bcd-3839-49b5-8c77-cbdf786e359b
ms.service: sql-database
ms.custom: load & move data
ms.devlang: NA
ms.date: 06/15/2017
ms.author: carlrab
ms.workload: data-management
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 64a297d819d6da89600fda60abe8394ae405abfe
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="copy-an-azure-sql-database"></a><span data-ttu-id="d6b76-103">Copiar uma base de dados SQL do Azure</span><span class="sxs-lookup"><span data-stu-id="d6b76-103">Copy an Azure SQL database</span></span>

<span data-ttu-id="d6b76-104">Base de dados SQL do Azure fornece vários métodos para criar uma cópia de uma forma consistente de um SQL do Azure existente da base de dados em qualquer um dos Olá mesmo servidor ou um servidor diferente.</span><span class="sxs-lookup"><span data-stu-id="d6b76-104">Azure SQL Database provides several methods for creating a transactionally consistent copy of an existing Azure SQL database on either hello same server or a different server.</span></span> <span data-ttu-id="d6b76-105">Pode copiar uma base de dados do SQL Server utilizando Olá portal do Azure, o PowerShell ou o T-SQL.</span><span class="sxs-lookup"><span data-stu-id="d6b76-105">You can copy a SQL database by using hello Azure portal, PowerShell, or T-SQL.</span></span> 

## <a name="overview"></a><span data-ttu-id="d6b76-106">Descrição geral</span><span class="sxs-lookup"><span data-stu-id="d6b76-106">Overview</span></span>

<span data-ttu-id="d6b76-107">Uma cópia da base de dados é um instantâneo da base de dados a partir da hora de Olá do pedido de cópia de Olá Olá origem.</span><span class="sxs-lookup"><span data-stu-id="d6b76-107">A database copy is a snapshot of hello source database as of hello time of hello copy request.</span></span> <span data-ttu-id="d6b76-108">Pode selecionar Olá mesmo servidor ou um servidor diferente, o nível de desempenho e o escalão de serviço ou um nível de desempenho diferente dentro Olá mesma camada de serviço (edição).</span><span class="sxs-lookup"><span data-stu-id="d6b76-108">You can select hello same server or a different server, its service tier and performance level, or a different performance level within hello same service tier (edition).</span></span> <span data-ttu-id="d6b76-109">Depois de concluída a cópia de Olá, torna-se uma base de dados totalmente funcional, independente.</span><span class="sxs-lookup"><span data-stu-id="d6b76-109">After hello copy is complete, it becomes a fully functional, independent database.</span></span> <span data-ttu-id="d6b76-110">Neste momento, pode atualizar ou mudar-tooany edição.</span><span class="sxs-lookup"><span data-stu-id="d6b76-110">At this point, you can upgrade or downgrade it tooany edition.</span></span> <span data-ttu-id="d6b76-111">inícios de sessão Olá, os utilizadores e permissões podem ser geridas de forma independente.</span><span class="sxs-lookup"><span data-stu-id="d6b76-111">hello logins, users, and permissions can be managed independently.</span></span>  

## <a name="logins-in-hello-database-copy"></a><span data-ttu-id="d6b76-112">Inícios de sessão na cópia da base de dados de Olá</span><span class="sxs-lookup"><span data-stu-id="d6b76-112">Logins in hello database copy</span></span>

<span data-ttu-id="d6b76-113">Quando copiar uma base de dados toohello mesmo servidor lógico, Olá inícios de sessão mesmos podem ser utilizados em ambas as bases de dados.</span><span class="sxs-lookup"><span data-stu-id="d6b76-113">When you copy a database toohello same logical server, hello same logins can be used on both databases.</span></span> <span data-ttu-id="d6b76-114">utilizar base de dados do toocopy Olá principal de segurança Olá torna-se proprietário da base de dados de Olá na base de dados nova Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-114">hello security principal you use toocopy hello database becomes hello database owner on hello new database.</span></span> <span data-ttu-id="d6b76-115">Todos os utilizadores de base de dados, as suas permissões e a segurança dos mesmos identificadores (SIDs) são copiados toohello cópia de base de dados.</span><span class="sxs-lookup"><span data-stu-id="d6b76-115">All database users, their permissions, and their security identifiers (SIDs) are copied toohello database copy.</span></span>  

<span data-ttu-id="d6b76-116">Quando copia a base de dados tooa lógica servidor diferente, segurança Olá principal num servidor novo Olá fica proprietário da base de dados de Olá na base de dados nova Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-116">When you copy a database tooa different logical server, hello security principal on hello new server becomes hello database owner on hello new database.</span></span> <span data-ttu-id="d6b76-117">Se utilizar [continha os utilizadores de base de dados](sql-database-manage-logins.md) para acesso a dados, certifique-se de que ambos Olá primário e de bases de dados secundárias tem sempre Olá mesmas credenciais de utilizador, pelo que concluir após a conclusão da cópia de Olá imediatamente podem aceder com Olá mesmo credenciais.</span><span class="sxs-lookup"><span data-stu-id="d6b76-117">If you use [contained database users](sql-database-manage-logins.md) for data access, ensure that both hello primary and secondary databases always have hello same user credentials, so that after hello copy is complete you can immediately access it with hello same credentials.</span></span> 

<span data-ttu-id="d6b76-118">Se utilizar [do Azure Active Directory](../active-directory/active-directory-whatis.md), pode eliminar completamente Olá necessário para a gestão de credenciais na cópia de Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-118">If you use [Azure Active Directory](../active-directory/active-directory-whatis.md), you can completely eliminate hello need for managing credentials in hello copy.</span></span> <span data-ttu-id="d6b76-119">No entanto, quando copiar o novo servidor tooa da base de dados de Olá, acesso baseado no início de sessão de Olá poderá não funcionar, porque não existem inícios de sessão Olá no novo servidor de Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-119">However, when you copy hello database tooa new server, hello login-based access might not work, because hello logins do not exist on hello new server.</span></span> <span data-ttu-id="d6b76-120">toolearn sobre a gestão de inícios de sessão quando copiar um base de dados tooa outro servidor lógico, consulte [como toomanage SQL do Azure da base de dados segurança após a recuperação de desastre](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="d6b76-120">toolearn about managing logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> 

<span data-ttu-id="d6b76-121">Depois de copiar Olá for bem sucedida e antes de outros utilizadores são novamente mapeados, apenas hello início de sessão que iniciadas Olá copiar, proprietário da base de dados de Olá, pode iniciar sessão toohello nova base de dados.</span><span class="sxs-lookup"><span data-stu-id="d6b76-121">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span> <span data-ttu-id="d6b76-122">Consulte tooresolve inícios de sessão após a conclusão, Olá copiar operação [resolver inícios de sessão](#resolve-logins).</span><span class="sxs-lookup"><span data-stu-id="d6b76-122">tooresolve logins after hello copying operation is complete, see [Resolve logins](#resolve-logins).</span></span>

## <a name="copy-a-database-by-using-hello-azure-portal"></a><span data-ttu-id="d6b76-123">Copiar uma base de dados utilizando Olá portal do Azure</span><span class="sxs-lookup"><span data-stu-id="d6b76-123">Copy a database by using hello Azure portal</span></span>

<span data-ttu-id="d6b76-124">toocopy uma base de dados utilizando Olá portal do Azure, a página Olá aberto para a base de dados e, em seguida, clique em **cópia**.</span><span class="sxs-lookup"><span data-stu-id="d6b76-124">toocopy a database by using hello Azure portal, open hello page for your database, and then click **Copy**.</span></span> 

   ![Cópia de base de dados](./media/sql-database-copy/database-copy.png)

## <a name="copy-a-database-by-using-powershell"></a><span data-ttu-id="d6b76-126">Copiar uma base de dados utilizando o PowerShell</span><span class="sxs-lookup"><span data-stu-id="d6b76-126">Copy a database by using PowerShell</span></span>

<span data-ttu-id="d6b76-127">toocopy uma base de dados utilizando o PowerShell, utilize Olá [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="d6b76-127">toocopy a database by using PowerShell, use hello [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span></span> 

```PowerShell
New-AzureRmSqlDatabaseCopy -ResourceGroupName "myResourceGroup" `
    -ServerName $sourceserver `
    -DatabaseName "MySampleDatabase" `
    -CopyResourceGroupName "myResourceGroup" `
    -CopyServerName $targetserver `
    -CopyDatabaseName "CopyOfMySampleDatabase"
```

<span data-ttu-id="d6b76-128">Para um script de exemplo completa, consulte [copiar um base de dados tooa novo servidor](scripts/sql-database-copy-database-to-new-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="d6b76-128">For a complete sample script, see [Copy a database tooa new server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span></span>

## <a name="copy-a-database-by-using-transact-sql"></a><span data-ttu-id="d6b76-129">Copiar uma base de dados, utilizando Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d6b76-129">Copy a database by using Transact-SQL</span></span>

<span data-ttu-id="d6b76-130">Inicie sessão no toohello mestra da base de dados com o início de sessão principal Olá ao nível do servidor ou o início de sessão de Olá criado Olá base de dados toocopy.</span><span class="sxs-lookup"><span data-stu-id="d6b76-130">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="d6b76-131">Para a base de dados está a copiar toosucceed, inícios de sessão que não são principal ao nível do servidor de Olá tem de ser membros da função de dbmanager Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-131">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span> <span data-ttu-id="d6b76-132">Para mais informações sobre os inícios de sessão e ligação toohello server, consulte [gerir inícios de sessão](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="d6b76-132">For more information about logins and connecting toohello server, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="d6b76-133">Começar a copiar a base de dados de origem de Olá com Olá [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) instrução.</span><span class="sxs-lookup"><span data-stu-id="d6b76-133">Start copying hello source database with hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) statement.</span></span> <span data-ttu-id="d6b76-134">Executar esta instrução inicia a base de dados de Olá copiar processo.</span><span class="sxs-lookup"><span data-stu-id="d6b76-134">Executing this statement initiates hello database copying process.</span></span> <span data-ttu-id="d6b76-135">Como copiar uma base de dados é um processo assíncrono, Olá instrução CREATE DATABASE devolve antes da cópia da base de dados de Olá está concluída.</span><span class="sxs-lookup"><span data-stu-id="d6b76-135">Because copying a database is an asynchronous process, hello CREATE DATABASE statement returns before hello database copying is complete.</span></span>

### <a name="copy-a-sql-database-toohello-same-server"></a><span data-ttu-id="d6b76-136">Copiar uma toohello de base de dados do SQL server do mesmo</span><span class="sxs-lookup"><span data-stu-id="d6b76-136">Copy a SQL database toohello same server</span></span>
<span data-ttu-id="d6b76-137">Inicie sessão no toohello mestra da base de dados com o início de sessão principal Olá ao nível do servidor ou o início de sessão de Olá criado Olá base de dados toocopy.</span><span class="sxs-lookup"><span data-stu-id="d6b76-137">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="d6b76-138">Para a base de dados está a copiar toosucceed, inícios de sessão que não são principal ao nível do servidor de Olá tem de ser membros da função de dbmanager Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-138">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span>

<span data-ttu-id="d6b76-139">Este comando copia Database1 tooa nova base de dados com o nome Database2 Olá mesmo servidor.</span><span class="sxs-lookup"><span data-stu-id="d6b76-139">This command copies Database1 tooa new database named Database2 on hello same server.</span></span> <span data-ttu-id="d6b76-140">Consoante o tamanho da base de dados Olá, Olá copiar operação poderá demorar toocomplete algum tempo.</span><span class="sxs-lookup"><span data-stu-id="d6b76-140">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-tooa-different-server"></a><span data-ttu-id="d6b76-141">Copie um servidor diferente do SQL Server da base de dados tooa</span><span class="sxs-lookup"><span data-stu-id="d6b76-141">Copy a SQL database tooa different server</span></span>

<span data-ttu-id="d6b76-142">Inicie sessão no toohello mestra da base de dados hello do servidor de destino, servidor de base de dados do SQL Server do olá onde a nova base de dados Olá é toobe criado.</span><span class="sxs-lookup"><span data-stu-id="d6b76-142">Log in toohello master database of hello destination server, hello SQL database server where hello new database is toobe created.</span></span> <span data-ttu-id="d6b76-143">Utilize um início de sessão tem Olá o mesmo nome e palavra-passe como proprietário da base de dados de Olá da base de dados de origem de Olá no servidor de base de dados SQL do Olá origem.</span><span class="sxs-lookup"><span data-stu-id="d6b76-143">Use a login that has hello same name and password as hello database owner of hello source database on hello source SQL database server.</span></span> <span data-ttu-id="d6b76-144">início de sessão Olá no servidor de destino Olá têm também de ser um membro da função de dbmanager Olá ou início de sessão principal Olá ao nível do servidor.</span><span class="sxs-lookup"><span data-stu-id="d6b76-144">hello login on hello destination server must also be a member of hello dbmanager role or be hello server-level principal login.</span></span>

<span data-ttu-id="d6b76-145">Este comando copia Database1 no servidor1 tooa nova base de dados com o nome Database2 no Servidor2.</span><span class="sxs-lookup"><span data-stu-id="d6b76-145">This command copies Database1 on server1 tooa new database named Database2 on server2.</span></span> <span data-ttu-id="d6b76-146">Consoante o tamanho da base de dados Olá, Olá copiar operação poderá demorar toocomplete algum tempo.</span><span class="sxs-lookup"><span data-stu-id="d6b76-146">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database of hello target server (server2)
    -- Start copying from Server1 tooServer2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;


### <a name="monitor-hello-progress-of-hello-copying-operation"></a><span data-ttu-id="d6b76-147">Monitorizar o progresso de Olá de Olá copiar operação</span><span class="sxs-lookup"><span data-stu-id="d6b76-147">Monitor hello progress of hello copying operation</span></span>

<span data-ttu-id="d6b76-148">Monitorizar o processo de cópia de Olá consultando vistas de Databases e sys.dm_database_copies Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-148">Monitor hello copying process by querying hello sys.databases and sys.dm_database_copies views.</span></span> <span data-ttu-id="d6b76-149">Enquanto Olá copiar está em curso, Olá **state_desc** coluna da vista de Databases Olá para a nova base de dados Olá estiver definida demasiado**copiar**.</span><span class="sxs-lookup"><span data-stu-id="d6b76-149">While hello copying is in progress, hello **state_desc** column of hello sys.databases view for hello new database is set too**COPYING**.</span></span>

* <span data-ttu-id="d6b76-150">Se copiar Olá falhar, Olá **state_desc** coluna da vista de Databases Olá para a nova base de dados Olá estiver definida demasiado**SUSPEITAR**.</span><span class="sxs-lookup"><span data-stu-id="d6b76-150">If hello copying fails, hello **state_desc** column of hello sys.databases view for hello new database is set too**SUSPECT**.</span></span> <span data-ttu-id="d6b76-151">Executar Olá instrução DROP na base de dados nova Olá e tente novamente mais tarde.</span><span class="sxs-lookup"><span data-stu-id="d6b76-151">Execute hello DROP statement on hello new database, and try again later.</span></span>
* <span data-ttu-id="d6b76-152">Se copiar Olá for bem sucedida, hello **state_desc** coluna da vista de Databases Olá para a nova base de dados Olá estiver definida demasiado**ONLINE**.</span><span class="sxs-lookup"><span data-stu-id="d6b76-152">If hello copying succeeds, hello **state_desc** column of hello sys.databases view for hello new database is set too**ONLINE**.</span></span> <span data-ttu-id="d6b76-153">Copiar Olá estiver concluída, não sendo nova base de dados Olá uma base de dados normal que pode ser alterado independente da base de dados de origem de Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-153">hello copying is complete, and hello new database is a regular database that can be changed independent of hello source database.</span></span>

> [!NOTE]
> <span data-ttu-id="d6b76-154">Se decidir toocancel Olá copiar enquanto esta se encontra em curso, executar Olá [remover a base de dados](https://msdn.microsoft.com/library/ms178613.aspx) instrução na base de dados nova Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-154">If you decide toocancel hello copying while it is in progress, execute hello [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) statement on hello new database.</span></span> <span data-ttu-id="d6b76-155">Em alternativa, ao executar a instrução de remover a base de dados de Olá na base de dados de origem de Olá também cancela Olá copiar processo.</span><span class="sxs-lookup"><span data-stu-id="d6b76-155">Alternatively, executing hello DROP DATABASE statement on hello source database also cancels hello copying process.</span></span>
> 

## <a name="resolve-logins"></a><span data-ttu-id="d6b76-156">Resolver inícios de sessão</span><span class="sxs-lookup"><span data-stu-id="d6b76-156">Resolve logins</span></span>

<span data-ttu-id="d6b76-157">Após a conclusão da nova base de dados Olá online no servidor de destino Olá, utilize Olá [ALTER utilizador](https://msdn.microsoft.com/library/ms176060.aspx) instrução tooremap Olá utilizadores Olá novos da base de dados toologins no servidor de destino Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-157">After hello new database is online on hello destination server, use hello [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) statement tooremap hello users from hello new database toologins on hello destination server.</span></span> <span data-ttu-id="d6b76-158">utilizadores de tooresolve órfão, consulte [resolver utilizadores órfãos](https://msdn.microsoft.com/library/ms175475.aspx).</span><span class="sxs-lookup"><span data-stu-id="d6b76-158">tooresolve orphaned users, see [Troubleshoot Orphaned Users](https://msdn.microsoft.com/library/ms175475.aspx).</span></span> <span data-ttu-id="d6b76-159">Consulte também [como toomanage SQL do Azure da base de dados segurança após a recuperação de desastre](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="d6b76-159">See also [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

<span data-ttu-id="d6b76-160">Todos os utilizadores na base de dados nova Olá mantém as permissões de Olá que tinham na base de dados de origem de Olá.</span><span class="sxs-lookup"><span data-stu-id="d6b76-160">All users in hello new database retain hello permissions that they had in hello source database.</span></span> <span data-ttu-id="d6b76-161">utilizador de Olá que iniciou a cópia da base de dados de Olá torna-se Olá proprietário de base de dados da base de dados nova Olá e é atribuído um novo identificador de segurança (SID).</span><span class="sxs-lookup"><span data-stu-id="d6b76-161">hello user who initiated hello database copy becomes hello database owner of hello new database and is assigned a new security identifier (SID).</span></span> <span data-ttu-id="d6b76-162">Depois de copiar Olá for bem sucedida e antes de outros utilizadores são novamente mapeados, apenas hello início de sessão que iniciadas Olá copiar, proprietário da base de dados de Olá, pode iniciar sessão toohello nova base de dados.</span><span class="sxs-lookup"><span data-stu-id="d6b76-162">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span>

<span data-ttu-id="d6b76-163">toolearn sobre a gestão de utilizadores e os inícios de sessão quando copiar um base de dados tooa outro servidor lógico, consulte [como toomanage SQL do Azure da base de dados segurança após a recuperação de desastre](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="d6b76-163">toolearn about managing users and logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="d6b76-164">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="d6b76-164">Next steps</span></span>

* <span data-ttu-id="d6b76-165">Para obter informações sobre os inícios de sessão, consulte [gerir inícios de sessão](sql-database-manage-logins.md) e [como toomanage SQL do Azure da base de dados segurança após a recuperação de desastre](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="d6b76-165">For information about logins, see [Manage logins](sql-database-manage-logins.md) and [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
* <span data-ttu-id="d6b76-166">tooexport uma base de dados, consulte [exportar a base de dados de Olá tooa BACPAC](sql-database-export.md).</span><span class="sxs-lookup"><span data-stu-id="d6b76-166">tooexport a database, see [Export hello database tooa BACPAC](sql-database-export.md).</span></span>
