---
title: aaaOperating arquivo de consultas na SQL Database do Azure
description: "Saiba como toooperate Olá arquivo de consultas na SQL Database do Azure"
keywords: 
services: sql-database
documentationcenter: 
author: bonova
manager: jhubbard
editor: 
ms.assetid: 0cccf6bd-1327-44f7-a6f9-8eff0c210463
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: sqldb-performance
ms.workload: data-management
ms.date: 11/08/2016
ms.author: bonova
ms.openlocfilehash: ab741e49685bf6df3bceab219aaf57ea51cdb25d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="operating-hello-query-store-in-azure-sql-database"></a><span data-ttu-id="90bd2-103">Sistema operativo Olá arquivo de consultas na SQL Database do Azure</span><span class="sxs-lookup"><span data-stu-id="90bd2-103">Operating hello Query Store in Azure SQL Database</span></span>
<span data-ttu-id="90bd2-104">O arquivo de consultas no Azure é uma funcionalidade de base de dados completamente gerido que continuamente recolhe e apresenta informações detalhadas de históricos sobre todas as consultas.</span><span class="sxs-lookup"><span data-stu-id="90bd2-104">Query Store in Azure is a fully managed database feature that continuously collects and presents detailed historic information about all queries.</span></span> <span data-ttu-id="90bd2-105">Pode pensar sobre o arquivo de consultas como dados gravador semelhante avião de tooan que significativamente simplifica o desempenho das consultas de resolução de problemas para a nuvem e os clientes no local.</span><span class="sxs-lookup"><span data-stu-id="90bd2-105">You can think about Query Store as similar tooan airplane's flight data recorder that significantly simplifies query performance troubleshooting both for cloud and on-premises customers.</span></span> <span data-ttu-id="90bd2-106">Este artigo explica os aspetos específicos de operativo arquivo de consultas no Azure.</span><span class="sxs-lookup"><span data-stu-id="90bd2-106">This article explains specific aspects of operating Query Store in Azure.</span></span> <span data-ttu-id="90bd2-107">Com esta consulta previamente recolhidos dados, pode rapidamente diagnosticar e resolver problemas de desempenho e, por conseguinte, demora mais tempo a concentrar-se na sua empresa.</span><span class="sxs-lookup"><span data-stu-id="90bd2-107">Using this pre-collected query data, you can quickly diagnose and resolve performance problems and thus spend more time focusing on their business.</span></span> 

<span data-ttu-id="90bd2-108">O arquivo de consultas foi [globalmente disponível](https://azure.microsoft.com/updates/general-availability-azure-sql-database-query-store/) na base de dados do Azure SQL desde Novembro de 2015.</span><span class="sxs-lookup"><span data-stu-id="90bd2-108">Query Store has been [globally available](https://azure.microsoft.com/updates/general-availability-azure-sql-database-query-store/) in Azure SQL Database since November, 2015.</span></span> <span data-ttu-id="90bd2-109">Arquivo de consultas está foundation Olá para análise de desempenho e a otimização de funcionalidades, tais como [Advisor de base de dados do SQL Server e o Dashboard de desempenho](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span><span class="sxs-lookup"><span data-stu-id="90bd2-109">Query Store is hello foundation for performance analysis and tuning features, such as [SQL Database Advisor and Performance Dashboard](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span></span> <span data-ttu-id="90bd2-110">Momento Olá de publicação deste artigo, o arquivo de consultas está em execução em mais de 200 000 bases de dados do utilizador no Azure, recolha informações relacionadas com a consulta para vários meses, sem interrupção.</span><span class="sxs-lookup"><span data-stu-id="90bd2-110">At hello moment of publishing this article, Query Store is running in more than 200,000 user databases in Azure, collecting query-related information for several months, without interruption.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="90bd2-111">A Microsoft está no processo de Olá de ativar o arquivo de consultas para todas as bases de dados do SQL do Azure (existentes e novos).</span><span class="sxs-lookup"><span data-stu-id="90bd2-111">Microsoft is in hello process of activating Query Store for all Azure SQL databases (existing and new).</span></span> 
> 
> 

## <a name="optimal-query-store-configuration"></a><span data-ttu-id="90bd2-112">Configuração do arquivo de consultas ideal</span><span class="sxs-lookup"><span data-stu-id="90bd2-112">Optimal Query Store Configuration</span></span>
<span data-ttu-id="90bd2-113">Esta secção descreve as predefinições de configuração ideal que são tooensure concebida operação fiável de arquivo de consultas Olá e funcionalidades dependentes, tais como [Advisor de base de dados do SQL Server e o Dashboard de desempenho](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span><span class="sxs-lookup"><span data-stu-id="90bd2-113">This section describes optimal configuration defaults that are designed tooensure reliable operation of hello Query Store and dependent features, such as [SQL Database Advisor and Performance Dashboard](https://azure.microsoft.com/updates/sqldatabaseadvisorga/).</span></span> <span data-ttu-id="90bd2-114">Configuração predefinida está otimizada para recolha de dados contínua, que é o mínimo tempo despendido no OFF/READ_ONLY Estados.</span><span class="sxs-lookup"><span data-stu-id="90bd2-114">Default configuration is optimized for continuous data collection, that is minimal time spent in OFF/READ_ONLY states.</span></span>

| <span data-ttu-id="90bd2-115">Configuração</span><span class="sxs-lookup"><span data-stu-id="90bd2-115">Configuration</span></span> | <span data-ttu-id="90bd2-116">Descrição</span><span class="sxs-lookup"><span data-stu-id="90bd2-116">Description</span></span> | <span data-ttu-id="90bd2-117">Predefinição</span><span class="sxs-lookup"><span data-stu-id="90bd2-117">Default</span></span> | <span data-ttu-id="90bd2-118">Comentário</span><span class="sxs-lookup"><span data-stu-id="90bd2-118">Comment</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="90bd2-119">MAX_STORAGE_SIZE_MB</span><span class="sxs-lookup"><span data-stu-id="90bd2-119">MAX_STORAGE_SIZE_MB</span></span> |<span data-ttu-id="90bd2-120">Especifica o limite de Olá de espaço de dados de Olá que pode efetuar o arquivo de consultas no interior da base de dados de cliente de z</span><span class="sxs-lookup"><span data-stu-id="90bd2-120">Specifies hello limit for hello data space that Query Store can take inside z customer database</span></span> |<span data-ttu-id="90bd2-121">100</span><span class="sxs-lookup"><span data-stu-id="90bd2-121">100</span></span> |<span data-ttu-id="90bd2-122">Imposto para novas bases de dados</span><span class="sxs-lookup"><span data-stu-id="90bd2-122">Enforced for new databases</span></span> |
| <span data-ttu-id="90bd2-123">INTERVAL_LENGTH_MINUTES</span><span class="sxs-lookup"><span data-stu-id="90bd2-123">INTERVAL_LENGTH_MINUTES</span></span> |<span data-ttu-id="90bd2-124">Define o tamanho de janela de tempo durante os quais as estatísticas de tempo de execução recolhidos para planos de consulta são agregadas e persistente.</span><span class="sxs-lookup"><span data-stu-id="90bd2-124">Defines size of time window during which collected runtime statistics for query plans are aggregated and persisted.</span></span> <span data-ttu-id="90bd2-125">Cada plano de consulta ativa tem no máximo uma linha para um período de tempo definido com esta configuração</span><span class="sxs-lookup"><span data-stu-id="90bd2-125">Every active query plan has at most one row for a period of time defined with this configuration</span></span> |<span data-ttu-id="90bd2-126">60</span><span class="sxs-lookup"><span data-stu-id="90bd2-126">60</span></span> |<span data-ttu-id="90bd2-127">Imposto para novas bases de dados</span><span class="sxs-lookup"><span data-stu-id="90bd2-127">Enforced for new databases</span></span> |
| <span data-ttu-id="90bd2-128">STALE_QUERY_THRESHOLD_DAYS</span><span class="sxs-lookup"><span data-stu-id="90bd2-128">STALE_QUERY_THRESHOLD_DAYS</span></span> |<span data-ttu-id="90bd2-129">Política de limpeza baseados no tempo que controla o período de retenção de Olá de estatísticas de tempo de execução persistente e consultas Inativas</span><span class="sxs-lookup"><span data-stu-id="90bd2-129">Time-based cleanup policy that controls hello retention period of persisted runtime statistics and inactive queries</span></span> |<span data-ttu-id="90bd2-130">30</span><span class="sxs-lookup"><span data-stu-id="90bd2-130">30</span></span> |<span data-ttu-id="90bd2-131">Imposto para novas bases de dados e bases de dados com predefinido anterior (367)</span><span class="sxs-lookup"><span data-stu-id="90bd2-131">Enforced for new databases and databases with previous default (367)</span></span> |
| <span data-ttu-id="90bd2-132">SIZE_BASED_CLEANUP_MODE</span><span class="sxs-lookup"><span data-stu-id="90bd2-132">SIZE_BASED_CLEANUP_MODE</span></span> |<span data-ttu-id="90bd2-133">Especifica se a limpeza de dados automática ocorre quando o limite de Olá se aproxima de tamanho de dados de arquivo de consultas</span><span class="sxs-lookup"><span data-stu-id="90bd2-133">Specifies whether automatic data cleanup takes place when Query Store data size approaches hello limit</span></span> |<span data-ttu-id="90bd2-134">AUTOMÁTICA</span><span class="sxs-lookup"><span data-stu-id="90bd2-134">AUTO</span></span> |<span data-ttu-id="90bd2-135">Imposto para todas as bases de dados</span><span class="sxs-lookup"><span data-stu-id="90bd2-135">Enforced for all databases</span></span> |
| <span data-ttu-id="90bd2-136">QUERY_CAPTURE_MODE</span><span class="sxs-lookup"><span data-stu-id="90bd2-136">QUERY_CAPTURE_MODE</span></span> |<span data-ttu-id="90bd2-137">Especifica se são controlados todas as consultas ou apenas um subconjunto de consultas</span><span class="sxs-lookup"><span data-stu-id="90bd2-137">Specifies whether all queries or only a subset of queries are tracked</span></span> |<span data-ttu-id="90bd2-138">AUTOMÁTICA</span><span class="sxs-lookup"><span data-stu-id="90bd2-138">AUTO</span></span> |<span data-ttu-id="90bd2-139">Imposto para todas as bases de dados</span><span class="sxs-lookup"><span data-stu-id="90bd2-139">Enforced for all databases</span></span> |
| <span data-ttu-id="90bd2-140">FLUSH_INTERVAL_SECONDS</span><span class="sxs-lookup"><span data-stu-id="90bd2-140">FLUSH_INTERVAL_SECONDS</span></span> |<span data-ttu-id="90bd2-141">Especifica o período máximo durante o qual as estatísticas de tempo de execução capturada são mantidas na memória, antes de libertar toodisk</span><span class="sxs-lookup"><span data-stu-id="90bd2-141">Specifies maximum period during which captured runtime statistics are kept in memory, before flushing toodisk</span></span> |<span data-ttu-id="90bd2-142">900</span><span class="sxs-lookup"><span data-stu-id="90bd2-142">900</span></span> |<span data-ttu-id="90bd2-143">Imposto para novas bases de dados</span><span class="sxs-lookup"><span data-stu-id="90bd2-143">Enforced for new databases</span></span> |
|  | | | |

> [!IMPORTANT]
> <span data-ttu-id="90bd2-144">Estas predefinições são automaticamente aplicadas na fase final de Olá de ativação de arquivo de consultas em todas as bases de dados SQL do Azure (ver nota importante anterior).</span><span class="sxs-lookup"><span data-stu-id="90bd2-144">These defaults are automatically applied in hello final stage of Query Store activation in all Azure SQL databases (see preceding important note).</span></span> <span data-ttu-id="90bd2-145">Após este leve cópias de segurança, SQL Database do Azure não estar a alterar os valores de configuração definidos pelos clientes, a menos que possam afetam negativamente carga de trabalho primária ou operações fiáveis de Olá arquivo de consultas.</span><span class="sxs-lookup"><span data-stu-id="90bd2-145">After this light up, Azure SQL Database won’t be changing configuration values set by customers, unless they negatively impact primary workload or reliable operations of hello Query Store.</span></span>
> 
> 

<span data-ttu-id="90bd2-146">Se pretender toostay com as definições personalizadas, utilize [ALTER DATABASE com opções de arquivo de consultas](https://msdn.microsoft.com/library/bb522682.aspx) estado anterior do toorevert configuração toohello.</span><span class="sxs-lookup"><span data-stu-id="90bd2-146">If you want toostay with your custom settings, use [ALTER DATABASE with Query Store options](https://msdn.microsoft.com/library/bb522682.aspx) toorevert configuration toohello previous state.</span></span> <span data-ttu-id="90bd2-147">Veja [melhores práticas com Olá arquivo de consultas](https://msdn.microsoft.com/library/mt604821.aspx) ordem toolearn como superior escolheu parâmetros de configuração ideal.</span><span class="sxs-lookup"><span data-stu-id="90bd2-147">Check out [Best Practices with hello Query Store](https://msdn.microsoft.com/library/mt604821.aspx) in order toolearn how top chose optimal configuration parameters.</span></span>

## <a name="next-steps"></a><span data-ttu-id="90bd2-148">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="90bd2-148">Next steps</span></span>
[<span data-ttu-id="90bd2-149">Informações de desempenho de base de dados do SQL Server</span><span class="sxs-lookup"><span data-stu-id="90bd2-149">SQL Database Performance Insight</span></span>](sql-database-performance.md)

## <a name="additional-resources"></a><span data-ttu-id="90bd2-150">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="90bd2-150">Additional resources</span></span>
<span data-ttu-id="90bd2-151">Para obter mais informações modificações Olá seguintes artigos:</span><span class="sxs-lookup"><span data-stu-id="90bd2-151">For more information check out hello following articles:</span></span>

* [<span data-ttu-id="90bd2-152">Um gravador de dados para a base de dados</span><span class="sxs-lookup"><span data-stu-id="90bd2-152">A flight data recorder for your database</span></span>](https://azure.microsoft.com/blog/query-store-a-flight-data-recorder-for-your-database) 
* [<span data-ttu-id="90bd2-153">Monitorização de desempenho ao utilizar o arquivo de consultas Olá</span><span class="sxs-lookup"><span data-stu-id="90bd2-153">Monitoring Performance By Using hello Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx)
* [<span data-ttu-id="90bd2-154">Cenários de utilização do arquivo de consultas</span><span class="sxs-lookup"><span data-stu-id="90bd2-154">Query Store Usage Scenarios</span></span>](https://msdn.microsoft.com/library/mt614796.aspx)
* [<span data-ttu-id="90bd2-155">Monitorização de desempenho ao utilizar o arquivo de consultas Olá</span><span class="sxs-lookup"><span data-stu-id="90bd2-155">Monitoring Performance By Using hello Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx) 

