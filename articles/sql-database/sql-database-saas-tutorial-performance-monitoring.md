---
title: "desempenho de aaaMonitor de muitas bases de dados SQL do Azure numa aplicação SaaS multi-inquilino | Microsoft Docs"
description: "Monitorizar e gerir o desempenho de bases de dados e agrupamentos de aplicações do Azure SQL da base de dados Wingtip SaaS de Olá"
keywords: tutorial de base de dados sql
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: f0d7ba456c485b7de249a56abac3cf4be3857285
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-performance-of-hello-wingtip-saas-application"></a><span data-ttu-id="044af-104">Monitorizar o desempenho de Olá aplicação Wingtip SaaS</span><span class="sxs-lookup"><span data-stu-id="044af-104">Monitor performance of hello Wingtip SaaS application</span></span>

<span data-ttu-id="044af-105">Neste tutorial, são explorou vários cenários de gestão de chave de desempenho utilizados em aplicações SaaS.</span><span class="sxs-lookup"><span data-stu-id="044af-105">In this tutorial, several key performance management scenarios used in SaaS applications are explored.</span></span> <span data-ttu-id="044af-106">Utilizar uma atividade de toosimulate do gerador de carga em todas as bases de dados do inquilino, Olá incorporada monitorização e alertas funcionalidades da base de dados SQL e conjuntos elásticos são demonstradas.</span><span class="sxs-lookup"><span data-stu-id="044af-106">Using a load generator toosimulate activity across all tenant databases, hello built-in monitoring and alerting features of SQL Database and elastic pools are demonstrated.</span></span>

<span data-ttu-id="044af-107">aplicações de Wingtip SaaS Olá utilizam um modelo de dados de inquilino único, onde cada venue (inquilino) tem a sua própria base de dados.</span><span class="sxs-lookup"><span data-stu-id="044af-107">hello Wingtip SaaS app uses a single-tenant data model, where each venue (tenant) has their own database.</span></span> <span data-ttu-id="044af-108">Como muitas aplicações de SaaS, Olá antecipado padrão de carga de trabalho de inquilino é imprevisível e esporádicas.</span><span class="sxs-lookup"><span data-stu-id="044af-108">Like many SaaS applications, hello anticipated tenant workload pattern is unpredictable and sporadic.</span></span> <span data-ttu-id="044af-109">Por outras palavras, as vendas de bilhetes podem ocorrer em qualquer altura.</span><span class="sxs-lookup"><span data-stu-id="044af-109">In other words, ticket sales may occur at any time.</span></span> <span data-ttu-id="044af-110">tootake vantagem deste padrão de utilização de base de dados típicas, inquilino bases de dados são implementadas em agrupamentos de bases de dados elásticas.</span><span class="sxs-lookup"><span data-stu-id="044af-110">tootake advantage of this typical database usage pattern, tenant databases are deployed into elastic database pools.</span></span> <span data-ttu-id="044af-111">Conjuntos elásticos otimizam os custos de Olá de uma solução, partilhar recursos em muitas bases de dados.</span><span class="sxs-lookup"><span data-stu-id="044af-111">Elastic pools optimize hello cost of a solution by sharing resources across many databases.</span></span> <span data-ttu-id="044af-112">Com este tipo de padrão, é importante toomonitor base de dados e tooensure de utilização de recursos de agrupamento carrega razoavelmente são equilibrados entre conjuntos.</span><span class="sxs-lookup"><span data-stu-id="044af-112">With this type of pattern, it's important toomonitor database and pool resource usage tooensure that loads are reasonably balanced across pools.</span></span> <span data-ttu-id="044af-113">Também precisa de tooensure que bases de dados individuais tem recursos adequados e de que os conjuntos são não atingir os seus [eDTU](sql-database-what-is-a-dtu.md) limites.</span><span class="sxs-lookup"><span data-stu-id="044af-113">You also need tooensure that individual databases have adequate resources, and that pools are not hitting their [eDTU](sql-database-what-is-a-dtu.md) limits.</span></span> <span data-ttu-id="044af-114">Este tutorial explicar toomonitor formas e gerir bases de dados e agrupamentos e como uma ação corretiva tootake na resposta toovariations numa carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="044af-114">This tutorial explores ways toomonitor and manage databases and pools, and how tootake corrective action in response toovariations in workload.</span></span>

<span data-ttu-id="044af-115">Neste tutorial, ficará a saber como:</span><span class="sxs-lookup"><span data-stu-id="044af-115">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="044af-116">Simular a utilização de bases de dados do Olá inquilino ao executar um gerador de carga fornecido</span><span class="sxs-lookup"><span data-stu-id="044af-116">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="044af-117">Inquilino do monitor Olá as bases de dados como estes respondem toohello aumento de carga</span><span class="sxs-lookup"><span data-stu-id="044af-117">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="044af-118">Aumentar verticalmente Olá conjunto elástico em resposta toohello da base de dados de aumento de carga</span><span class="sxs-lookup"><span data-stu-id="044af-118">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="044af-119">Aprovisionar uma segunda atividade de base de dados de balanceamento do tooload conjunto elástico</span><span class="sxs-lookup"><span data-stu-id="044af-119">Provision a second Elastic pool tooload balance database activity</span></span>


<span data-ttu-id="044af-120">toocomplete neste tutorial, Olá se disponibilizar os seguintes pré-requisitos estão concluídas:</span><span class="sxs-lookup"><span data-stu-id="044af-120">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="044af-121">Olá Wingtip SaaS aplicação é implementada.</span><span class="sxs-lookup"><span data-stu-id="044af-121">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="044af-122">toodeploy em menos de cinco minutos, consulte [implementar e explorar aplicações de Wingtip SaaS Olá](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="044af-122">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="044af-123">O Azure PowerShell está instalado.</span><span class="sxs-lookup"><span data-stu-id="044af-123">Azure PowerShell is installed.</span></span> <span data-ttu-id="044af-124">Para obter mais detalhes, veja [Introdução ao Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="044af-124">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toosaas-performance-management-patterns"></a><span data-ttu-id="044af-125">Padrões de gestão de desempenho de tooSaaS de introdução</span><span class="sxs-lookup"><span data-stu-id="044af-125">Introduction tooSaaS performance management patterns</span></span>

<span data-ttu-id="044af-126">Gerir o desempenho de base de dados consiste em compilar e analisar dados de desempenho e, em seguida, agir os dados de toothis ao ajustar os parâmetros toomaintain um tempo de resposta aceitável para a sua aplicação.</span><span class="sxs-lookup"><span data-stu-id="044af-126">Managing database performance consists of compiling and analyzing performance data, and then reacting toothis data by adjusting parameters toomaintain an acceptable response time for your application.</span></span> <span data-ttu-id="044af-127">Quando alojam vários inquilinos, conjuntos de bases de dados elásticas estão tooprovide uma forma económica e gerir os recursos para um grupo de bases de dados com cargas de trabalho imprevisíveis.</span><span class="sxs-lookup"><span data-stu-id="044af-127">When hosting multiple tenants, Elastic database pools are a cost-effective way tooprovide and manage resources for a group of databases with unpredictable workloads.</span></span> <span data-ttu-id="044af-128">Com determinados padrões de carga de trabalho, um mínimo de duas bases de dados S3 pode beneficiar ao serem geridas num conjunto.</span><span class="sxs-lookup"><span data-stu-id="044af-128">With certain workload patterns, as few as two S3 databases can benefit from being managed in a pool.</span></span>

![suporte de dados](./media/sql-database-saas-tutorial-performance-monitoring/app-diagram.png)

<span data-ttu-id="044af-130">Os conjuntos e bases de dados de Olá em conjuntos, devem ser tooensure monitorizado, ficam nos intervalos aceitáveis de desempenho.</span><span class="sxs-lookup"><span data-stu-id="044af-130">Pools, and hello databases in pools, should be monitored tooensure they stay within acceptable ranges of performance.</span></span> <span data-ttu-id="044af-131">Otimizar Olá conjunto configuração toomeet Olá às necessidades da carga de trabalho de agregação Olá de todas as bases de dados, assegurar que os eDTUs de conjunto de Olá estão adequados para Olá carga de trabalho geral.</span><span class="sxs-lookup"><span data-stu-id="044af-131">Tune hello pool configuration toomeet hello needs of hello aggregate workload of all databases, ensuring that hello pool eDTUs are appropriate for hello overall workload.</span></span> <span data-ttu-id="044af-132">Ajuste Olá por base de dados por base de dados e mínima de eDTU máxima valores tooappropriate os valores para os seus requisitos de aplicação específica.</span><span class="sxs-lookup"><span data-stu-id="044af-132">Adjust hello per-database min and per-database max eDTU values tooappropriate values for your specific application requirements.</span></span>

### <a name="performance-management-strategies"></a><span data-ttu-id="044af-133">Estratégias da gestão do desempenho</span><span class="sxs-lookup"><span data-stu-id="044af-133">Performance management strategies</span></span>

* <span data-ttu-id="044af-134">tooavoid ter toomanually monitorizar o desempenho, é mais eficaz demasiado**definir alertas acionam quando ou agrupamentos de bases de dados stray fora do normais intervalos**.</span><span class="sxs-lookup"><span data-stu-id="044af-134">tooavoid having toomanually monitor performance, it’s most effective too**set alerts that trigger when databases or pools stray out of normal ranges**.</span></span>
* <span data-ttu-id="044af-135">Olá, flutuações de tooshort termo toorespond de nível de desempenho agregado de Olá de um agrupamento, **nível de eDTU do conjunto pode ser escalado para cima ou para baixo**.</span><span class="sxs-lookup"><span data-stu-id="044af-135">toorespond tooshort-term fluctuations in hello aggregate performance level of a pool, hello **pool eDTU level can be scaled up or down**.</span></span> <span data-ttu-id="044af-136">Se esta flutuação ocorre de forma normal ou previsível, **dimensionamento conjunto Olá pode ser agendada toooccur automaticamente**.</span><span class="sxs-lookup"><span data-stu-id="044af-136">If this fluctuation occurs on a regular or predictable basis, **scaling hello pool can be scheduled toooccur automatically**.</span></span> <span data-ttu-id="044af-137">Por exemplo, reduza verticalmente quando sabe que a carga de trabalho é leve, talvez durante a noite ou durante os fins de semana.</span><span class="sxs-lookup"><span data-stu-id="044af-137">For example, scale down when you know your workload is light, maybe overnight, or during weekends.</span></span>
* <span data-ttu-id="044af-138">Olá, flutuações de toolonger termo toorespond ou alterações ao número de bases de dados, **bases de dados individuais podem ser movidos para outros conjuntos**.</span><span class="sxs-lookup"><span data-stu-id="044af-138">toorespond toolonger-term fluctuations, or changes in hello number of databases, **individual databases can be moved into other pools**.</span></span>
* <span data-ttu-id="044af-139">os aumentos toorespond tooshort termo *individuais* carga de base de dados **bases de dados individuais podem ser efetuadas fora de um conjunto e atribuídos um nível de desempenho individuais**.</span><span class="sxs-lookup"><span data-stu-id="044af-139">toorespond tooshort term increases in *individual* database load **individual databases can be taken out of a pool and assigned an individual performance level**.</span></span> <span data-ttu-id="044af-140">Assim que a carga de Olá é reduzida, base de dados de Olá pode, em seguida, ser devolvido toohello agrupamento.</span><span class="sxs-lookup"><span data-stu-id="044af-140">Once hello load is reduced, hello database can then be returned toohello pool.</span></span> <span data-ttu-id="044af-141">Quando isto é conhecido seguinte com antecedência, bases de dados podem ser movidos pre-emptively tooensure Olá base de dados sempre tem recursos Olá necessita e tooavoid impacto nas outras bases de dados no agrupamento de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-141">When this is known in advance, databases can be moved pre-emptively tooensure hello database always has hello resources it needs, and tooavoid impact on other databases in hello pool.</span></span> <span data-ttu-id="044af-142">Se este requisito é previsível, tais como um venue experienciar uma rush de vendas de pedido de suporte para um evento popular, este comportamento de gestão pode ser integrado na aplicação Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-142">If this requirement is predictable, such as a venue experiencing a rush of ticket sales for a popular event, then this management behavior can be integrated into hello application.</span></span>

<span data-ttu-id="044af-143">Olá [portal do Azure](https://portal.azure.com) fornece monitorização incorporada e os alertas na maioria dos recursos.</span><span class="sxs-lookup"><span data-stu-id="044af-143">hello [Azure portal](https://portal.azure.com) provides built-in monitoring and alerting on most resources.</span></span> <span data-ttu-id="044af-144">Na Base de Dados SQL, a monitorização e os alertas estão disponíveis nas bases de dados e nos conjuntos.</span><span class="sxs-lookup"><span data-stu-id="044af-144">For SQL Database, monitoring and alerting is available on databases and pools.</span></span> <span data-ttu-id="044af-145">Este incorporado monitorização e alertas é específico de recursos, é conveniente toouse para pequenas quantidades de recursos, mas não é muito conveniente ao trabalhar com muitos recursos.</span><span class="sxs-lookup"><span data-stu-id="044af-145">This built-in monitoring and alerting is resource-specific, so it's convenient toouse for small numbers of resources, but is not very convenient when working with many resources.</span></span>

<span data-ttu-id="044af-146">Para cenários de elevado volume onde está a trabalhar com muitos reources, [análise de registos (OMS)](sql-database-saas-tutorial-log-analytics.md) pode ser utilizado.</span><span class="sxs-lookup"><span data-stu-id="044af-146">For high-volume scenarios where you're working with many reources, [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md) can be used.</span></span> <span data-ttu-id="044af-147">Este é um serviço Azure separado que fornece análises através de registos de diagnóstico emitidos e telemetria recolhidos numa área de trabalho de análise de registo.</span><span class="sxs-lookup"><span data-stu-id="044af-147">This is a separate Azure service that provides analytics over emitted diagnostic logs and telemetry gathered in a log analytics workspace.</span></span> <span data-ttu-id="044af-148">Análise de registos pode recolher telemetria a partir de vários serviços e ser utilizado tooquery e definir alertas.</span><span class="sxs-lookup"><span data-stu-id="044af-148">Log Analytics can collect telemetry from many services and be used tooquery and set alerts.</span></span>

## <a name="get-hello-wingtip-application-source-code-and-scripts"></a><span data-ttu-id="044af-149">Obter o código fonte da aplicação Wingtip Olá e scripts</span><span class="sxs-lookup"><span data-stu-id="044af-149">Get hello Wingtip application source code and scripts</span></span>

<span data-ttu-id="044af-150">Olá Wingtip SaaS scripts e código fonte da aplicação estão disponíveis no Olá [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) repositório do github.</span><span class="sxs-lookup"><span data-stu-id="044af-150">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="044af-151">[Os passos scripts de Wingtip SaaS toodownload Olá](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="044af-151">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="provision-additional-tenants"></a><span data-ttu-id="044af-152">Aprovisionar inquilinos adicionais</span><span class="sxs-lookup"><span data-stu-id="044af-152">Provision additional tenants</span></span>

<span data-ttu-id="044af-153">Enquanto agrupamentos podem ser económicos com apenas dois bases de dados de S3, hello mais bases de dados que estão a ser Olá de conjunto de Olá mais económica Olá média, menos efeito torna-se.</span><span class="sxs-lookup"><span data-stu-id="044af-153">While pools can be cost-effective with just two S3 databases, hello more databases that are in hello pool hello more cost-effective hello averaging effect becomes.</span></span> <span data-ttu-id="044af-154">Para uma boa compreensão de como funciona a monitorização e a gestão do desempenho à escala, este tutorial requer que tenha, pelo menos, 20 bases de dados implementadas.</span><span class="sxs-lookup"><span data-stu-id="044af-154">For a good understanding of how performance monitoring and management works at scale, this tutorial requires you have at least 20 databases deployed.</span></span>

<span data-ttu-id="044af-155">Se já um lote de inquilinos que aprovisionou um tutorial anterior, avance toohello [simular utilização em todas as bases de dados do inquilino](#simulate-usage-on-all-tenant-databases) secção.</span><span class="sxs-lookup"><span data-stu-id="044af-155">If you already provisioned a batch of tenants in a prior tutorial, skip toohello [Simulate usage on all tenant databases](#simulate-usage-on-all-tenant-databases) section.</span></span>

1. <span data-ttu-id="044af-156">Abra... \\Learning módulos\\monitorização de desempenho e gestão\\*demonstração PerformanceMonitoringAndManagement.ps1* no Olá *ISE do PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="044af-156">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="044af-157">Mantenha este script aberto, uma vez que vai executar vários cenários durante este tutorial.</span><span class="sxs-lookup"><span data-stu-id="044af-157">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="044af-158">Defina **$DemoScenario** = **1**, **Aprovisionar um lote de inquilinos**</span><span class="sxs-lookup"><span data-stu-id="044af-158">Set **$DemoScenario** = **1**, **Provision a batch of tenants**</span></span>
1. <span data-ttu-id="044af-159">Prima **F5** script de Olá toorun.</span><span class="sxs-lookup"><span data-stu-id="044af-159">Press **F5** toorun hello script.</span></span>

<span data-ttu-id="044af-160">script de Olá irá implementar 17 inquilinos em menos de cinco minutos.</span><span class="sxs-lookup"><span data-stu-id="044af-160">hello script will deploy 17 tenants in less than five minutes.</span></span>

<span data-ttu-id="044af-161">Olá *New-TenantBatch* script utiliza um conjunto aninhado ou ligado de [Resource Manager](../azure-resource-manager/index.md) modelos que criam um lote de inquilinos, que, por predefinição, copia a base de dados de Olá **basetenantdb** no Olá catálogo toocreate Olá novo inquilino bases de dados, em seguida, regista estes no catálogo de Olá e, finalmente, inicializa-los com o tipo de nome e venue do inquilino de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-161">hello *New-TenantBatch* script uses a nested or linked set of [Resource Manager](../azure-resource-manager/index.md) templates that create a batch of tenants, which by default copies hello database **basetenantdb** on hello catalog server toocreate hello new tenant databases, then registers these in hello catalog, and finally initializes them with hello tenant name and venue type.</span></span> <span data-ttu-id="044af-162">Isto é consistente com a forma de Olá aplicação Olá aprovisiona um novo inquilino.</span><span class="sxs-lookup"><span data-stu-id="044af-162">This is consistent with hello way hello app provisions a new tenant.</span></span> <span data-ttu-id="044af-163">Todas as alterações efetuadas demasiado*basetenantdb* é aplicado tooany novos inquilinos aprovisionados após essa data.</span><span class="sxs-lookup"><span data-stu-id="044af-163">Any changes made too*basetenantdb* are applied tooany new tenants provisioned thereafter.</span></span> <span data-ttu-id="044af-164">Consulte Olá [tutorial de gestão de esquema](sql-database-saas-tutorial-schema-management.md) toosee como esquema de toomake alterações demasiado*existente* inquilino bases de dados (incluindo Olá *basetenantdb* base de dados).</span><span class="sxs-lookup"><span data-stu-id="044af-164">See hello [Schema Management tutorial](sql-database-saas-tutorial-schema-management.md) toosee how toomake schema changes too*existing* tenant databases (including hello *basetenantdb* database).</span></span>

## <a name="simulate-usage-on-all-tenant-databases"></a><span data-ttu-id="044af-165">Simular a utilização em todas as bases de dados de inquilinos</span><span class="sxs-lookup"><span data-stu-id="044af-165">Simulate usage on all tenant databases</span></span>

<span data-ttu-id="044af-166">Olá *demonstração PerformanceMonitoringAndManagement.ps1* script é fornecida que simula uma carga de trabalho em execução em todas as bases de dados do inquilino.</span><span class="sxs-lookup"><span data-stu-id="044af-166">hello *Demo-PerformanceMonitoringAndManagement.ps1* script is provided that simulates a workload running against all tenant databases.</span></span> <span data-ttu-id="044af-167">carga de Olá é gerada utilizando uma das situações de carga disponíveis Olá:</span><span class="sxs-lookup"><span data-stu-id="044af-167">hello load is generated using one of hello available load scenarios:</span></span>

| <span data-ttu-id="044af-168">Demonstração</span><span class="sxs-lookup"><span data-stu-id="044af-168">Demo</span></span> | <span data-ttu-id="044af-169">Cenário</span><span class="sxs-lookup"><span data-stu-id="044af-169">Scenario</span></span> |
|:--|:--|
| <span data-ttu-id="044af-170">2</span><span class="sxs-lookup"><span data-stu-id="044af-170">2</span></span> | <span data-ttu-id="044af-171">Gerar carga de intensidade normal (aprox. 40 DTUs)</span><span class="sxs-lookup"><span data-stu-id="044af-171">Generate normal intensity load (approx. 40 DTU)</span></span> |
| <span data-ttu-id="044af-172">3</span><span class="sxs-lookup"><span data-stu-id="044af-172">3</span></span> | <span data-ttu-id="044af-173">Gerar carga com picos mais demorados e mais frequentes por base de dados</span><span class="sxs-lookup"><span data-stu-id="044af-173">Generate load with longer and more frequent bursts per database</span></span>|
| <span data-ttu-id="044af-174">4</span><span class="sxs-lookup"><span data-stu-id="044af-174">4</span></span> | <span data-ttu-id="044af-175">Gerar carga com picos de DTU mais altos por base de dados (aprox. 80 DTUs)</span><span class="sxs-lookup"><span data-stu-id="044af-175">Generate load with higher DTU bursts per database (approx. 80 DTU)</span></span>|
| <span data-ttu-id="044af-176">5</span><span class="sxs-lookup"><span data-stu-id="044af-176">5</span></span> | <span data-ttu-id="044af-177">Gerar uma carga normal + uma carga elevada num inquilino individual (aprox. 95 DTUs)</span><span class="sxs-lookup"><span data-stu-id="044af-177">Generate a normal load plus a high load on a single tenant (approx. 95 DTU)</span></span>|
| <span data-ttu-id="044af-178">6</span><span class="sxs-lookup"><span data-stu-id="044af-178">6</span></span> | <span data-ttu-id="044af-179">Gerar carga desequilibrada em vários conjuntos</span><span class="sxs-lookup"><span data-stu-id="044af-179">Generate unbalanced load across multiple pools</span></span>|

<span data-ttu-id="044af-180">gerador de carga Olá aplica-se um *sintético* base de dados do carregamento só de CPU tooevery inquilino.</span><span class="sxs-lookup"><span data-stu-id="044af-180">hello load generator applies a *synthetic* CPU-only load tooevery tenant database.</span></span> <span data-ttu-id="044af-181">gerador de Olá inicia uma tarefa para cada base de dados do inquilino que chama um procedimento armazenado de uma só periodicamente o que gera carga Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-181">hello generator starts a job for each tenant database, which calls a stored procedure periodically that generates hello load.</span></span> <span data-ttu-id="044af-182">níveis de carga Olá (nas eDTUs), a duração e o intervalos são diversificados em todas as bases de dados, simulando atividade inquilino imprevisível.</span><span class="sxs-lookup"><span data-stu-id="044af-182">hello load levels (in eDTUs), duration, and intervals are varied across all databases, simulating unpredictable tenant activity.</span></span>

1. <span data-ttu-id="044af-183">Abra... \\Learning módulos\\monitorização de desempenho e gestão\\*demonstração PerformanceMonitoringAndManagement.ps1* no Olá *ISE do PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="044af-183">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="044af-184">Mantenha este script aberto, uma vez que vai executar vários cenários durante este tutorial.</span><span class="sxs-lookup"><span data-stu-id="044af-184">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="044af-185">Definir **$DemoScenario** = **2**, *carga normal intensidade de gerar*.</span><span class="sxs-lookup"><span data-stu-id="044af-185">Set **$DemoScenario** = **2**, *Generate normal intensity load*.</span></span>
1. <span data-ttu-id="044af-186">Prima **F5** tooapply tooall uma carga as bases de dados do inquilino.</span><span class="sxs-lookup"><span data-stu-id="044af-186">Press **F5** tooapply a load tooall your tenant databases.</span></span>

<span data-ttu-id="044af-187">Wingtip é uma aplicação SaaS e carga do mundo real Olá numa aplicação SaaS é normalmente esporádicas e imprevisíveis.</span><span class="sxs-lookup"><span data-stu-id="044af-187">Wingtip is a SaaS app, and hello real-world load on a SaaS app is typically sporadic and unpredictable.</span></span> <span data-ttu-id="044af-188">toosimulate isto, Olá carga gerador produz uma carga aleatório distribuída a todos os inquilinos.</span><span class="sxs-lookup"><span data-stu-id="044af-188">toosimulate this, hello load generator produces a randomized load distributed across all tenants.</span></span> <span data-ttu-id="044af-189">Necessários alguns minutos para Olá carga padrão tooemerge, por isso, executar o gerador de carga Olá durante 3 a 5 minutos antes de repetir o carregamento de Olá toomonitor em Olá secções a seguir.</span><span class="sxs-lookup"><span data-stu-id="044af-189">Several minutes are needed for hello load pattern tooemerge, so run hello load generator for 3-5 minutes before attempting toomonitor hello load in hello following sections.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="044af-190">gerador de carga Olá está em execução como uma série de tarefas na sua sessão do PowerShell local.</span><span class="sxs-lookup"><span data-stu-id="044af-190">hello load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="044af-191">Manter Olá *demonstração PerformanceMonitoringAndManagement.ps1* separador abra!</span><span class="sxs-lookup"><span data-stu-id="044af-191">Keep hello *Demo-PerformanceMonitoringAndManagement.ps1* tab open!</span></span> <span data-ttu-id="044af-192">Se fechar o separador de Olá ou suspender o seu computador, deixa de gerador de carga Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-192">If you close hello tab, or suspend your machine, hello load generator stops.</span></span> <span data-ttu-id="044af-193">gerador de carga Olá permanece num *invocar a tarefa* Estado onde gera carga de quaisquer novos inquilinos aprovisionados após o início do gerador de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-193">hello load generator remains in a *job-invoking* state where it generates load on any new tenants that are provisioned after hello generator is started.</span></span> <span data-ttu-id="044af-194">Utilize *Ctrl-C* toostop invocar as novas tarefas e saída Olá script.</span><span class="sxs-lookup"><span data-stu-id="044af-194">Use *Ctrl-C* toostop invoking new jobs and exit hello script.</span></span> <span data-ttu-id="044af-195">gerador de carga Olá continuará toorun, mas apenas nos inquilinos existentes.</span><span class="sxs-lookup"><span data-stu-id="044af-195">hello load generator will continue toorun, but only on existing tenants.</span></span>

## <a name="monitor-resource-usage-using-hello-azure-portal"></a><span data-ttu-id="044af-196">Monitorizar a utilização de recursos com Olá portal do Azure</span><span class="sxs-lookup"><span data-stu-id="044af-196">Monitor resource usage using hello Azure portal</span></span>

<span data-ttu-id="044af-197">toomonitor Olá a utilização de recursos que carregamento de resultados de Olá que está a ser aplicada, abra o conjunto de portal toohello de Olá que contêm bases de dados do Olá inquilino:</span><span class="sxs-lookup"><span data-stu-id="044af-197">toomonitor hello resource usage that results from hello load being applied, open hello portal toohello pool containing hello tenant databases:</span></span>

1. <span data-ttu-id="044af-198">Abra Olá [portal do Azure](https://portal.azure.com) e procurar toohello *tenants1 -&lt;utilizador&gt;*  servidor.</span><span class="sxs-lookup"><span data-stu-id="044af-198">Open hello [Azure portal](https://portal.azure.com) and browse toohello *tenants1-&lt;USER&gt;* server.</span></span>
1. <span data-ttu-id="044af-199">Desloque-se para baixo, localize os conjuntos elásticos e clique em **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="044af-199">Scroll down and locate elastic pools and click **Pool1**.</span></span> <span data-ttu-id="044af-200">Este conjunto contém todos os Olá inquilino bases de dados criadas até ao momento.</span><span class="sxs-lookup"><span data-stu-id="044af-200">This pool contains all hello tenant databases created so far.</span></span>

<span data-ttu-id="044af-201">Observar Olá **monitorização do conjunto elástico** e **monitorização de base de dados elástica** gráficos.</span><span class="sxs-lookup"><span data-stu-id="044af-201">Observe hello **Elastic pool monitoring** and **Elastic database monitoring** charts.</span></span>

<span data-ttu-id="044af-202">Olá a utilização de recursos do conjunto é utilização de base de dados de agregação de Olá para todas as bases de dados no agrupamento de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-202">hello pool's resource utilization is hello aggregate database utilization for all databases in hello pool.</span></span> <span data-ttu-id="044af-203">gráfico de base de dados de Olá mostra Olá cinco hottest bases de dados:</span><span class="sxs-lookup"><span data-stu-id="044af-203">hello database chart shows hello five hottest databases:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/pool1.png)

<span data-ttu-id="044af-204">Porque existem bases de dados adicionais no agrupamento de Olá além Olá cinco superior, utilização de conjunto de Olá mostra atividade que não será refletida no gráfico de bases de dados de cinco superior Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-204">Because there are additional databases in hello pool beyond hello top five, hello pool utilization shows activity that is not reflected in hello top five databases chart.</span></span> <span data-ttu-id="044af-205">Para obter mais detalhes, clique em **utilização de recursos de base de dados**:</span><span class="sxs-lookup"><span data-stu-id="044af-205">For additional details, click **Database Resource Utilization**:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/database-utilization.png)


## <a name="set-performance-alerts-on-hello-pool"></a><span data-ttu-id="044af-206">Definir alertas de desempenho Olá agrupamento</span><span class="sxs-lookup"><span data-stu-id="044af-206">Set performance alerts on hello pool</span></span>

<span data-ttu-id="044af-207">Defina um alerta num conjunto de Olá que aciona no \>75% de utilização da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="044af-207">Set an alert on hello pool that triggers on \>75% utilization as follows:</span></span>

1. <span data-ttu-id="044af-208">Abra *Pool1* (no Olá *tenants1 -\<utilizador\>*  servidor) no Olá [portal do Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="044af-208">Open *Pool1* (on hello *tenants1-\<user\>* server) in hello [Azure portal](https://portal.azure.com).</span></span>
1. <span data-ttu-id="044af-209">Clique em **Regras de Alerta**e, em seguida, clique em **+ Adicionar alerta**:</span><span class="sxs-lookup"><span data-stu-id="044af-209">Click **Alert Rules**, and then click **+ Add alert**:</span></span>

   ![adicionar alerta](media/sql-database-saas-tutorial-performance-monitoring/add-alert.png)

1. <span data-ttu-id="044af-211">Forneça um nome, tal como **DTU elevada**,</span><span class="sxs-lookup"><span data-stu-id="044af-211">Provide a name, such as **High DTU**,</span></span>
1. <span data-ttu-id="044af-212">Definir Olá os seguintes valores:</span><span class="sxs-lookup"><span data-stu-id="044af-212">Set hello following values:</span></span>
   * <span data-ttu-id="044af-213">**Métrica = percentagem de eDTU**</span><span class="sxs-lookup"><span data-stu-id="044af-213">**Metric = eDTU percentage**</span></span>
   * <span data-ttu-id="044af-214">**Condição = maior que**.</span><span class="sxs-lookup"><span data-stu-id="044af-214">**Condition = greater than**.</span></span>
   * <span data-ttu-id="044af-215">**Limiar = 75**.</span><span class="sxs-lookup"><span data-stu-id="044af-215">**Threshold = 75**.</span></span>
   * <span data-ttu-id="044af-216">**Período = através de Olá últimos 30 minutos**.</span><span class="sxs-lookup"><span data-stu-id="044af-216">**Period = Over hello last 30 minutes**.</span></span>
1. <span data-ttu-id="044af-217">Adicionar um toohello de endereço de correio eletrónico *administrador adicionais email(s)* caixa e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="044af-217">Add an email address toohello *Additional administrator email(s)* box and click **OK**.</span></span>

   ![alerta de definição](media/sql-database-saas-tutorial-performance-monitoring/alert-rule.png)


## <a name="scale-up-a-busy-pool"></a><span data-ttu-id="044af-219">Aumentar verticalmente um conjunto ocupado</span><span class="sxs-lookup"><span data-stu-id="044af-219">Scale up a busy pool</span></span>

<span data-ttu-id="044af-220">Se o nível de carga agregado Olá aumenta num ponto de toohello conjunto que maxes saída conjunto Olá e atingir a utilização de eDTU de 100%, em seguida, o desempenho de base de dados individuais é afetado, potencialmente abrandamento tempos de resposta de consulta para todas as bases de dados no agrupamento de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-220">If hello aggregate load level increases on a pool toohello point that it maxes out hello pool and reaches 100% eDTU usage, then individual database performance is affected, potentially slowing query response times for all databases in hello pool.</span></span>

<span data-ttu-id="044af-221">**A curto prazo**, considere como aumentar verticalmente a recursos adicionais do Olá conjunto tooprovide ou remover bases de dados do conjunto de Olá (movê-los tooother agrupamentos, ou fora do escalão de serviço autónomo Olá conjunto tooa).</span><span class="sxs-lookup"><span data-stu-id="044af-221">**Short term**, consider scaling up hello pool tooprovide additional resources, or removing databases from hello pool (moving them tooother pools, or out of hello pool tooa stand-alone service tier).</span></span>

<span data-ttu-id="044af-222">**Termo mais**, considere a possibilidade de otimizar as consultas ou índice de desempenho de base de dados de tooimprove de utilização.</span><span class="sxs-lookup"><span data-stu-id="044af-222">**Longer term**, consider optimizing queries or index usage tooimprove database performance.</span></span> <span data-ttu-id="044af-223">Consoante Olá tooperformance de sensibilidade da aplicação emite o tooscale prática melhor um conjunto de cópias de segurança antes de atingir a utilização de eDTU de 100%.</span><span class="sxs-lookup"><span data-stu-id="044af-223">Depending on hello application's sensitivity tooperformance issues its best practice tooscale a pool up before it reaches 100% eDTU usage.</span></span> <span data-ttu-id="044af-224">Utilize um alerta toowarn que antecipadamente.</span><span class="sxs-lookup"><span data-stu-id="044af-224">Use an alert toowarn you in advance.</span></span>

<span data-ttu-id="044af-225">Pode simular um conjunto ocupado ao aumento da carga Olá produzido pelo gerador de dimensões Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-225">You can simulate a busy pool by increasing hello load produced by hello generator.</span></span> <span data-ttu-id="044af-226">A causar Olá tooburst de bases de dados mais frequentemente e para a carga agregado Olá maior, aumentar no conjunto de Olá sem alterar os requisitos de Olá das bases de dados individuais Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-226">Causing hello databases tooburst more frequently, and for longer, increasing hello aggregate load on hello pool without changing hello requirements of hello individual databases.</span></span> <span data-ttu-id="044af-227">Como aumentar verticalmente conjunto Olá facilmente é efetuada no portal de Olá ou a partir do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="044af-227">Scaling up hello pool is easily done in hello portal or from PowerShell.</span></span> <span data-ttu-id="044af-228">Neste exercício utiliza o portal de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-228">This exercise uses hello portal.</span></span>

1. <span data-ttu-id="044af-229">Definir *$DemoScenario* = **3**, _carga gerar com maiores e mais frequentes bursts por base de dados_ intensidade de Olá tooincrease de carga de agregação Olá conjunto de Olá sem alterar Olá pico de carga necessário para cada base de dados.</span><span class="sxs-lookup"><span data-stu-id="044af-229">Set *$DemoScenario* = **3**, _Generate load with longer and more frequent bursts per database_ tooincrease hello intensity of hello aggregate load on hello pool without changing hello peak load required by each database.</span></span>
1. <span data-ttu-id="044af-230">Prima **F5** tooapply tooall uma carga as bases de dados do inquilino.</span><span class="sxs-lookup"><span data-stu-id="044af-230">Press **F5** tooapply a load tooall your tenant databases.</span></span>

1. <span data-ttu-id="044af-231">Aceda demasiado**Pool1** no Olá portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="044af-231">Go too**Pool1** in hello Azure portal.</span></span>

<span data-ttu-id="044af-232">Olá monitor aumenta a utilização de eDTU do conjunto no gráfico superior Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-232">Monitor hello increased pool eDTU usage on hello upper chart.</span></span> <span data-ttu-id="044af-233">Demora alguns minutos para tookick carga superior novo por Olá, mas rapidamente deverá ver o conjunto de Olá iniciar toohit de utilização máxima e como carga Olá steadies para padrão de nova Olá, sobrecarrega rapidamente conjunto Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-233">It takes a few minutes for hello new higher load tookick in, but you should quickly see hello pool start toohit max utilization, and as hello load steadies into hello new pattern, it rapidly overloads hello pool.</span></span>

1. <span data-ttu-id="044af-234">tooscale segurança agrupamento Olá, clique em **configurar conjunto** , Olá parte superior do Olá **Pool1** página.</span><span class="sxs-lookup"><span data-stu-id="044af-234">tooscale up hello pool, click **Configure pool** at hello top of hello **Pool1** page.</span></span>
1. <span data-ttu-id="044af-235">Ajustar Olá **eDTU do conjunto** definição demasiado**100**.</span><span class="sxs-lookup"><span data-stu-id="044af-235">Adjust hello **Pool eDTU** setting too**100**.</span></span> <span data-ttu-id="044af-236">A alteração de eDTU do conjunto de Olá não alterar as definições de por base de dados de Olá (que é ainda 50 eDTU máxima por base de dados).</span><span class="sxs-lookup"><span data-stu-id="044af-236">Changing hello pool eDTU does not change hello per-database settings (which is still 50 eDTU max per database).</span></span> <span data-ttu-id="044af-237">Pode ver as definições do Olá por base de dados no lado direito de Olá de Olá **configurar conjunto** página.</span><span class="sxs-lookup"><span data-stu-id="044af-237">You can see hello per-database settings on hello right side of hello **Configure pool** page.</span></span>
1. <span data-ttu-id="044af-238">Clique em **guardar** agrupamento de Olá toosubmit Olá pedido tooscale.</span><span class="sxs-lookup"><span data-stu-id="044af-238">Click **Save** toosubmit hello request tooscale hello pool.</span></span>

<span data-ttu-id="044af-239">Voltar atrás demasiado**Pool1** > **descrição geral** Olá tooview gráficos de monitorização.</span><span class="sxs-lookup"><span data-stu-id="044af-239">Go back too**Pool1** > **Overview** tooview hello monitoring charts.</span></span> <span data-ttu-id="044af-240">Monitorizar o efeito de Olá de fornecer o conjunto de Olá com mais recursos (embora com algumas bases de dados e uma carga aleatório não seja sempre toosee fácil conclusively até ser executado há algum tempo).</span><span class="sxs-lookup"><span data-stu-id="044af-240">Monitor hello effect of providing hello pool with more resources (although with few databases and a randomized load it’s not always easy toosee conclusively until you run for some time).</span></span> <span data-ttu-id="044af-241">Enquanto está a visualizar Olá gráficos tenha em atenção que a 100% no Olá superior agora gráfico representa 100 eDTUs, enquanto no Olá inferior gráfico 100% ainda 50 eDTUs como Olá por base de dados máximo ainda 50 eDTUs.</span><span class="sxs-lookup"><span data-stu-id="044af-241">While you are looking at hello charts bear in mind that 100% on hello upper chart now represents 100 eDTUs, while on hello lower chart 100% is still 50 eDTUs as hello per-database max is still 50 eDTUs.</span></span>

<span data-ttu-id="044af-242">Bases de dados permanecerem online e totalmente disponíveis ao longo do processo de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-242">Databases remain online and fully available throughout hello process.</span></span> <span data-ttu-id="044af-243">Em Olá último neste momento dado que cada base de dados é toobe pronto, ativada com Olá novo eDTU de agrupamento, quaisquer ligações ativas sejam interrompidas.</span><span class="sxs-lookup"><span data-stu-id="044af-243">At hello last moment as each database is ready toobe enabled with hello new pool eDTU, any active connections are broken.</span></span> <span data-ttu-id="044af-244">Código da aplicação sempre deve ser escrito tooretry ignorado ligações e para a ligação será restabelecida toohello base de dados no agrupamento de expandidos Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-244">Application code should always be written tooretry dropped connections, and so will reconnect toohello database in hello scaled-up pool.</span></span>

## <a name="load-balance-between-pools"></a><span data-ttu-id="044af-245">Balanceamento de carga entre conjuntos</span><span class="sxs-lookup"><span data-stu-id="044af-245">Load balance between pools</span></span>

<span data-ttu-id="044af-246">Como uma alternativa tooscaling segurança agrupamento Olá, crie um segundo conjunto e mover bases de dados para a mesma toobalance Olá carregar entre Olá dois conjuntos.</span><span class="sxs-lookup"><span data-stu-id="044af-246">As an alternative tooscaling up hello pool, create a second pool and move databases into it toobalance hello load between hello two pools.</span></span> <span data-ttu-id="044af-247">toodo este novo conjunto de Olá deve estar criado no Olá mesmo servidor que Olá primeiro.</span><span class="sxs-lookup"><span data-stu-id="044af-247">toodo this hello new pool must be created on hello same server as hello first.</span></span>

1. <span data-ttu-id="044af-248">No Olá [portal do Azure](https://portal.azure.com), abra Olá **tenants1 -&lt;utilizador&gt;**  servidor.</span><span class="sxs-lookup"><span data-stu-id="044af-248">In hello [Azure portal](https://portal.azure.com), open hello **tenants1-&lt;USER&gt;** server.</span></span>
1. <span data-ttu-id="044af-249">Clique em **+ novo conjunto** toocreate um agrupamento de servidor atual Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-249">Click **+ New pool** toocreate a pool on hello current server.</span></span>
1. <span data-ttu-id="044af-250">No Olá **conjunto de bases de dados elásticas** modelo:</span><span class="sxs-lookup"><span data-stu-id="044af-250">On hello **Elastic database pool** template:</span></span>

    1. <span data-ttu-id="044af-251">Definir **nome** demasiado*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="044af-251">Set **Name** too*Pool2*.</span></span>
    1. <span data-ttu-id="044af-252">Deixe Olá preços camada como **conjunto Standard**.</span><span class="sxs-lookup"><span data-stu-id="044af-252">Leave hello pricing tier as **Standard Pool**.</span></span>
    1. <span data-ttu-id="044af-253">Clique em **Configurar conjunto**.</span><span class="sxs-lookup"><span data-stu-id="044af-253">Click **Configure pool**,</span></span>
    1. <span data-ttu-id="044af-254">Definir **eDTU do conjunto** demasiado*50 eDTU*.</span><span class="sxs-lookup"><span data-stu-id="044af-254">Set **Pool eDTU** too*50 eDTU*.</span></span>
    1. <span data-ttu-id="044af-255">Clique em **adicionar bases de dados** toosee uma lista de bases de dados no servidor de Olá que podem ser adicionados demasiado*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="044af-255">Click **Add databases** toosee a list of databases on hello server that can be added too*Pool2*.</span></span>
    1. <span data-ttu-id="044af-256">Selecione qualquer toomove 10 bases de dados estes toohello novo agrupamento e, em seguida, clique em **selecione**.</span><span class="sxs-lookup"><span data-stu-id="044af-256">Select any 10 databases toomove these toohello new pool, and then click **Select**.</span></span> <span data-ttu-id="044af-257">Se tiver sido a executar o gerador de carga Olá, o serviço de Olá já sabe que o seu perfil de desempenho necessita de um conjunto maior do que o tamanho predefinido da 50 eDTU Olá e recomenda a começar com uma definição de eDTU 100.</span><span class="sxs-lookup"><span data-stu-id="044af-257">If you've been running hello load generator, hello service already knows that your performance profile requires a larger pool than hello default 50 eDTU size and recommends starting with a 100 eDTU setting.</span></span>

    ![Recomendação](media/sql-database-saas-tutorial-performance-monitoring/configure-pool.png)

    1. <span data-ttu-id="044af-259">Para este tutorial, deixe a predefinição de Olá 50 eDTUs e clique em **selecione** novamente.</span><span class="sxs-lookup"><span data-stu-id="044af-259">For this tutorial, leave hello default at 50 eDTUs, and click **Select** again.</span></span>
    1. <span data-ttu-id="044af-260">Selecione **OK** toocreate Olá novo agrupamento e toomove Olá selecionado bases de dados para a mesma.</span><span class="sxs-lookup"><span data-stu-id="044af-260">Select **OK** toocreate hello new pool and toomove hello selected databases into it.</span></span>

<span data-ttu-id="044af-261">Criar conjunto de Olá e mover bases de dados de Olá demora alguns minutos.</span><span class="sxs-lookup"><span data-stu-id="044af-261">Creating hello pool and moving hello databases takes a few minutes.</span></span> <span data-ttu-id="044af-262">Como as bases de dados são movidos permanecem online e acessível a totalmente até Olá último muito pouco, altura em que todas as ligações abertas são fechadas.</span><span class="sxs-lookup"><span data-stu-id="044af-262">As databases are moved they remain online and fully accessible until hello very last moment, at which point any open connections are closed.</span></span> <span data-ttu-id="044af-263">Desde que tenham algumas lógica de repetição, os clientes, em seguida, irão ligar toohello base de dados no novo conjunto de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-263">As long as you have some retry logic, clients will then connect toohello database in hello new pool.</span></span>

<span data-ttu-id="044af-264">Procurar demasiado**Pool2** (no Olá *tenants1* servidor) tooopen Olá agrupamento e monitorizar o desempenho dele.</span><span class="sxs-lookup"><span data-stu-id="044af-264">Browse too**Pool2** (on hello *tenants1* server) tooopen hello pool and monitor its performance.</span></span> <span data-ttu-id="044af-265">Se não o vir, aguarde que o aprovisionamento de Olá novo conjunto toocomplete.</span><span class="sxs-lookup"><span data-stu-id="044af-265">If you don't see it, wait for provisioning of hello new pool toocomplete.</span></span>

<span data-ttu-id="044af-266">Verá então que a utilização de recursos no *Pool1* interrompeu e que *Pool2* da mesma forma já foi carregadas.</span><span class="sxs-lookup"><span data-stu-id="044af-266">You now see that resource usage on *Pool1* has dropped and that *Pool2* is now similarly loaded.</span></span>

## <a name="manage-performance-of-a-single-database"></a><span data-ttu-id="044af-267">Gerir o desempenho de uma base de dados</span><span class="sxs-lookup"><span data-stu-id="044af-267">Manage performance of a single database</span></span>

<span data-ttu-id="044af-268">Se uma base de dados individual num conjunto sofre uma carga elevada constante, consoante a configuração do agrupamento de Olá, poderá tendem a recursos de Olá toodominate no agrupamento de Olá e afetar outras bases de dados.</span><span class="sxs-lookup"><span data-stu-id="044af-268">If a single database in a pool experiences a sustained high load, depending on hello pool configuration, it may tend toodominate hello resources in hello pool and impact other databases.</span></span> <span data-ttu-id="044af-269">Se a atividade de Olá toocontinue provável durante algum tempo, base de dados de Olá pode ser movido temporariamente fora do conjunto de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-269">If hello activity is likely toocontinue for some time, hello database can be temporarily moved out of hello pool.</span></span> <span data-ttu-id="044af-270">Isto permite Olá de toohave de base de dados de Olá recursos adicionais necessita e isola de Olá outras bases de dados.</span><span class="sxs-lookup"><span data-stu-id="044af-270">This allows hello database toohave hello extra resources it needs, and isolates it from hello other databases.</span></span>

<span data-ttu-id="044af-271">Neste exercício simula o efeito de Olá da Contoso Concert Hall experienciar uma elevada carga quando acede bilhetes de venda para um concert popular.</span><span class="sxs-lookup"><span data-stu-id="044af-271">This exercise simulates hello effect of Contoso Concert Hall experiencing a high load when tickets go on sale for a popular concert.</span></span>

1. <span data-ttu-id="044af-272">Abra Olá... \\ *Demonstração PerformanceMonitoringAndManagement.ps1* script.</span><span class="sxs-lookup"><span data-stu-id="044af-272">Open hello …\\*Demo-PerformanceMonitoringAndManagement.ps1* script.</span></span>
1. <span data-ttu-id="044af-273">Defina **$DemoScenario = 5, Gerar uma carga normal mais uma carga elevada num inquilino individual (aprox. 95 DTUs).**</span><span class="sxs-lookup"><span data-stu-id="044af-273">Set **$DemoScenario = 5, Generate a normal load plus a high load on a single tenant (approx. 95 DTU).**</span></span>
1. <span data-ttu-id="044af-274">Defina **$SingleTenantDatabaseName = contosoconcerthall**</span><span class="sxs-lookup"><span data-stu-id="044af-274">Set **$SingleTenantDatabaseName = contosoconcerthall**</span></span>
1. <span data-ttu-id="044af-275">Executar através do script de Olá **F5**.</span><span class="sxs-lookup"><span data-stu-id="044af-275">Execute hello script using **F5**.</span></span>


1. <span data-ttu-id="044af-276">No Olá [portal do Azure](https://portal.azure.com) abrir **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="044af-276">In hello [Azure portal](https://portal.azure.com) open **Pool1**.</span></span>
1. <span data-ttu-id="044af-277">Inspecione Olá **monitorização do conjunto elástico** gráfico e procure a utilização de eDTU do conjunto de Olá aumentada.</span><span class="sxs-lookup"><span data-stu-id="044af-277">Inspect hello **Elastic pool monitoring** chart and look for hello increased pool eDTU usage.</span></span> <span data-ttu-id="044af-278">Depois de um minuto ou dois, uma carga maior Olá deve começar tookick em e, deverá ver rapidamente o conjunto de Olá chega a utilização de 100%.</span><span class="sxs-lookup"><span data-stu-id="044af-278">After a minute or two, hello higher load should start tookick in, and you should quickly see that hello pool hits 100% utilization.</span></span>
1. <span data-ttu-id="044af-279">Inspecione Olá **monitorização de base de dados elástica** ecrã que mostra as bases de dados hottest Olá Olá horas anteriores.</span><span class="sxs-lookup"><span data-stu-id="044af-279">Inspect hello **Elastic database monitoring** display which shows hello hottest databases in hello past hour.</span></span> <span data-ttu-id="044af-280">Olá *contosoconcerthall* base de dados em breve deve aparecer como uma das bases de dados hottest Olá cinco.</span><span class="sxs-lookup"><span data-stu-id="044af-280">hello *contosoconcerthall* database should soon appear as one of hello five hottest databases.</span></span>
1. <span data-ttu-id="044af-281">**Clique em monitorização de base de dados elástica Olá** **gráfico** e abre-se Olá **utilização de recursos de base de dados** página onde é possível monitorizar qualquer uma das bases de dados de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-281">**Click on hello Elastic database monitoring** **chart** and it opens hello **Database Resource Utilization** page where you can monitor any of hello databases.</span></span> <span data-ttu-id="044af-282">Isto permite-lhe isolar apresentar Olá para Olá *contosoconcerthall* base de dados.</span><span class="sxs-lookup"><span data-stu-id="044af-282">This lets you isolate hello display for hello *contosoconcerthall* database.</span></span>
1. <span data-ttu-id="044af-283">Na lista de Olá das bases de dados, clique em **contosoconcerthall**.</span><span class="sxs-lookup"><span data-stu-id="044af-283">From hello list of databases, click **contosoconcerthall**.</span></span>
1. <span data-ttu-id="044af-284">Clique em **escalão de preço (dimensionamento DTUs)** tooopen Olá **Configurar desempenho** página onde pode definir um nível de desempenho autónomo da base de dados de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-284">Click **Pricing Tier (scale DTUs)** tooopen hello **Configure performance** page where you can set a stand-alone performance level for hello database.</span></span>
1. <span data-ttu-id="044af-285">Clique em Olá **padrão** separador Opções de dimensionamento de Olá tooopen no escalão Standard Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-285">Click on hello **Standard** tab tooopen hello scale options in hello Standard tier.</span></span>
1. <span data-ttu-id="044af-286">Deslize Olá **controlo de deslize DTU** tooright tooselect **100** DTUs.</span><span class="sxs-lookup"><span data-stu-id="044af-286">Slide hello **DTU slider** tooright tooselect **100** DTUs.</span></span> <span data-ttu-id="044af-287">Note que este corresponde ao objetivo de serviço toohello, **S3**.</span><span class="sxs-lookup"><span data-stu-id="044af-287">Note this corresponds toohello service objective, **S3**.</span></span>
1. <span data-ttu-id="044af-288">Clique em **aplicar** toomove Olá da base de dados fora do conjunto de Olá e torná-lo um *Standard S3* base de dados.</span><span class="sxs-lookup"><span data-stu-id="044af-288">Click **Apply** toomove hello database out of hello pool and make it a *Standard S3* database.</span></span>
1. <span data-ttu-id="044af-289">Assim que o dimensionamento é concluída, monitor Olá efeito na base de dados do Olá contosoconcerthall e Pool1 no painéis de agrupamento e da base de dados elásticos no Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-289">Once scaling is complete, monitor hello effect on hello contosoconcerthall database and Pool1 on hello elastic pool and database blades.</span></span>

<span data-ttu-id="044af-290">Assim que a carga elevada do Olá na base de dados do Olá contosoconcerthall subsides deve retomadas rapidamente regressar-toohello conjunto tooreduce o custo.</span><span class="sxs-lookup"><span data-stu-id="044af-290">Once hello high load on hello contosoconcerthall database subsides you should promptly return it toohello pool tooreduce its cost.</span></span> <span data-ttu-id="044af-291">Se não é claro quando que irá acontecer pode configurar um alerta na base de dados de Olá que é acionado quando a utilização da DTU descerem abaixo Olá por base de dados máximo no conjunto de Olá.</span><span class="sxs-lookup"><span data-stu-id="044af-291">If it’s unclear when that will happen you could set an alert on hello database that will trigger when its DTU usage drops below hello per-database max on hello pool.</span></span> <span data-ttu-id="044af-292">Veja o exercício 5, para saber como mover uma base de dados para um conjunto.</span><span class="sxs-lookup"><span data-stu-id="044af-292">Moving a database into a pool is described in exercise 5.</span></span>

## <a name="other-performance-management-patterns"></a><span data-ttu-id="044af-293">Outros Padrões de Gestão do Desempenho</span><span class="sxs-lookup"><span data-stu-id="044af-293">Other Performance Management Patterns</span></span>

<span data-ttu-id="044af-294">**Dimensionamento preventivas** exercício de Olá acima onde, explorou como tooscale uma base de dados isolado, souberem que toolook de base de dados para.</span><span class="sxs-lookup"><span data-stu-id="044af-294">**Pre-emptive scaling** In hello exercise above where you explored how tooscale an isolated database, you knew which database toolook for.</span></span> <span data-ttu-id="044af-295">Se a gestão de Olá da Contoso Concert Hall tinha informado Wingtips de venda de permissão iminente Olá, base de dados de Olá foi terem sido movido fora do conjunto de Olá pre-emptively.</span><span class="sxs-lookup"><span data-stu-id="044af-295">If hello management of Contoso Concert Hall had informed Wingtips of hello impending ticket sale, hello database could have been moved out of hello pool pre-emptively.</span></span> <span data-ttu-id="044af-296">Caso contrário, é provável que necessitaria um alerta no conjunto de Olá ou Olá toospot de base de dados que estava a acontecer.</span><span class="sxs-lookup"><span data-stu-id="044af-296">Otherwise, it would likely have required an alert on hello pool or hello database toospot what was happening.</span></span> <span data-ttu-id="044af-297">Não pretende toolearn sobre esta de Olá outros inquilinos na Olá conjunto complaining de degradação do desempenho.</span><span class="sxs-lookup"><span data-stu-id="044af-297">You wouldn’t want toolearn about this from hello other tenants in hello pool complaining of degraded performance.</span></span> <span data-ttu-id="044af-298">E se o inquilino Olá pode prever quanto terão de recursos adicionais pode configurar uma automatização do Azure runbook toomove Olá base de dados fora do conjunto de Olá e, em seguida, fazer uma cópia no novo com base numa agenda definida.</span><span class="sxs-lookup"><span data-stu-id="044af-298">And if hello tenant can predict how long they will need additional resources you can set up an Azure Automation runbook toomove hello database out of hello pool and then back in again on a defined schedule.</span></span>

<span data-ttu-id="044af-299">**Dimensionamento de self-service de inquilino** porque o dimensionamento é uma tarefa facilmente chamada através de API de gestão de Olá, pode facilmente criar capacidade Olá tooscale inquilino as bases de dados na sua aplicação destinado ao inquilino e oferecem-la como uma funcionalidade do seu serviço de SaaS.</span><span class="sxs-lookup"><span data-stu-id="044af-299">**Tenant self-service scaling** Because scaling is a task easily called via hello management API, you can easily build hello ability tooscale tenant databases into your tenant-facing application, and offer it as a feature of your SaaS service.</span></span> <span data-ttu-id="044af-300">Por exemplo, permitir que os inquilinos self-administer aumentar e reduzir verticalmente, talvez ligado diretamente tootheir faturação!</span><span class="sxs-lookup"><span data-stu-id="044af-300">For example, let tenants self-administer scaling up and down, perhaps linked directly tootheir billing!</span></span>

<span data-ttu-id="044af-301">**Aumentar um conjunto e reduzir verticalmente nos padrões de utilização de toomatch agenda**</span><span class="sxs-lookup"><span data-stu-id="044af-301">**Scaling a pool up and down on a schedule toomatch usage patterns**</span></span>

<span data-ttu-id="044af-302">Em que a utilização de agregação inquilino segue padrões de utilização previsíveis, pode utilizar tooscale de automatização do Azure um agrupamento de cima e baixo com base numa agenda.</span><span class="sxs-lookup"><span data-stu-id="044af-302">Where aggregate tenant usage follows predictable usage patterns, you can use Azure Automation tooscale a pool up and down on a schedule.</span></span> <span data-ttu-id="044af-303">Por exemplo, reduza verticalmente um conjunto após as 18:00 e aumente-o verticalmente antes das 06:00 nos dias da semana quando sabe que existe uma quebra nos requisitos de recursos.</span><span class="sxs-lookup"><span data-stu-id="044af-303">For example, scale a pool down after 6pm and up again before 6am on weekdays when you know there is a drop in resource requirements.</span></span>



## <a name="next-steps"></a><span data-ttu-id="044af-304">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="044af-304">Next steps</span></span>

<span data-ttu-id="044af-305">Neste tutorial, ficará a saber como:</span><span class="sxs-lookup"><span data-stu-id="044af-305">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="044af-306">Simular a utilização de bases de dados do Olá inquilino ao executar um gerador de carga fornecido</span><span class="sxs-lookup"><span data-stu-id="044af-306">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="044af-307">Inquilino do monitor Olá as bases de dados como estes respondem toohello aumento de carga</span><span class="sxs-lookup"><span data-stu-id="044af-307">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="044af-308">Aumentar verticalmente Olá conjunto elástico em resposta toohello da base de dados de aumento de carga</span><span class="sxs-lookup"><span data-stu-id="044af-308">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="044af-309">Aprovisionar uma segundo conjunto elástico tooload saldo Olá atividade base de dados</span><span class="sxs-lookup"><span data-stu-id="044af-309">Provision a second Elastic pool tooload balance hello database activity</span></span>

[<span data-ttu-id="044af-310">Tutorial Restaurar um inquilino individual</span><span class="sxs-lookup"><span data-stu-id="044af-310">Restore a single tenant tutorial</span></span>](sql-database-saas-tutorial-restore-single-tenant.md)


## <a name="additional-resources"></a><span data-ttu-id="044af-311">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="044af-311">Additional resources</span></span>

* <span data-ttu-id="044af-312">Adicionais [tutoriais baseiam Olá implementação de aplicação Wingtip SaaS](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="044af-312">Additional [tutorials that build upon hello Wingtip SaaS application deployment](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="044af-313">Conjuntos elásticos SQL</span><span class="sxs-lookup"><span data-stu-id="044af-313">SQL Elastic pools</span></span>](sql-database-elastic-pool.md)
* [<span data-ttu-id="044af-314">Automatização do Azure</span><span class="sxs-lookup"><span data-stu-id="044af-314">Azure automation</span></span>](../automation/automation-intro.md)
* <span data-ttu-id="044af-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) – Tutorial de configuração e utilização do Log Analytics</span><span class="sxs-lookup"><span data-stu-id="044af-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Setting up and using Log Analytics tutorial</span></span>
