---
title: "aaaJob dimensionamento com as funções do Azure Stream Analytics & AzureML | Microsoft Docs"
description: "Saiba como tooproperly dimensionar as tarefas do Stream Analytics (criação de partições, a quantidade SU e mais) ao utilizar as funções do Azure Machine Learning."
keywords: 
documentationcenter: 
services: stream-analytics
author: jeffstokes72
manager: jhubbard
editor: cgronlun
ms.assetid: 47ce7c5e-1de1-41ca-9a26-b5ecce814743
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: jeffstok
ms.openlocfilehash: 3fbdfaf7e8e86896c56f1d18bbde3a10bd3dca04
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/06/2017
---
# <a name="scale-your-stream-analytics-job-with-azure-machine-learning-functions"></a><span data-ttu-id="7ffb1-103">Dimensionar a sua tarefa do Stream Analytics com as funções do Azure Machine Learning</span><span class="sxs-lookup"><span data-stu-id="7ffb1-103">Scale your Stream Analytics job with Azure Machine Learning functions</span></span>
<span data-ttu-id="7ffb1-104">Muitas vezes, é fácil bastante tooset se uma tarefa de Stream Analytics e executar alguns dados de exemplo através do mesmo.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-104">It is often quite easy tooset up an Stream Analytics job and run some sample data through it.</span></span> <span data-ttu-id="7ffb1-105">O fazer quando é necessário toorun Olá mesmo da tarefa com o volume de dados superior?</span><span class="sxs-lookup"><span data-stu-id="7ffb1-105">What should we do when we need toorun hello same job with higher data volume?</span></span> <span data-ttu-id="7ffb1-106">Requer toounderstand como tooconfigure Olá Stream Analytics da tarefa para que sejam dimensionadas-nos.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-106">It requires us toounderstand how tooconfigure hello Stream Analytics job so that it will scale.</span></span> <span data-ttu-id="7ffb1-107">Neste documento, iremos focar-nos aspetos de especial Olá de dimensionamento do Stream Analytics tarefas com as funções de Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-107">In this document, we will focus on hello special aspects of scaling Stream Analytics jobs with Machine Learning functions.</span></span> <span data-ttu-id="7ffb1-108">Para obter informações sobre como tarefas do Stream Analytics tooscale em geral, consulte o artigo de Olá [dimensionamento tarefas](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-108">For information on how tooscale Stream Analytics jobs in general see hello article [Scaling jobs](stream-analytics-scale-jobs.md).</span></span>

## <a name="what-is-an-azure-machine-learning-function-in-stream-analytics"></a><span data-ttu-id="7ffb1-109">O que é uma função do Azure Machine Learning no Stream Analytics?</span><span class="sxs-lookup"><span data-stu-id="7ffb1-109">What is an Azure Machine Learning function in Stream Analytics?</span></span>
<span data-ttu-id="7ffb1-110">Uma função de Machine Learning no Stream Analytics pode ser utilizada como uma chamada de função regulares em Olá idioma de consulta do Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-110">A Machine Learning function in Stream Analytics can be used like a regular function call in hello Stream Analytics query language.</span></span> <span data-ttu-id="7ffb1-111">No entanto, por trás de cenas Olá, chamadas de função Olá são, na verdade, os pedidos de serviço Web do Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-111">However, behind hello scene, hello function calls are actually Azure Machine Learning Web Service requests.</span></span> <span data-ttu-id="7ffb1-112">Suporte "criação de batches" várias linhas, que é chamado batch mini de serviços web do Machine Learning, no Olá mesmo web chamada à API do serviço, tooimprove débito global.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-112">Machine Learning web services support “batching” multiple rows, which is called mini-batch, in hello same web service API call, tooimprove overall throughput.</span></span> <span data-ttu-id="7ffb1-113">Consulte Olá seguintes artigos para obter mais detalhes; [Funções do azure Machine Learning no Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) e [serviços Web do Azure Machine Learning](../machine-learning/machine-learning-consume-web-services.md).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-113">Please see hello following articles for more details; [Azure Machine Learning functions in Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) and [Azure Machine Learning Web Services](../machine-learning/machine-learning-consume-web-services.md).</span></span>

## <a name="configure-a-stream-analytics-job-with-machine-learning-functions"></a><span data-ttu-id="7ffb1-114">Configurar uma tarefa de Stream Analytics com as funções de Machine Learning</span><span class="sxs-lookup"><span data-stu-id="7ffb1-114">Configure a Stream Analytics job with Machine Learning functions</span></span>
<span data-ttu-id="7ffb1-115">Quando configurar uma função de Machine Learning para a tarefa de Stream Analytics, existem dois parâmetros tooconsider, tamanho do lote Olá de chamadas de função do Machine Learning Olá e Olá unidades (SUs) aprovisionadas para a tarefa de Stream Analytics Olá de transmissão em fluxo.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-115">When configuring a Machine Learning function for Stream Analytics job, there are two parameters tooconsider, hello batch size of hello Machine Learning function calls, and hello streaming units (SUs) provisioned for hello Stream Analytics job.</span></span> <span data-ttu-id="7ffb1-116">toodetermine Olá os valores adequados para estas, primeiro uma decisão têm de ser efetuada entre a latência e débito, ou seja, a latência da tarefa de Stream Analytics Olá e débito de cada SU.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-116">toodetermine hello appropriate values for these, first a decision must be made between latency and throughput, that is, latency of hello Stream Analytics job, and throughput of each SU.</span></span> <span data-ttu-id="7ffb1-117">Sempre podem ser adicionados tooa tarefa tooincrease débito uma consulta do Stream Analytics bem particionada, SUs embora SUs adicionais aumenta o custo de Olá de tarefa Olá em execução.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-117">SUs may always be added tooa job tooincrease throughput of a well partitioned Stream Analytics query, although additional SUs increases hello cost of running hello job.</span></span>

<span data-ttu-id="7ffb1-118">Por conseguinte, é importante toodetermine Olá *tolerância* de latência em execução uma tarefa de Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-118">Therefore it is important toodetermine hello *tolerance* of latency in running a Stream Analytics job.</span></span> <span data-ttu-id="7ffb1-119">Latência adicional a execução de pedidos de serviço do Azure Machine Learning naturalmente irá aumentar com o tamanho do lote, que será composta latência Olá da tarefa de Stream Analytics Olá.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-119">Additional latency from running Azure Machine Learning service requests will naturally increase with batch size, which will compound hello latency of hello Stream Analytics job.</span></span> <span data-ttu-id="7ffb1-120">No Olá por outro lado, aumentar o tamanho do lote permite tooprocess de tarefa do Stream Analytics Olá * mais eventos com Olá *mesmo número* do Machine Learning pedidos de serviço da web.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-120">On hello other hand, increasing batch size allows hello Stream Analytics job tooprocess *more events with hello *same number* of Machine Learning web service requests.</span></span> <span data-ttu-id="7ffb1-121">Muitas vezes, o aumento de Olá de latência de serviço web de Machine Learning é toohello subplano linear aumento do tamanho do lote, pelo que é importante tooconsider Olá mais económico tamanho do lote para um serviço web do Machine Learning em qualquer situação de determinado.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-121">Often hello increase of Machine Learning web service latency is sub-linear toohello increase of batch size so it is important tooconsider hello most cost-efficient batch size for a Machine Learning web service in any given situation.</span></span> <span data-ttu-id="7ffb1-122">tamanho de lote Olá predefinido para o serviço web de Olá pedidos é 1000 e pode ser modificado utilizando Olá [API de REST do Stream Analytics](https://msdn.microsoft.com/library/mt653706.aspx "API de REST do Stream Analytics") ou Olá [PowerShell cliente para o Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "PowerShell de cliente para o Stream Analytics").</span><span class="sxs-lookup"><span data-stu-id="7ffb1-122">hello default batch size for hello web service requests is 1000 and may be modified either by using hello [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") or hello [PowerShell client for Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "PowerShell client for Stream Analytics").</span></span>

<span data-ttu-id="7ffb1-123">Depois de um tamanho de lote foi considerado, quantidade de Olá de transmissão em fluxo unidades (SUs) podem ser determinadas, com base no Olá número de eventos que função Olá tem tooprocess por segundo.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-123">Once a batch size has been determined, hello amount of streaming units (SUs) can be determined, based on hello number of events that hello function needs tooprocess per second.</span></span> <span data-ttu-id="7ffb1-124">Para obter mais informações sobre unidades de transmissão em fluxo, consulte [Stream Analytics Dimensionar tarefas](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-124">For more information about streaming units, see [Stream Analytics scale jobs](stream-analytics-scale-jobs.md).</span></span>

<span data-ttu-id="7ffb1-125">Em geral, existem 20 ligações simultâneas serviço de web do Machine Learning toohello para cada 6 SUs, exceto que as tarefas de SU 1 e 3 tarefas SU obterá 20 ligações simultâneas também.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-125">In general, there are 20 concurrent connections toohello Machine Learning web service for every 6 SUs, except that 1 SU jobs and 3 SU jobs will get 20 concurrent connections also.</span></span>  <span data-ttu-id="7ffb1-126">Por exemplo, se a taxa de dados de entrada Olá é 200 000 eventos por segundo e o tamanho do lote Olá for deixado toohello predefinido de 1000 Olá resultante web service latência com o batch mini do 1000 eventos é de 200 MS.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-126">For example, if hello input data rate is 200,000 events per second and hello batch size is left toohello default of 1000 hello resulting web service latency with 1000 events mini-batch is 200ms.</span></span> <span data-ttu-id="7ffb1-127">Isto significa que cada ligação possa fazer 5 pedidos serviço de web do Machine Learning toohello num segundo.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-127">This means every connection can make 5 requests toohello Machine Learning web service in a second.</span></span> <span data-ttu-id="7ffb1-128">Com 20 ligações, tarefa de Stream Analytics Olá pode processar e, por conseguinte, 100 000 eventos de 20000 eventos 200 MS num segundo.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-128">With 20 connections, hello Stream Analytics job can process 20,000 events in 200ms  and therefore 100,000 events in a second.</span></span> <span data-ttu-id="7ffb1-129">Por isso, tooprocess inferior 200.000 eventos por segundo, tarefa de Stream Analytics Olá necessita de 40 ligações em simultâneo, vem saída too12 SUs.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-129">So tooprocess 200,000 events per second, hello Stream Analytics job needs 40 concurrent connections, which comes out too12 SUs.</span></span> <span data-ttu-id="7ffb1-130">Diagrama de Olá abaixo mostra os pedidos de Olá de Olá Stream Analytics tarefa toohello Machine Learning web ponto final de serviço – cada 6 SUs tem 20 serviço de web do Learning tooMachine ligações simultâneas no máximo.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-130">hello diagram below illustrates hello requests from hello Stream Analytics job toohello Machine Learning web service endpoint – Every 6 SUs has 20 concurrent connections tooMachine Learning web service at max.</span></span>

<span data-ttu-id="7ffb1-131">![Dimensionar o Stream Analytics com o exemplo de trabalho do Machine Learning funções 2](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "escala Stream Analytics com o exemplo de trabalho do Machine Learning funções 2")</span><span class="sxs-lookup"><span data-stu-id="7ffb1-131">![Scale Stream Analytics with Machine Learning Functions 2 job example](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "Scale Stream Analytics with Machine Learning Functions 2 job example")</span></span>

<span data-ttu-id="7ffb1-132">Em geral, ***B*** para o tamanho do lote, ***L*** de latência de serviço de web de Olá no tamanho do lote B em milissegundos, Olá débito de uma tarefa de Stream Analytics com ***N*** SUs é:</span><span class="sxs-lookup"><span data-stu-id="7ffb1-132">In general, ***B*** for batch size, ***L*** for hello web service latency at batch size B in milliseconds, hello throughput of an Stream Analytics job with ***N*** SUs is:</span></span>

<span data-ttu-id="7ffb1-133">![Dimensionar o do Stream Analytics com Machine Learning funções fórmula](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "do Stream Analytics com Machine Learning funções fórmula de dimensionamento")</span><span class="sxs-lookup"><span data-stu-id="7ffb1-133">![Scale Stream Analytics with Machine Learning Functions Formula](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "Scale Stream Analytics with Machine Learning Functions Formula")</span></span>

<span data-ttu-id="7ffb1-134">Uma consideração adicional pode ser Olá 'Máx. de chamadas em simultâneo' no Olá lado de serviço web Machine Learning, é recomendado tooset este valor máximo de toohello (200 atualmente).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-134">An additional consideration may be hello 'max concurrent calls' on hello Machine Learning web service side, it’s recommended tooset this toohello maximum value (200 currently).</span></span>

<span data-ttu-id="7ffb1-135">Para mais informações sobre esta definição reveja Olá [artigo de dimensionamento para serviços Web Machine Learning](../machine-learning/machine-learning-scaling-webservice.md).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-135">For more information on this setting please review hello [Scaling article for Machine Learning Web Services](../machine-learning/machine-learning-scaling-webservice.md).</span></span>

## <a name="example--sentiment-analysis"></a><span data-ttu-id="7ffb1-136">Exemplo-Sentiment análise</span><span class="sxs-lookup"><span data-stu-id="7ffb1-136">Example – Sentiment Analysis</span></span>
<span data-ttu-id="7ffb1-137">Olá exemplo seguinte inclui uma tarefa de Stream Analytics com a análise de dados de sentimento Olá função do Machine Learning, conforme descrito em Olá [tutorial de integração de aprendizagem do Stream Analytics](stream-analytics-machine-learning-integration-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-137">hello following example includes a Stream Analytics job with hello sentiment analysis Machine Learning function, as described in hello [Stream Analytics Machine Learning integration tutorial](stream-analytics-machine-learning-integration-tutorial.md).</span></span>

<span data-ttu-id="7ffb1-138">Olá consulta é uma consulta simples totalmente particionada, seguida de Olá **sentimento** funcionem, como mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="7ffb1-138">hello query is a simple fully partitioned query followed by hello **sentiment** function, as shown below:</span></span>

    WITH subquery AS (
        SELECT text, sentiment(text) as result from input
    )

    Select text, result.[Score]
    Into output
    From subquery

<span data-ttu-id="7ffb1-139">Considere Olá seguir o cenário; com um débito de 10 000 tweets por segundo deve ser criada uma tarefa de Stream Analytics análise de dados de sentimento tooperform de tweets Olá (eventos).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-139">Consider hello following scenario; with a throughput of 10,000 tweets per second a Stream Analytics job must be created tooperform sentiment analysis of hello tweets (events).</span></span> <span data-ttu-id="7ffb1-140">Utilizar 1 SU, esta tarefa de Stream Analytics dever toohandle capaz de tráfego de Olá?</span><span class="sxs-lookup"><span data-stu-id="7ffb1-140">Using 1 SU, could this Stream Analytics job be able toohandle hello traffic?</span></span> <span data-ttu-id="7ffb1-141">Utilizar o tamanho de lote Olá predefinido da tarefa de Olá 1000 deve ser capaz de tookeep cópias de segurança com entrada de Olá.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-141">Using hello default batch size of 1000 hello job should be able tookeep up with hello input.</span></span> <span data-ttu-id="7ffb1-142">Olá mais Adicionar função de Machine Learning deve gerar não mais do que um segundo de latência, que é a latência de predefinição geral Olá da análise de dados de sentimento Olá serviço web Machine Learning (com um tamanho de lote de predefinição de 1000).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-142">Further hello added Machine Learning function should generate no more than a second of latency, which is hello general default latency of hello sentiment analysis Machine Learning web service (with a default batch size of 1000).</span></span> <span data-ttu-id="7ffb1-143">tarefa de Stream Analytics a Olá **geral** ou latência ponto-a-ponto, normalmente, seria alguns segundos.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-143">hello Stream Analytics job’s **overall** or end-to-end latency would typically be a few seconds.</span></span> <span data-ttu-id="7ffb1-144">Veja mais detalhadas para esta tarefa de Stream Analytics *especialmente* Olá chamadas de função do Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-144">Take a more detailed look into this Stream Analytics job, *especially* hello Machine Learning function calls.</span></span> <span data-ttu-id="7ffb1-145">Ter o tamanho do lote Olá como 1000, um débito de 10 000 eventos irá demorar cerca de 10 pedidos tooweb serviço.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-145">Having hello batch size as 1000, a throughput of 10,000 events will take about 10 requests tooweb service.</span></span> <span data-ttu-id="7ffb1-146">Mesmo com 1 SU, existem suficiente tooaccommodate de ligações simultâneas este tráfego de entrada.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-146">Even with 1 SU, there are enough concurrent connections tooaccommodate this input traffic.</span></span>

<span data-ttu-id="7ffb1-147">Mas e se a taxa de eventos de entrada Olá aumenta ao 100 x e agora a tarefa de Stream Analytics Olá tem tooprocess 1.000.000 tweets por segundo?</span><span class="sxs-lookup"><span data-stu-id="7ffb1-147">But what if hello input event rate increases by 100x and now hello Stream Analytics job needs tooprocess 1,000,000 tweets per second?</span></span> <span data-ttu-id="7ffb1-148">Existem duas opções:</span><span class="sxs-lookup"><span data-stu-id="7ffb1-148">There are two options:</span></span>

1. <span data-ttu-id="7ffb1-149">Aumentar o tamanho do lote hello, ou</span><span class="sxs-lookup"><span data-stu-id="7ffb1-149">Increase hello batch size, or</span></span>
2. <span data-ttu-id="7ffb1-150">Partição Olá o fluxo de entrada tooprocess Olá eventos em paralelo</span><span class="sxs-lookup"><span data-stu-id="7ffb1-150">Partition hello input stream tooprocess hello events in parallel</span></span>

<span data-ttu-id="7ffb1-151">Com a opção de primeiro Olá, Olá tarefa **latência** irá aumentar.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-151">With hello first option, hello job **latency** will increase.</span></span>

<span data-ttu-id="7ffb1-152">Com a segunda opção Olá, SUs mais seriam necessário toobe aprovisionado e, por conseguinte, gerar mais pedidos simultâneos de Machine Learning web service.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-152">With hello second option, more SUs would need toobe provisioned and therefore generate more concurrent Machine Learning web service requests.</span></span> <span data-ttu-id="7ffb1-153">Isto significa que a tarefa de Olá **custo** irá aumentar.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-153">This means hello job **cost** will increase.</span></span>

<span data-ttu-id="7ffb1-154">Partem do princípio de latência de Olá da análise de dados de sentimento Olá serviço web Machine Learning é 200 MS para lotes de 1000 eventos ou abaixo, 250ms para eventos de 5000 lotes, 300ms para 10 000 eventos lotes ou 500ms para lotes 25,000-o evento.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-154">Assume hello latency of hello sentiment analysis Machine Learning web service is 200ms for 1000-event batches or below, 250ms for 5,000-event batches, 300ms for 10,000-event batches or 500ms for 25,000-event batches.</span></span>

1. <span data-ttu-id="7ffb1-155">Utilizando a opção de primeiro Olá, (**não** aprovisionamento mais SUs), o tamanho do lote Olá pode ser aumentado demasiado**25,000**.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-155">Using hello first option, (**not** provisioning more SUs), hello batch size could be increased too**25,000**.</span></span> <span data-ttu-id="7ffb1-156">Isto por sua vez permitiria que Olá tarefa tooprocess 1.000.000 eventos com 20 ligações simultâneas toohello serviço web Machine Learning (com uma latência de 500ms por chamada).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-156">This in turn would allow hello job tooprocess 1,000,000 events with 20 concurrent connections toohello Machine Learning web service (with a latency of 500ms per call).</span></span> <span data-ttu-id="7ffb1-157">Olá, por isso, a latência adicional da tarefa de Stream Analytics Olá devido a pedidos de função de sentimento toohello contra Olá Machine Learning pedidos de serviço web teriam de ser aumentados de **200 MS** demasiado**500ms**.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-157">So hello additional latency of hello Stream Analytics job due toohello sentiment function requests against hello Machine Learning web service requests would be increased from **200ms** too**500ms**.</span></span> <span data-ttu-id="7ffb1-158">No entanto, tenha em atenção que o tamanho do lote **não é possível** ser aumentado infinitamente como hello serviços web do Machine Learning, precisa de tamanho do payload Olá de um pedido web mais pequeno o tempo limite de pedidos de serviço após 100 segundos da operação ou ser 4 MB.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-158">However, note that batch size **cannot** be increased infinitely as hello Machine Learning web services requires hello payload size of a request be 4MB or smaller web service requests timeout after 100 seconds of operation.</span></span>
2. <span data-ttu-id="7ffb1-159">Utilizar a segunda opção de Olá, tamanho do lote Olá for deixado em 1000, com uma latência de serviço web de 200 MS, todos os serviço de web de toohello 20 ligações simultâneas seria capaz de tooprocess 1000 * 20 * 5 eventos = 100 000 por segundo.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-159">Using hello second option, hello batch size is left at 1000, with 200ms web service latency, every 20 concurrent connections toohello web service would be able tooprocess 1000 * 20 * 5 events = 100,000 per second.</span></span> <span data-ttu-id="7ffb1-160">Por isso, tooprocess 1.000.000 eventos por segundo, tarefa de Olá teria 60 SUs.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-160">So tooprocess 1,000,000 events per second, hello job would need 60 SUs.</span></span> <span data-ttu-id="7ffb1-161">Em comparação com toohello primeira opção, Stream Analytics tarefa iria tornar mais pedidos de batch de serviço, da web por sua vez gerar um custo de aumento.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-161">Compared toohello first option, Stream Analytics job would make more web service batch requests, in turn generating an increased cost.</span></span>

<span data-ttu-id="7ffb1-162">Segue-se uma tabela para o débito de Olá da tarefa de Stream Analytics Olá para diferentes SUs e tamanhos de lote (num número de eventos por segundo).</span><span class="sxs-lookup"><span data-stu-id="7ffb1-162">Below is a table for hello throughput of hello Stream Analytics job for different SUs and batch sizes (in number of events per second).</span></span>

| <span data-ttu-id="7ffb1-163">tamanho de lote (latência de ML)</span><span class="sxs-lookup"><span data-stu-id="7ffb1-163">batch size (ML latency)</span></span> | <span data-ttu-id="7ffb1-164">500 (200 MS)</span><span class="sxs-lookup"><span data-stu-id="7ffb1-164">500 (200ms)</span></span> | <span data-ttu-id="7ffb1-165">1000 (200 MS)</span><span class="sxs-lookup"><span data-stu-id="7ffb1-165">1,000 (200ms)</span></span> | <span data-ttu-id="7ffb1-166">5000 (250ms)</span><span class="sxs-lookup"><span data-stu-id="7ffb1-166">5,000 (250ms)</span></span> | <span data-ttu-id="7ffb1-167">10 000 (300ms)</span><span class="sxs-lookup"><span data-stu-id="7ffb1-167">10,000 (300ms)</span></span> | <span data-ttu-id="7ffb1-168">25,000 (500ms)</span><span class="sxs-lookup"><span data-stu-id="7ffb1-168">25,000 (500ms)</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="7ffb1-169">**1 SU**</span><span class="sxs-lookup"><span data-stu-id="7ffb1-169">**1 SU**</span></span> |<span data-ttu-id="7ffb1-170">2,500</span><span class="sxs-lookup"><span data-stu-id="7ffb1-170">2,500</span></span> |<span data-ttu-id="7ffb1-171">5,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-171">5,000</span></span> |<span data-ttu-id="7ffb1-172">20,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-172">20,000</span></span> |<span data-ttu-id="7ffb1-173">30,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-173">30,000</span></span> |<span data-ttu-id="7ffb1-174">50,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-174">50,000</span></span> |
| <span data-ttu-id="7ffb1-175">**3 SUs**</span><span class="sxs-lookup"><span data-stu-id="7ffb1-175">**3 SUs**</span></span> |<span data-ttu-id="7ffb1-176">2,500</span><span class="sxs-lookup"><span data-stu-id="7ffb1-176">2,500</span></span> |<span data-ttu-id="7ffb1-177">5,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-177">5,000</span></span> |<span data-ttu-id="7ffb1-178">20,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-178">20,000</span></span> |<span data-ttu-id="7ffb1-179">30,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-179">30,000</span></span> |<span data-ttu-id="7ffb1-180">50,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-180">50,000</span></span> |
| <span data-ttu-id="7ffb1-181">**6 SUs**</span><span class="sxs-lookup"><span data-stu-id="7ffb1-181">**6 SUs**</span></span> |<span data-ttu-id="7ffb1-182">2,500</span><span class="sxs-lookup"><span data-stu-id="7ffb1-182">2,500</span></span> |<span data-ttu-id="7ffb1-183">5,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-183">5,000</span></span> |<span data-ttu-id="7ffb1-184">20,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-184">20,000</span></span> |<span data-ttu-id="7ffb1-185">30,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-185">30,000</span></span> |<span data-ttu-id="7ffb1-186">50,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-186">50,000</span></span> |
| <span data-ttu-id="7ffb1-187">**12 SUs**</span><span class="sxs-lookup"><span data-stu-id="7ffb1-187">**12 SUs**</span></span> |<span data-ttu-id="7ffb1-188">5,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-188">5,000</span></span> |<span data-ttu-id="7ffb1-189">10,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-189">10,000</span></span> |<span data-ttu-id="7ffb1-190">40,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-190">40,000</span></span> |<span data-ttu-id="7ffb1-191">60,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-191">60,000</span></span> |<span data-ttu-id="7ffb1-192">100,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-192">100,000</span></span> |
| <span data-ttu-id="7ffb1-193">**18 SUs**</span><span class="sxs-lookup"><span data-stu-id="7ffb1-193">**18 SUs**</span></span> |<span data-ttu-id="7ffb1-194">7,500</span><span class="sxs-lookup"><span data-stu-id="7ffb1-194">7,500</span></span> |<span data-ttu-id="7ffb1-195">15,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-195">15,000</span></span> |<span data-ttu-id="7ffb1-196">60,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-196">60,000</span></span> |<span data-ttu-id="7ffb1-197">90,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-197">90,000</span></span> |<span data-ttu-id="7ffb1-198">150,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-198">150,000</span></span> |
| <span data-ttu-id="7ffb1-199">**24 SUs**</span><span class="sxs-lookup"><span data-stu-id="7ffb1-199">**24 SUs**</span></span> |<span data-ttu-id="7ffb1-200">10,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-200">10,000</span></span> |<span data-ttu-id="7ffb1-201">20,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-201">20,000</span></span> |<span data-ttu-id="7ffb1-202">80,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-202">80,000</span></span> |<span data-ttu-id="7ffb1-203">120,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-203">120,000</span></span> |<span data-ttu-id="7ffb1-204">200,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-204">200,000</span></span> |
| <span data-ttu-id="7ffb1-205">**…**</span><span class="sxs-lookup"><span data-stu-id="7ffb1-205">**…**</span></span> |<span data-ttu-id="7ffb1-206">…</span><span class="sxs-lookup"><span data-stu-id="7ffb1-206">…</span></span> |<span data-ttu-id="7ffb1-207">…</span><span class="sxs-lookup"><span data-stu-id="7ffb1-207">…</span></span> |<span data-ttu-id="7ffb1-208">…</span><span class="sxs-lookup"><span data-stu-id="7ffb1-208">…</span></span> |<span data-ttu-id="7ffb1-209">…</span><span class="sxs-lookup"><span data-stu-id="7ffb1-209">…</span></span> |<span data-ttu-id="7ffb1-210">…</span><span class="sxs-lookup"><span data-stu-id="7ffb1-210">…</span></span> |
| <span data-ttu-id="7ffb1-211">**60 SUs**</span><span class="sxs-lookup"><span data-stu-id="7ffb1-211">**60 SUs**</span></span> |<span data-ttu-id="7ffb1-212">25,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-212">25,000</span></span> |<span data-ttu-id="7ffb1-213">50,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-213">50,000</span></span> |<span data-ttu-id="7ffb1-214">200,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-214">200,000</span></span> |<span data-ttu-id="7ffb1-215">300,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-215">300,000</span></span> |<span data-ttu-id="7ffb1-216">500,000</span><span class="sxs-lookup"><span data-stu-id="7ffb1-216">500,000</span></span> |

<span data-ttu-id="7ffb1-217">Por agora, já deverá ter uma boa compreensão sobre como funcionam as funções de Machine Learning no Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-217">By now, you should already have a good understanding of how Machine Learning functions in Stream Analytics work.</span></span> <span data-ttu-id="7ffb1-218">Provavelmente também compreende que tarefas do Stream Analytics "solicitar" dados a partir de origens de dados e cada "pull" devolve um lote de eventos para Olá tooprocess de tarefa do Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-218">You likely also understand that Stream Analytics jobs “pull” data from data sources and each “pull” returns a batch of events for hello Stream Analytics job tooprocess.</span></span> <span data-ttu-id="7ffb1-219">Como é que este modelo de extração afetar os pedidos de serviço web do Olá Machine Learning?</span><span class="sxs-lookup"><span data-stu-id="7ffb1-219">How does this pull model impact hello Machine Learning web service requests?</span></span>

<span data-ttu-id="7ffb1-220">Normalmente, o tamanho do lote Olá que definimos para funções de Machine Learning exatamente será divisible por número de Olá de eventos devolvidos por cada tarefa de Stream Analytics "solicitação".</span><span class="sxs-lookup"><span data-stu-id="7ffb1-220">Normally, hello batch size we set for Machine Learning functions won’t exactly be divisible by hello number of events returned by each Stream Analytics job “pull”.</span></span> <span data-ttu-id="7ffb1-221">Quando isto ocorre Olá serviço web Machine Learning será chamado com lotes "parciais".</span><span class="sxs-lookup"><span data-stu-id="7ffb1-221">When this occurs hello Machine Learning web service will be called with “partial” batches.</span></span> <span data-ttu-id="7ffb1-222">Isto é feito toonot implicar a latência de trabalhos adicionais sobrecarga em eventos de agregação de toopull de extração.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-222">This is done toonot incur additional job latency overhead in coalescing events from pull toopull.</span></span>

## <a name="new-function-related-monitoring-metrics"></a><span data-ttu-id="7ffb1-223">Nova função monitorização das métricas relacionadas com</span><span class="sxs-lookup"><span data-stu-id="7ffb1-223">New function-related monitoring metrics</span></span>
<span data-ttu-id="7ffb1-224">Na área de Monitor de uma tarefa de Stream Analytics Olá, foram adicionadas três métricas adicionais relacionados com a função.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-224">In hello Monitor area of a Stream Analytics job, three additional function-related metrics have been added.</span></span> <span data-ttu-id="7ffb1-225">Estes são pedidos de função, eventos de função e função de pedidos FALHADOS, conforme apresentado no gráfico Olá abaixo.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-225">They are FUNCTION REQUESTS, FUNCTION EVENTS and FAILED FUNCTION REQUESTS, as shown in hello graphic below.</span></span>

<span data-ttu-id="7ffb1-226">![Dimensionar o do Stream Analytics com a métrica de funções do Machine Learning](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "dimensionar o do Stream Analytics com a métrica de funções do Machine Learning")</span><span class="sxs-lookup"><span data-stu-id="7ffb1-226">![Scale Stream Analytics with Machine Learning Functions Metrics](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "Scale Stream Analytics with Machine Learning Functions Metrics")</span></span>

<span data-ttu-id="7ffb1-227">Olá são definidos do seguinte modo:</span><span class="sxs-lookup"><span data-stu-id="7ffb1-227">hello are defined as follows:</span></span>

<span data-ttu-id="7ffb1-228">**PEDIDOS de função**: Olá número de pedidos de função.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-228">**FUNCTION REQUESTS**: hello number of function requests.</span></span>

<span data-ttu-id="7ffb1-229">**EVENTOS de função**: eventos de número de Olá no Olá funcionarem pedidos.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-229">**FUNCTION EVENTS**: hello number events in hello function requests.</span></span>

<span data-ttu-id="7ffb1-230">**PEDIDOS FALHADOS de função**: Olá número de pedidos de função falhada.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-230">**FAILED FUNCTION REQUESTS**: hello number of failed function requests.</span></span>

## <a name="key-takeaways"></a><span data-ttu-id="7ffb1-231">Chaves Takeaways</span><span class="sxs-lookup"><span data-stu-id="7ffb1-231">Key Takeaways</span></span>
<span data-ttu-id="7ffb1-232">toosummarize Olá principal pontos, tooscale ordem uma tarefa de Stream Analytics com as funções de Machine Learning, hello seguintes itens têm de ser considerados:</span><span class="sxs-lookup"><span data-stu-id="7ffb1-232">toosummarize hello main points, in order tooscale an Stream Analytics job with Machine Learning functions, hello following items must be considered:</span></span>

1. <span data-ttu-id="7ffb1-233">taxa de eventos de entrada de Olá</span><span class="sxs-lookup"><span data-stu-id="7ffb1-233">hello input event rate</span></span>
2. <span data-ttu-id="7ffb1-234">Olá tolerated latência para Olá executar tarefa de Stream Analytics (e, por conseguinte, o tamanho do lote Olá do serviço de web do Machine Learning Olá pedidos)</span><span class="sxs-lookup"><span data-stu-id="7ffb1-234">hello tolerated latency for hello running Stream Analytics job (and thus hello batch size of hello Machine Learning web service requests)</span></span>
3. <span data-ttu-id="7ffb1-235">Olá aprovisionado Stream Analytics SUs e número de Olá de pedidos de serviço web Machine Learning (Olá relacionadas com a função custos adicionais)</span><span class="sxs-lookup"><span data-stu-id="7ffb1-235">hello provisioned Stream Analytics SUs and hello number of Machine Learning web service requests (hello additional function-related costs)</span></span>

<span data-ttu-id="7ffb1-236">Uma consulta do Stream Analytics totalmente particionada foi utilizada como exemplo.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-236">A fully partitioned Stream Analytics query was used as an example.</span></span> <span data-ttu-id="7ffb1-237">Se necessitar de uma consulta mais complexa Olá [fórum do Azure Stream Analytics](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) é um ótimo recurso para obter ajuda adicional da equipa de Stream Analytics Olá.</span><span class="sxs-lookup"><span data-stu-id="7ffb1-237">If a more complex query is needed hello [Azure Stream Analytics forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) is a great resource for getting additional help from hello Stream Analytics team.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7ffb1-238">Passos seguintes</span><span class="sxs-lookup"><span data-stu-id="7ffb1-238">Next steps</span></span>
<span data-ttu-id="7ffb1-239">toolearn mais informações sobre o Stream Analytics, consulte:</span><span class="sxs-lookup"><span data-stu-id="7ffb1-239">toolearn more about Stream Analytics, see:</span></span>

* [<span data-ttu-id="7ffb1-240">Começar a utilizar o Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="7ffb1-240">Get started using Azure Stream Analytics</span></span>](stream-analytics-real-time-fraud-detection.md)
* [<span data-ttu-id="7ffb1-241">Tarefas de escala do Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="7ffb1-241">Scale Azure Stream Analytics jobs</span></span>](stream-analytics-scale-jobs.md)
* [<span data-ttu-id="7ffb1-242">Referência do idioma de consulta do Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="7ffb1-242">Azure Stream Analytics Query Language Reference</span></span>](https://msdn.microsoft.com/library/azure/dn834998.aspx)
* [<span data-ttu-id="7ffb1-243">Referência de API do REST de gestão do Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="7ffb1-243">Azure Stream Analytics Management REST API Reference</span></span>](https://msdn.microsoft.com/library/azure/dn835031.aspx)
